(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    188408,       4060]
NotebookOptionsPosition[    179515,       3912]
NotebookOutlinePosition[    180035,       3931]
CellTagsIndexPosition[    179992,       3928]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PredicateName", "[", "p_Symbol", "]"}], ":=", " ", "p"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Special", " ", "case", " ", "usable", " ", "for", " ", "simpler", " ", 
    "representation", " ", "of", " ", "propositional", " ", "logic"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PredicateName", "[", 
   RowBox[{"p_", "[", "x___", "]"}], "]"}], ":=", 
  "p"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PredicateSymbols", "[", 
   RowBox[{"Not", "[", "a_", "]"}], "]"}], " ", ":=", " ", 
  RowBox[{"PredicateSymbols", "[", "a", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PredicateSymbols", "[", 
   RowBox[{"a_", "\[And]", "b_"}], "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"PredicateSymbols", "[", "a", "]"}], "\[Union]", 
   RowBox[{"PredicateSymbols", "[", "b", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PredicateSymbols", "[", 
   RowBox[{"a_", "\[Or]", "b_"}], "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"PredicateSymbols", "[", "a", "]"}], "\[Union]", 
   RowBox[{"PredicateSymbols", "[", "b", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PredicateSymbols", "[", 
   RowBox[{"a_", "\[Implies]", "b_"}], "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"PredicateSymbols", "[", "a", "]"}], "\[Union]", 
   RowBox[{"PredicateSymbols", "[", "b", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PredicateSymbols", "[", 
   RowBox[{"p_Symbol", "[", "x_", "]"}], "]"}], ":=", " ", 
  RowBox[{"{", 
   RowBox[{"{", 
    RowBox[{"p", ",", " ", "1"}], "}"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PredicateSymbols", "[", 
   RowBox[{"p_Symbol", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{"{", 
    RowBox[{"p", ",", "2"}], "}"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FOAtoms", "[", "False", "]"}], " ", ":=", " ", 
  RowBox[{"{", "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FOAtoms", "[", "True", "]"}], " ", ":=", " ", 
  RowBox[{"{", "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FOAtoms", "[", 
   RowBox[{"Not", "[", "\[Phi]_", "]"}], "]"}], " ", ":=", " ", 
  RowBox[{"FOAtoms", "[", "\[Phi]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FOAtoms", "[", 
   RowBox[{"\[Phi]_", "\[And]", "\[Psi]_"}], "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"FOAtoms", "[", "\[Phi]", "]"}], "\[Union]", 
   RowBox[{"FOAtoms", "[", "\[Psi]", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FOAtoms", "[", 
   RowBox[{"\[Phi]_", "\[Or]", "\[Psi]_"}], "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"FOAtoms", "[", "\[Phi]", "]"}], "\[Union]", 
   RowBox[{"FOAtoms", "[", "\[Psi]", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FOAtoms", "[", 
   RowBox[{"\[Phi]_", "\[Implies]", "\[Psi]_"}], "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"FOAtoms", "[", "\[Phi]", "]"}], "\[Union]", 
   RowBox[{"FOAtoms", "[", "\[Psi]", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FOAtoms", "[", "atom_", "]"}], ":=", " ", 
  RowBox[{"{", "atom", "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PositiveAtoms", "[", "model_List", "]"}], ":=", 
  RowBox[{"model", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"a_", "\[Rule]", "False"}], ")"}], " ", "\[RuleDelayed]", " ", 
      "Nothing"}], ",", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"a_", "\[Rule]", "True"}], ")"}], " ", "\[RuleDelayed]", " ", 
      "a"}]}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NegativeAtoms", "[", "model_List", "]"}], ":=", 
  RowBox[{"model", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"a_", "\[Rule]", "True"}], ")"}], " ", "\[RuleDelayed]", " ", 
      "Nothing"}], ",", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"a_", "\[Rule]", "False"}], ")"}], " ", "\[RuleDelayed]", " ", 
      "a"}]}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PredicateSymbol", "[", 
   RowBox[{"p_Symbol", "[", "x___", "]"}], "]"}], ":=", " ", 
  RowBox[{"{", 
   RowBox[{"p", ",", " ", 
    RowBox[{"Length", "[", "x", "]"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PredicateSymbols", "[", "\[Phi]_", "]"}], ":=", " ", 
  RowBox[{"PredicateSymbol", "/@", " ", 
   RowBox[{"FOAtoms", "[", "\[Phi]", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MakeLiteral", "[", 
   RowBox[{"a_", "->", "True"}], "]"}], ":=", " ", 
  "a"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MakeLiteral", "[", 
   RowBox[{"b_", "->", "False"}], "]"}], ":=", " ", 
  RowBox[{"\[Not]", "b"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"InterpretationToFormula", "[", "f_List", "]"}], ":=", " ", 
  RowBox[{"And", "@@", 
   RowBox[{"(", 
    RowBox[{"MakeLiteral", " ", "/@", " ", "f"}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SymbolSetWeight", "[", 
   RowBox[{"set_List", ",", " ", "weights_"}], "]"}], ":=", " ", 
  RowBox[{"Times", "@@", " ", 
   RowBox[{"(", 
    RowBox[{"weights", " ", "/@", "set"}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GroundAtomSetWeight", "[", 
   RowBox[{"set_List", ",", " ", "weights_"}], "]"}], ":=", 
  RowBox[{"SymbolSetWeight", "[", 
   RowBox[{
    RowBox[{"PredicateName", "/@", " ", "set"}], ",", " ", "weights"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ModelWeight", "[", 
   RowBox[{
   "model_", ",", " ", "weightsPositive_", ",", " ", "weightsNegative_"}], 
   "]"}], ":=", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"FIXME", " ", "-", " ", 
    RowBox[{
    "this", " ", "should", " ", "be", " ", "easy", " ", "to", " ", "make", 
     " ", "2", "x", " ", "faster"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"GroundAtomSetWeight", "[", 
    RowBox[{
     RowBox[{"PositiveAtoms", "[", "model", "]"}], ",", " ", 
     "weightsPositive"}], "]"}], " ", "*", " ", 
   RowBox[{"GroundAtomSetWeight", "[", 
    RowBox[{
     RowBox[{"NegativeAtoms", "[", "model", "]"}], ",", " ", 
     "weightsNegative"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AllModels", "[", "False", "]"}], ":=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AllModels", "[", "True", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"{", "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AllModels", "[", "\[Phi]_", "]"}], ":=", " ", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"variables", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], ",", 
        RowBox[{"f", "[", 
         RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], ",", " ", 
        RowBox[{"f", "[", 
         RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}], ",", 
        RowBox[{"f", "[", 
         RowBox[{"\[FormalB]", ",", "\[FormalB]"}], "]"}]}], "}"}]}], "}"}], 
    ",", " ", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"FIXME", " ", "-", " ", 
       RowBox[{
       "this", " ", "is", " ", "probably", " ", "wrong", " ", "in", " ", 
        "general"}]}], ",", " ", 
      RowBox[{"if", " ", "not", " ", "justify", " ", "why"}]}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"modelBool", "\[Function]", 
       RowBox[{"Thread", "[", 
        RowBox[{"variables", "\[Rule]", "modelBool"}], "]"}]}], ")"}], "/@", 
     "\[IndentingNewLine]", 
     RowBox[{"SatisfiabilityInstances", "[", 
      RowBox[{"\[Phi]", ",", "variables", ",", "All"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WeightedModels", "[", 
   RowBox[{"\[Phi]_", ",", "weightsPositive_", ",", " ", "weightsNegative_"}],
    "]"}], ":=", 
  RowBox[{"Total", "[", " ", 
   RowBox[{"(*", 
    RowBox[{
    "naive", " ", "WMC", " ", "implementation", " ", "using", " ", "SAT"}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"model", " ", "\[Function]", 
      RowBox[{"ModelWeight", "[", 
       RowBox[{
       "model", ",", " ", "weightsPositive", ",", " ", "weightsNegative"}], 
       "]"}]}], ")"}], "/@", "\[IndentingNewLine]", 
    RowBox[{"AllModels", "[", "\[Phi]", "]"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PredicateToAtom", "[", 
   RowBox[{"{", 
    RowBox[{"p_", ",", "1"}], "}"}], "]"}], ":=", " ", 
  RowBox[{"p", "[", "\[FormalA]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PredicateToAtom", "[", 
   RowBox[{"{", 
    RowBox[{"p_", ",", "2"}], "}"}], "]"}], ":=", " ", 
  RowBox[{"p", "[", 
   RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}]}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{"CellAtoms", "[", "predicates_List", "]"}], ":=", 
   RowBox[{"PredicateToAtom", "/@", " ", "predicates"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"MakeCell", "[", 
     RowBox[{"atoms_List", ",", "fs_List"}], "]"}], ":=", "  ", 
    RowBox[{"And", "@@", 
     RowBox[{"MapThread", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"#1", "[", "#2", "]"}], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{"fs", ",", "atoms"}], "}"}]}], "]"}]}]}], " ", "*)"}], 
  RowBox[{"(*", " ", 
   RowBox[{
   "just", " ", "a", " ", "helper", " ", "function", " ", "for", " ", 
    "AllCells"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MakeCell", "[", 
   RowBox[{"atoms_List", ",", "boolVec_List"}], "]"}], ":=", " ", 
  RowBox[{"Thread", "[", 
   RowBox[{"atoms", "\[Rule]", "boolVec"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AllCells", "[", "atoms_List", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"boolVec", " ", "\[Function]", 
     RowBox[{"MakeCell", "[", 
      RowBox[{"atoms", ",", "boolVec"}], "]"}]}], ")"}], "/@", 
   "\[IndentingNewLine]", 
   RowBox[{"Tuples", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"False", ",", "True"}], "}"}], ",", " ", 
     RowBox[{"Length", "[", "atoms", "]"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FormulaCells", "[", "\[Phi]_", "]"}], ":=", " ", 
  RowBox[{"AllCells", "@", 
   RowBox[{"CellAtoms", "@", 
    RowBox[{
    "PredicateSymbols", "[", "\[Phi]", "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SwapVariables", "[", "object_", "]"}], ":=", " ", 
  RowBox[{"object", " ", "/.", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[FormalA]", "\[Rule]", "\[FormalB]"}], ",", " ", 
     RowBox[{"\[FormalB]", "\[Rule]", "\[FormalA]"}]}], 
    "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FormulaSymmetric", "[", "\[Psi]_", "]"}], ":=", 
  RowBox[{"\[Psi]", "\[And]", 
   RowBox[{"SwapVariables", "[", "\[Psi]", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FormulaReflexive", "[", "\[Psi]_", "]"}], ":=", " ", 
  RowBox[{"\[Psi]", " ", "/.", " ", 
   RowBox[{"\[FormalB]", "\[Rule]", "\[FormalA]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FormulaSimplified1Cell", "[", 
   RowBox[{"\[Psi]_", ",", "cell_"}], "]"}], " ", ":=", " ", 
  RowBox[{"\[Psi]", " ", "/.", 
   RowBox[{"Join", "[", 
    RowBox[{"cell", ",", " ", 
     RowBox[{"SwapVariables", "[", "cell", "]"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FormulaSimplified2Cell", "[", 
   RowBox[{"\[Psi]_", ",", "cell1_", ",", " ", "cell2_"}], "]"}], " ", ":=", 
  " ", 
  RowBox[{
   RowBox[{"FormulaSymmetric", "[", "\[Psi]", "]"}], " ", "/.", 
   RowBox[{"Join", "[", 
    RowBox[{"cell1", ",", " ", 
     RowBox[{"SwapVariables", "[", "cell2", "]"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FormulaSimplified", "[", 
   RowBox[{"\[Psi]_", ",", " ", "cell1_", ",", " ", "cell2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"FormulaSymmetric", "[", "\[Psi]", "]"}], " ", "/.", 
   RowBox[{"Join", "[", 
    RowBox[{"cell1", ",", " ", 
     RowBox[{"SwapVariables", "[", "cell2", "]"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FormulaSimplified", "[", 
   RowBox[{"\[Psi]_", ",", "cell_"}], "]"}], ":=", 
  RowBox[{"FormulaSimplified", "[", 
   RowBox[{"\[Psi]", ",", " ", "cell", ",", " ", "cell"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RTerm", "[", 
   RowBox[{
   "\[Psi]_", ",", "cell1_", ",", "cell2_", ",", "weightsPositive_", ",", " ",
     "weightsNegative_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"WeightedModels", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FormulaSimplified2Cell", "[", 
     RowBox[{"\[Psi]", ",", " ", "cell1", ",", " ", "cell2"}], "]"}], ",", 
    "\[IndentingNewLine]", "weightsPositive", ",", " ", "weightsNegative"}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"STerm", "[", 
   RowBox[{
   "\[Psi]_", ",", "cell_", ",", "weightsPositive_", ",", " ", 
    "weightsNegative_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"WeightedModels", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FormulaSimplified1Cell", "[", 
      RowBox[{"\[Psi]", ",", " ", "cell"}], "]"}], "\[And]", 
     RowBox[{"SwapVariables", "@", 
      RowBox[{"FormulaSimplified1Cell", "[", 
       RowBox[{"\[Psi]", ",", " ", "cell"}], "]"}]}]}], ",", 
    "\[IndentingNewLine]", "weightsPositive", ",", " ", "weightsNegative"}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"WTerm", "[", 
    RowBox[{
    "\[Psi]_", ",", "cell_", ",", "weightsPositive_", ",", " ", 
     "weightsNegative_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"WeightedModels", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"FormulaSimplified1Cell", "[", 
      RowBox[{
       RowBox[{"FormulaReflexive", "[", "\[Psi]", "]"}], ",", " ", "cell"}], 
      "]"}], ",", "\[IndentingNewLine]", "weightsPositive", ",", " ", 
     "weightsNegative"}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"STerm", "[", 
      RowBox[{
      "\[Psi]_", ",", "cell_", ",", "weightsPositive_", ",", " ", 
       "weightsNegative_"}], "]"}], ":=", 
     RowBox[{"RTerm", "[", 
      RowBox[{
       RowBox[{"FormulaSymmetric", "[", "\[Psi]", "]"}], ",", " ", "cell", 
       ",", " ", "cell", ",", " ", "weightsPositive", ",", 
       "weightsNegative"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"WTerm", "[", 
      RowBox[{
      "\[Psi]_", ",", "cell_", ",", "weightsPositive_", ",", " ", 
       "weightsNegative_"}], "]"}], ":=", 
     RowBox[{"RTerm", "[", 
      RowBox[{
       RowBox[{"FormulaReflexive", "[", "\[Psi]", "]"}], ",", " ", "cell", 
       ",", " ", "cell", ",", " ", "weightsPositive", ",", 
       "weightsNegative"}], "]"}]}]}], "\[IndentingNewLine]", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"STerms", "[", 
   RowBox[{
   "\[Psi]_", ",", " ", "weightsPositive_", ",", " ", "weightsNegative_"}], 
   "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"cell", "\[Function]", 
     RowBox[{"STerm", "[", 
      RowBox[{
      "\[Psi]", ",", " ", "cell", ",", " ", "weightsPositive", ",", 
       "weightsNegative"}], "]"}]}], ")"}], " ", "/@", " ", 
   RowBox[{"FormulaCells", "[", "\[Psi]", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WTerms", "[", 
   RowBox[{
   "\[Psi]_", ",", " ", "weightsPositive_", ",", " ", "weightsNegative_"}], 
   "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"cell", "\[Function]", 
     RowBox[{"WTerm", "[", 
      RowBox[{
      "\[Psi]", ",", " ", "cell", ",", " ", "weightsPositive", ",", 
       "weightsNegative"}], "]"}]}], ")"}], " ", "/@", " ", 
   RowBox[{"FormulaCells", "[", "\[Psi]", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RTerms", "[", 
   RowBox[{
   "\[Psi]_", ",", " ", "weightsPositive_", ",", " ", "weightsNegative_"}], 
   "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"cells", " ", "=", " ", 
       RowBox[{"FormulaCells", "[", "\[Psi]", "]"}]}], ",", " ", "length"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"length", " ", "=", " ", 
      RowBox[{"Length", "[", "cells", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"row", " ", "\[Function]", 
        RowBox[{"PadRight", "[", 
         RowBox[{"row", ",", " ", "length"}], "]"}]}], ")"}], " ", "/@", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"RTerm", "[", 
         RowBox[{"\[Psi]", ",", " ", 
          RowBox[{
          "cells", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
          ",", " ", 
          RowBox[{
          "cells", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
          ",", " ", "weightsPositive", ",", "weightsNegative"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "1", ",", " ", "length"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", " ", 
          RowBox[{"i", "+", "1"}], ",", " ", "length"}], "}"}]}], 
       "\[IndentingNewLine]", "]"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Compatible", "[", 
   RowBox[{"i_Integer", ",", " ", "cliquePart_List", ",", " ", 
    RowBox[{"{", 
     RowBox[{"s_", ",", "w_", ",", "r_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"all", "=", 
       RowBox[{"Range", "@", 
        RowBox[{"Length", "[", "s", "]"}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"cond3", "=", " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"j_", ",", "k_"}], "}"}], "\[RuleDelayed]", " ", 
        RowBox[{
         RowBox[{"j", "<", "k"}], "\[Implies]", " ", 
         RowBox[{
          RowBox[{"r", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "k"}], "\[RightDoubleBracket]"}], "\[Equal]", 
          RowBox[{"r", "\[LeftDoubleBracket]", 
           RowBox[{"j", ",", "k"}], "\[RightDoubleBracket]"}]}]}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"cond4", "=", " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"j_", ",", "k_", ",", "l_"}], "}"}], "\[RuleDelayed]", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"i", "<", "j"}], "\[And]", 
           RowBox[{"k", "<", "l"}]}], ")"}], "\[Implies]", " ", 
         RowBox[{
          RowBox[{"r", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "\[Equal]", 
          RowBox[{"r", "\[LeftDoubleBracket]", 
           RowBox[{"k", ",", "l"}], "\[RightDoubleBracket]"}]}]}]}]}]}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"And", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"AllTrue", "[", 
       RowBox[{"cliquePart", ",", 
        RowBox[{"j", "\[Function]", 
         RowBox[{
          RowBox[{"s", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
           "\[Equal]", 
          RowBox[{
          "s", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}]}]}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"AllTrue", "[", 
       RowBox[{"cliquePart", ",", 
        RowBox[{"j", "\[Function]", 
         RowBox[{
          RowBox[{"w", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
           "\[Equal]", 
          RowBox[{
          "s", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}]}]}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"And", "@@", 
        RowBox[{"Tuples", "[", 
         RowBox[{"{", 
          RowBox[{"cliquePart", ",", 
           RowBox[{"Complement", "[", 
            RowBox[{"all", ",", " ", "cliquePart"}], "]"}]}], "}"}], "]"}]}], 
       "/.", "cond3"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"And", "@@", 
        RowBox[{"Tuples", "[", 
         RowBox[{"{", 
          RowBox[{
          "cliquePart", ",", " ", "cliquePart", ",", " ", "cliquePart"}], 
          "}"}], "]"}]}], "/.", "cond4"}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cliques", "[", 
    RowBox[{"{", 
     RowBox[{"s_", ",", "w_", ",", "r_"}], "}"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "j", ",", " ", 
       RowBox[{"cliques", "=", 
        RowBox[{"{", "}"}]}], ",", " ", 
       RowBox[{"length", " ", "=", " ", 
        RowBox[{"Length", "[", "s", "]"}]}], ",", "current", ",", " ", 
       "all"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"all", " ", "=", " ", 
       RowBox[{"Range", "[", "length", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "all", "]"}], ">", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"current", " ", "=", " ", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"cell", "\[Function]", " ", 
            RowBox[{"If", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Compatible", "[", 
               RowBox[{"cell", ",", " ", "current", ",", " ", 
                RowBox[{"{", 
                 RowBox[{"s", ",", "w", ",", "r"}], "}"}]}], "]"}], " ", ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"AppendTo", "[", 
                RowBox[{"current", ",", " ", "cell"}], "]"}], ";", " ", 
               RowBox[{"all", " ", "=", " ", 
                RowBox[{"all", " ", "/.", " ", 
                 RowBox[{"cell", " ", "\[Rule]", " ", "Nothing"}]}]}], 
               ";"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]",
            ")"}], " ", "/@", " ", "all"}], ";", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"cliques", ",", " ", "current"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "cliques"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GetGTerm", "[", 
     RowBox[{"0", ",", " ", "n_Integer", ",", "cliqueIds_List"}], "]"}], ":=",
     " ", 
    RowBox[{
     RowBox[{"GetGTerm", "[", 
      RowBox[{"0", ",", " ", "n", ",", "cliqueIds"}], "]"}], " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"Module", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"i", "\[Function]"}], " ", ")"}], " ", "/@", " ", 
         RowBox[{"Range", "[", 
          RowBox[{"1", ",", "k"}], "]"}]}], "\[IndentingNewLine]", "]"}], 
       "\[IndentingNewLine]", 
       RowBox[{"GetGTerm", "[", 
        RowBox[{"p_Integer", ",", " ", "n_Integer", ",", "cliqueIds_List"}], 
        "]"}]}], ":=", " ", 
      RowBox[{
       RowBox[{"GetGTerm", "[", 
        RowBox[{"p", ",", " ", "n", ",", "cliqueIds"}], "]"}], " ", "=", " ", 
       
       RowBox[{"Module", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"s", "=", "0"}], "}"}], ","}], "\[IndentingNewLine]", 
        "]"}]}]}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetDTerm", "[", 
    RowBox[{"c_", ",", " ", "k_", ",", "n_"}], "]"}], " ", ":=", " ", 
   RowBox[{"GetDTerm", "[", 
    RowBox[{"c", ",", "1", ",", " ", "k", ",", "n"}], "]"}]}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetDTerm", "[", 
    RowBox[{"c_", ",", "i_", ",", " ", "k_", ",", "n_"}], "]"}], " ", ":=", 
   " ", "Nothing"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",\

 CellChangeTimes->{{3.826691908173477*^9, 3.826691923275236*^9}, {
   3.8266943734494*^9, 3.826694384949321*^9}, {3.826696719597742*^9, 
   3.826696741314296*^9}, {3.826696887890477*^9, 3.826696890586649*^9}, {
   3.826698545236833*^9, 3.82669854743611*^9}, {3.8266989941890793`*^9, 
   3.826699042378667*^9}, {3.826699112856061*^9, 3.826699123718796*^9}, {
   3.82669940165061*^9, 3.826699419960739*^9}, {3.826699598801098*^9, 
   3.826699632078167*^9}, {3.8266996655265017`*^9, 3.826699720825424*^9}, {
   3.826699786981991*^9, 3.826699813892815*^9}, {3.826699879796061*^9, 
   3.826699883905335*^9}, {3.8266999194673777`*^9, 3.826699933158588*^9}, 
   3.826699969104002*^9, {3.826700012274729*^9, 3.826700043681284*^9}, {
   3.826700086880082*^9, 3.826700150171782*^9}, {3.826700225590479*^9, 
   3.826700333466172*^9}, {3.8267003641925297`*^9, 3.826700408846528*^9}, {
   3.826700444903625*^9, 3.826700449460507*^9}, {3.8267005340590563`*^9, 
   3.826700568662376*^9}, {3.826700766822391*^9, 3.826700795346916*^9}, {
   3.8267010424257193`*^9, 3.826701045861957*^9}, {3.8267012253125687`*^9, 
   3.826701246347601*^9}, {3.826701284937923*^9, 3.826701427354864*^9}, {
   3.826701463580579*^9, 3.826701471848776*^9}, {3.8267018740990057`*^9, 
   3.826701917416954*^9}, 3.826702283191683*^9, {3.826705194988215*^9, 
   3.826705337877451*^9}, {3.8267053814033117`*^9, 3.826705404970828*^9}, {
   3.826705442371807*^9, 3.826705464311863*^9}, {3.82670553421457*^9, 
   3.826705573762063*^9}, {3.826705692294456*^9, 3.826705894606629*^9}, {
   3.826706740393756*^9, 3.8267067571069717`*^9}, {3.8267068413362913`*^9, 
   3.8267069970710087`*^9}, {3.826707033722508*^9, 3.8267070366287813`*^9}, {
   3.826709236360263*^9, 3.8267092488614683`*^9}, {3.826709840693407*^9, 
   3.826709919313323*^9}, {3.826710353655128*^9, 3.826710358971368*^9}, {
   3.826710446022162*^9, 3.826710454829954*^9}, {3.826710528785511*^9, 
   3.826710552908914*^9}, {3.826711140107106*^9, 3.826711141034778*^9}, {
   3.826770141889476*^9, 3.826770147009123*^9}, {3.826770465766946*^9, 
   3.826770583510621*^9}, {3.826770684871632*^9, 3.826770702422164*^9}, {
   3.826770853485091*^9, 3.826770931323544*^9}, {3.8267709849139338`*^9, 
   3.826771003352418*^9}, {3.82677107493321*^9, 3.826771154186501*^9}, {
   3.826771190888564*^9, 3.8267712068558197`*^9}, {3.826772324555181*^9, 
   3.826772352986643*^9}, {3.8267724847155113`*^9, 3.826772491503093*^9}, {
   3.826772532967822*^9, 3.826772591075437*^9}, {3.826772779313925*^9, 
   3.8267727818571167`*^9}, {3.826772819333974*^9, 3.826772911132647*^9}, {
   3.826772999117989*^9, 3.826773025234232*^9}, {3.8267731298730307`*^9, 
   3.8267731410045633`*^9}, 3.82677340296294*^9, {3.8267734611022253`*^9, 
   3.826773487118004*^9}, {3.826773774201734*^9, 3.826773776430725*^9}, {
   3.826773915864647*^9, 3.826773954867942*^9}, {3.826774019441201*^9, 
   3.8267740362696047`*^9}, {3.826774075764183*^9, 3.8267742614049807`*^9}, {
   3.826774297889739*^9, 3.826774319116613*^9}, {3.826774375630319*^9, 
   3.826774547985279*^9}, {3.8267745976747923`*^9, 3.8267746369191236`*^9}, {
   3.8267746952389174`*^9, 3.826774717378902*^9}, {3.826776432780423*^9, 
   3.826776511622465*^9}, {3.826777602795004*^9, 3.826777629127974*^9}, {
   3.826778605190192*^9, 3.8267786290803833`*^9}, {3.826778665013783*^9, 
   3.826778863719534*^9}, {3.826779048235779*^9, 3.826779057911319*^9}, {
   3.826779251029684*^9, 3.826779287002925*^9}, {3.826779343329282*^9, 
   3.826779357336011*^9}, {3.826779431518835*^9, 3.8267794511221933`*^9}, {
   3.826780141591258*^9, 3.826780149126049*^9}, {3.826780206185391*^9, 
   3.82678020703806*^9}, {3.8267808097394133`*^9, 3.8267808098912582`*^9}, {
   3.82678139198076*^9, 3.8267813922233887`*^9}, {3.826781444096285*^9, 
   3.826781444232154*^9}, {3.826797198806508*^9, 3.826797243076335*^9}, {
   3.8267973019466677`*^9, 3.826797389530806*^9}, {3.826797814909292*^9, 
   3.826797999365364*^9}, {3.826798110502787*^9, 3.826798276387518*^9}, {
   3.82679849770181*^9, 3.8267984990031843`*^9}, 3.826799113849916*^9, {
   3.826799370299933*^9, 3.826799423792611*^9}, {3.82679946759827*^9, 
   3.826799639354917*^9}, {3.82679979565377*^9, 3.826799814261026*^9}, {
   3.826800043313301*^9, 3.826800068607938*^9}, {3.8268001037298822`*^9, 
   3.8268003503377037`*^9}, {3.826800392231367*^9, 3.826800397919237*^9}, {
   3.826801380495721*^9, 3.826801382343668*^9}, {3.826801893974278*^9, 
   3.8268019177732153`*^9}, {3.826802102011656*^9, 3.826802342928423*^9}, {
   3.826802373332333*^9, 3.8268023960322943`*^9}, {3.826802458834202*^9, 
   3.826802541404107*^9}, {3.827296223325539*^9, 3.827296225605289*^9}, {
   3.827296263986578*^9, 3.827296291465073*^9}, {3.827296332863793*^9, 
   3.827296353125709*^9}, {3.8272976190386257`*^9, 3.8272976326292343`*^9}, {
   3.827298035763824*^9, 3.827298067790472*^9}, {3.827298117709277*^9, 
   3.8272981384407578`*^9}, 3.827300239749887*^9, {3.827301154141986*^9, 
   3.827301239976479*^9}, {3.827301828810267*^9, 3.827301861393035*^9}, {
   3.827301892239365*^9, 3.8273019997861423`*^9}, {3.827302031544429*^9, 
   3.827302255543271*^9}, {3.827302304523499*^9, 3.827302321580572*^9}, {
   3.82730248286719*^9, 3.8273025455406637`*^9}, {3.827302608101035*^9, 
   3.827302617630672*^9}, {3.827465227052306*^9, 3.8274652357712183`*^9}, {
   3.827465453730818*^9, 3.8274654953603287`*^9}, {3.827466585441311*^9, 
   3.827466614087874*^9}, {3.827467552881259*^9, 3.827467558249358*^9}, {
   3.827467610911867*^9, 3.827467618280074*^9}, {3.8274676677975388`*^9, 
   3.827467701754944*^9}, {3.827471543491213*^9, 3.8274715488008966`*^9}, {
   3.836278108933132*^9, 3.836278114187827*^9}, {3.8362819426280737`*^9, 
   3.83628195502315*^9}, {3.8364496937759247`*^9, 3.836449711676116*^9}, {
   3.836456651041934*^9, 3.836456655832328*^9}, {3.838100534554991*^9, 
   3.838100605720351*^9}, 3.838101269334474*^9, {3.8381020227796707`*^9, 
   3.838102023306238*^9}, {3.838102168928934*^9, 3.838102370223971*^9}, {
   3.8381080347049103`*^9, 3.8381080661841497`*^9}, {3.838111708903923*^9, 
   3.8381117597921257`*^9}, {3.838122424492795*^9, 3.8381224247200613`*^9}, {
   3.838122515320002*^9, 3.838122540114081*^9}, {3.8381225771795473`*^9, 
   3.838122605654173*^9}, {3.83812343625648*^9, 3.838123437520603*^9}, {
   3.838123516788821*^9, 3.8381235187720137`*^9}, {3.838184360478383*^9, 
   3.8381844836167383`*^9}, {3.838184578091997*^9, 3.838184579179769*^9}, {
   3.8381886954017773`*^9, 3.838188725654476*^9}, {3.8381892313484917`*^9, 
   3.83818923159582*^9}, {3.838189276202713*^9, 3.838189280298307*^9}, {
   3.838190002261059*^9, 3.8381900353954973`*^9}, {3.838190120096134*^9, 
   3.838190132071341*^9}, {3.8381914350321217`*^9, 3.838191444540365*^9}, 
   3.838191526761639*^9, {3.838191587309626*^9, 3.8381916119806223`*^9}, {
   3.838191686560042*^9, 3.838191705175729*^9}, {3.838191747236854*^9, 
   3.838191862416596*^9}, {3.83819192810434*^9, 3.838191947260088*^9}, {
   3.8381919846209707`*^9, 3.838191985994561*^9}, {3.8381935988945427`*^9, 
   3.838193662655756*^9}, {3.83819509839776*^9, 3.8381951039734993`*^9}, {
   3.838197016459901*^9, 3.838197033220586*^9}, {3.8381970764112387`*^9, 
   3.838197083408684*^9}, {3.8381974671047773`*^9, 3.8381974712206573`*^9}, {
   3.8381975070272217`*^9, 3.838197533530995*^9}, {3.838354421593877*^9, 
   3.838354428516543*^9}, {3.838354495013659*^9, 3.838354500591889*^9}, {
   3.8387000014189177`*^9, 3.838700040586*^9}},
 CellLabel->
  "In[219]:=",ExpressionUUID->"bd4dac13-24d5-43d7-ae76-3f67079096f2"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"exampleDerangements", "=", " ", 
  RowBox[{
   RowBox[{"\[Not]", 
    RowBox[{"f", "[", 
     RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}]}], " ", "\[And]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Implies]", 
     RowBox[{"s1", "[", "\[FormalA]", "]"}]}], ")"}], "\[And]", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}], "\[Implies]", 
     RowBox[{"s2", "[", "\[FormalA]", "]"}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"weightsPositiveDerangements", "=", 
  RowBox[{"\[LeftAssociation]", 
   RowBox[{
    RowBox[{"f", "\[Rule]", "\[FormalF]"}], ",", 
    RowBox[{"s1", "\[Rule]", "1"}], ",", 
    RowBox[{"s2", "\[Rule]", "1"}]}], 
   "\[RightAssociation]"}]}], "\[IndentingNewLine]", 
 RowBox[{"weightsNegativeDerangements", "=", 
  RowBox[{"\[LeftAssociation]", 
   RowBox[{
    RowBox[{"f", "\[Rule]", "1"}], ",", 
    RowBox[{"s1", "\[Rule]", 
     RowBox[{"-", "1"}]}], ",", 
    RowBox[{"s2", "\[Rule]", 
     RowBox[{"-", "1"}]}]}], "\[RightAssociation]"}]}], "\[IndentingNewLine]", 
 RowBox[{"s", "=", 
  RowBox[{"STerms", "[", 
   RowBox[{
   "exampleDerangements", ",", " ", "weightsPositiveDerangements", ",", " ", 
    "weightsNegativeDerangements"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"w", "=", 
  RowBox[{"WTerms", "[", 
   RowBox[{
   "exampleDerangements", ",", " ", "weightsPositiveDerangements", ",", " ", 
    "weightsNegativeDerangements"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r", "=", 
   RowBox[{"RTerms", "[", 
    RowBox[{
    "exampleDerangements", ",", " ", "weightsPositiveDerangements", ",", " ", 
     "weightsNegativeDerangements"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "r", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Cliques", "[", 
  RowBox[{"{", 
   RowBox[{"s", ",", "w", ",", "r"}], "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.826696981041272*^9, 3.826696981041636*^9}, {
   3.826702378820546*^9, 3.826702510883778*^9}, {3.826702587136442*^9, 
   3.826702610319283*^9}, {3.826702852625656*^9, 3.826702897223771*^9}, {
   3.826702940773076*^9, 3.8267029763798227`*^9}, {3.82670300689018*^9, 
   3.826703018049738*^9}, {3.826703058167557*^9, 3.826703081774447*^9}, {
   3.82670381663201*^9, 3.826703817949976*^9}, {3.826771473506196*^9, 
   3.826771511356617*^9}, {3.826780292468261*^9, 3.826780292634017*^9}, {
   3.8267982888200407`*^9, 3.826798427415094*^9}, {3.8267985390164633`*^9, 
   3.8267985842944202`*^9}, {3.826798632690894*^9, 3.826798659407157*^9}, {
   3.826802604969912*^9, 3.82680261255084*^9}, {3.827297465929699*^9, 
   3.8272974720970182`*^9}, {3.8272975162151337`*^9, 3.827297523918103*^9}, {
   3.827302587993596*^9, 3.827302596304904*^9}, {3.8380934718439093`*^9, 
   3.838093477555969*^9}, 3.838093570843687*^9, {3.8380936266160307`*^9, 
   3.83809364447511*^9}, {3.838093750328511*^9, 3.8380937512934427`*^9}, {
   3.838094093143944*^9, 3.838094101723831*^9}, {3.8380941564647827`*^9, 
   3.838094162416993*^9}, {3.838094227472848*^9, 3.838094260934346*^9}, 
   3.838698880165805*^9, {3.838699780538712*^9, 3.838699784145278*^9}},
 CellLabel->
  "In[146]:=",ExpressionUUID->"622b1969-fc58-4ae9-8f5e-e2c8bd36032e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"!", 
   RowBox[{"f", "[", 
    RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}]}], "&&", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Implies]", 
    RowBox[{"s1", "[", "\[FormalA]", "]"}]}], ")"}], "&&", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}], "\[Implies]", 
    RowBox[{"s2", "[", "\[FormalA]", "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.826696982300784*^9, 3.826697230048061*^9, {3.826702488865617*^9, 
   3.8267025015546093`*^9}, 3.8267026144088917`*^9, 3.826702762333441*^9, 
   3.826703818555366*^9, 3.8267099217023478`*^9, 3.8267111446595993`*^9, 
   3.826767829675147*^9, 3.826771178601449*^9, 3.826771215950741*^9, 
   3.826771512159486*^9, 3.8267728991433153`*^9, 3.8267794795366917`*^9, 
   3.8267802938244753`*^9, 3.826780815294139*^9, {3.8267983456761827`*^9, 
   3.8267984277380733`*^9}, 3.826798491702149*^9, {3.826798540201313*^9, 
   3.826798579207993*^9}, 3.826798664911477*^9, 3.8268025260727158`*^9, {
   3.826802579310977*^9, 3.826802613004622*^9}, 3.82686083377431*^9, {
   3.8268609163722486`*^9, 3.826860932530357*^9}, 3.827201237776141*^9, 
   3.8272872471031017`*^9, 3.827297477522232*^9, 3.8272975243596067`*^9, 
   3.8272980866680317`*^9, 3.8272981487752542`*^9, {3.8273025967134*^9, 
   3.827302622916754*^9}, 3.827373100371805*^9, 3.827462466994236*^9, 
   3.827548905382824*^9, 3.836269632505393*^9, 3.8364496842512693`*^9, 
   3.837660504565434*^9, 3.837745785474065*^9, 3.8380907731602163`*^9, 
   3.8380924100052156`*^9, 3.8380934834596367`*^9, {3.838093572427854*^9, 
   3.838093592150734*^9}, {3.838093629516045*^9, 3.838093645047511*^9}, 
   3.83809375211615*^9, {3.838094094691434*^9, 3.838094102196062*^9}, 
   3.838094163078074*^9, 3.838094248175436*^9, 3.8380990648877497`*^9, 
   3.838102379328494*^9, 3.838103144968397*^9, 3.8381080704419813`*^9, {
   3.838111743900663*^9, 3.838111763139818*^9}, 3.838122556829055*^9, 
   3.838122610349843*^9, 3.838123440938367*^9, 3.8381837107418633`*^9, 
   3.8381842587668962`*^9, {3.8381843735125732`*^9, 3.838184487722888*^9}, 
   3.8381845832659597`*^9, {3.8381887092424803`*^9, 3.838188730092664*^9}, 
   3.8381892451351633`*^9, 3.83818928354243*^9, 3.8381918344233227`*^9, 
   3.838191865136002*^9, {3.838191930351416*^9, 3.838191951059766*^9}, 
   3.838191989187777*^9, 3.8381936269199057`*^9, 3.838193665875762*^9, 
   3.838196998879464*^9, 3.8381970363014107`*^9, 3.838197087748087*^9, 
   3.838197473756794*^9, {3.838197517657262*^9, 3.838197536274044*^9}, 
   3.838354172867756*^9, {3.838354431791059*^9, 3.838354439914709*^9}, {
   3.838354559658051*^9, 3.838354584275238*^9}, 3.838437454141199*^9, 
   3.8386949608447533`*^9, 3.838698880923183*^9, {3.83869981172126*^9, 
   3.838699835601173*^9}},
 CellLabel->
  "Out[146]=",ExpressionUUID->"5de8ae20-78f8-4a84-a373-dddaf7ab3e12"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"f", "\[Rule]", "\[FormalF]"}], ",", 
   RowBox[{"s1", "\[Rule]", "1"}], ",", 
   RowBox[{"s2", "\[Rule]", "1"}]}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{
  3.826696982300784*^9, 3.826697230048061*^9, {3.826702488865617*^9, 
   3.8267025015546093`*^9}, 3.8267026144088917`*^9, 3.826702762333441*^9, 
   3.826703818555366*^9, 3.8267099217023478`*^9, 3.8267111446595993`*^9, 
   3.826767829675147*^9, 3.826771178601449*^9, 3.826771215950741*^9, 
   3.826771512159486*^9, 3.8267728991433153`*^9, 3.8267794795366917`*^9, 
   3.8267802938244753`*^9, 3.826780815294139*^9, {3.8267983456761827`*^9, 
   3.8267984277380733`*^9}, 3.826798491702149*^9, {3.826798540201313*^9, 
   3.826798579207993*^9}, 3.826798664911477*^9, 3.8268025260727158`*^9, {
   3.826802579310977*^9, 3.826802613004622*^9}, 3.82686083377431*^9, {
   3.8268609163722486`*^9, 3.826860932530357*^9}, 3.827201237776141*^9, 
   3.8272872471031017`*^9, 3.827297477522232*^9, 3.8272975243596067`*^9, 
   3.8272980866680317`*^9, 3.8272981487752542`*^9, {3.8273025967134*^9, 
   3.827302622916754*^9}, 3.827373100371805*^9, 3.827462466994236*^9, 
   3.827548905382824*^9, 3.836269632505393*^9, 3.8364496842512693`*^9, 
   3.837660504565434*^9, 3.837745785474065*^9, 3.8380907731602163`*^9, 
   3.8380924100052156`*^9, 3.8380934834596367`*^9, {3.838093572427854*^9, 
   3.838093592150734*^9}, {3.838093629516045*^9, 3.838093645047511*^9}, 
   3.83809375211615*^9, {3.838094094691434*^9, 3.838094102196062*^9}, 
   3.838094163078074*^9, 3.838094248175436*^9, 3.8380990648877497`*^9, 
   3.838102379328494*^9, 3.838103144968397*^9, 3.8381080704419813`*^9, {
   3.838111743900663*^9, 3.838111763139818*^9}, 3.838122556829055*^9, 
   3.838122610349843*^9, 3.838123440938367*^9, 3.8381837107418633`*^9, 
   3.8381842587668962`*^9, {3.8381843735125732`*^9, 3.838184487722888*^9}, 
   3.8381845832659597`*^9, {3.8381887092424803`*^9, 3.838188730092664*^9}, 
   3.8381892451351633`*^9, 3.83818928354243*^9, 3.8381918344233227`*^9, 
   3.838191865136002*^9, {3.838191930351416*^9, 3.838191951059766*^9}, 
   3.838191989187777*^9, 3.8381936269199057`*^9, 3.838193665875762*^9, 
   3.838196998879464*^9, 3.8381970363014107`*^9, 3.838197087748087*^9, 
   3.838197473756794*^9, {3.838197517657262*^9, 3.838197536274044*^9}, 
   3.838354172867756*^9, {3.838354431791059*^9, 3.838354439914709*^9}, {
   3.838354559658051*^9, 3.838354584275238*^9}, 3.838437454141199*^9, 
   3.8386949608447533`*^9, 3.838698880923183*^9, {3.83869981172126*^9, 
   3.838699835603784*^9}},
 CellLabel->
  "Out[147]=",ExpressionUUID->"a56ca005-481d-474e-8354-a4d58a4c1810"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"f", "\[Rule]", "1"}], ",", 
   RowBox[{"s1", "\[Rule]", 
    RowBox[{"-", "1"}]}], ",", 
   RowBox[{"s2", "\[Rule]", 
    RowBox[{"-", "1"}]}]}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{
  3.826696982300784*^9, 3.826697230048061*^9, {3.826702488865617*^9, 
   3.8267025015546093`*^9}, 3.8267026144088917`*^9, 3.826702762333441*^9, 
   3.826703818555366*^9, 3.8267099217023478`*^9, 3.8267111446595993`*^9, 
   3.826767829675147*^9, 3.826771178601449*^9, 3.826771215950741*^9, 
   3.826771512159486*^9, 3.8267728991433153`*^9, 3.8267794795366917`*^9, 
   3.8267802938244753`*^9, 3.826780815294139*^9, {3.8267983456761827`*^9, 
   3.8267984277380733`*^9}, 3.826798491702149*^9, {3.826798540201313*^9, 
   3.826798579207993*^9}, 3.826798664911477*^9, 3.8268025260727158`*^9, {
   3.826802579310977*^9, 3.826802613004622*^9}, 3.82686083377431*^9, {
   3.8268609163722486`*^9, 3.826860932530357*^9}, 3.827201237776141*^9, 
   3.8272872471031017`*^9, 3.827297477522232*^9, 3.8272975243596067`*^9, 
   3.8272980866680317`*^9, 3.8272981487752542`*^9, {3.8273025967134*^9, 
   3.827302622916754*^9}, 3.827373100371805*^9, 3.827462466994236*^9, 
   3.827548905382824*^9, 3.836269632505393*^9, 3.8364496842512693`*^9, 
   3.837660504565434*^9, 3.837745785474065*^9, 3.8380907731602163`*^9, 
   3.8380924100052156`*^9, 3.8380934834596367`*^9, {3.838093572427854*^9, 
   3.838093592150734*^9}, {3.838093629516045*^9, 3.838093645047511*^9}, 
   3.83809375211615*^9, {3.838094094691434*^9, 3.838094102196062*^9}, 
   3.838094163078074*^9, 3.838094248175436*^9, 3.8380990648877497`*^9, 
   3.838102379328494*^9, 3.838103144968397*^9, 3.8381080704419813`*^9, {
   3.838111743900663*^9, 3.838111763139818*^9}, 3.838122556829055*^9, 
   3.838122610349843*^9, 3.838123440938367*^9, 3.8381837107418633`*^9, 
   3.8381842587668962`*^9, {3.8381843735125732`*^9, 3.838184487722888*^9}, 
   3.8381845832659597`*^9, {3.8381887092424803`*^9, 3.838188730092664*^9}, 
   3.8381892451351633`*^9, 3.83818928354243*^9, 3.8381918344233227`*^9, 
   3.838191865136002*^9, {3.838191930351416*^9, 3.838191951059766*^9}, 
   3.838191989187777*^9, 3.8381936269199057`*^9, 3.838193665875762*^9, 
   3.838196998879464*^9, 3.8381970363014107`*^9, 3.838197087748087*^9, 
   3.838197473756794*^9, {3.838197517657262*^9, 3.838197536274044*^9}, 
   3.838354172867756*^9, {3.838354431791059*^9, 3.838354439914709*^9}, {
   3.838354559658051*^9, 3.838354584275238*^9}, 3.838437454141199*^9, 
   3.8386949608447533`*^9, 3.838698880923183*^9, {3.83869981172126*^9, 
   3.8386998356060543`*^9}},
 CellLabel->
  "Out[148]=",ExpressionUUID->"1d4e6355-b00a-4c38-b0eb-e5efd2ebf70e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}],
   "}"}]], "Output",
 CellChangeTimes->{
  3.826696982300784*^9, 3.826697230048061*^9, {3.826702488865617*^9, 
   3.8267025015546093`*^9}, 3.8267026144088917`*^9, 3.826702762333441*^9, 
   3.826703818555366*^9, 3.8267099217023478`*^9, 3.8267111446595993`*^9, 
   3.826767829675147*^9, 3.826771178601449*^9, 3.826771215950741*^9, 
   3.826771512159486*^9, 3.8267728991433153`*^9, 3.8267794795366917`*^9, 
   3.8267802938244753`*^9, 3.826780815294139*^9, {3.8267983456761827`*^9, 
   3.8267984277380733`*^9}, 3.826798491702149*^9, {3.826798540201313*^9, 
   3.826798579207993*^9}, 3.826798664911477*^9, 3.8268025260727158`*^9, {
   3.826802579310977*^9, 3.826802613004622*^9}, 3.82686083377431*^9, {
   3.8268609163722486`*^9, 3.826860932530357*^9}, 3.827201237776141*^9, 
   3.8272872471031017`*^9, 3.827297477522232*^9, 3.8272975243596067`*^9, 
   3.8272980866680317`*^9, 3.8272981487752542`*^9, {3.8273025967134*^9, 
   3.827302622916754*^9}, 3.827373100371805*^9, 3.827462466994236*^9, 
   3.827548905382824*^9, 3.836269632505393*^9, 3.8364496842512693`*^9, 
   3.837660504565434*^9, 3.837745785474065*^9, 3.8380907731602163`*^9, 
   3.8380924100052156`*^9, 3.8380934834596367`*^9, {3.838093572427854*^9, 
   3.838093592150734*^9}, {3.838093629516045*^9, 3.838093645047511*^9}, 
   3.83809375211615*^9, {3.838094094691434*^9, 3.838094102196062*^9}, 
   3.838094163078074*^9, 3.838094248175436*^9, 3.8380990648877497`*^9, 
   3.838102379328494*^9, 3.838103144968397*^9, 3.8381080704419813`*^9, {
   3.838111743900663*^9, 3.838111763139818*^9}, 3.838122556829055*^9, 
   3.838122610349843*^9, 3.838123440938367*^9, 3.8381837107418633`*^9, 
   3.8381842587668962`*^9, {3.8381843735125732`*^9, 3.838184487722888*^9}, 
   3.8381845832659597`*^9, {3.8381887092424803`*^9, 3.838188730092664*^9}, 
   3.8381892451351633`*^9, 3.83818928354243*^9, 3.8381918344233227`*^9, 
   3.838191865136002*^9, {3.838191930351416*^9, 3.838191951059766*^9}, 
   3.838191989187777*^9, 3.8381936269199057`*^9, 3.838193665875762*^9, 
   3.838196998879464*^9, 3.8381970363014107`*^9, 3.838197087748087*^9, 
   3.838197473756794*^9, {3.838197517657262*^9, 3.838197536274044*^9}, 
   3.838354172867756*^9, {3.838354431791059*^9, 3.838354439914709*^9}, {
   3.838354559658051*^9, 3.838354584275238*^9}, 3.838437454141199*^9, 
   3.8386949608447533`*^9, 3.838698880923183*^9, {3.83869981172126*^9, 
   3.838699835608287*^9}},
 CellLabel->
  "Out[149]=",ExpressionUUID->"18c7cb1d-252c-4472-9d1c-8db620173dd7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}],
   "}"}]], "Output",
 CellChangeTimes->{
  3.826696982300784*^9, 3.826697230048061*^9, {3.826702488865617*^9, 
   3.8267025015546093`*^9}, 3.8267026144088917`*^9, 3.826702762333441*^9, 
   3.826703818555366*^9, 3.8267099217023478`*^9, 3.8267111446595993`*^9, 
   3.826767829675147*^9, 3.826771178601449*^9, 3.826771215950741*^9, 
   3.826771512159486*^9, 3.8267728991433153`*^9, 3.8267794795366917`*^9, 
   3.8267802938244753`*^9, 3.826780815294139*^9, {3.8267983456761827`*^9, 
   3.8267984277380733`*^9}, 3.826798491702149*^9, {3.826798540201313*^9, 
   3.826798579207993*^9}, 3.826798664911477*^9, 3.8268025260727158`*^9, {
   3.826802579310977*^9, 3.826802613004622*^9}, 3.82686083377431*^9, {
   3.8268609163722486`*^9, 3.826860932530357*^9}, 3.827201237776141*^9, 
   3.8272872471031017`*^9, 3.827297477522232*^9, 3.8272975243596067`*^9, 
   3.8272980866680317`*^9, 3.8272981487752542`*^9, {3.8273025967134*^9, 
   3.827302622916754*^9}, 3.827373100371805*^9, 3.827462466994236*^9, 
   3.827548905382824*^9, 3.836269632505393*^9, 3.8364496842512693`*^9, 
   3.837660504565434*^9, 3.837745785474065*^9, 3.8380907731602163`*^9, 
   3.8380924100052156`*^9, 3.8380934834596367`*^9, {3.838093572427854*^9, 
   3.838093592150734*^9}, {3.838093629516045*^9, 3.838093645047511*^9}, 
   3.83809375211615*^9, {3.838094094691434*^9, 3.838094102196062*^9}, 
   3.838094163078074*^9, 3.838094248175436*^9, 3.8380990648877497`*^9, 
   3.838102379328494*^9, 3.838103144968397*^9, 3.8381080704419813`*^9, {
   3.838111743900663*^9, 3.838111763139818*^9}, 3.838122556829055*^9, 
   3.838122610349843*^9, 3.838123440938367*^9, 3.8381837107418633`*^9, 
   3.8381842587668962`*^9, {3.8381843735125732`*^9, 3.838184487722888*^9}, 
   3.8381845832659597`*^9, {3.8381887092424803`*^9, 3.838188730092664*^9}, 
   3.8381892451351633`*^9, 3.83818928354243*^9, 3.8381918344233227`*^9, 
   3.838191865136002*^9, {3.838191930351416*^9, 3.838191951059766*^9}, 
   3.838191989187777*^9, 3.8381936269199057`*^9, 3.838193665875762*^9, 
   3.838196998879464*^9, 3.8381970363014107`*^9, 3.838197087748087*^9, 
   3.838197473756794*^9, {3.838197517657262*^9, 3.838197536274044*^9}, 
   3.838354172867756*^9, {3.838354431791059*^9, 3.838354439914709*^9}, {
   3.838354559658051*^9, 3.838354584275238*^9}, 3.838437454141199*^9, 
   3.8386949608447533`*^9, 3.838698880923183*^9, {3.83869981172126*^9, 
   3.838699835610509*^9}},
 CellLabel->
  "Out[150]=",ExpressionUUID->"145df478-7298-4518-95c4-949ddf3ca98f"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "1", "1", "0", "0", "0", "0", "0"},
     {"1", "1", "0", "0", "0", "0", "0", "0"},
     {"1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.826696982300784*^9, 3.826697230048061*^9, {3.826702488865617*^9, 
   3.8267025015546093`*^9}, 3.8267026144088917`*^9, 3.826702762333441*^9, 
   3.826703818555366*^9, 3.8267099217023478`*^9, 3.8267111446595993`*^9, 
   3.826767829675147*^9, 3.826771178601449*^9, 3.826771215950741*^9, 
   3.826771512159486*^9, 3.8267728991433153`*^9, 3.8267794795366917`*^9, 
   3.8267802938244753`*^9, 3.826780815294139*^9, {3.8267983456761827`*^9, 
   3.8267984277380733`*^9}, 3.826798491702149*^9, {3.826798540201313*^9, 
   3.826798579207993*^9}, 3.826798664911477*^9, 3.8268025260727158`*^9, {
   3.826802579310977*^9, 3.826802613004622*^9}, 3.82686083377431*^9, {
   3.8268609163722486`*^9, 3.826860932530357*^9}, 3.827201237776141*^9, 
   3.8272872471031017`*^9, 3.827297477522232*^9, 3.8272975243596067`*^9, 
   3.8272980866680317`*^9, 3.8272981487752542`*^9, {3.8273025967134*^9, 
   3.827302622916754*^9}, 3.827373100371805*^9, 3.827462466994236*^9, 
   3.827548905382824*^9, 3.836269632505393*^9, 3.8364496842512693`*^9, 
   3.837660504565434*^9, 3.837745785474065*^9, 3.8380907731602163`*^9, 
   3.8380924100052156`*^9, 3.8380934834596367`*^9, {3.838093572427854*^9, 
   3.838093592150734*^9}, {3.838093629516045*^9, 3.838093645047511*^9}, 
   3.83809375211615*^9, {3.838094094691434*^9, 3.838094102196062*^9}, 
   3.838094163078074*^9, 3.838094248175436*^9, 3.8380990648877497`*^9, 
   3.838102379328494*^9, 3.838103144968397*^9, 3.8381080704419813`*^9, {
   3.838111743900663*^9, 3.838111763139818*^9}, 3.838122556829055*^9, 
   3.838122610349843*^9, 3.838123440938367*^9, 3.8381837107418633`*^9, 
   3.8381842587668962`*^9, {3.8381843735125732`*^9, 3.838184487722888*^9}, 
   3.8381845832659597`*^9, {3.8381887092424803`*^9, 3.838188730092664*^9}, 
   3.8381892451351633`*^9, 3.83818928354243*^9, 3.8381918344233227`*^9, 
   3.838191865136002*^9, {3.838191930351416*^9, 3.838191951059766*^9}, 
   3.838191989187777*^9, 3.8381936269199057`*^9, 3.838193665875762*^9, 
   3.838196998879464*^9, 3.8381970363014107`*^9, 3.838197087748087*^9, 
   3.838197473756794*^9, {3.838197517657262*^9, 3.838197536274044*^9}, 
   3.838354172867756*^9, {3.838354431791059*^9, 3.838354439914709*^9}, {
   3.838354559658051*^9, 3.838354584275238*^9}, 3.838437454141199*^9, 
   3.8386949608447533`*^9, 3.838698880923183*^9, {3.83869981172126*^9, 
   3.8386998356126957`*^9}},
 CellLabel->
  "Out[152]//MatrixForm=",ExpressionUUID->"95a9da60-9e3c-493d-8b71-\
3d698796d460"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "1", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "6", ",", "7", ",", "8"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.826696982300784*^9, 3.826697230048061*^9, {3.826702488865617*^9, 
   3.8267025015546093`*^9}, 3.8267026144088917`*^9, 3.826702762333441*^9, 
   3.826703818555366*^9, 3.8267099217023478`*^9, 3.8267111446595993`*^9, 
   3.826767829675147*^9, 3.826771178601449*^9, 3.826771215950741*^9, 
   3.826771512159486*^9, 3.8267728991433153`*^9, 3.8267794795366917`*^9, 
   3.8267802938244753`*^9, 3.826780815294139*^9, {3.8267983456761827`*^9, 
   3.8267984277380733`*^9}, 3.826798491702149*^9, {3.826798540201313*^9, 
   3.826798579207993*^9}, 3.826798664911477*^9, 3.8268025260727158`*^9, {
   3.826802579310977*^9, 3.826802613004622*^9}, 3.82686083377431*^9, {
   3.8268609163722486`*^9, 3.826860932530357*^9}, 3.827201237776141*^9, 
   3.8272872471031017`*^9, 3.827297477522232*^9, 3.8272975243596067`*^9, 
   3.8272980866680317`*^9, 3.8272981487752542`*^9, {3.8273025967134*^9, 
   3.827302622916754*^9}, 3.827373100371805*^9, 3.827462466994236*^9, 
   3.827548905382824*^9, 3.836269632505393*^9, 3.8364496842512693`*^9, 
   3.837660504565434*^9, 3.837745785474065*^9, 3.8380907731602163`*^9, 
   3.8380924100052156`*^9, 3.8380934834596367`*^9, {3.838093572427854*^9, 
   3.838093592150734*^9}, {3.838093629516045*^9, 3.838093645047511*^9}, 
   3.83809375211615*^9, {3.838094094691434*^9, 3.838094102196062*^9}, 
   3.838094163078074*^9, 3.838094248175436*^9, 3.8380990648877497`*^9, 
   3.838102379328494*^9, 3.838103144968397*^9, 3.8381080704419813`*^9, {
   3.838111743900663*^9, 3.838111763139818*^9}, 3.838122556829055*^9, 
   3.838122610349843*^9, 3.838123440938367*^9, 3.8381837107418633`*^9, 
   3.8381842587668962`*^9, {3.8381843735125732`*^9, 3.838184487722888*^9}, 
   3.8381845832659597`*^9, {3.8381887092424803`*^9, 3.838188730092664*^9}, 
   3.8381892451351633`*^9, 3.83818928354243*^9, 3.8381918344233227`*^9, 
   3.838191865136002*^9, {3.838191930351416*^9, 3.838191951059766*^9}, 
   3.838191989187777*^9, 3.8381936269199057`*^9, 3.838193665875762*^9, 
   3.838196998879464*^9, 3.8381970363014107`*^9, 3.838197087748087*^9, 
   3.838197473756794*^9, {3.838197517657262*^9, 3.838197536274044*^9}, 
   3.838354172867756*^9, {3.838354431791059*^9, 3.838354439914709*^9}, {
   3.838354559658051*^9, 3.838354584275238*^9}, 3.838437454141199*^9, 
   3.8386949608447533`*^9, 3.838698880923183*^9, {3.83869981172126*^9, 
   3.838699835615012*^9}},
 CellLabel->
  "Out[153]=",ExpressionUUID->"453c0cf5-a7f8-45f7-aa3b-d4a6d04274c7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Compatible", "[", 
  RowBox[{"7", ",", 
   RowBox[{"{", "8", "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"s", ",", "w", ",", "r"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.826801350660635*^9, 3.826801362325594*^9}, {
  3.826801841949338*^9, 3.826801862092627*^9}, {3.8268019379309807`*^9, 
  3.826801969160474*^9}, {3.8268026220197144`*^9, 3.82680264178094*^9}, {
  3.82729749025751*^9, 3.827297490567906*^9}, {3.827299659521373*^9, 
  3.827299679950248*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"a1dbc901-f48d-419c-b733-12c229e599cf"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.826696982300784*^9, 3.826697230048061*^9, {3.826702488865617*^9, 
   3.8267025015546093`*^9}, 3.8267026144088917`*^9, 3.826702762333441*^9, 
   3.826703818555366*^9, 3.8267099217023478`*^9, 3.8267111446595993`*^9, 
   3.826767829675147*^9, 3.826771178601449*^9, 3.826771215950741*^9, 
   3.826771512159486*^9, 3.8267728991433153`*^9, 3.8267794795366917`*^9, 
   3.8267802938244753`*^9, 3.826780815294139*^9, {3.8267983456761827`*^9, 
   3.8267984277380733`*^9}, 3.826798491702149*^9, {3.826798540201313*^9, 
   3.826798579207993*^9}, 3.82679866492896*^9, {3.8268018485734*^9, 
   3.826801862551759*^9}, {3.826801956403139*^9, 3.826801970324349*^9}, 
   3.826802642245599*^9, 3.826860833810317*^9, {3.8268609164011106`*^9, 
   3.826860932577302*^9}, 3.827201237821631*^9, 3.827287247148532*^9, 
   3.8272961611820717`*^9, 3.8272962323043613`*^9, 3.8272963598834753`*^9, {
   3.827297480375877*^9, 3.827297491121402*^9}, 3.827298152706089*^9, {
   3.82729966016712*^9, 3.827299681025053*^9}, 3.827373100394485*^9, 
   3.827462467019346*^9, 3.82754890546767*^9, 3.836269632529438*^9, 
   3.8364496843163967`*^9, 3.837660504635318*^9, 3.837745785530489*^9, 
   3.838090773210363*^9, 3.838092410019444*^9, {3.83809357590361*^9, 
   3.838093592166595*^9}, 3.838099064906814*^9, 3.8381023793617773`*^9, 
   3.838103145019204*^9, 3.83810807053688*^9, {3.838111744014998*^9, 
   3.8381117631716757`*^9}, 3.8381225569928293`*^9, 3.838122610381201*^9, 
   3.8381234409874887`*^9, 3.8381837107733307`*^9, 3.838184258795245*^9, {
   3.838184373679949*^9, 3.838184487814864*^9}, 3.8381845833584337`*^9, {
   3.838188709337325*^9, 3.838188730113989*^9}, 3.838189245203529*^9, 
   3.8381892835718*^9, 3.838191834450638*^9, 3.838191865328079*^9, {
   3.838191930373618*^9, 3.8381919510791903`*^9}, 3.8381919892080193`*^9, 
   3.838193626939494*^9, 3.838193665895557*^9, 3.8381969990231457`*^9, 
   3.838197036406303*^9, 3.8381970877729816`*^9, 3.838197473864284*^9, {
   3.8381975177738333`*^9, 3.838197536385684*^9}, 3.838354173398986*^9, 
   3.838354431962056*^9, {3.8383545597224073`*^9, 3.8383545842938213`*^9}, 
   3.838437454186892*^9, 3.838694960900199*^9},
 CellLabel->"Out[61]=",ExpressionUUID->"3010cc90-f572-49ac-97d5-7717194dc8c7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CellGraphEdges", "[", "cells_", "]"}], " ", ":=", " ", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
         "cells", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
         "\[DirectedEdge]", " ", 
         RowBox[{
         "cells", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}], 
        ",", " ", 
        RowBox[{"{", 
         RowBox[{"j", ",", " ", "1", ",", " ", 
          RowBox[{"Length", "[", "cells", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"j", "-", "1"}]}], "}"}]}], "]"}], ",", "2"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CellGraph", "[", 
     RowBox[{
     "\[Phi]_", ",", "weightsPositive_", ",", " ", "weightsNegative_"}], 
     "]"}], ":=", " ", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"cells", " ", "=", 
         RowBox[{"FormulaCells", "[", "\[Phi]", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"edgeLabeling", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"cell1_", "\[DirectedEdge]", "cell2_"}], ")"}], 
          "\[RuleDelayed]", " ", 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"cell1", "\[DirectedEdge]", "cell2"}], ")"}], " ", 
            "\[Rule]", "\[IndentingNewLine]", 
            RowBox[{"RTerm", "[", 
             RowBox[{
             "\[Phi]", ",", " ", "cell1", ",", "cell2", ",", " ", 
              "weightsPositive", ",", " ", "weightsNegative"}], "]"}]}], 
           ")"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"vertexLabeling", "=", 
         RowBox[{"cell", "\[Function]", 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{"cell", " ", "\[Rule]", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"STerm", "[", 
               RowBox[{
               "\[Phi]", ",", " ", "cell", ",", " ", "weightsPositive", ",", 
                " ", "weightsNegative"}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"WTerm", "[", 
               RowBox[{
               "\[Phi]", ",", " ", "cell", ",", " ", "weightsPositive", ",", 
                " ", "weightsNegative"}], "]"}]}], "}"}]}], ")"}]}]}]}], 
       "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"With", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"edges", "=", " ", 
          RowBox[{"CellGraphEdges", "[", "cells", "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Graph", "[", "\[IndentingNewLine]", 
         RowBox[{"edges", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"EdgeLabels", "\[Rule]", " ", "edges"}], " ", "/.", " ", 
           "edgeLabeling"}], ",", "\[IndentingNewLine]", 
          RowBox[{"VertexLabels", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "vertexLabeling", ")"}], " ", "/@", " ", "cells"}]}],
           ",", "\[IndentingNewLine]", 
          RowBox[{"GraphLayout", "->", "\"\<CircularEmbedding\>\""}]}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"g", "=", 
    RowBox[{"CellGraph", "[", 
     RowBox[{
     "exampleDerangements", ",", "weightsPositiveDerangements", ",", 
      "weightsNegativeDerangements"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.82677631664717*^9, 3.826776392106119*^9}, {
   3.8267765332843943`*^9, 3.8267766975869493`*^9}, {3.826776732923592*^9, 
   3.826776879441977*^9}, {3.826776914408204*^9, 3.826777159010041*^9}, {
   3.8267772126363697`*^9, 3.826777281654173*^9}, {3.826777409263867*^9, 
   3.82677752628185*^9}, {3.826779530135537*^9, 3.8267795697076406`*^9}, {
   3.826779604479659*^9, 3.8267796593012533`*^9}, {3.826779690132078*^9, 
   3.826779735226982*^9}, {3.826779768791193*^9, 3.8267799442464542`*^9}, {
   3.826779999790695*^9, 3.826780008762195*^9}, {3.826780216348117*^9, 
   3.8267802165420732`*^9}, {3.826780247717576*^9, 3.826780251767538*^9}, {
   3.82678032029327*^9, 3.826780380809041*^9}, {3.826780641696588*^9, 
   3.826780668223263*^9}, 3.826781434212461*^9, {3.826781507117353*^9, 
   3.826781639628915*^9}, 3.826781671652635*^9, {3.826781728169271*^9, 
   3.826781762582808*^9}, {3.8267818619143267`*^9, 3.826781873473317*^9}, {
   3.8267819217592897`*^9, 3.826781945990067*^9}, {3.826781976836549*^9, 
   3.826782016579034*^9}, {3.826782048146036*^9, 3.826782048744166*^9}, {
   3.826787002171405*^9, 3.826787002506032*^9}, {3.8267873756492157`*^9, 
   3.8267873817162027`*^9}, {3.827374667603437*^9, 3.827374674262203*^9}},
 CellLabel->
  "In[154]:=",ExpressionUUID->"cb5ccc7e-7f44-46d8-b840-19729f63b518"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{{$CellContext`f[\[FormalA], \[FormalA]] -> 
        False, $CellContext`s1[\[FormalA]] -> 
        False, $CellContext`s2[\[FormalA]] -> 
        False}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
        False, $CellContext`s1[\[FormalA]] -> 
        False, $CellContext`s2[\[FormalA]] -> 
        True}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
        False, $CellContext`s1[\[FormalA]] -> 
        True, $CellContext`s2[\[FormalA]] -> 
        False}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
        False, $CellContext`s1[\[FormalA]] -> 
        True, $CellContext`s2[\[FormalA]] -> 
        True}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
        True, $CellContext`s1[\[FormalA]] -> 
        False, $CellContext`s2[\[FormalA]] -> 
        False}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
        True, $CellContext`s1[\[FormalA]] -> 
        False, $CellContext`s2[\[FormalA]] -> 
        True}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
        True, $CellContext`s1[\[FormalA]] -> 
        True, $CellContext`s2[\[FormalA]] -> 
        False}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
        True, $CellContext`s1[\[FormalA]] -> 
        True, $CellContext`s2[\[FormalA]] -> True}}, {{{1, 2}, {1, 3}, {2, 
       3}, {1, 4}, {2, 4}, {3, 4}, {1, 5}, {2, 5}, {3, 5}, {4, 5}, {1, 6}, {2,
        6}, {3, 6}, {4, 6}, {5, 6}, {1, 7}, {2, 7}, {3, 7}, {4, 7}, {5, 7}, {
       6, 7}, {1, 8}, {2, 8}, {3, 8}, {4, 8}, {5, 8}, {6, 8}, {7, 8}}, 
       Null}, {EdgeLabels -> {
        DirectedEdge[{$CellContext`f[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            False, $CellContext`s2[\[FormalA]] -> 
            True}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
            True, $CellContext`s1[\[FormalA]] -> 
            True, $CellContext`s2[\[FormalA]] -> False}] -> 0, 
         DirectedEdge[{$CellContext`f[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            True, $CellContext`s2[\[FormalA]] -> 
            False}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
            True, $CellContext`s1[\[FormalA]] -> 
            False, $CellContext`s2[\[FormalA]] -> False}] -> 0, 
         DirectedEdge[{$CellContext`f[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            True, $CellContext`s2[\[FormalA]] -> 
            False}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
            True, $CellContext`s1[\[FormalA]] -> 
            True, $CellContext`s2[\[FormalA]] -> True}] -> 0, 
         DirectedEdge[{$CellContext`f[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            True, $CellContext`s2[\[FormalA]] -> 
            True}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
            True, $CellContext`s1[\[FormalA]] -> 
            False, $CellContext`s2[\[FormalA]] -> True}] -> 0, 
         DirectedEdge[{$CellContext`f[\[FormalA], \[FormalA]] -> 
            True, $CellContext`s1[\[FormalA]] -> 
            False, $CellContext`s2[\[FormalA]] -> 
            False}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
            True, $CellContext`s1[\[FormalA]] -> 
            False, $CellContext`s2[\[FormalA]] -> True}] -> 0, 
         DirectedEdge[{$CellContext`f[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            False, $CellContext`s2[\[FormalA]] -> 
            False}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
            True, $CellContext`s1[\[FormalA]] -> 
            True, $CellContext`s2[\[FormalA]] -> True}] -> 0, 
         DirectedEdge[{$CellContext`f[\[FormalA], \[FormalA]] -> 
            True, $CellContext`s1[\[FormalA]] -> 
            False, $CellContext`s2[\[FormalA]] -> 
            True}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
            True, $CellContext`s1[\[FormalA]] -> 
            True, $CellContext`s2[\[FormalA]] -> False}] -> 0, 
         DirectedEdge[{$CellContext`f[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            False, $CellContext`s2[\[FormalA]] -> 
            False}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            True, $CellContext`s2[\[FormalA]] -> False}] -> 1, 
         DirectedEdge[{$CellContext`f[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            False, $CellContext`s2[\[FormalA]] -> 
            True}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
            True, $CellContext`s1[\[FormalA]] -> 
            False, $CellContext`s2[\[FormalA]] -> True}] -> 0, 
         DirectedEdge[{$CellContext`f[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            True, $CellContext`s2[\[FormalA]] -> 
            False}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
            True, $CellContext`s1[\[FormalA]] -> 
            True, $CellContext`s2[\[FormalA]] -> False}] -> 0, 
         DirectedEdge[{$CellContext`f[\[FormalA], \[FormalA]] -> 
            True, $CellContext`s1[\[FormalA]] -> 
            False, $CellContext`s2[\[FormalA]] -> 
            False}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
            True, $CellContext`s1[\[FormalA]] -> 
            True, $CellContext`s2[\[FormalA]] -> False}] -> 0, 
         DirectedEdge[{$CellContext`f[\[FormalA], \[FormalA]] -> 
            True, $CellContext`s1[\[FormalA]] -> 
            False, $CellContext`s2[\[FormalA]] -> 
            False}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
            True, $CellContext`s1[\[FormalA]] -> 
            True, $CellContext`s2[\[FormalA]] -> True}] -> 0, 
         DirectedEdge[{$CellContext`f[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            True, $CellContext`s2[\[FormalA]] -> 
            True}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
            True, $CellContext`s1[\[FormalA]] -> 
            True, $CellContext`s2[\[FormalA]] -> False}] -> 0, 
         DirectedEdge[{$CellContext`f[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            False, $CellContext`s2[\[FormalA]] -> 
            False}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
            True, $CellContext`s1[\[FormalA]] -> 
            False, $CellContext`s2[\[FormalA]] -> False}] -> 0, 
         DirectedEdge[{$CellContext`f[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            True, $CellContext`s2[\[FormalA]] -> 
            True}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
            True, $CellContext`s1[\[FormalA]] -> 
            True, $CellContext`s2[\[FormalA]] -> True}] -> 0, 
         DirectedEdge[{$CellContext`f[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            False, $CellContext`s2[\[FormalA]] -> 
            True}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            True, $CellContext`s2[\[FormalA]] -> False}] -> 1, 
         DirectedEdge[{$CellContext`f[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            False, $CellContext`s2[\[FormalA]] -> 
            False}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            True, $CellContext`s2[\[FormalA]] -> True}] -> 1, 
         DirectedEdge[{$CellContext`f[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            False, $CellContext`s2[\[FormalA]] -> 
            True}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
            True, $CellContext`s1[\[FormalA]] -> 
            True, $CellContext`s2[\[FormalA]] -> True}] -> 0, 
         DirectedEdge[{$CellContext`f[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            False, $CellContext`s2[\[FormalA]] -> 
            False}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
            True, $CellContext`s1[\[FormalA]] -> 
            True, $CellContext`s2[\[FormalA]] -> False}] -> 0, 
         DirectedEdge[{$CellContext`f[\[FormalA], \[FormalA]] -> 
            True, $CellContext`s1[\[FormalA]] -> 
            True, $CellContext`s2[\[FormalA]] -> 
            False}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
            True, $CellContext`s1[\[FormalA]] -> 
            True, $CellContext`s2[\[FormalA]] -> True}] -> 0, 
         DirectedEdge[{$CellContext`f[\[FormalA], \[FormalA]] -> 
            True, $CellContext`s1[\[FormalA]] -> 
            False, $CellContext`s2[\[FormalA]] -> 
            True}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
            True, $CellContext`s1[\[FormalA]] -> 
            True, $CellContext`s2[\[FormalA]] -> True}] -> 0, 
         DirectedEdge[{$CellContext`f[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            False, $CellContext`s2[\[FormalA]] -> 
            False}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            False, $CellContext`s2[\[FormalA]] -> True}] -> 1, 
         DirectedEdge[{$CellContext`f[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            False, $CellContext`s2[\[FormalA]] -> 
            True}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            True, $CellContext`s2[\[FormalA]] -> True}] -> 1, 
         DirectedEdge[{$CellContext`f[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            True, $CellContext`s2[\[FormalA]] -> 
            True}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
            True, $CellContext`s1[\[FormalA]] -> 
            False, $CellContext`s2[\[FormalA]] -> False}] -> 0, 
         DirectedEdge[{$CellContext`f[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            False, $CellContext`s2[\[FormalA]] -> 
            True}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
            True, $CellContext`s1[\[FormalA]] -> 
            False, $CellContext`s2[\[FormalA]] -> False}] -> 0, 
         DirectedEdge[{$CellContext`f[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            True, $CellContext`s2[\[FormalA]] -> 
            False}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            True, $CellContext`s2[\[FormalA]] -> True}] -> 1, 
         DirectedEdge[{$CellContext`f[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            False, $CellContext`s2[\[FormalA]] -> 
            False}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
            True, $CellContext`s1[\[FormalA]] -> 
            False, $CellContext`s2[\[FormalA]] -> True}] -> 0, 
         DirectedEdge[{$CellContext`f[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            True, $CellContext`s2[\[FormalA]] -> 
            False}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
            True, $CellContext`s1[\[FormalA]] -> 
            False, $CellContext`s2[\[FormalA]] -> True}] -> 0}, GraphLayout -> 
       "CircularEmbedding", 
       VertexLabels -> {{$CellContext`f[\[FormalA], \[FormalA]] -> 
           False, $CellContext`s1[\[FormalA]] -> 
           True, $CellContext`s2[\[FormalA]] -> False} -> {1, 
          1}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
           True, $CellContext`s1[\[FormalA]] -> 
           True, $CellContext`s2[\[FormalA]] -> False} -> {0, 
          0}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
           False, $CellContext`s1[\[FormalA]] -> 
           False, $CellContext`s2[\[FormalA]] -> False} -> {1, 
          1}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
           False, $CellContext`s1[\[FormalA]] -> 
           False, $CellContext`s2[\[FormalA]] -> True} -> {1, 
          1}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
           True, $CellContext`s1[\[FormalA]] -> 
           False, $CellContext`s2[\[FormalA]] -> True} -> {0, 
          0}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
           True, $CellContext`s1[\[FormalA]] -> 
           True, $CellContext`s2[\[FormalA]] -> True} -> {0, 
          0}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
           False, $CellContext`s1[\[FormalA]] -> 
           True, $CellContext`s2[\[FormalA]] -> True} -> {1, 
          1}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
           True, $CellContext`s1[\[FormalA]] -> 
           False, $CellContext`s2[\[FormalA]] -> False} -> {0, 0}}}]]}, 
    TagBox[GraphicsGroupBox[{
       {Hue[0.6, 0.7, 0.5], Opacity[0.7], Arrowheads[
        Medium], {
         ArrowBox[{{-0.707106781186548, 
          0.7071067811865482}, {-7.044813998280222*^-16, 1.}}, 
          0.02261146496815286], 
         InsetBox["1", {-0.35355339059327434, 0.8535533905932742}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{-0.707106781186548, 0.7071067811865482}, {
          0.707106781186547, 0.7071067811865467}}, 0.02261146496815286], 
         InsetBox["1", {-4.996003610813204*^-16, 0.7071067811865475}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{-0.707106781186548, 0.7071067811865482}, {
          1., -1.133107779529596*^-15}}, 0.02261146496815286], 
         InsetBox["1", {0.146446609406726, 0.35355339059327356}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{-0.707106781186548, 0.7071067811865482}, {
          0.7071067811865481, -0.7071067811865483}}, 0.02261146496815286], 
         InsetBox["0", {5.551115123125783*^-17, -5.551115123125783*^-17}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{-0.707106781186548, 0.7071067811865482}, {
          6.049014748177263*^-16, -1.}}, 0.02261146496815286], 
         InsetBox["0", {-0.35355339059327373, -0.14644660940672588}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{-0.707106781186548, 
          0.7071067811865482}, {-0.7071067811865471, -0.7071067811865468}}, 
          0.02261146496815286], 
         InsetBox["0", {-0.7071067811865476, 7.216449660063518*^-16}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{-0.707106781186548, 0.7071067811865482}, {-1., 
          1.0106430996148606`*^-15}}, 0.02261146496815286], 
         InsetBox["0", {-0.853553390593274, 0.3535533905932746}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{-7.044813998280222*^-16, 1.}, {0.707106781186547, 
          0.7071067811865467}}, 0.02261146496815286], 
         InsetBox["1", {0.3535533905932732, 0.8535533905932733}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{-7.044813998280222*^-16, 1.}, {
          1., -1.133107779529596*^-15}}, 0.02261146496815286], 
         InsetBox["1", {0.49999999999999967, 0.49999999999999944}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{-7.044813998280222*^-16, 1.}, {
          0.7071067811865481, -0.7071067811865483}}, 0.02261146496815286], 
         InsetBox["0", {0.35355339059327373, 0.14644660940672583}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{-7.044813998280222*^-16, 1.}, {
          6.049014748177263*^-16, -1.}}, 0.02261146496815286], 
         InsetBox["0", {-4.978996250514798*^-17, 0.}, ImageScaled[{0.5, 0.5}],
          
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{-7.044813998280222*^-16, 
          1.}, {-0.7071067811865471, -0.7071067811865468}}, 
          0.02261146496815286], 
         InsetBox["0", {-0.3535533905932739, 0.1464466094067266}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{-7.044813998280222*^-16, 1.}, {-1., 
          1.0106430996148606`*^-15}}, 0.02261146496815286], 
         InsetBox["0", {-0.5000000000000003, 0.5000000000000006}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{0.707106781186547, 0.7071067811865467}, {
          1., -1.133107779529596*^-15}}, 0.02261146496815286], 
         InsetBox["1", {0.8535533905932735, 0.3535533905932728}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{0.707106781186547, 0.7071067811865467}, {
          0.7071067811865481, -0.7071067811865483}}, 0.02261146496815286], 
         InsetBox["0", {0.7071067811865476, -8.326672684688674*^-16}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{0.707106781186547, 0.7071067811865467}, {
          6.049014748177263*^-16, -1.}}, 0.02261146496815286], 
         InsetBox["0", {0.3535533905932738, -0.14644660940672666}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{0.707106781186547, 
          0.7071067811865467}, {-0.7071067811865471, -0.7071067811865468}}, 
          0.02261146496815286], 
         InsetBox["0", {-5.551115123125783*^-17, -5.551115123125783*^-17}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{0.707106781186547, 0.7071067811865467}, {-1., 
          1.0106430996148606`*^-15}}, 0.02261146496815286], 
         InsetBox["0", {-0.1464466094067265, 0.35355339059327384}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{1., -1.133107779529596*^-15}, {
          0.7071067811865481, -0.7071067811865483}}, 0.02261146496815286], 
         InsetBox["0", {0.8535533905932741, -0.35355339059327473}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{1., -1.133107779529596*^-15}, {
          6.049014748177263*^-16, -1.}}, 0.02261146496815286], 
         InsetBox["0", {0.5000000000000003, -0.5000000000000006}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{
          1., -1.133107779529596*^-15}, {-0.7071067811865471, \
-0.7071067811865468}}, 0.02261146496815286], 
         InsetBox["0", {0.14644660940672644, -0.35355339059327395}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{1., -1.133107779529596*^-15}, {-1., 
          1.0106430996148606`*^-15}}, 0.02261146496815286], 
         InsetBox["0", {0., -6.123233995736767*^-17}, ImageScaled[{0.5, 0.5}],
          
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{0.7071067811865481, -0.7071067811865483}, {
          6.049014748177263*^-16, -1.}}, 0.02261146496815286], 
         InsetBox["0", {0.35355339059327434, -0.8535533905932742}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{
          0.7071067811865481, -0.7071067811865483}, {-0.7071067811865471, \
-0.7071067811865468}}, 0.02261146496815286], 
         InsetBox["0", {4.996003610813204*^-16, -0.7071067811865476}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{0.7071067811865481, -0.7071067811865483}, {-1., 
          1.0106430996148606`*^-15}}, 0.02261146496815286], 
         InsetBox["0", {-0.14644660940672594, -0.3535533905932737}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{
          6.049014748177263*^-16, -1.}, {-0.7071067811865471, \
-0.7071067811865468}}, 0.02261146496815286], 
         InsetBox["0", {-0.3535533905932733, -0.8535533905932734}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{6.049014748177263*^-16, -1.}, {-1., 
          1.0106430996148606`*^-15}}, 0.02261146496815286], 
         InsetBox["0", {-0.4999999999999997, -0.4999999999999995}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{-0.7071067811865471, -0.7071067811865468}, {-1., 
          1.0106430996148606`*^-15}}, 0.02261146496815286], 
         InsetBox["0", {-0.8535533905932735, -0.3535533905932729}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}}, 
       {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
        DiskBox[{-0.707106781186548, 0.7071067811865482}, 
         0.02261146496815286], 
        DiskBox[{-7.044813998280222*^-16, 1.}, 0.02261146496815286], 
        DiskBox[{0.707106781186547, 0.7071067811865467}, 0.02261146496815286],
         DiskBox[{1., -1.133107779529596*^-15}, 0.02261146496815286], 
        DiskBox[{0.7071067811865481, -0.7071067811865483}, 
         0.02261146496815286], 
        DiskBox[{6.049014748177263*^-16, -1.}, 0.02261146496815286], 
        DiskBox[{-0.7071067811865471, -0.7071067811865468}, 
         0.02261146496815286], 
        DiskBox[{-1., 1.0106430996148606*^-15}, 0.02261146496815286]}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameTicks->None,
  ImageSize->{918.8910891089109, Automatic}]], "Output",
 CellChangeTimes->{
  3.826780217077115*^9, 3.8267802522017517`*^9, {3.8267803346474*^9, 
   3.826780373231633*^9}, {3.8267806421737213`*^9, 3.8267806688445873`*^9}, 
   3.826780815366444*^9, 3.826781450295142*^9, {3.8267816496814737`*^9, 
   3.826781672205987*^9}, {3.8267817492620783`*^9, 3.826781763592647*^9}, {
   3.8267819136800947`*^9, 3.826781946945999*^9}, {3.826781987110038*^9, 
   3.826782017064035*^9}, 3.8267820511738157`*^9, 3.8267870030832453`*^9, 
   3.826787384876696*^9, {3.826860916492393*^9, 3.826860932677967*^9}, 
   3.827201237919807*^9, 3.827287247242787*^9, 3.8273731004446983`*^9, 
   3.827374674998238*^9, 3.827462467136628*^9, 3.827548905541114*^9, 
   3.836269632584982*^9, 3.8364496844218082`*^9, 3.837660504743149*^9, 
   3.83774578562612*^9, 3.838090773352538*^9, 3.838092410078659*^9, {
   3.838093575972663*^9, 3.838093592218259*^9}, 3.838099064961789*^9, 
   3.838102379434535*^9, 3.838103145100259*^9, 3.8381080706707897`*^9, {
   3.838111744174169*^9, 3.8381117632425632`*^9}, 3.838122557391739*^9, 
   3.838122610445403*^9, 3.838123441034047*^9, 3.838183710842853*^9, 
   3.838184258825932*^9, {3.838184373949942*^9, 3.838184487920012*^9}, 
   3.838184583469955*^9, {3.838188709445644*^9, 3.838188730148946*^9}, 
   3.8381892452785807`*^9, 3.838189283609213*^9, 3.838191834484107*^9, 
   3.838191865748198*^9, {3.8381919304066143`*^9, 3.838191951108574*^9}, 
   3.838191989236289*^9, 3.8381936269722357`*^9, 3.838193665939782*^9, 
   3.838196999500413*^9, 3.8381970368258457`*^9, 3.838197087801025*^9, 
   3.83819747427612*^9, {3.838197518265292*^9, 3.8381975368757763`*^9}, 
   3.8383541737852287`*^9, 3.838354432378731*^9, {3.838354559759267*^9, 
   3.838354584319495*^9}, 3.83843745423356*^9, 3.838694960951501*^9, 
   3.838699840529909*^9},
 CellLabel->
  "Out[156]=",ExpressionUUID->"cb918192-4799-470b-b6c0-72b96bdcc384"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Implementation", " ", "of", " ", "WFOMC", " ", "according", " ", "to", 
     " ", "formula", " ", 
     RowBox[{"(", "1", ")"}], " ", "in", " ", "Faster", " ", "Lifting", " ", 
     "for", " ", "Two"}], "-", 
    RowBox[{
    "Variable", " ", "Logic", " ", "using", " ", "Cell", " ", "Graphs"}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"OrderedPartitions", "[", 
     RowBox[{"n_Integer", ",", "m_Integer"}], "]"}], ":=", " ", 
    RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Permutations", "[", 
         RowBox[{"PadRight", "[", 
          RowBox[{"#", ",", "m"}], "]"}], "]"}], "&"}], "\[IndentingNewLine]",
        "/@", 
       RowBox[{"IntegerPartitions", "[", 
        RowBox[{"n", ",", "m"}], "]"}]}], ",", "\[IndentingNewLine]", "1"}], 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Pow", "[", 
     RowBox[{"0", ",", "0"}], "]"}], ":=", "1"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Pow", "[", 
     RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
    RowBox[{"a", "^", "b"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"WFOMC1", "[", 
     RowBox[{
     "\[Phi]_", ",", "n_", ",", "weightsPositive_", ",", " ", 
      "weightsNegative_"}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"s", "=", 
         RowBox[{"STerms", "[", 
          RowBox[{
          "\[Phi]", ",", " ", "weightsPositive", ",", " ", 
           "weightsNegative"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"w", "=", 
         RowBox[{"WTerms", "[", 
          RowBox[{
          "\[Phi]", ",", " ", "weightsPositive", ",", " ", 
           "weightsNegative"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"r", "=", 
         RowBox[{"RTerms", "[", 
          RowBox[{
          "\[Phi]", ",", " ", "weightsPositive", ",", " ", 
           "weightsNegative"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"u", "=", 
         RowBox[{"2", "^", 
          RowBox[{"(", 
           RowBox[{"Length", "@", 
            RowBox[{"PredicateSymbols", "[", "\[Phi]", "]"}]}], " ", 
           ")"}]}]}], ",", "\[IndentingNewLine]", "i", ",", "j"}], "}"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{"Total", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"partition", " ", "|->", " ", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Multinomial", "[", 
            RowBox[{"Sequence", "@@", "partition"}], "]"}], " ", "*", 
           "\[IndentingNewLine]", 
           RowBox[{"Product", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"r", "\[LeftDoubleBracket]", 
               RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "~", "Pow",
               "~", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "partition", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}], "*", 
                RowBox[{
                "partition", "\[LeftDoubleBracket]", "j", 
                 "\[RightDoubleBracket]"}]}], ")"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", "u"}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", " ", ",", " ", 
               RowBox[{"j", "-", "1"}]}], "}"}]}], "]"}], "*", 
           "\[IndentingNewLine]", 
           RowBox[{"Product", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
               "s", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
               "~", "Pow", "~", 
               RowBox[{"Binomial", "[", 
                RowBox[{
                 RowBox[{
                 "partition", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}], ",", "2"}], "]"}]}], " ", "*", 
              "\[IndentingNewLine]", " ", 
              RowBox[{
               RowBox[{
               "w", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
               "~", "Pow", "~", 
               RowBox[{
               "partition", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "u"}], "}"}]}], "]"}]}]}], 
         "\[IndentingNewLine]", ")"}], " ", "/@", " ", 
        RowBox[{"OrderedPartitions", "[", 
         RowBox[{"n", ",", " ", "u"}], "]"}]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.837671520214148*^9, 3.837671559005844*^9}, {
  3.83767175868404*^9, 3.837671836650036*^9}, {3.837676078777917*^9, 
  3.8376761046086807`*^9}, {3.837677350649568*^9, 3.837677351937161*^9}, {
  3.837678843118335*^9, 3.837678850990128*^9}, {3.837678890276106*^9, 
  3.837678925290481*^9}, {3.837678958848846*^9, 3.837678976703998*^9}, {
  3.837679016694084*^9, 3.8376793311201487`*^9}, {3.8377469641332273`*^9, 
  3.837746978068305*^9}, {3.837747023042777*^9, 3.837747067350965*^9}, {
  3.8377472368946753`*^9, 3.8377472703717403`*^9}, {3.837747438573263*^9, 
  3.837747440265904*^9}, {3.837747477906584*^9, 3.837747496104636*^9}, {
  3.838367477804426*^9, 3.8383674923385878`*^9}, {3.8384456841657877`*^9, 
  3.838445684684894*^9}, {3.838695013887693*^9, 3.8386950144711227`*^9}},
 CellLabel->
  "In[271]:=",ExpressionUUID->"de9d90ff-36d4-4acd-a124-54bc81661d37"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Expand", "@", 
     RowBox[{"WFOMC1", "[", 
      RowBox[{
      "exampleDerangements", ",", "n", ",", "weightsPositiveDerangements", 
       ",", "weightsNegativeDerangements"}], "]"}]}], ",", 
    "\[IndentingNewLine]", " ", 
    RowBox[{"{", 
     RowBox[{"n", ",", " ", "0", ",", " ", "5"}], "}"}]}], "]"}], " ", "//", 
  " ", "Column"}]], "Input",
 CellChangeTimes->{{3.837671569973804*^9, 3.8376715949630013`*^9}, {
  3.837671627206588*^9, 3.837671631546236*^9}, {3.837678818766939*^9, 
  3.837678831829865*^9}, {3.837678937946063*^9, 3.8376789529351254`*^9}, {
  3.837679364693651*^9, 3.837679417960854*^9}, {3.838111781844524*^9, 
  3.838111784124291*^9}, {3.8381118428259373`*^9, 3.838111910430691*^9}, {
  3.838698894148209*^9, 3.838698906137195*^9}, {3.838699871003758*^9, 
  3.8386998807575274`*^9}, {3.8387000986729717`*^9, 3.838700114533228*^9}},
 CellLabel->
  "In[281]:=",ExpressionUUID->"3967da30-0426-4e51-8fed-f7c482dc836e"],

Cell[BoxData[
 TagBox[GridBox[{
    {"1"},
    {"4"},
    {
     RowBox[{"8", "+", 
      RowBox[{"14", " ", "\[FormalF]"}], "+", 
      RowBox[{"7", " ", 
       SuperscriptBox["\[FormalF]", "2"]}]}]},
    {
     RowBox[{"16", "+", 
      RowBox[{"90", " ", "\[FormalF]"}], "+", 
      RowBox[{"225", " ", 
       SuperscriptBox["\[FormalF]", "2"]}], "+", 
      RowBox[{"300", " ", 
       SuperscriptBox["\[FormalF]", "3"]}], "+", 
      RowBox[{"225", " ", 
       SuperscriptBox["\[FormalF]", "4"]}], "+", 
      RowBox[{"90", " ", 
       SuperscriptBox["\[FormalF]", "5"]}], "+", 
      RowBox[{"15", " ", 
       SuperscriptBox["\[FormalF]", "6"]}]}]},
    {
     RowBox[{"32", "+", 
      RowBox[{"372", " ", "\[FormalF]"}], "+", 
      RowBox[{"2046", " ", 
       SuperscriptBox["\[FormalF]", "2"]}], "+", 
      RowBox[{"6820", " ", 
       SuperscriptBox["\[FormalF]", "3"]}], "+", 
      RowBox[{"15345", " ", 
       SuperscriptBox["\[FormalF]", "4"]}], "+", 
      RowBox[{"24552", " ", 
       SuperscriptBox["\[FormalF]", "5"]}], "+", 
      RowBox[{"28644", " ", 
       SuperscriptBox["\[FormalF]", "6"]}], "+", 
      RowBox[{"24552", " ", 
       SuperscriptBox["\[FormalF]", "7"]}], "+", 
      RowBox[{"15345", " ", 
       SuperscriptBox["\[FormalF]", "8"]}], "+", 
      RowBox[{"6820", " ", 
       SuperscriptBox["\[FormalF]", "9"]}], "+", 
      RowBox[{"2046", " ", 
       SuperscriptBox["\[FormalF]", "10"]}], "+", 
      RowBox[{"372", " ", 
       SuperscriptBox["\[FormalF]", "11"]}], "+", 
      RowBox[{"31", " ", 
       SuperscriptBox["\[FormalF]", "12"]}]}]},
    {
     RowBox[{"64", "+", 
      RowBox[{"1260", " ", "\[FormalF]"}], "+", 
      RowBox[{"11970", " ", 
       SuperscriptBox["\[FormalF]", "2"]}], "+", 
      RowBox[{"71820", " ", 
       SuperscriptBox["\[FormalF]", "3"]}], "+", 
      RowBox[{"305235", " ", 
       SuperscriptBox["\[FormalF]", "4"]}], "+", 
      RowBox[{"976752", " ", 
       SuperscriptBox["\[FormalF]", "5"]}], "+", 
      RowBox[{"2441880", " ", 
       SuperscriptBox["\[FormalF]", "6"]}], "+", 
      RowBox[{"4883760", " ", 
       SuperscriptBox["\[FormalF]", "7"]}], "+", 
      RowBox[{"7936110", " ", 
       SuperscriptBox["\[FormalF]", "8"]}], "+", 
      RowBox[{"10581480", " ", 
       SuperscriptBox["\[FormalF]", "9"]}], "+", 
      RowBox[{"11639628", " ", 
       SuperscriptBox["\[FormalF]", "10"]}], "+", 
      RowBox[{"10581480", " ", 
       SuperscriptBox["\[FormalF]", "11"]}], "+", 
      RowBox[{"7936110", " ", 
       SuperscriptBox["\[FormalF]", "12"]}], "+", 
      RowBox[{"4883760", " ", 
       SuperscriptBox["\[FormalF]", "13"]}], "+", 
      RowBox[{"2441880", " ", 
       SuperscriptBox["\[FormalF]", "14"]}], "+", 
      RowBox[{"976752", " ", 
       SuperscriptBox["\[FormalF]", "15"]}], "+", 
      RowBox[{"305235", " ", 
       SuperscriptBox["\[FormalF]", "16"]}], "+", 
      RowBox[{"71820", " ", 
       SuperscriptBox["\[FormalF]", "17"]}], "+", 
      RowBox[{"11970", " ", 
       SuperscriptBox["\[FormalF]", "18"]}], "+", 
      RowBox[{"1260", " ", 
       SuperscriptBox["\[FormalF]", "19"]}], "+", 
      RowBox[{"63", " ", 
       SuperscriptBox["\[FormalF]", "20"]}]}]}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Output",
 CellChangeTimes->{{3.837671573612368*^9, 3.837671595498357*^9}, 
   3.837671631855782*^9, {3.837678823257477*^9, 3.837678832158881*^9}, {
   3.837678939241272*^9, 3.83767895328126*^9}, {3.8376793938334217`*^9, 
   3.837679420199458*^9}, 3.837745785659285*^9, 3.837746983196039*^9, {
   3.837747250296301*^9, 3.8377472724534893`*^9}, 3.837747464566654*^9, 
   3.838090773490415*^9, 3.838092410185232*^9, 3.838093499868433*^9, {
   3.838093576075965*^9, 3.8380935923208027`*^9}, 3.838094131970779*^9, {
   3.838099053156966*^9, 3.8380990650603533`*^9}, 3.838102379617313*^9, 
   3.838103145302347*^9, 3.838108071159771*^9, {3.838111744725732*^9, 
   3.838111784742243*^9}, {3.838111906302454*^9, 3.838111911175551*^9}, 
   3.83812255757415*^9, 3.838122610587903*^9, 3.8381234411805*^9, 
   3.838183710998446*^9, 3.838184258966941*^9, {3.838184374123165*^9, 
   3.838184488370401*^9}, 3.838184583949355*^9, {3.83818870993018*^9, 
   3.838188730323399*^9}, 3.838189245691696*^9, 3.8381892837754993`*^9, 
   3.838191834650038*^9, 3.838191865897613*^9, {3.838191930535947*^9, 
   3.8381919512149963`*^9}, 3.838191989338784*^9, 3.838193627078986*^9, 
   3.838193666058004*^9, 3.8381969996710587`*^9, 3.838197036964589*^9, 
   3.83819708790653*^9, 3.838197474412085*^9, {3.838197518412426*^9, 
   3.838197537022626*^9}, 3.838354173953002*^9, 3.8383544325390043`*^9, {
   3.838354559879693*^9, 3.8383545844135427`*^9}, 3.838437454340425*^9, 
   3.8386949610540257`*^9, {3.838698889811092*^9, 3.838698906779139*^9}, {
   3.838699821471425*^9, 3.83869988477948*^9}, {3.838700087249617*^9, 
   3.838700115149205*^9}},
 CellLabel->
  "Out[281]=",ExpressionUUID->"789b0e37-5796-48b9-9794-0fa012613fef"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"Subfactorial", "[", "i", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "0", ",", "5"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8381118835136557`*^9, 3.8381118923358297`*^9}, {
  3.8381226889470387`*^9, 3.838122699967991*^9}},
 CellLabel->"In[70]:=",ExpressionUUID->"1bf93d6f-5376-48d2-b66b-57fcc9112f94"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "0", ",", "1", ",", "2", ",", "9", ",", "44"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.838123441191609*^9, 3.838183711009601*^9, 3.838184258977017*^9, {
   3.838184374133192*^9, 3.838184488391726*^9}, 3.838184583965845*^9, {
   3.838188709946292*^9, 3.838188730329379*^9}, 3.838189245702137*^9, 
   3.8381892837861433`*^9, 3.8381918346588287`*^9, 3.83819186590799*^9, {
   3.838191930541678*^9, 3.838191951225313*^9}, 3.8381919893488092`*^9, 
   3.838193627089519*^9, 3.838193666068465*^9, 3.8381969996872263`*^9, 
   3.838197036976269*^9, 3.8381970879128447`*^9, 3.8381974744235563`*^9, {
   3.838197518424284*^9, 3.83819753703443*^9}, 3.838354173964332*^9, 
   3.8383544325493183`*^9, {3.838354559884881*^9, 3.838354584424411*^9}, 
   3.8384374543513203`*^9, 3.838694961067622*^9},
 CellLabel->"Out[70]=",ExpressionUUID->"ebd7313b-e156-4c1d-8772-b4bc4df759cd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Expand", "@", 
     RowBox[{"WFOMC1", "[", 
      RowBox[{
      "exampleDerangements", ",", "n", ",", "weightsPositiveDerangements", 
       ",", "weightsNegativeDerangements"}], "]"}]}], ",", 
    "\[IndentingNewLine]", " ", 
    RowBox[{"{", 
     RowBox[{"n", ",", " ", "0", ",", " ", "5"}], "}"}]}], "]"}], "//", 
  "Column"}]], "Input",
 CellChangeTimes->{{3.838122720239593*^9, 3.838122720440585*^9}, {
  3.838183741035527*^9, 3.8381837759355097`*^9}},
 CellLabel->"In[71]:=",ExpressionUUID->"76a0a37c-2633-427e-bed4-0617b95548f2"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"{", 
      RowBox[{"{", "1", "}"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0", ",", 
        "0"}], "}"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "2", ",", "2", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0"}], "}"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "3", ",", "3", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "3", ",", "3", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0"}], "}"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "4", ",", "4", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "4", ",", "4", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "6", ",", "6", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0"}], "}"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "5", ",", "5", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "5", ",", "5", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "10", ",", "10", ",", "0", ",", "0", ",", "0", ",", "0", 
        ",", "0", ",", "10", ",", "10", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0"}], "}"}], "}"}]}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Output",
 CellChangeTimes->{
  3.838122721473688*^9, 3.8381234412626667`*^9, {3.838183748640065*^9, 
   3.838183776303419*^9}, 3.83818425911757*^9, {3.838184374286139*^9, 
   3.8381844888492804`*^9}, 3.83818458440415*^9, {3.838188710395216*^9, 
   3.838188730490213*^9}, 3.838189246121151*^9, 3.838189283943097*^9, 
   3.838191834813396*^9, 3.838191866039031*^9, {3.838191930658791*^9, 
   3.8381919513257008`*^9}, 3.8381919894467707`*^9, 3.8381936271925583`*^9, 
   3.83819366617636*^9, 3.838196999820107*^9, 3.83819703708288*^9, 
   3.838197088007276*^9, 3.838197474532572*^9, {3.83819751854667*^9, 
   3.838197537145276*^9}, 3.838354174074936*^9, 3.838354432678266*^9, {
   3.838354559971341*^9, 3.8383545845125713`*^9}, 3.838437454440277*^9, 
   3.838694961159751*^9},
 CellLabel->"Out[71]=",ExpressionUUID->"6e915be8-6732-4a3d-b5e8-7aa16c7bc9d1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{"exampleDerangements", "\[IndentingNewLine]", 
 RowBox[{"FormulaCells", "[", "exampleDerangements", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"FormulaSimplified", "[", 
  RowBox[{"exampleDerangements", ",", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", "False"}],
      ",", 
     RowBox[{
      RowBox[{"s1", "[", "\[FormalA]", "]"}], "\[Rule]", "False"}], ",", 
     RowBox[{
      RowBox[{"s2", "[", "\[FormalA]", "]"}], "\[Rule]", "False"}]}], "}"}], 
   ",", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", "False"}],
      ",", 
     RowBox[{
      RowBox[{"s1", "[", "\[FormalA]", "]"}], "\[Rule]", "False"}], ",", 
     RowBox[{
      RowBox[{"s2", "[", "\[FormalA]", "]"}], "\[Rule]", "True"}]}], "}"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.8380981264487658`*^9, 3.838098179925247*^9}},
 CellLabel->"In[72]:=",ExpressionUUID->"f05d3a32-c296-4536-aa67-f328bff48d86"],

Cell[BoxData[
 RowBox[{
  RowBox[{"!", 
   RowBox[{"f", "[", 
    RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}]}], "&&", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Implies]", 
    RowBox[{"s1", "[", "\[FormalA]", "]"}]}], ")"}], "&&", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}], "\[Implies]", 
    RowBox[{"s2", "[", "\[FormalA]", "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.838098133310258*^9, 3.838098180535962*^9, 3.838099065086752*^9, 
   3.838102379642735*^9, 3.838103145344054*^9, 3.8381080711957083`*^9, {
   3.838111744755787*^9, 3.8381117634230947`*^9}, 3.838122557598761*^9, 
   3.838122610607719*^9, 3.838123441274624*^9, 3.838183711024054*^9, 
   3.8381842591304827`*^9, {3.8381843742978163`*^9, 3.8381844888785343`*^9}, 
   3.838184584432899*^9, {3.8381887104250803`*^9, 3.838188730498337*^9}, 
   3.8381892461445704`*^9, 3.838189283955021*^9, 3.838191834823461*^9, 
   3.8381918660516253`*^9, {3.838191930666052*^9, 3.838191951339555*^9}, 
   3.838191989459845*^9, 3.8381936272041073`*^9, 3.838193666190998*^9, 
   3.8381969998426857`*^9, 3.838197037099408*^9, 3.8381970880166187`*^9, 
   3.838197474546194*^9, {3.838197518561165*^9, 3.838197537158659*^9}, 
   3.838354174088666*^9, 3.838354432689597*^9, {3.838354559977212*^9, 
   3.8383545845244513`*^9}, 3.838437454452187*^9, 3.838694961176097*^9},
 CellLabel->"Out[72]=",ExpressionUUID->"60e5e2d0-246d-451d-9798-f09a9d193571"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", "False"}],
      ",", 
     RowBox[{
      RowBox[{"s1", "[", "\[FormalA]", "]"}], "\[Rule]", "False"}], ",", 
     RowBox[{
      RowBox[{"s2", "[", "\[FormalA]", "]"}], "\[Rule]", "False"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", "False"}],
      ",", 
     RowBox[{
      RowBox[{"s1", "[", "\[FormalA]", "]"}], "\[Rule]", "False"}], ",", 
     RowBox[{
      RowBox[{"s2", "[", "\[FormalA]", "]"}], "\[Rule]", "True"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", "False"}],
      ",", 
     RowBox[{
      RowBox[{"s1", "[", "\[FormalA]", "]"}], "\[Rule]", "True"}], ",", 
     RowBox[{
      RowBox[{"s2", "[", "\[FormalA]", "]"}], "\[Rule]", "False"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", "False"}],
      ",", 
     RowBox[{
      RowBox[{"s1", "[", "\[FormalA]", "]"}], "\[Rule]", "True"}], ",", 
     RowBox[{
      RowBox[{"s2", "[", "\[FormalA]", "]"}], "\[Rule]", "True"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", "True"}], 
     ",", 
     RowBox[{
      RowBox[{"s1", "[", "\[FormalA]", "]"}], "\[Rule]", "False"}], ",", 
     RowBox[{
      RowBox[{"s2", "[", "\[FormalA]", "]"}], "\[Rule]", "False"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", "True"}], 
     ",", 
     RowBox[{
      RowBox[{"s1", "[", "\[FormalA]", "]"}], "\[Rule]", "False"}], ",", 
     RowBox[{
      RowBox[{"s2", "[", "\[FormalA]", "]"}], "\[Rule]", "True"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", "True"}], 
     ",", 
     RowBox[{
      RowBox[{"s1", "[", "\[FormalA]", "]"}], "\[Rule]", "True"}], ",", 
     RowBox[{
      RowBox[{"s2", "[", "\[FormalA]", "]"}], "\[Rule]", "False"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", "True"}], 
     ",", 
     RowBox[{
      RowBox[{"s1", "[", "\[FormalA]", "]"}], "\[Rule]", "True"}], ",", 
     RowBox[{
      RowBox[{"s2", "[", "\[FormalA]", "]"}], "\[Rule]", "True"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.838098133310258*^9, 3.838098180535962*^9, 3.838099065086752*^9, 
   3.838102379642735*^9, 3.838103145344054*^9, 3.8381080711957083`*^9, {
   3.838111744755787*^9, 3.8381117634230947`*^9}, 3.838122557598761*^9, 
   3.838122610607719*^9, 3.838123441274624*^9, 3.838183711024054*^9, 
   3.8381842591304827`*^9, {3.8381843742978163`*^9, 3.8381844888785343`*^9}, 
   3.838184584432899*^9, {3.8381887104250803`*^9, 3.838188730498337*^9}, 
   3.8381892461445704`*^9, 3.838189283955021*^9, 3.838191834823461*^9, 
   3.8381918660516253`*^9, {3.838191930666052*^9, 3.838191951339555*^9}, 
   3.838191989459845*^9, 3.8381936272041073`*^9, 3.838193666190998*^9, 
   3.8381969998426857`*^9, 3.838197037099408*^9, 3.8381970880166187`*^9, 
   3.838197474546194*^9, {3.838197518561165*^9, 3.838197537158659*^9}, 
   3.838354174088666*^9, 3.838354432689597*^9, {3.838354559977212*^9, 
   3.8383545845244513`*^9}, 3.838437454452187*^9, 3.838694961179043*^9},
 CellLabel->"Out[73]=",ExpressionUUID->"f4daff74-b501-4ade-9c9c-82d8ebcda437"],

Cell[BoxData[
 RowBox[{
  RowBox[{"!", 
   RowBox[{"f", "[", 
    RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}]}], "&&", 
  RowBox[{"!", 
   RowBox[{"f", "[", 
    RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}]}], "&&", 
  RowBox[{"!", 
   RowBox[{"f", "[", 
    RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.838098133310258*^9, 3.838098180535962*^9, 3.838099065086752*^9, 
   3.838102379642735*^9, 3.838103145344054*^9, 3.8381080711957083`*^9, {
   3.838111744755787*^9, 3.8381117634230947`*^9}, 3.838122557598761*^9, 
   3.838122610607719*^9, 3.838123441274624*^9, 3.838183711024054*^9, 
   3.8381842591304827`*^9, {3.8381843742978163`*^9, 3.8381844888785343`*^9}, 
   3.838184584432899*^9, {3.8381887104250803`*^9, 3.838188730498337*^9}, 
   3.8381892461445704`*^9, 3.838189283955021*^9, 3.838191834823461*^9, 
   3.8381918660516253`*^9, {3.838191930666052*^9, 3.838191951339555*^9}, 
   3.838191989459845*^9, 3.8381936272041073`*^9, 3.838193666190998*^9, 
   3.8381969998426857`*^9, 3.838197037099408*^9, 3.8381970880166187`*^9, 
   3.838197474546194*^9, {3.838197518561165*^9, 3.838197537158659*^9}, 
   3.838354174088666*^9, 3.838354432689597*^9, {3.838354559977212*^9, 
   3.8383545845244513`*^9}, 3.838437454452187*^9, 3.838694961180497*^9},
 CellLabel->"Out[74]=",ExpressionUUID->"098caec7-20b4-438d-950e-06f9d12b4dc4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FormulaSymmetric", "[", 
  RowBox[{"exampleDerangements", ",", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", "False"}],
      ",", 
     RowBox[{
      RowBox[{"s1", "[", "\[FormalA]", "]"}], "\[Rule]", "False"}], ",", 
     RowBox[{
      RowBox[{"s2", "[", "\[FormalA]", "]"}], "\[Rule]", "True"}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.838098207396513*^9, 3.838098219395213*^9}},
 CellLabel->"In[75]:=",ExpressionUUID->"36013548-77da-4387-928a-f58dc552d2e1"],

Cell[BoxData[
 RowBox[{"FormulaSymmetric", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"!", 
     RowBox[{"f", "[", 
      RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}]}], "&&", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Implies]", 
      RowBox[{"s1", "[", "\[FormalA]", "]"}]}], ")"}], "&&", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}], "\[Implies]", 
      RowBox[{"s2", "[", "\[FormalA]", "]"}]}], ")"}]}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", "False"}],
      ",", 
     RowBox[{
      RowBox[{"s1", "[", "\[FormalA]", "]"}], "\[Rule]", "False"}], ",", 
     RowBox[{
      RowBox[{"s2", "[", "\[FormalA]", "]"}], "\[Rule]", "True"}]}], "}"}]}], 
  "]"}]], "Output",
 CellChangeTimes->{
  3.838098219827306*^9, 3.838099065103709*^9, 3.838102379663918*^9, 
   3.838103145368932*^9, 3.83810807121319*^9, {3.838111744775968*^9, 
   3.8381117634407597`*^9}, 3.8381225576166058`*^9, 3.838122610625678*^9, 
   3.8381234413104687`*^9, 3.8381837110392523`*^9, 3.838184259147045*^9, {
   3.838184374314364*^9, 3.8381844888967323`*^9}, 3.838184584448059*^9, {
   3.838188710441163*^9, 3.838188730513351*^9}, 3.838189246158681*^9, 
   3.838189283972101*^9, 3.8381918348372393`*^9, 3.838191866070422*^9, {
   3.838191930681616*^9, 3.838191951356091*^9}, 3.8381919894773483`*^9, 
   3.838193627227124*^9, 3.838193666207158*^9, 3.8381969998686438`*^9, 
   3.838197037118374*^9, 3.8381970880318823`*^9, 3.8381974745639563`*^9, {
   3.838197518579564*^9, 3.8381975371758966`*^9}, 3.838354174104103*^9, 
   3.838354432705203*^9, {3.838354559991342*^9, 3.83835458453995*^9}, 
   3.8384374544682493`*^9, 3.838694961192634*^9},
 CellLabel->"Out[75]=",ExpressionUUID->"6cc8fcc7-6d7d-4303-9451-2904628a60a1"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8380981393116693`*^9, 3.838098164797565*^9}},
 CellLabel->"In[76]:=",ExpressionUUID->"20e847e6-6bb1-4aa8-913f-6b80258eca00"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ModelWeight", "[", 
    RowBox[{
    "#", ",", " ", "weightsPositiveDerangements", ",", 
     "weightsNegativeDerangements"}], "]"}], "&"}], "/@", 
  RowBox[{"AllModels", "[", "exampleDerangements", "]"}]}]], "Input",
 CellChangeTimes->{{3.838098819334339*^9, 3.838098865611024*^9}},
 CellLabel->"In[77]:=",ExpressionUUID->"f3cfa98d-c6ec-495b-848f-47d8b6faed6d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   SuperscriptBox["\[FormalF]", "2"], ",", "\[FormalF]", ",", "\[FormalF]", 
   ",", "1", ",", 
   RowBox[{"-", "\[FormalF]"}], ",", 
   RowBox[{"-", "\[FormalF]"}], ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{
  3.8380988244118567`*^9, 3.838098866079464*^9, 3.838099065123562*^9, 
   3.838102379691928*^9, 3.838102419260352*^9, 3.838103145397114*^9, 
   3.838108071234391*^9, {3.8381117447958193`*^9, 3.838111763460903*^9}, 
   3.838122557634344*^9, 3.8381226106427*^9, 3.838123441327703*^9, 
   3.83818371106369*^9, 3.8381842591669703`*^9, {3.838184374347711*^9, 
   3.838184488916671*^9}, 3.838184584470642*^9, {3.838188710462914*^9, 
   3.838188730535371*^9}, 3.838189246181641*^9, 3.838189283991869*^9, 
   3.8381918348521442`*^9, 3.8381918660902643`*^9, {3.838191930702074*^9, 
   3.8381919513924713`*^9}, 3.8381919895125647`*^9, 3.838193627267757*^9, 
   3.838193666242621*^9, 3.838196999901561*^9, 3.83819703715296*^9, 
   3.838197088067288*^9, 3.838197474598939*^9, {3.838197518613563*^9, 
   3.838197537209833*^9}, 3.838354174136012*^9, 3.8383544327231283`*^9, {
   3.838354560012918*^9, 3.838354584557035*^9}, 3.83843745449082*^9, 
   3.838694961212955*^9},
 CellLabel->"Out[77]=",ExpressionUUID->"d410b2f1-6b94-47d0-82a8-d376d50b32e6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"WeightedModels", "[", 
  RowBox[{
  "exampleDerangements", ",", " ", "weightsPositiveDerangements", ",", 
   "weightsNegativeDerangements"}], "]"}]], "Input",
 CellChangeTimes->{{3.838099720145666*^9, 3.838099736874793*^9}},
 CellLabel->"In[78]:=",ExpressionUUID->"224e29fa-1cc0-417c-ae55-cfe7ece6ec60"],

Cell[BoxData[
 SuperscriptBox["\[FormalF]", "2"]], "Output",
 CellChangeTimes->{
  3.8380997373861017`*^9, 3.838102379703783*^9, 3.838103145417046*^9, 
   3.838108071246037*^9, {3.8381117448079643`*^9, 3.838111763472926*^9}, 
   3.83812255764607*^9, 3.838122610654303*^9, 3.8381234413391933`*^9, 
   3.838183711074381*^9, 3.8381842591774178`*^9, {3.838184374372775*^9, 
   3.8381844889319897`*^9}, 3.8381845844852943`*^9, {3.83818871047857*^9, 
   3.83818873054169*^9}, 3.838189246192319*^9, 3.838189284002638*^9, 
   3.838191834861681*^9, 3.8381918661020947`*^9, {3.8381919307135572`*^9, 
   3.8381919514216337`*^9}, 3.838191989540753*^9, 3.838193627297078*^9, 
   3.838193666269936*^9, 3.838196999912821*^9, 3.838197037181302*^9, 
   3.8381970880953493`*^9, 3.838197474629553*^9, {3.838197518644169*^9, 
   3.8381975372385283`*^9}, 3.838354174160686*^9, 3.83835443272886*^9, {
   3.838354560025075*^9, 3.8383545845668783`*^9}, 3.838437454502782*^9, 
   3.8386949612274714`*^9},
 CellLabel->"Out[78]=",ExpressionUUID->"40d0a69c-304e-48ef-a4dd-8bfbe2135c4c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["r"], "Input",
 CellChangeTimes->{{3.838100389560898*^9, 3.838100391559927*^9}},
 CellLabel->"In[79]:=",ExpressionUUID->"cfabe9ee-4c7b-4e69-a489-39dd753abbcb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.838100391958374*^9, {3.83810237971979*^9, 3.838102398875473*^9}, 
   3.838103145438302*^9, 3.838108071260315*^9, {3.838111744821457*^9, 
   3.838111763486867*^9}, 3.838122557659689*^9, 3.838122610667678*^9, 
   3.8381234413517647`*^9, 3.838183711087811*^9, 3.83818425918999*^9, {
   3.838184374383481*^9, 3.838184488943109*^9}, 3.838184584496763*^9, {
   3.838188710489653*^9, 3.8381887305474033`*^9}, 3.8381892462077713`*^9, 
   3.8381892840160103`*^9, 3.838191834872188*^9, 3.8381918661164017`*^9, {
   3.838191930728826*^9, 3.838191951433544*^9}, 3.838191989551958*^9, 
   3.83819362730812*^9, 3.838193666280951*^9, 3.838196999922744*^9, 
   3.838197037193157*^9, 3.838197088108185*^9, 3.838197474642378*^9, {
   3.8381975186640787`*^9, 3.8381975372502403`*^9}, 3.838354174172443*^9, 
   3.838354432733906*^9, {3.8383545600385933`*^9, 3.8383545845797853`*^9}, 
   3.838437454517219*^9, 3.8386949612419157`*^9},
 CellLabel->"Out[79]=",ExpressionUUID->"0a91a015-cdcf-467b-844f-6cd170b943ea"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"models", " ", "=", 
   RowBox[{"AllModels", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"!", 
       RowBox[{"f", "[", 
        RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}]}], "&&", 
      RowBox[{"!", 
       RowBox[{"f", "[", 
        RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}]}]}], ",", " ", 
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}], "&&", 
      RowBox[{"f", "[", 
       RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "&&", 
      RowBox[{"f", "[", 
       RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "&&", 
      RowBox[{"s1", "[", "\[FormalA]", "]"}], "&&", 
      RowBox[{"s1", "[", "\[FormalB]", "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Column", "[", "models", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ModelWeight", "[", 
     RowBox[{
     "#", ",", "weightsPositiveDerangements", ",", 
      "weightsNegativeDerangements"}], "]"}], "&"}], "/@", "models"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{"Total", "[", "%", "]"}]}], "Input",
 CellChangeTimes->{{3.8381014747314262`*^9, 3.838101488601864*^9}, {
  3.838103162250931*^9, 3.8381031635446043`*^9}, {3.838103203951015*^9, 
  3.838103210416279*^9}, {3.838103253636713*^9, 3.838103279242836*^9}, {
  3.8381033833820667`*^9, 3.838103385469743*^9}, {3.838103507466207*^9, 
  3.838103594062615*^9}, {3.8381077696758842`*^9, 3.838107810577064*^9}, {
  3.838107888501956*^9, 3.838107899572689*^9}, {3.838107954684597*^9, 
  3.838107987624586*^9}, {3.838110687459238*^9, 3.838110688882585*^9}, {
  3.838111647399269*^9, 3.838111670682152*^9}},
 CellLabel->"In[80]:=",ExpressionUUID->"ce5bdbc9-d955-449c-8485-e54739764cf7"],

Cell[BoxData[
 RowBox[{"Column", "[", 
  RowBox[{"AllModels", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"!", 
      RowBox[{"f", "[", 
       RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}]}], "&&", 
     RowBox[{"!", 
      RowBox[{"f", "[", 
       RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}]}]}], ",", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}], "&&", 
     RowBox[{"f", "[", 
      RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "&&", 
     RowBox[{"f", "[", 
      RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "&&", 
     RowBox[{"s1", "[", "\[FormalA]", "]"}], "&&", 
     RowBox[{"s1", "[", "\[FormalB]", "]"}]}]}], "]"}], "]"}]], "Output",
 CellChangeTimes->{{3.83811166083286*^9, 3.8381116713962708`*^9}, {
   3.838111744840527*^9, 3.838111763501708*^9}, 3.838122286706458*^9, 
   3.838122557674437*^9, 3.8381226106803093`*^9, 3.838123441365127*^9, 
   3.83818371110152*^9, 3.838184259202876*^9, {3.83818437439694*^9, 
   3.838184488957222*^9}, 3.838184584510748*^9, {3.838188710503827*^9, 
   3.83818873055829*^9}, 3.838189246222843*^9, 3.838189284029916*^9, 
   3.838191834883956*^9, 3.83819186614091*^9, {3.838191930743258*^9, 
   3.838191951449164*^9}, 3.8381919895683928`*^9, 3.8381936273264627`*^9, 
   3.8381936662972107`*^9, 3.838196999943338*^9, 3.838197037206975*^9, 
   3.83819708812269*^9, 3.838197474656671*^9, {3.838197518676702*^9, 
   3.8381975372711906`*^9}, 3.8383541741875477`*^9, 3.838354432744006*^9, {
   3.838354560052655*^9, 3.838354584593141*^9}, 3.838437454533354*^9, 
   3.838694961260388*^9},
 CellLabel->"Out[81]=",ExpressionUUID->"d2c804d0-21d4-4964-9d70-d7c3b046acab"],

Cell[BoxData[
 RowBox[{"AllModels", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"GroundAtomSetWeight", "[", 
     RowBox[{
      RowBox[{"NegativeAtoms", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"f", "[", 
          RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}]}], "&&", 
        RowBox[{"!", 
         RowBox[{"f", "[", 
          RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}]}]}], "]"}], ",", 
      RowBox[{"\[LeftAssociation]", 
       RowBox[{
        RowBox[{"f", "\[Rule]", "1"}], ",", 
        RowBox[{"s1", "\[Rule]", 
         RowBox[{"-", "1"}]}], ",", 
        RowBox[{"s2", "\[Rule]", 
         RowBox[{"-", "1"}]}]}], "\[RightAssociation]"}]}], "]"}], " ", 
    RowBox[{"GroundAtomSetWeight", "[", 
     RowBox[{
      RowBox[{"PositiveAtoms", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"f", "[", 
          RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}]}], "&&", 
        RowBox[{"!", 
         RowBox[{"f", "[", 
          RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}]}]}], "]"}], ",", 
      RowBox[{"\[LeftAssociation]", 
       RowBox[{
        RowBox[{"f", "\[Rule]", "\[FormalF]"}], ",", 
        RowBox[{"s1", "\[Rule]", "1"}], ",", 
        RowBox[{"s2", "\[Rule]", "1"}]}], "\[RightAssociation]"}]}], "]"}]}], 
   ",", 
   RowBox[{
    RowBox[{"GroundAtomSetWeight", "[", 
     RowBox[{
      RowBox[{"NegativeAtoms", "[", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}], "&&", 
        RowBox[{"f", "[", 
         RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "&&", 
        RowBox[{"f", "[", 
         RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "&&", 
        RowBox[{"s1", "[", "\[FormalA]", "]"}], "&&", 
        RowBox[{"s1", "[", "\[FormalB]", "]"}]}], "]"}], ",", 
      RowBox[{"\[LeftAssociation]", 
       RowBox[{
        RowBox[{"f", "\[Rule]", "1"}], ",", 
        RowBox[{"s1", "\[Rule]", 
         RowBox[{"-", "1"}]}], ",", 
        RowBox[{"s2", "\[Rule]", 
         RowBox[{"-", "1"}]}]}], "\[RightAssociation]"}]}], "]"}], " ", 
    RowBox[{"GroundAtomSetWeight", "[", 
     RowBox[{
      RowBox[{"PositiveAtoms", "[", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}], "&&", 
        RowBox[{"f", "[", 
         RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "&&", 
        RowBox[{"f", "[", 
         RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "&&", 
        RowBox[{"s1", "[", "\[FormalA]", "]"}], "&&", 
        RowBox[{"s1", "[", "\[FormalB]", "]"}]}], "]"}], ",", 
      RowBox[{"\[LeftAssociation]", 
       RowBox[{
        RowBox[{"f", "\[Rule]", "\[FormalF]"}], ",", 
        RowBox[{"s1", "\[Rule]", "1"}], ",", 
        RowBox[{"s2", "\[Rule]", "1"}]}], "\[RightAssociation]"}]}], 
     "]"}]}]}], "]"}]], "Output",
 CellChangeTimes->{{3.83811166083286*^9, 3.8381116713962708`*^9}, {
   3.838111744840527*^9, 3.838111763501708*^9}, 3.838122286706458*^9, 
   3.838122557674437*^9, 3.8381226106803093`*^9, 3.838123441365127*^9, 
   3.83818371110152*^9, 3.838184259202876*^9, {3.83818437439694*^9, 
   3.838184488957222*^9}, 3.838184584510748*^9, {3.838188710503827*^9, 
   3.83818873055829*^9}, 3.838189246222843*^9, 3.838189284029916*^9, 
   3.838191834883956*^9, 3.83819186614091*^9, {3.838191930743258*^9, 
   3.838191951449164*^9}, 3.8381919895683928`*^9, 3.8381936273264627`*^9, 
   3.8381936662972107`*^9, 3.838196999943338*^9, 3.838197037206975*^9, 
   3.83819708812269*^9, 3.838197474656671*^9, {3.838197518676702*^9, 
   3.8381975372711906`*^9}, 3.8383541741875477`*^9, 3.838354432744006*^9, {
   3.838354560052655*^9, 3.838354584593141*^9}, 3.838437454533354*^9, 
   3.838694961267619*^9},
 CellLabel->"Out[82]=",ExpressionUUID->"e54c9b4b-aef6-4090-93fe-3c1fa3a2e30b"],

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{"AllModels", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"GroundAtomSetWeight", "[", 
      RowBox[{
       RowBox[{"NegativeAtoms", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"f", "[", 
           RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}]}], "&&", 
         RowBox[{"!", 
          RowBox[{"f", "[", 
           RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}]}]}], "]"}], ",", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{
         RowBox[{"f", "\[Rule]", "1"}], ",", 
         RowBox[{"s1", "\[Rule]", 
          RowBox[{"-", "1"}]}], ",", 
         RowBox[{"s2", "\[Rule]", 
          RowBox[{"-", "1"}]}]}], "\[RightAssociation]"}]}], "]"}], " ", 
     RowBox[{"GroundAtomSetWeight", "[", 
      RowBox[{
       RowBox[{"PositiveAtoms", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"f", "[", 
           RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}]}], "&&", 
         RowBox[{"!", 
          RowBox[{"f", "[", 
           RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}]}]}], "]"}], ",", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{
         RowBox[{"f", "\[Rule]", "\[FormalF]"}], ",", 
         RowBox[{"s1", "\[Rule]", "1"}], ",", 
         RowBox[{"s2", "\[Rule]", "1"}]}], "\[RightAssociation]"}]}], "]"}]}],
     ",", 
    RowBox[{
     RowBox[{"GroundAtomSetWeight", "[", 
      RowBox[{
       RowBox[{"NegativeAtoms", "[", 
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}], "&&", 
         RowBox[{"f", "[", 
          RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "&&", 
         RowBox[{"f", "[", 
          RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "&&", 
         RowBox[{"s1", "[", "\[FormalA]", "]"}], "&&", 
         RowBox[{"s1", "[", "\[FormalB]", "]"}]}], "]"}], ",", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{
         RowBox[{"f", "\[Rule]", "1"}], ",", 
         RowBox[{"s1", "\[Rule]", 
          RowBox[{"-", "1"}]}], ",", 
         RowBox[{"s2", "\[Rule]", 
          RowBox[{"-", "1"}]}]}], "\[RightAssociation]"}]}], "]"}], " ", 
     RowBox[{"GroundAtomSetWeight", "[", 
      RowBox[{
       RowBox[{"PositiveAtoms", "[", 
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}], "&&", 
         RowBox[{"f", "[", 
          RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "&&", 
         RowBox[{"f", "[", 
          RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "&&", 
         RowBox[{"s1", "[", "\[FormalA]", "]"}], "&&", 
         RowBox[{"s1", "[", "\[FormalB]", "]"}]}], "]"}], ",", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{
         RowBox[{"f", "\[Rule]", "\[FormalF]"}], ",", 
         RowBox[{"s1", "\[Rule]", "1"}], ",", 
         RowBox[{"s2", "\[Rule]", "1"}]}], "\[RightAssociation]"}]}], 
      "]"}]}]}], "]"}], "]"}]], "Output",
 CellChangeTimes->{{3.83811166083286*^9, 3.8381116713962708`*^9}, {
   3.838111744840527*^9, 3.838111763501708*^9}, 3.838122286706458*^9, 
   3.838122557674437*^9, 3.8381226106803093`*^9, 3.838123441365127*^9, 
   3.83818371110152*^9, 3.838184259202876*^9, {3.83818437439694*^9, 
   3.838184488957222*^9}, 3.838184584510748*^9, {3.838188710503827*^9, 
   3.83818873055829*^9}, 3.838189246222843*^9, 3.838189284029916*^9, 
   3.838191834883956*^9, 3.83819186614091*^9, {3.838191930743258*^9, 
   3.838191951449164*^9}, 3.8381919895683928`*^9, 3.8381936273264627`*^9, 
   3.8381936662972107`*^9, 3.838196999943338*^9, 3.838197037206975*^9, 
   3.83819708812269*^9, 3.838197474656671*^9, {3.838197518676702*^9, 
   3.8381975372711906`*^9}, 3.8383541741875477`*^9, 3.838354432744006*^9, {
   3.838354560052655*^9, 3.838354584593141*^9}, 3.838437454533354*^9, 
   3.838694961269423*^9},
 CellLabel->"Out[83]=",ExpressionUUID->"4a3f1f60-b07c-413e-97e2-2102e16556a9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"WeightedModels", "[", 
    RowBox[{
     RowBox[{"!", 
      RowBox[{"f", "[", 
       RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}]}], ",", " ", 
     "exampleDerangements", ",", "weightsPositiveDerangements", ",", 
     "weightsNegativeDerangements"}], "]"}], "&"}], "/@", 
  RowBox[{"AllModels", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"f", "[", 
      RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}]}], ",", 
    "exampleDerangements"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8381015121933527`*^9, 3.838101519528397*^9}, {
  3.838103028856469*^9, 3.838103059501882*^9}, {3.83810584740711*^9, 
  3.838105848642314*^9}},
 CellLabel->"In[84]:=",ExpressionUUID->"bdb3b010-a9e6-44b7-9f42-e61be1ab3b6a"],

Cell[BoxData[
 RowBox[{"AllModels", "[", 
  RowBox[{
   RowBox[{"WeightedModels", "[", 
    RowBox[{
     RowBox[{"!", 
      RowBox[{"f", "[", 
       RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"!", 
       RowBox[{"f", "[", 
        RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}]}], "&&", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Implies]", 
        RowBox[{"s1", "[", "\[FormalA]", "]"}]}], ")"}], "&&", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}], "\[Implies]", 
        RowBox[{"s2", "[", "\[FormalA]", "]"}]}], ")"}]}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"f", "\[Rule]", "\[FormalF]"}], ",", 
       RowBox[{"s1", "\[Rule]", "1"}], ",", 
       RowBox[{"s2", "\[Rule]", "1"}]}], "\[RightAssociation]"}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"f", "\[Rule]", "1"}], ",", 
       RowBox[{"s1", "\[Rule]", 
        RowBox[{"-", "1"}]}], ",", 
       RowBox[{"s2", "\[Rule]", 
        RowBox[{"-", "1"}]}]}], "\[RightAssociation]"}]}], "]"}], ",", 
   RowBox[{"WeightedModels", "[", 
    RowBox[{
     RowBox[{"!", 
      RowBox[{"f", "[", 
       RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"!", 
       RowBox[{"f", "[", 
        RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}]}], "&&", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Implies]", 
        RowBox[{"s1", "[", "\[FormalA]", "]"}]}], ")"}], "&&", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}], "\[Implies]", 
        RowBox[{"s2", "[", "\[FormalA]", "]"}]}], ")"}]}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"f", "\[Rule]", "\[FormalF]"}], ",", 
       RowBox[{"s1", "\[Rule]", "1"}], ",", 
       RowBox[{"s2", "\[Rule]", "1"}]}], "\[RightAssociation]"}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{
       RowBox[{"f", "\[Rule]", "1"}], ",", 
       RowBox[{"s1", "\[Rule]", 
        RowBox[{"-", "1"}]}], ",", 
       RowBox[{"s2", "\[Rule]", 
        RowBox[{"-", "1"}]}]}], "\[RightAssociation]"}]}], "]"}]}], 
  "]"}]], "Output",
 CellChangeTimes->{
  3.838101519879475*^9, 3.838102379768368*^9, {3.8381030264592733`*^9, 
   3.838103030878705*^9}, 3.8381031455097437`*^9, 3.83810584905332*^9, 
   3.838108071330781*^9, {3.838111744870131*^9, 3.8381117635206537`*^9}, 
   3.8381225576923447`*^9, 3.838122610698505*^9, 3.838123441383477*^9, 
   3.838183711117817*^9, 3.8381842592189093`*^9, {3.838184374413711*^9, 
   3.8381844889754543`*^9}, 3.838184584529396*^9, {3.838188710523314*^9, 
   3.838188730575732*^9}, 3.838189246241115*^9, 3.838189284046775*^9, 
   3.838191834894697*^9, 3.8381918661566877`*^9, {3.838191930761924*^9, 
   3.8381919514672956`*^9}, 3.838191989587203*^9, 3.838193627347693*^9, 
   3.838193666313686*^9, 3.83819699997117*^9, 3.8381970372266073`*^9, 
   3.8381970881429787`*^9, 3.838197474676445*^9, {3.838197518695683*^9, 
   3.838197537288479*^9}, 3.8383541742046022`*^9, 3.8383544327685633`*^9, {
   3.838354560069669*^9, 3.838354584608939*^9}, 3.838437454551372*^9, 
   3.838694961281992*^9},
 CellLabel->"Out[84]=",ExpressionUUID->"3899a56b-683d-49e7-9a4a-828c497af818"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SatisfiabilityInstances", "[", 
  RowBox[{
   RowBox[{"Equivalent", "[", 
    RowBox[{"a", ",", "b"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "b", ",", "c"}], "}"}], ",", "All"}], "]"}]], "Input",
 CellChangeTimes->{{3.838101878377994*^9, 3.838101878512289*^9}, {
  3.838101919240226*^9, 3.838101919918236*^9}},
 CellLabel->"In[85]:=",ExpressionUUID->"b3634519-e47b-4ccb-a5cc-3221112b6045"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"True", ",", "True", ",", "True"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"False", ",", "False", ",", "True"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"True", ",", "True", ",", "False"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"False", ",", "False", ",", "False"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.838101878935114*^9, 3.838101920216107*^9, 3.83810237978391*^9, 
   3.838103145529585*^9, 3.838108071344205*^9, {3.838111744884371*^9, 
   3.838111763529591*^9}, 3.8381225577053747`*^9, 3.8381226107117233`*^9, 
   3.838123441396247*^9, 3.838183711131963*^9, 3.8381842592320347`*^9, {
   3.838184374426745*^9, 3.8381844889893103`*^9}, 3.8381845845444393`*^9, {
   3.8381887105368223`*^9, 3.838188730590213*^9}, 3.838189246254918*^9, 
   3.8381892840605173`*^9, 3.8381918349047832`*^9, 3.8381918661694117`*^9, {
   3.838191930776018*^9, 3.838191951481205*^9}, 3.8381919896029797`*^9, 
   3.838193627362705*^9, 3.838193666327064*^9, 3.838196999992745*^9, 
   3.838197037239736*^9, 3.838197088157496*^9, 3.8381974746896763`*^9, {
   3.8381975187087593`*^9, 3.8381975373015747`*^9}, 3.8383541742207747`*^9, 
   3.8383544327790403`*^9, {3.8383545600969477`*^9, 3.8383545846216593`*^9}, 
   3.838437454566251*^9, 3.8386949612995462`*^9},
 CellLabel->"Out[85]=",ExpressionUUID->"c294b8a4-af8d-4926-ad5f-738852fd78eb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FOAtoms", "[", "exampleDerangements", "]"}], "/.", " ", 
   RowBox[{
    RowBox[{"f_", "[", "x_", "]"}], ":>", " ", "Nothing"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.83810204004356*^9, 3.838102043231557*^9}, {
  3.838110586135778*^9, 3.8381106315494423`*^9}},
 CellLabel->"In[86]:=",ExpressionUUID->"6b369bda-5486-4d02-a25b-e9853c306eef"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], ",", 
   RowBox[{"f", "[", 
    RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], ",", 
   RowBox[{"f", "[", 
    RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.838102043596262*^9, 3.8381023797991257`*^9, 3.83810314555127*^9, 
   3.838108071358699*^9, 3.83811063188701*^9, {3.838111744891811*^9, 
   3.8381117635424957`*^9}, 3.838122557718676*^9, 3.838122610724658*^9, 
   3.8381234414090223`*^9, 3.83818371114684*^9, 3.8381842592448397`*^9, {
   3.838184374441334*^9, 3.8381844890026407`*^9}, 3.83818458455754*^9, {
   3.838188710550292*^9, 3.838188730603786*^9}, 3.838189246270049*^9, 
   3.83818928407412*^9, 3.838191834914544*^9, 3.8381918661829233`*^9, {
   3.8381919307900763`*^9, 3.838191951495248*^9}, 3.838191989617052*^9, 
   3.8381936273788433`*^9, 3.8381936663408003`*^9, 3.838197000015875*^9, 
   3.8381970372545757`*^9, 3.8381970881720457`*^9, 3.838197474703267*^9, {
   3.8381975187222843`*^9, 3.838197537315164*^9}, 3.838354174237452*^9, 
   3.838354432791855*^9, {3.838354560178093*^9, 3.838354584634316*^9}, 
   3.838437454581828*^9, 3.838694961323451*^9},
 CellLabel->"Out[86]=",ExpressionUUID->"d50e423f-f49e-4151-8e88-c9fa2f94f2d1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"InterpretationToFormula", "/@", 
  RowBox[{"FormulaCells", "[", "exampleDerangements", "]"}]}]], "Input",
 CellChangeTimes->{{3.838102052866599*^9, 3.83810205391364*^9}, {
  3.83812183246978*^9, 3.838121839541614*^9}, {3.83812229637994*^9, 
  3.8381222976678677`*^9}, {3.8381223861374607`*^9, 3.8381223900631*^9}},
 CellLabel->"In[87]:=",ExpressionUUID->"2d0ed693-e2c3-4ca7-9bf9-1d47aa6ae4a5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"!", 
     RowBox[{"f", "[", 
      RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"s1", "[", "\[FormalA]", "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"s2", "[", "\[FormalA]", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"f", "[", 
      RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"s1", "[", "\[FormalA]", "]"}]}], "&&", 
    RowBox[{"s2", "[", "\[FormalA]", "]"}]}], ",", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"f", "[", 
      RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}]}], "&&", 
    RowBox[{"s1", "[", "\[FormalA]", "]"}], "&&", 
    RowBox[{"!", 
     RowBox[{"s2", "[", "\[FormalA]", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"f", "[", 
      RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}]}], "&&", 
    RowBox[{"s1", "[", "\[FormalA]", "]"}], "&&", 
    RowBox[{"s2", "[", "\[FormalA]", "]"}]}], ",", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "&&", 
    RowBox[{"!", 
     RowBox[{"s1", "[", "\[FormalA]", "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"s2", "[", "\[FormalA]", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "&&", 
    RowBox[{"!", 
     RowBox[{"s1", "[", "\[FormalA]", "]"}]}], "&&", 
    RowBox[{"s2", "[", "\[FormalA]", "]"}]}], ",", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "&&", 
    RowBox[{"s1", "[", "\[FormalA]", "]"}], "&&", 
    RowBox[{"!", 
     RowBox[{"s2", "[", "\[FormalA]", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "&&", 
    RowBox[{"s1", "[", "\[FormalA]", "]"}], "&&", 
    RowBox[{"s2", "[", "\[FormalA]", "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8381020542236567`*^9, 3.838102379814673*^9, 3.83810314557094*^9, 
   3.838108071373516*^9, {3.838111744918364*^9, 3.838111763556007*^9}, 
   3.838122298034914*^9, {3.838122390518427*^9, 3.838122400774682*^9}, 
   3.838122557731662*^9, 3.838122610738008*^9, 3.83812344142423*^9, 
   3.838183711161027*^9, 3.838184259259542*^9, {3.838184374455287*^9, 
   3.838184489015424*^9}, 3.8381845845713377`*^9, {3.838188710564431*^9, 
   3.838188730617794*^9}, 3.83818924628371*^9, 3.8381892840890503`*^9, 
   3.838191834931197*^9, 3.838191866196684*^9, {3.838191930813815*^9, 
   3.838191951510571*^9}, 3.838191989631919*^9, 3.838193627394743*^9, 
   3.838193666354618*^9, 3.838197000040045*^9, 3.838197037268248*^9, 
   3.838197088186824*^9, 3.838197474716984*^9, {3.838197518736289*^9, 
   3.838197537328306*^9}, 3.838354174254551*^9, 3.838354432804817*^9, {
   3.8383545602229652`*^9, 3.8383545846471863`*^9}, 3.838437454599329*^9, 
   3.838694961341226*^9},
 CellLabel->"Out[87]=",ExpressionUUID->"b026e0d6-856c-491d-857c-dba433e588d7"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MakeLiteral", "[", 
   RowBox[{"a_", "->", "True"}], "]"}], ":=", " ", 
  "a"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MakeLiteral", "[", 
   RowBox[{"b_", "->", "False"}], "]"}], ":=", " ", 
  RowBox[{"\[Not]", "b"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"InterpretationToFormula", "[", "f_List", "]"}], ":=", " ", 
  RowBox[{"And", "@@", 
   RowBox[{"(", 
    RowBox[{"MakeLiteral", " ", "/@", " ", "f"}], ")"}]}]}]}], "Input",
 CellChangeTimes->{{3.838122303245535*^9, 3.8381223974230633`*^9}},
 CellLabel->"In[88]:=",ExpressionUUID->"1f0a8a2f-d088-4503-953c-cc46737c56cb"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8381223817696047`*^9, 3.838122382559389*^9}},
 CellLabel->"In[91]:=",ExpressionUUID->"d1220f35-09f5-4a9c-b843-3f1b587ba987"],

Cell[CellGroupData[{

Cell[BoxData[{"exampleDerangements", "\[IndentingNewLine]", 
 RowBox[{"FormulaCells", "[", "exampleDerangements", "]"}]}], "Input",
 CellChangeTimes->{{3.838191912315362*^9, 3.838191915834586*^9}, {
  3.838194960022892*^9, 3.83819504467213*^9}, {3.838195351619562*^9, 
  3.838195355592453*^9}},
 CellLabel->"In[92]:=",ExpressionUUID->"1a474330-a1c8-4001-9b86-ae6794fdcf57"],

Cell[BoxData[
 RowBox[{
  RowBox[{"!", 
   RowBox[{"f", "[", 
    RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}]}], "&&", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Implies]", 
    RowBox[{"s1", "[", "\[FormalA]", "]"}]}], ")"}], "&&", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}], "\[Implies]", 
    RowBox[{"s2", "[", "\[FormalA]", "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.838191916274329*^9, 3.838191951532773*^9}, 
   3.8381919896580772`*^9, 3.838193627421913*^9, 3.838193666376979*^9, {
   3.838194962291594*^9, 3.83819499396003*^9}, {3.838195045120281*^9, 
   3.83819505277629*^9}, 3.838195356121076*^9, 3.83819700007274*^9, 
   3.8381970373030376`*^9, 3.83819708821224*^9, 3.838197474739004*^9, {
   3.838197518758172*^9, 3.838197537350152*^9}, 3.838354174282999*^9, 
   3.83835443282549*^9, {3.838354560520364*^9, 3.838354584667781*^9}, 
   3.83843745463789*^9, 3.838694961372216*^9},
 CellLabel->"Out[92]=",ExpressionUUID->"3287a451-646b-4d71-9053-a2d261334a72"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", "False"}],
      ",", 
     RowBox[{
      RowBox[{"s1", "[", "\[FormalA]", "]"}], "\[Rule]", "False"}], ",", 
     RowBox[{
      RowBox[{"s2", "[", "\[FormalA]", "]"}], "\[Rule]", "False"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", "False"}],
      ",", 
     RowBox[{
      RowBox[{"s1", "[", "\[FormalA]", "]"}], "\[Rule]", "False"}], ",", 
     RowBox[{
      RowBox[{"s2", "[", "\[FormalA]", "]"}], "\[Rule]", "True"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", "False"}],
      ",", 
     RowBox[{
      RowBox[{"s1", "[", "\[FormalA]", "]"}], "\[Rule]", "True"}], ",", 
     RowBox[{
      RowBox[{"s2", "[", "\[FormalA]", "]"}], "\[Rule]", "False"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", "False"}],
      ",", 
     RowBox[{
      RowBox[{"s1", "[", "\[FormalA]", "]"}], "\[Rule]", "True"}], ",", 
     RowBox[{
      RowBox[{"s2", "[", "\[FormalA]", "]"}], "\[Rule]", "True"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", "True"}], 
     ",", 
     RowBox[{
      RowBox[{"s1", "[", "\[FormalA]", "]"}], "\[Rule]", "False"}], ",", 
     RowBox[{
      RowBox[{"s2", "[", "\[FormalA]", "]"}], "\[Rule]", "False"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", "True"}], 
     ",", 
     RowBox[{
      RowBox[{"s1", "[", "\[FormalA]", "]"}], "\[Rule]", "False"}], ",", 
     RowBox[{
      RowBox[{"s2", "[", "\[FormalA]", "]"}], "\[Rule]", "True"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", "True"}], 
     ",", 
     RowBox[{
      RowBox[{"s1", "[", "\[FormalA]", "]"}], "\[Rule]", "True"}], ",", 
     RowBox[{
      RowBox[{"s2", "[", "\[FormalA]", "]"}], "\[Rule]", "False"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", "True"}], 
     ",", 
     RowBox[{
      RowBox[{"s1", "[", "\[FormalA]", "]"}], "\[Rule]", "True"}], ",", 
     RowBox[{
      RowBox[{"s2", "[", "\[FormalA]", "]"}], "\[Rule]", "True"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.838191916274329*^9, 3.838191951532773*^9}, 
   3.8381919896580772`*^9, 3.838193627421913*^9, 3.838193666376979*^9, {
   3.838194962291594*^9, 3.83819499396003*^9}, {3.838195045120281*^9, 
   3.83819505277629*^9}, 3.838195356121076*^9, 3.83819700007274*^9, 
   3.8381970373030376`*^9, 3.83819708821224*^9, 3.838197474739004*^9, {
   3.838197518758172*^9, 3.838197537350152*^9}, 3.838354174282999*^9, 
   3.83835443282549*^9, {3.838354560520364*^9, 3.838354584667781*^9}, 
   3.83843745463789*^9, 3.83869496137365*^9},
 CellLabel->"Out[93]=",ExpressionUUID->"e322337e-3464-40fe-88cd-d59cf03dc682"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"FormulaSymmetric", "[", "exampleDerangements", "]"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{"%", "/.", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", "False"}], 
    ",", 
    RowBox[{
     RowBox[{"s1", "[", "\[FormalA]", "]"}], "\[Rule]", "False"}], ",", 
    RowBox[{
     RowBox[{"s2", "[", "\[FormalA]", "]"}], "\[Rule]", "False"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"%", "/.", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"\[FormalB]", ",", "\[FormalB]"}], "]"}], "\[Rule]", "False"}], 
    ",", 
    RowBox[{
     RowBox[{"s1", "[", "\[FormalB]", "]"}], "\[Rule]", "False"}], ",", 
    RowBox[{
     RowBox[{"s2", "[", "\[FormalB]", "]"}], "\[Rule]", "True"}]}], 
   "}"}]}]}], "Input",
 CellChangeTimes->{{3.838195451924683*^9, 3.838195460531879*^9}, {
  3.838195626538907*^9, 3.838195693256258*^9}, {3.838195778732409*^9, 
  3.838195779627398*^9}},
 CellLabel->"In[94]:=",ExpressionUUID->"60bf9e89-b947-4f6d-a953-c307f921098a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"!", 
   RowBox[{"f", "[", 
    RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}]}], "&&", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Implies]", 
    RowBox[{"s1", "[", "\[FormalA]", "]"}]}], ")"}], "&&", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}], "\[Implies]", 
    RowBox[{"s2", "[", "\[FormalA]", "]"}]}], ")"}], "&&", 
  RowBox[{"!", 
   RowBox[{"f", "[", 
    RowBox[{"\[FormalB]", ",", "\[FormalB]"}], "]"}]}], "&&", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}], "\[Implies]", 
    RowBox[{"s1", "[", "\[FormalB]", "]"}]}], ")"}], "&&", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Implies]", 
    RowBox[{"s2", "[", "\[FormalB]", "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.83819563367632*^9, 3.83819565808823*^9}, 
   3.8381956948662577`*^9, 3.838195779995111*^9, 3.838197000096209*^9, 
   3.838197037318432*^9, 3.838197088229396*^9, 3.838197474762742*^9, {
   3.8381975187743177`*^9, 3.838197537365287*^9}, 3.838354174300398*^9, 
   3.8383544328374853`*^9, {3.838354560568809*^9, 3.8383545846809387`*^9}, 
   3.8384374546522007`*^9, 3.838694961386964*^9},
 CellLabel->"Out[94]=",ExpressionUUID->"76757210-7118-4694-98ad-8c3a92d64cdd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"!", 
   RowBox[{"f", "[", 
    RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}]}], "&&", 
  RowBox[{"!", 
   RowBox[{"f", "[", 
    RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}]}], "&&", 
  RowBox[{"!", 
   RowBox[{"f", "[", 
    RowBox[{"\[FormalB]", ",", "\[FormalB]"}], "]"}]}], "&&", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}], "\[Implies]", 
    RowBox[{"s1", "[", "\[FormalB]", "]"}]}], ")"}], "&&", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Implies]", 
    RowBox[{"s2", "[", "\[FormalB]", "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.83819563367632*^9, 3.83819565808823*^9}, 
   3.8381956948662577`*^9, 3.838195779995111*^9, 3.838197000096209*^9, 
   3.838197037318432*^9, 3.838197088229396*^9, 3.838197474762742*^9, {
   3.8381975187743177`*^9, 3.838197537365287*^9}, 3.838354174300398*^9, 
   3.8383544328374853`*^9, {3.838354560568809*^9, 3.8383545846809387`*^9}, 
   3.8384374546522007`*^9, 3.838694961389388*^9},
 CellLabel->"Out[95]=",ExpressionUUID->"911b40e3-167e-4912-b6b8-1e420a4513dd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"!", 
   RowBox[{"f", "[", 
    RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}]}], "&&", 
  RowBox[{"!", 
   RowBox[{"f", "[", 
    RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}]}], "&&", 
  RowBox[{"!", 
   RowBox[{"f", "[", 
    RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.83819563367632*^9, 3.83819565808823*^9}, 
   3.8381956948662577`*^9, 3.838195779995111*^9, 3.838197000096209*^9, 
   3.838197037318432*^9, 3.838197088229396*^9, 3.838197474762742*^9, {
   3.8381975187743177`*^9, 3.838197537365287*^9}, 3.838354174300398*^9, 
   3.8383544328374853`*^9, {3.838354560568809*^9, 3.8383545846809387`*^9}, 
   3.8384374546522007`*^9, 3.838694961390781*^9},
 CellLabel->"Out[96]=",ExpressionUUID->"9bc9e09e-70fc-4e88-a284-e11ddd020203"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"WeightedModels", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"!", 
     RowBox[{"f", "[", 
      RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"f", "[", 
      RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}]}], "&&", 
    RowBox[{"!", 
     RowBox[{"f", "[", 
      RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}]}]}], ",", " ", 
   "weightsPositiveDerangements", ",", " ", "weightsNegativeDerangements"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8381958179167843`*^9, 3.838195842879238*^9}},
 CellLabel->"In[97]:=",ExpressionUUID->"c9e94789-58ab-4020-8cd1-99cddfda4288"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.8381958253312893`*^9, 3.838195843226307*^9}, 
   3.8381970001239033`*^9, 3.838197037352751*^9, 3.838197088250525*^9, 
   3.838197474798764*^9, {3.8381975188116407`*^9, 3.8381975374037857`*^9}, 
   3.838354174331608*^9, 3.838354432852985*^9, {3.838354560584797*^9, 
   3.838354584697795*^9}, 3.838437454670562*^9, 3.838694961395399*^9},
 CellLabel->"Out[97]=",ExpressionUUID->"9d156d21-52ee-47e5-82e0-f448651b13ef"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["weightsNegativeDerangements"], "Input",
 CellChangeTimes->{{3.83819589320548*^9, 3.838195904220837*^9}, {
  3.8381974322196827`*^9, 3.838197432958095*^9}},
 CellLabel->"In[98]:=",ExpressionUUID->"2ed9fe64-7950-4a83-8cad-686f85ff7185"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"f", "\[Rule]", "1"}], ",", 
   RowBox[{"s1", "\[Rule]", 
    RowBox[{"-", "1"}]}], ",", 
   RowBox[{"s2", "\[Rule]", 
    RowBox[{"-", "1"}]}]}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{
  3.838195904935349*^9, 3.838197000148843*^9, 3.838197037364832*^9, 
   3.838197088259692*^9, 3.838197433381557*^9, 3.838197474811345*^9, {
   3.8381975188238564`*^9, 3.838197537416404*^9}, 3.838354174342019*^9, 
   3.838354432860107*^9, {3.838354560600123*^9, 3.838354584710711*^9}, 
   3.838437454685955*^9, 3.838694961412366*^9},
 CellLabel->"Out[98]=",ExpressionUUID->"f2a47319-b434-4a7d-b1fe-1a376aced03c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"WFOMC1", "[", 
     RowBox[{
      RowBox[{"!", 
       RowBox[{"e", "[", 
        RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}]}], ",", "n", ",", 
      RowBox[{"<|", 
       RowBox[{"e", "->", "1"}], "|>"}], ",", 
      RowBox[{"<|", 
       RowBox[{"e", "->", "1"}], "|>"}]}], "]"}], ",", "\[IndentingNewLine]", 
    " ", 
    RowBox[{"{", 
     RowBox[{"n", ",", " ", "0", ",", " ", "5"}], "}"}]}], "]"}], "//", 
  "Column"}]], "Input",
 CellChangeTimes->{{3.838197363020336*^9, 3.8381974473389683`*^9}, {
   3.838197483698296*^9, 3.838197483886821*^9}, 3.8381976502064867`*^9, {
   3.838198552616817*^9, 3.838198561584305*^9}},
 CellLabel->"In[99]:=",ExpressionUUID->"17930ea2-028e-494d-bfea-b7791d3d8e08"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"{", 
      RowBox[{"{", "1", "}"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0"}], "}"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0"}], "}"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}],
       "}"}]}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Output",
 CellChangeTimes->{{3.8381974483541183`*^9, 3.838197484856846*^9}, {
   3.838197518838541*^9, 3.838197537432558*^9}, 3.8381985621263323`*^9, 
   3.838354174354722*^9, 3.838354432902199*^9, {3.838354560617818*^9, 
   3.83835458472367*^9}, 3.838437454702488*^9, 3.838694961425359*^9},
 CellLabel->"Out[99]=",ExpressionUUID->"2092513d-d6a3-4aec-983a-f1b3d9139f58"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"2", "^", 
    RowBox[{"(", 
     RowBox[{"4", "*", "n"}], ")"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", "0", ",", "10"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8381975472225933`*^9, 3.8381976075678873`*^9}},
 CellLabel->
  "In[100]:=",ExpressionUUID->"c5a243dc-b7a4-4e0e-a1fc-84222ec518b9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1", ",", "16", ",", "256", ",", "4096", ",", "65536", ",", "1048576", ",", 
   "16777216", ",", "268435456", ",", "4294967296", ",", "68719476736", ",", 
   "1099511627776"}], "}"}]], "Output",
 CellChangeTimes->{{3.838197565494857*^9, 3.838197608006716*^9}, 
   3.8383541743675337`*^9, 3.838354432912572*^9, {3.8383545606244392`*^9, 
   3.83835458473647*^9}, 3.838437454718914*^9, 3.838694961439437*^9},
 CellLabel->
  "Out[100]=",ExpressionUUID->"f2c2fd5e-d122-4fcb-a8e9-0db211c2d006"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"RTerms", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"!", 
     RowBox[{"e", "[", 
      RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}]}], "&&", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"e", "[", 
       RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Implies]", 
      RowBox[{"e", "[", 
       RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}]}], ")"}]}], ",", 
   RowBox[{"<|", 
    RowBox[{"e", "->", "1"}], "|>"}], ",", 
   RowBox[{"<|", 
    RowBox[{"e", "->", "1"}], "|>"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"WTerms", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"!", 
     RowBox[{"e", "[", 
      RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}]}], "&&", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"e", "[", 
       RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Implies]", 
      RowBox[{"e", "[", 
       RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}]}], ")"}]}], ",", 
   RowBox[{"<|", 
    RowBox[{"e", "->", "1"}], "|>"}], ",", 
   RowBox[{"<|", 
    RowBox[{"e", "->", "1"}], "|>"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"STerms", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"!", 
     RowBox[{"e", "[", 
      RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}]}], "&&", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"e", "[", 
       RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Implies]", 
      RowBox[{"e", "[", 
       RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}]}], ")"}]}], ",", 
   RowBox[{"<|", 
    RowBox[{"e", "->", "1"}], "|>"}], ",", 
   RowBox[{"<|", 
    RowBox[{"e", "->", "1"}], "|>"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.838197642175172*^9, 3.8381976536292953`*^9}, {
  3.8381985391286783`*^9, 3.8381985413125467`*^9}, {3.8381985896805487`*^9, 
  3.8381987241611032`*^9}},
 CellLabel->
  "In[101]:=",ExpressionUUID->"29b8e3bd-e545-4974-860b-25d5b65b33b4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.838198593171464*^9, {3.8381986374386997`*^9, 3.838198652104289*^9}, {
   3.8381987061016903`*^9, 3.838198724568715*^9}, 3.8383541743806753`*^9, 
   3.838354432936961*^9, {3.8383545606405897`*^9, 3.838354584750009*^9}, 
   3.8384374547345533`*^9, 3.8386949614600554`*^9},
 CellLabel->
  "Out[101]=",ExpressionUUID->"38496940-6848-41ce-99da-3f84c6c55564"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.838198593171464*^9, {3.8381986374386997`*^9, 3.838198652104289*^9}, {
   3.8381987061016903`*^9, 3.838198724568715*^9}, 3.8383541743806753`*^9, 
   3.838354432936961*^9, {3.8383545606405897`*^9, 3.838354584750009*^9}, 
   3.8384374547345533`*^9, 3.838694961466344*^9},
 CellLabel->
  "Out[102]=",ExpressionUUID->"e0ca9a64-0e5e-462b-a4d8-8e41785a423c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.838198593171464*^9, {3.8381986374386997`*^9, 3.838198652104289*^9}, {
   3.8381987061016903`*^9, 3.838198724568715*^9}, 3.8383541743806753`*^9, 
   3.838354432936961*^9, {3.8383545606405897`*^9, 3.838354584750009*^9}, 
   3.8384374547345533`*^9, 3.838694961467689*^9},
 CellLabel->
  "Out[103]=",ExpressionUUID->"4a9f3e97-63b0-4733-a273-787b06989ccd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FormulaCells", "[", 
  RowBox[{
   RowBox[{"!", 
    RowBox[{"e", "[", 
     RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}]}], "&&", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"e", "[", 
      RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Implies]", 
     RowBox[{"e", "[", 
      RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}]}], ")"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.838198792007969*^9, 3.838198795132205*^9}},
 CellLabel->
  "In[104]:=",ExpressionUUID->"3f40eb03-0e81-4c03-99e3-036ab41fa7f4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"e", "[", 
      RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", "False"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"e", "[", 
      RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", "True"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.838198795577814*^9, 3.838354174395238*^9, 3.838354432971702*^9, {
   3.8383545606577673`*^9, 3.838354584765287*^9}, 3.838437454750948*^9, 
   3.8386949614804487`*^9},
 CellLabel->
  "Out[104]=",ExpressionUUID->"b275ac87-7361-465e-b674-cc8e929acb9c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"PredicateSymbols", "[", "exampleDerangements", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"FOAtoms", "[", "exampleDerangements", "]"}]}], "Input",
 CellChangeTimes->{{3.838365601922574*^9, 3.8383656159414673`*^9}, {
  3.838437540486032*^9, 3.838437552087492*^9}},
 CellLabel->
  "In[105]:=",ExpressionUUID->"14471c0f-42c7-42bb-9027-b2e56aeadd76"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"f", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"s1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"s2", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.838365616521994*^9, 3.8384374547656612`*^9, 
  3.838437552489973*^9, 3.838694961498447*^9},
 CellLabel->
  "Out[105]=",ExpressionUUID->"2b358d51-b6ac-4b8f-a453-6e1e9fcb0456"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], ",", 
   RowBox[{"f", "[", 
    RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], ",", 
   RowBox[{"f", "[", 
    RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}], ",", 
   RowBox[{"s1", "[", "\[FormalA]", "]"}], ",", 
   RowBox[{"s2", "[", "\[FormalA]", "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.838365616521994*^9, 3.8384374547656612`*^9, 
  3.838437552489973*^9, 3.8386949615012302`*^9},
 CellLabel->
  "Out[106]=",ExpressionUUID->"d1e0523b-f873-474a-a145-6bad919e1702"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"formula", " ", "=", " ", 
  RowBox[{
   RowBox[{"\[Not]", 
    RowBox[{"e", "[", 
     RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}]}], " ", "\[And]", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"e", "[", 
      RowBox[{"\[FormalA]", ",", " ", "\[FormalB]"}], "]"}], "\[Implies]", 
     RowBox[{"e", "[", 
      RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"n", "=", "3"}], "\[IndentingNewLine]", 
 RowBox[{"m", " ", "=", "  ", 
  RowBox[{"2", "^", 
   RowBox[{"Length", "[", 
    RowBox[{"PredicateSymbols", "[", "formula", "]"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"OrderedPartitions", "[", 
  RowBox[{"n", ",", "m"}], "]"}]}], "Input",
 CellChangeTimes->{{3.838437459449757*^9, 3.8384375182679987`*^9}, {
  3.838437561774248*^9, 3.83843758530927*^9}, {3.838442833387088*^9, 
  3.838442903533723*^9}},
 CellLabel->
  "In[107]:=",ExpressionUUID->"61becec3-e278-4e87-9881-b1494b3793a4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"!", 
   RowBox[{"e", "[", 
    RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}]}], "&&", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"e", "[", 
     RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Implies]", 
    RowBox[{"e", "[", 
     RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.838437586466517*^9, 3.838442904708034*^9, 
  3.838694961513591*^9},
 CellLabel->
  "Out[107]=",ExpressionUUID->"54d35d15-740e-41a2-8ed9-cb8f36fc45b0"],

Cell[BoxData["3"], "Output",
 CellChangeTimes->{3.838437586466517*^9, 3.838442904708034*^9, 
  3.8386949615164223`*^9},
 CellLabel->
  "Out[108]=",ExpressionUUID->"8e43cd1f-2046-41fb-bc18-1809c846e8b2"],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{3.838437586466517*^9, 3.838442904708034*^9, 
  3.838694961517749*^9},
 CellLabel->
  "Out[109]=",ExpressionUUID->"15cea3f4-e088-43ac-8b69-ec200b38472a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"3", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.838437586466517*^9, 3.838442904708034*^9, 
  3.838694961518807*^9},
 CellLabel->
  "Out[110]=",ExpressionUUID->"3c2d3d52-72bb-49fc-89e4-daec31d16e6b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"WFOMC1", "[", 
    RowBox[{"formula", ",", "i", ",", " ", 
     RowBox[{"<|", 
      RowBox[{"e", "->", "1"}], "|>"}], ",", 
     RowBox[{"<|", 
      RowBox[{"e", "->", "1"}], "|>"}]}], "]"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"i", ",", "0", ",", "5"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.838445701171155*^9, 3.838445740135502*^9}, {
  3.838694971167336*^9, 3.8386949814545307`*^9}},
 CellLabel->
  "In[117]:=",ExpressionUUID->"4bfaff06-f3e3-4d17-bc46-f5121fdd4669"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "1", ",", "2", ",", "8", ",", "64", ",", "1024"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.838445727512501*^9, 3.838445740529455*^9}, {
   3.838694961529904*^9, 3.838694981886231*^9}, 3.838695022248148*^9},
 CellLabel->
  "Out[117]=",ExpressionUUID->"f9af6a4d-1feb-4f39-aaf6-b421465f27e7"]
}, Open  ]]
},
WindowSize->{912.4752475247525, 492.59405940594064`},
WindowMargins->{{1368.7128712871288`, -912.4752475247526}, \
{256.6336633663367, 20.673267326732674`}},
DockedCells->{},
Magnification:>0.8 Inherited,
FrontEndVersion->"12.3 for Linux x86 (64-bit) (June 19, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"3f7ebace-b87e-4310-9597-9cae25c330a8"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 31465, 722, 2082, "Input",ExpressionUUID->"bd4dac13-24d5-43d7-ae76-3f67079096f2"],
Cell[CellGroupData[{
Cell[32048, 746, 3314, 70, 145, "Input",ExpressionUUID->"622b1969-fc58-4ae9-8f5e-e2c8bd36032e"],
Cell[35365, 818, 2950, 50, 28, "Output",ExpressionUUID->"5de8ae20-78f8-4a84-a373-dddaf7ab3e12"],
Cell[38318, 870, 2677, 41, 28, "Output",ExpressionUUID->"a56ca005-481d-474e-8354-a4d58a4c1810"],
Cell[40998, 913, 2710, 43, 28, "Output",ExpressionUUID->"1d4e6355-b00a-4c38-b0eb-e5efd2ebf70e"],
Cell[43711, 958, 2597, 40, 26, "Output",ExpressionUUID->"18c7cb1d-252c-4472-9d1c-8db620173dd7"],
Cell[46311, 1000, 2597, 40, 26, "Output",ExpressionUUID->"145df478-7298-4518-95c4-949ddf3ca98f"],
Cell[48911, 1042, 3298, 58, 135, "Output",ExpressionUUID->"95a9da60-9e3c-493d-8b71-3d698796d460"],
Cell[52212, 1102, 2693, 43, 26, "Output",ExpressionUUID->"453c0cf5-a7f8-45f7-aa3b-d4a6d04274c7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[54942, 1150, 573, 11, 23, "Input",ExpressionUUID->"a1dbc901-f48d-419c-b733-12c229e599cf"],
Cell[55518, 1163, 2282, 32, 26, "Output",ExpressionUUID->"3010cc90-f572-49ac-97d5-7717194dc8c7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[57837, 1200, 5002, 106, 421, "Input",ExpressionUUID->"cb5ccc7e-7f44-46d8-b840-19729f63b518"],
Cell[62842, 1308, 23180, 417, 747, "Output",ExpressionUUID->"cb918192-4799-470b-b6c0-72b96bdcc384"]
}, Open  ]],
Cell[86037, 1728, 5663, 133, 443, "Input",ExpressionUUID->"de9d90ff-36d4-4acd-a124-54bc81661d37"],
Cell[CellGroupData[{
Cell[91725, 1865, 1040, 21, 60, "Input",ExpressionUUID->"3967da30-0426-4e51-8fed-f7c482dc836e"],
Cell[92768, 1888, 5081, 117, 127, "Output",ExpressionUUID->"789b0e37-5796-48b9-9794-0fa012613fef"]
}, Open  ]],
Cell[CellGroupData[{
Cell[97886, 2010, 380, 8, 25, "Input",ExpressionUUID->"1bf93d6f-5376-48d2-b66b-57fcc9112f94"],
Cell[98269, 2020, 917, 15, 26, "Output",ExpressionUUID->"ebd7313b-e156-4c1d-8772-b4bc4df759cd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[99223, 2040, 635, 15, 60, "Input",ExpressionUUID->"76a0a37c-2633-427e-bed4-0617b95548f2"],
Cell[99861, 2057, 16031, 230, 491, "Output",ExpressionUUID->"6e915be8-6732-4a3d-b5e8-7aa16c7bc9d1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[115929, 2292, 1089, 28, 58, "Input",ExpressionUUID->"f05d3a32-c296-4536-aa67-f328bff48d86"],
Cell[117021, 2322, 1536, 29, 28, "Output",ExpressionUUID->"60e5e2d0-246d-451d-9798-f09a9d193571"],
Cell[118560, 2353, 3876, 105, 46, "Output",ExpressionUUID->"f4daff74-b501-4ade-9c9c-82d8ebcda437"],
Cell[122439, 2460, 1376, 25, 28, "Output",ExpressionUUID->"098caec7-20b4-438d-950e-06f9d12b4dc4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[123852, 2490, 597, 15, 25, "Input",ExpressionUUID->"36013548-77da-4387-928a-f58dc552d2e1"],
Cell[124452, 2507, 1942, 42, 28, "Output",ExpressionUUID->"6cc8fcc7-6d7d-4303-9451-2904628a60a1"]
}, Open  ]],
Cell[126409, 2552, 173, 2, 23, "Input",ExpressionUUID->"20e847e6-6bb1-4aa8-913f-6b80258eca00"],
Cell[CellGroupData[{
Cell[126607, 2558, 409, 9, 25, "Input",ExpressionUUID->"f3cfa98d-c6ec-495b-848f-47d8b6faed6d"],
Cell[127019, 2569, 1350, 24, 28, "Output",ExpressionUUID->"d410b2f1-6b94-47d0-82a8-d376d50b32e6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[128406, 2598, 327, 6, 25, "Input",ExpressionUUID->"224e29fa-1cc0-417c-ae55-cfe7ece6ec60"],
Cell[128736, 2606, 1058, 16, 28, "Output",ExpressionUUID->"40d0a69c-304e-48ef-a4dd-8bfbe2135c4c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[129831, 2627, 172, 2, 23, "Input",ExpressionUUID->"cfabe9ee-4c7b-4e69-a489-39dd753abbcb"],
Cell[130006, 2631, 2110, 49, 26, "Output",ExpressionUUID->"0a91a015-cdcf-467b-844f-6cd170b943ea"]
}, Open  ]],
Cell[CellGroupData[{
Cell[132153, 2685, 1753, 40, 75, "Input",ExpressionUUID->"ce5bdbc9-d955-449c-8485-e54739764cf7"],
Cell[133909, 2727, 1674, 33, 28, "Output",ExpressionUUID->"d2c804d0-21d4-4964-9d70-d7c3b046acab"],
Cell[135586, 2762, 3805, 88, 46, "Output",ExpressionUUID->"e54c9b4b-aef6-4090-93fe-3c1fa3a2e30b"],
Cell[139394, 2852, 3910, 89, 46, "Output",ExpressionUUID->"4a3f1f60-b07c-413e-97e2-2102e16556a9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[143341, 2946, 764, 19, 25, "Input",ExpressionUUID->"bdb3b010-a9e6-44b7-9f42-e61be1ab3b6a"],
Cell[144108, 2967, 3493, 81, 46, "Output",ExpressionUUID->"3899a56b-683d-49e7-9a4a-828c497af818"]
}, Open  ]],
Cell[CellGroupData[{
Cell[147638, 3053, 427, 9, 25, "Input",ExpressionUUID->"b3634519-e47b-4ccb-a5cc-3221112b6045"],
Cell[148068, 3064, 1404, 25, 26, "Output",ExpressionUUID->"c294b8a4-af8d-4926-ad5f-738852fd78eb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[149509, 3094, 410, 9, 40, "Input",ExpressionUUID->"6b369bda-5486-4d02-a25b-e9853c306eef"],
Cell[149922, 3105, 1316, 23, 28, "Output",ExpressionUUID->"d50e423f-f49e-4151-8e88-c9fa2f94f2d1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[151275, 3133, 417, 6, 24, "Input",ExpressionUUID->"2d0ed693-e2c3-4ca7-9bf9-1d47aa6ae4a5"],
Cell[151695, 3141, 2964, 70, 28, "Output",ExpressionUUID->"b026e0d6-856c-491d-857c-dba433e588d7"]
}, Open  ]],
Cell[154674, 3214, 628, 15, 58, "Input",ExpressionUUID->"1f0a8a2f-d088-4503-953c-cc46737c56cb"],
Cell[155305, 3231, 173, 2, 23, "Input",ExpressionUUID->"d1220f35-09f5-4a9c-b843-3f1b587ba987"],
Cell[CellGroupData[{
Cell[155503, 3237, 373, 5, 40, "Input",ExpressionUUID->"1a474330-a1c8-4001-9b86-ae6794fdcf57"],
Cell[155879, 3244, 1111, 23, 28, "Output",ExpressionUUID->"3287a451-646b-4d71-9053-a2d261334a72"],
Cell[156993, 3269, 3450, 99, 46, "Output",ExpressionUUID->"e322337e-3464-40fe-88cd-d59cf03dc682"]
}, Open  ]],
Cell[CellGroupData[{
Cell[160480, 3373, 1122, 31, 59, "Input",ExpressionUUID->"60bf9e89-b947-4f6d-a953-c307f921098a"],
Cell[161605, 3406, 1440, 34, 28, "Output",ExpressionUUID->"76757210-7118-4694-98ad-8c3a92d64cdd"],
Cell[163048, 3442, 1179, 27, 28, "Output",ExpressionUUID->"911b40e3-167e-4912-b6b8-1e420a4513dd"],
Cell[164230, 3471, 817, 17, 28, "Output",ExpressionUUID->"9bc9e09e-70fc-4e88-a284-e11ddd020203"]
}, Open  ]],
Cell[CellGroupData[{
Cell[165084, 3493, 640, 16, 25, "Input",ExpressionUUID->"c9e94789-58ab-4020-8cd1-99cddfda4288"],
Cell[165727, 3511, 465, 6, 26, "Output",ExpressionUUID->"9d156d21-52ee-47e5-82e0-f448651b13ef"]
}, Open  ]],
Cell[CellGroupData[{
Cell[166229, 3522, 248, 3, 24, "Input",ExpressionUUID->"2ed9fe64-7950-4a83-8cad-686f85ff7185"],
Cell[166480, 3527, 682, 14, 28, "Output",ExpressionUUID->"f2a47319-b434-4a7d-b1fe-1a376aced03c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[167199, 3546, 811, 20, 60, "Input",ExpressionUUID->"17930ea2-028e-494d-bfea-b7791d3d8e08"],
Cell[168013, 3568, 1206, 35, 96, "Output",ExpressionUUID->"2092513d-d6a3-4aec-983a-f1b3d9139f58"]
}, Open  ]],
Cell[CellGroupData[{
Cell[169256, 3608, 369, 10, 23, "Input",ExpressionUUID->"c5a243dc-b7a4-4e0e-a1fc-84222ec518b9"],
Cell[169628, 3620, 530, 10, 26, "Output",ExpressionUUID->"f2c2fd5e-d122-4fcb-a8e9-0db211c2d006"]
}, Open  ]],
Cell[CellGroupData[{
Cell[170195, 3635, 1860, 53, 60, "Input",ExpressionUUID->"29b8e3bd-e545-4974-860b-25d5b65b33b4"],
Cell[172058, 3690, 549, 13, 26, "Output",ExpressionUUID->"38496940-6848-41ce-99da-3f84c6c55564"],
Cell[172610, 3705, 449, 9, 26, "Output",ExpressionUUID->"e0ca9a64-0e5e-462b-a4d8-8e41785a423c"],
Cell[173062, 3716, 449, 9, 26, "Output",ExpressionUUID->"4a9f3e97-63b0-4733-a273-787b06989ccd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[173548, 3730, 544, 15, 25, "Input",ExpressionUUID->"3f40eb03-0e81-4c03-99e3-036ab41fa7f4"],
Cell[174095, 3747, 626, 18, 28, "Output",ExpressionUUID->"b275ac87-7361-465e-b674-cc8e929acb9c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[174758, 3770, 371, 7, 40, "Input",ExpressionUUID->"14471c0f-42c7-42bb-9027-b2e56aeadd76"],
Cell[175132, 3779, 428, 12, 28, "Output",ExpressionUUID->"2b358d51-b6ac-4b8f-a453-6e1e9fcb0456"],
Cell[175563, 3793, 595, 14, 28, "Output",ExpressionUUID->"d1e0523b-f873-474a-a145-6bad919e1702"]
}, Open  ]],
Cell[CellGroupData[{
Cell[176195, 3812, 984, 25, 75, "Input",ExpressionUUID->"61becec3-e278-4e87-9881-b1494b3793a4"],
Cell[177182, 3839, 517, 14, 28, "Output",ExpressionUUID->"54d35d15-740e-41a2-8ed9-cb8f36fc45b0"],
Cell[177702, 3855, 202, 4, 26, "Output",ExpressionUUID->"8e43cd1f-2046-41fb-bc18-1809c846e8b2"],
Cell[177907, 3861, 200, 4, 26, "Output",ExpressionUUID->"15cea3f4-e088-43ac-8b69-ec200b38472a"],
Cell[178110, 3867, 461, 14, 26, "Output",ExpressionUUID->"3c2d3d52-72bb-49fc-89e4-daec31d16e6b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[178608, 3886, 547, 14, 25, "Input",ExpressionUUID->"4bfaff06-f3e3-4d17-bc46-f5121fdd4669"],
Cell[179158, 3902, 341, 7, 26, "Output",ExpressionUUID->"f9af6a4d-1feb-4f39-aaf6-b421465f27e7"]
}, Open  ]]
}
]
*)

