(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     84385,       1800]
NotebookOptionsPosition[     81790,       1755]
NotebookOutlinePosition[     82226,       1771]
CellTagsIndexPosition[     82183,       1768]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PredicateName", "[", "p_Symbol", "]"}], ":=", " ", "p"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Special", " ", "case", " ", "usable", " ", "for", " ", "simpler", " ", 
    "representation", " ", "of", " ", "propositional", " ", "logic"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PredicateName", "[", 
   RowBox[{"p_", "[", "x___", "]"}], "]"}], ":=", 
  "p"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PredicateSymbols", "[", 
   RowBox[{"Not", "[", "a_", "]"}], "]"}], " ", ":=", " ", 
  RowBox[{"PredicateSymbols", "[", "a", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PredicateSymbols", "[", 
   RowBox[{"a_", "\[And]", "b_"}], "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"PredicateSymbols", "[", "a", "]"}], "\[Union]", 
   RowBox[{"PredicateSymbols", "[", "b", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PredicateSymbols", "[", 
   RowBox[{"a_", "\[Or]", "b_"}], "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"PredicateSymbols", "[", "a", "]"}], "\[Union]", 
   RowBox[{"PredicateSymbols", "[", "b", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PredicateSymbols", "[", 
   RowBox[{"a_", "\[Implies]", "b_"}], "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"PredicateSymbols", "[", "a", "]"}], "\[Union]", 
   RowBox[{"PredicateSymbols", "[", "b", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PredicateSymbols", "[", 
   RowBox[{"p_Symbol", "[", "x_", "]"}], "]"}], ":=", " ", 
  RowBox[{"{", 
   RowBox[{"{", 
    RowBox[{"p", ",", " ", "1"}], "}"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PredicateSymbols", "[", 
   RowBox[{"p_Symbol", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{"{", 
    RowBox[{"p", ",", "2"}], "}"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FOAtoms", "[", "False", "]"}], " ", ":=", " ", 
  RowBox[{"{", "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FOAtoms", "[", "True", "]"}], " ", ":=", " ", 
  RowBox[{"{", "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FOAtoms", "[", 
   RowBox[{"Not", "[", "\[Phi]_", "]"}], "]"}], " ", ":=", " ", 
  RowBox[{"FOAtoms", "[", "\[Phi]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FOAtoms", "[", 
   RowBox[{"\[Phi]_", "\[And]", "\[Psi]_"}], "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"FOAtoms", "[", "\[Phi]", "]"}], "\[Union]", 
   RowBox[{"FOAtoms", "[", "\[Psi]", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FOAtoms", "[", 
   RowBox[{"\[Phi]_", "\[Or]", "\[Psi]_"}], "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"FOAtoms", "[", "\[Phi]", "]"}], "\[Union]", 
   RowBox[{"FOAtoms", "[", "\[Psi]", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FOAtoms", "[", 
   RowBox[{"\[Phi]_", "\[Implies]", "\[Psi]_"}], "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"FOAtoms", "[", "\[Phi]", "]"}], "\[Union]", 
   RowBox[{"FOAtoms", "[", "\[Psi]", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FOAtoms", "[", "atom_", "]"}], ":=", " ", 
  RowBox[{"{", "atom", "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PositiveAtoms", "[", "model_List", "]"}], ":=", 
  RowBox[{"model", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"a_", "\[Rule]", "False"}], ")"}], " ", "\[RuleDelayed]", " ", 
      "Nothing"}], ",", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"a_", "\[Rule]", "True"}], ")"}], " ", "\[RuleDelayed]", " ", 
      "a"}]}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NegativeAtoms", "[", "model_List", "]"}], ":=", 
  RowBox[{"model", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"a_", "\[Rule]", "True"}], ")"}], " ", "\[RuleDelayed]", " ", 
      "Nothing"}], ",", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"a_", "\[Rule]", "False"}], ")"}], " ", "\[RuleDelayed]", " ", 
      "a"}]}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PredicateSymbol", "[", 
   RowBox[{"p_Symbol", "[", "x___", "]"}], "]"}], ":=", " ", 
  RowBox[{"{", 
   RowBox[{"p", ",", " ", 
    RowBox[{"Length", "[", "x", "]"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PredicateSymbols", "[", "\[Phi]_", "]"}], ":=", " ", 
  RowBox[{"PredicateSymbol", "/@", " ", 
   RowBox[{"FOAtoms", "[", "\[Phi]", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SymbolSetWeight", "[", 
   RowBox[{"set_List", ",", " ", "weights_"}], "]"}], ":=", " ", 
  RowBox[{"Times", "@@", " ", 
   RowBox[{"(", 
    RowBox[{"weights", " ", "/@", "set"}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GroundAtomSetWeight", "[", 
   RowBox[{"set_List", ",", " ", "weights_"}], "]"}], ":=", 
  RowBox[{"SymbolSetWeight", "[", 
   RowBox[{
    RowBox[{"PredicateName", "/@", " ", "set"}], ",", " ", "weights"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ModelWeight", "[", 
   RowBox[{
   "model_", ",", " ", "weightsPositive_", ",", " ", "weightsNegative_"}], 
   "]"}], ":=", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"FIXME", " ", "-", " ", 
    RowBox[{
    "this", " ", "should", " ", "be", " ", "easy", " ", "to", " ", "make", 
     " ", "2", "x", " ", "faster"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"GroundAtomSetWeight", "[", 
    RowBox[{
     RowBox[{"PositiveAtoms", "[", "model", "]"}], ",", " ", 
     "weightsPositive"}], "]"}], " ", "*", " ", 
   RowBox[{"GroundAtomSetWeight", "[", 
    RowBox[{
     RowBox[{"NegativeAtoms", "[", "model", "]"}], ",", " ", 
     "weightsNegative"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AllModels", "[", "False", "]"}], ":=", " ", 
  RowBox[{"{", "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AllModels", "[", "True", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{"{", "}"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AllModels", "[", "\[Phi]_", "]"}], ":=", " ", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"variables", "=", " ", 
      RowBox[{"FOAtoms", "[", "\[Phi]", "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"modelBool", "\[Function]", 
       RowBox[{"Thread", "[", 
        RowBox[{"variables", "\[Rule]", "modelBool"}], "]"}]}], ")"}], "/@", 
     "\[IndentingNewLine]", 
     RowBox[{"SatisfiabilityInstances", "[", 
      RowBox[{"\[Phi]", ",", "variables", ",", "All"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WeightedModels", "[", 
   RowBox[{"\[Phi]_", ",", "weightsPositive_", ",", " ", "weightsNegative_"}],
    "]"}], ":=", 
  RowBox[{"Total", "[", " ", 
   RowBox[{"(*", 
    RowBox[{
    "naive", " ", "WMC", " ", "implementation", " ", "using", " ", "SAT"}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"model", " ", "\[Function]", 
      RowBox[{"ModelWeight", "[", 
       RowBox[{
       "model", ",", " ", "weightsPositive", ",", " ", "weightsNegative"}], 
       "]"}]}], ")"}], "/@", "\[IndentingNewLine]", 
    RowBox[{"AllModels", "[", "\[Phi]", "]"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PredicateToAtom", "[", 
   RowBox[{"{", 
    RowBox[{"p_", ",", "1"}], "}"}], "]"}], ":=", " ", 
  RowBox[{"p", "[", "\[FormalA]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PredicateToAtom", "[", 
   RowBox[{"{", 
    RowBox[{"p_", ",", "2"}], "}"}], "]"}], ":=", " ", 
  RowBox[{"p", "[", 
   RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}]}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{"CellAtoms", "[", "predicates_List", "]"}], ":=", 
   RowBox[{"PredicateToAtom", "/@", " ", "predicates"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"MakeCell", "[", 
     RowBox[{"atoms_List", ",", "fs_List"}], "]"}], ":=", "  ", 
    RowBox[{"And", "@@", 
     RowBox[{"MapThread", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"#1", "[", "#2", "]"}], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{"fs", ",", "atoms"}], "}"}]}], "]"}]}]}], " ", "*)"}], 
  RowBox[{"(*", " ", 
   RowBox[{
   "just", " ", "a", " ", "helper", " ", "function", " ", "for", " ", 
    "AllCells"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MakeCell", "[", 
   RowBox[{"atoms_List", ",", "boolVec_List"}], "]"}], ":=", " ", 
  RowBox[{"Thread", "[", 
   RowBox[{"atoms", "\[Rule]", "boolVec"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AllCells", "[", "atoms_List", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"boolVec", " ", "\[Function]", 
     RowBox[{"MakeCell", "[", 
      RowBox[{"atoms", ",", "boolVec"}], "]"}]}], ")"}], "/@", 
   "\[IndentingNewLine]", 
   RowBox[{"Tuples", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"False", ",", "True"}], "}"}], ",", " ", 
     RowBox[{"Length", "[", "atoms", "]"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FormulaCells", "[", "\[Phi]_", "]"}], ":=", " ", 
  RowBox[{"AllCells", "@", 
   RowBox[{"CellAtoms", "@", 
    RowBox[{
    "PredicateSymbols", "[", "\[Phi]", "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SwapVariables", "[", "object_", "]"}], ":=", " ", 
  RowBox[{"object", " ", "/.", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[FormalA]", "\[Rule]", "\[FormalB]"}], ",", " ", 
     RowBox[{"\[FormalB]", "\[Rule]", "\[FormalA]"}]}], 
    "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FormulaSymmetric", "[", "\[Psi]_", "]"}], ":=", 
  RowBox[{"\[Psi]", "\[And]", 
   RowBox[{"SwapVariables", "[", "\[Psi]", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FormulaReflexive", "[", "\[Psi]_", "]"}], ":=", " ", 
  RowBox[{"\[Psi]", " ", "/.", " ", 
   RowBox[{"\[FormalB]", "\[Rule]", "\[FormalA]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FormulaSimplified", "[", 
   RowBox[{"\[Psi]_", ",", " ", "cell1_", ",", " ", "cell2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"FormulaSymmetric", "[", "\[Psi]", "]"}], " ", "/.", " ", 
   RowBox[{"Join", "[", 
    RowBox[{"cell1", ",", " ", 
     RowBox[{"SwapVariables", "[", "cell2", "]"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FormulaSimplified", "[", 
   RowBox[{"\[Psi]_", ",", "cell_"}], "]"}], ":=", 
  RowBox[{"FormulaSimplified", "[", 
   RowBox[{"\[Psi]", ",", " ", "cell", ",", " ", "cell"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RTerm", "[", 
   RowBox[{
   "\[Psi]_", ",", "cell1_", ",", "cell2_", ",", "weightsPositive_", ",", " ",
     "weightsNegative_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"WeightedModels", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FormulaSimplified", "[", 
     RowBox[{"\[Psi]", ",", " ", "cell1", ",", " ", "cell2"}], "]"}], ",", 
    "\[IndentingNewLine]", "weightsPositive", ",", " ", "weightsNegative"}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"STerm", "[", 
   RowBox[{
   "\[Psi]_", ",", "cell_", ",", "weightsPositive_", ",", " ", 
    "weightsNegative_"}], "]"}], ":=", 
  RowBox[{"RTerm", "[", 
   RowBox[{
    RowBox[{"FormulaSymmetric", "[", "\[Psi]", "]"}], ",", " ", "cell", ",", 
    " ", "cell", ",", " ", "weightsPositive", ",", "weightsNegative"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WTerm", "[", 
   RowBox[{
   "\[Psi]_", ",", "cell_", ",", "weightsPositive_", ",", " ", 
    "weightsNegative_"}], "]"}], ":=", 
  RowBox[{"RTerm", "[", 
   RowBox[{
    RowBox[{"FormulaReflexive", "[", "\[Psi]", "]"}], ",", " ", "cell", ",", 
    " ", "cell", ",", " ", "weightsPositive", ",", "weightsNegative"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"STerms", "[", 
   RowBox[{
   "\[Psi]_", ",", " ", "weightsPositive_", ",", " ", "weightsNegative_"}], 
   "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"cell", "\[Function]", 
     RowBox[{"STerm", "[", 
      RowBox[{
      "\[Psi]", ",", " ", "cell", ",", " ", "weightsPositive", ",", 
       "weightsNegative"}], "]"}]}], ")"}], " ", "/@", " ", 
   RowBox[{"FormulaCells", "[", "\[Psi]", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WTerms", "[", 
   RowBox[{
   "\[Psi]_", ",", " ", "weightsPositive_", ",", " ", "weightsNegative_"}], 
   "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"cell", "\[Function]", 
     RowBox[{"WTerm", "[", 
      RowBox[{
      "\[Psi]", ",", " ", "cell", ",", " ", "weightsPositive", ",", 
       "weightsNegative"}], "]"}]}], ")"}], " ", "/@", " ", 
   RowBox[{"FormulaCells", "[", "\[Psi]", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RTerms", "[", 
   RowBox[{
   "\[Psi]_", ",", " ", "weightsPositive_", ",", " ", "weightsNegative_"}], 
   "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"cells", " ", "=", " ", 
       RowBox[{"FormulaCells", "[", "\[Psi]", "]"}]}], ",", " ", "length"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"length", " ", "=", " ", 
      RowBox[{"Length", "[", "cells", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"row", " ", "\[Function]", 
        RowBox[{"PadRight", "[", 
         RowBox[{"row", ",", " ", "length"}], "]"}]}], ")"}], " ", "/@", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"RTerm", "[", 
         RowBox[{"\[Psi]", ",", " ", 
          RowBox[{
          "cells", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
          ",", " ", 
          RowBox[{
          "cells", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
          ",", " ", "weightsPositive", ",", "weightsNegative"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "1", ",", " ", "length"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", " ", 
          RowBox[{"i", "+", "1"}], ",", " ", "length"}], "}"}]}], 
       "\[IndentingNewLine]", "]"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Compatible", "[", 
   RowBox[{"i_Integer", ",", " ", "cliquePart_List", ",", " ", 
    RowBox[{"{", 
     RowBox[{"s_", ",", "w_", ",", "r_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"all", "=", 
       RowBox[{"Range", "@", 
        RowBox[{"Length", "[", "s", "]"}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"cond3", "=", " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"j_", ",", "k_"}], "}"}], "\[RuleDelayed]", " ", 
        RowBox[{
         RowBox[{"j", "<", "k"}], "\[Implies]", " ", 
         RowBox[{
          RowBox[{"r", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "k"}], "\[RightDoubleBracket]"}], "\[Equal]", 
          RowBox[{"r", "\[LeftDoubleBracket]", 
           RowBox[{"j", ",", "k"}], "\[RightDoubleBracket]"}]}]}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"cond4", "=", " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"j_", ",", "k_", ",", "l_"}], "}"}], "\[RuleDelayed]", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"i", "<", "j"}], "\[And]", 
           RowBox[{"k", "<", "l"}]}], ")"}], "\[Implies]", " ", 
         RowBox[{
          RowBox[{"r", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "\[Equal]", 
          RowBox[{"r", "\[LeftDoubleBracket]", 
           RowBox[{"k", ",", "l"}], "\[RightDoubleBracket]"}]}]}]}]}]}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"And", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"AllTrue", "[", 
       RowBox[{"cliquePart", ",", 
        RowBox[{"j", "\[Function]", 
         RowBox[{
          RowBox[{"s", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
           "\[Equal]", 
          RowBox[{
          "s", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}]}]}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"AllTrue", "[", 
       RowBox[{"cliquePart", ",", 
        RowBox[{"j", "\[Function]", 
         RowBox[{
          RowBox[{"w", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
           "\[Equal]", 
          RowBox[{
          "s", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}]}]}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"And", "@@", 
        RowBox[{"Tuples", "[", 
         RowBox[{"{", 
          RowBox[{"cliquePart", ",", 
           RowBox[{"Complement", "[", 
            RowBox[{"all", ",", " ", "cliquePart"}], "]"}]}], "}"}], "]"}]}], 
       "/.", "cond3"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"And", "@@", 
        RowBox[{"Tuples", "[", 
         RowBox[{"{", 
          RowBox[{
          "cliquePart", ",", " ", "cliquePart", ",", " ", "cliquePart"}], 
          "}"}], "]"}]}], "/.", "cond4"}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cliques", "[", 
    RowBox[{"{", 
     RowBox[{"s_", ",", "w_", ",", "r_"}], "}"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "j", ",", " ", 
       RowBox[{"cliques", "=", 
        RowBox[{"{", "}"}]}], ",", " ", 
       RowBox[{"length", " ", "=", " ", 
        RowBox[{"Length", "[", "s", "]"}]}], ",", "current", ",", " ", 
       "all"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"all", " ", "=", " ", 
       RowBox[{"Range", "[", "length", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "all", "]"}], ">", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"current", " ", "=", " ", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"cell", "\[Function]", " ", 
            RowBox[{"If", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Compatible", "[", 
               RowBox[{"cell", ",", " ", "current", ",", " ", 
                RowBox[{"{", 
                 RowBox[{"s", ",", "w", ",", "r"}], "}"}]}], "]"}], " ", ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"AppendTo", "[", 
                RowBox[{"current", ",", " ", "cell"}], "]"}], ";", " ", 
               RowBox[{"all", " ", "=", " ", 
                RowBox[{"all", " ", "/.", " ", 
                 RowBox[{"cell", " ", "\[Rule]", " ", "Nothing"}]}]}], 
               ";"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]",
            ")"}], " ", "/@", " ", "all"}], ";", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"cliques", ",", " ", "current"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "cliques"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GetGTerm", "[", 
     RowBox[{"0", ",", " ", "n_Integer", ",", "cliqueIds_List"}], "]"}], ":=",
     " ", 
    RowBox[{
     RowBox[{"GetGTerm", "[", 
      RowBox[{"0", ",", " ", "n", ",", "cliqueIds"}], "]"}], " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"Module", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"i", "\[Function]"}], " ", ")"}], " ", "/@", " ", 
         RowBox[{"Range", "[", 
          RowBox[{"1", ",", "k"}], "]"}]}], "\[IndentingNewLine]", "]"}], 
       "\[IndentingNewLine]", 
       RowBox[{"GetGTerm", "[", 
        RowBox[{"p_Integer", ",", " ", "n_Integer", ",", "cliqueIds_List"}], 
        "]"}]}], ":=", " ", 
      RowBox[{
       RowBox[{"GetGTerm", "[", 
        RowBox[{"p", ",", " ", "n", ",", "cliqueIds"}], "]"}], " ", "=", " ", 
       
       RowBox[{"Module", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"s", "=", "0"}], "}"}], ","}], "\[IndentingNewLine]", 
        "]"}]}]}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetDTerm", "[", 
    RowBox[{"c_", ",", " ", "k_", ",", "n_"}], "]"}], " ", ":=", " ", 
   RowBox[{"GetDTerm", "[", 
    RowBox[{"c", ",", "1", ",", " ", "k", ",", "n"}], "]"}]}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetDTerm", "[", 
    RowBox[{"c_", ",", "i_", ",", " ", "k_", ",", "n_"}], "]"}], " ", ":=", 
   " ", "Nothing"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",\

 CellChangeTimes->{{3.826691908173477*^9, 3.826691923275236*^9}, {
   3.8266943734494*^9, 3.826694384949321*^9}, {3.826696719597742*^9, 
   3.826696741314296*^9}, {3.826696887890477*^9, 3.826696890586649*^9}, {
   3.826698545236833*^9, 3.82669854743611*^9}, {3.8266989941890793`*^9, 
   3.826699042378667*^9}, {3.826699112856061*^9, 3.826699123718796*^9}, {
   3.82669940165061*^9, 3.826699419960739*^9}, {3.826699598801098*^9, 
   3.826699632078167*^9}, {3.8266996655265017`*^9, 3.826699720825424*^9}, {
   3.826699786981991*^9, 3.826699813892815*^9}, {3.826699879796061*^9, 
   3.826699883905335*^9}, {3.8266999194673777`*^9, 3.826699933158588*^9}, 
   3.826699969104002*^9, {3.826700012274729*^9, 3.826700043681284*^9}, {
   3.826700086880082*^9, 3.826700150171782*^9}, {3.826700225590479*^9, 
   3.826700333466172*^9}, {3.8267003641925297`*^9, 3.826700408846528*^9}, {
   3.826700444903625*^9, 3.826700449460507*^9}, {3.8267005340590563`*^9, 
   3.826700568662376*^9}, {3.826700766822391*^9, 3.826700795346916*^9}, {
   3.8267010424257193`*^9, 3.826701045861957*^9}, {3.8267012253125687`*^9, 
   3.826701246347601*^9}, {3.826701284937923*^9, 3.826701427354864*^9}, {
   3.826701463580579*^9, 3.826701471848776*^9}, {3.8267018740990057`*^9, 
   3.826701917416954*^9}, 3.826702283191683*^9, {3.826705194988215*^9, 
   3.826705337877451*^9}, {3.8267053814033117`*^9, 3.826705404970828*^9}, {
   3.826705442371807*^9, 3.826705464311863*^9}, {3.82670553421457*^9, 
   3.826705573762063*^9}, {3.826705692294456*^9, 3.826705894606629*^9}, {
   3.826706740393756*^9, 3.8267067571069717`*^9}, {3.8267068413362913`*^9, 
   3.8267069970710087`*^9}, {3.826707033722508*^9, 3.8267070366287813`*^9}, {
   3.826709236360263*^9, 3.8267092488614683`*^9}, {3.826709840693407*^9, 
   3.826709919313323*^9}, {3.826710353655128*^9, 3.826710358971368*^9}, {
   3.826710446022162*^9, 3.826710454829954*^9}, {3.826710528785511*^9, 
   3.826710552908914*^9}, {3.826711140107106*^9, 3.826711141034778*^9}, {
   3.826770141889476*^9, 3.826770147009123*^9}, {3.826770465766946*^9, 
   3.826770583510621*^9}, {3.826770684871632*^9, 3.826770702422164*^9}, {
   3.826770853485091*^9, 3.826770931323544*^9}, {3.8267709849139338`*^9, 
   3.826771003352418*^9}, {3.82677107493321*^9, 3.826771154186501*^9}, {
   3.826771190888564*^9, 3.8267712068558197`*^9}, {3.826772324555181*^9, 
   3.826772352986643*^9}, {3.8267724847155113`*^9, 3.826772491503093*^9}, {
   3.826772532967822*^9, 3.826772591075437*^9}, {3.826772779313925*^9, 
   3.8267727818571167`*^9}, {3.826772819333974*^9, 3.826772911132647*^9}, {
   3.826772999117989*^9, 3.826773025234232*^9}, {3.8267731298730307`*^9, 
   3.8267731410045633`*^9}, 3.82677340296294*^9, {3.8267734611022253`*^9, 
   3.826773487118004*^9}, {3.826773774201734*^9, 3.826773776430725*^9}, {
   3.826773915864647*^9, 3.826773954867942*^9}, {3.826774019441201*^9, 
   3.8267740362696047`*^9}, {3.826774075764183*^9, 3.8267742614049807`*^9}, {
   3.826774297889739*^9, 3.826774319116613*^9}, {3.826774375630319*^9, 
   3.826774547985279*^9}, {3.8267745976747923`*^9, 3.8267746369191236`*^9}, {
   3.8267746952389174`*^9, 3.826774717378902*^9}, {3.826776432780423*^9, 
   3.826776511622465*^9}, {3.826777602795004*^9, 3.826777629127974*^9}, {
   3.826778605190192*^9, 3.8267786290803833`*^9}, {3.826778665013783*^9, 
   3.826778863719534*^9}, {3.826779048235779*^9, 3.826779057911319*^9}, {
   3.826779251029684*^9, 3.826779287002925*^9}, {3.826779343329282*^9, 
   3.826779357336011*^9}, {3.826779431518835*^9, 3.8267794511221933`*^9}, {
   3.826780141591258*^9, 3.826780149126049*^9}, {3.826780206185391*^9, 
   3.82678020703806*^9}, {3.8267808097394133`*^9, 3.8267808098912582`*^9}, {
   3.82678139198076*^9, 3.8267813922233887`*^9}, {3.826781444096285*^9, 
   3.826781444232154*^9}, {3.826797198806508*^9, 3.826797243076335*^9}, {
   3.8267973019466677`*^9, 3.826797389530806*^9}, {3.826797814909292*^9, 
   3.826797999365364*^9}, {3.826798110502787*^9, 3.826798276387518*^9}, {
   3.82679849770181*^9, 3.8267984990031843`*^9}, 3.826799113849916*^9, {
   3.826799370299933*^9, 3.826799423792611*^9}, {3.82679946759827*^9, 
   3.826799639354917*^9}, {3.82679979565377*^9, 3.826799814261026*^9}, {
   3.826800043313301*^9, 3.826800068607938*^9}, {3.8268001037298822`*^9, 
   3.8268003503377037`*^9}, {3.826800392231367*^9, 3.826800397919237*^9}, {
   3.826801380495721*^9, 3.826801382343668*^9}, {3.826801893974278*^9, 
   3.8268019177732153`*^9}, {3.826802102011656*^9, 3.826802342928423*^9}, {
   3.826802373332333*^9, 3.8268023960322943`*^9}, {3.826802458834202*^9, 
   3.826802541404107*^9}, {3.827296223325539*^9, 3.827296225605289*^9}, {
   3.827296263986578*^9, 3.827296291465073*^9}, {3.827296332863793*^9, 
   3.827296353125709*^9}, {3.8272976190386257`*^9, 3.8272976326292343`*^9}, {
   3.827298035763824*^9, 3.827298067790472*^9}, {3.827298117709277*^9, 
   3.8272981384407578`*^9}, 3.827300239749887*^9, {3.827301154141986*^9, 
   3.827301239976479*^9}, {3.827301828810267*^9, 3.827301861393035*^9}, {
   3.827301892239365*^9, 3.8273019997861423`*^9}, {3.827302031544429*^9, 
   3.827302255543271*^9}, {3.827302304523499*^9, 3.827302321580572*^9}, {
   3.82730248286719*^9, 3.8273025455406637`*^9}, {3.827302608101035*^9, 
   3.827302617630672*^9}, {3.827465227052306*^9, 3.8274652357712183`*^9}, {
   3.827465453730818*^9, 3.8274654953603287`*^9}, {3.827466585441311*^9, 
   3.827466614087874*^9}, {3.827467552881259*^9, 3.827467558249358*^9}, {
   3.827467610911867*^9, 3.827467618280074*^9}, {3.8274676677975388`*^9, 
   3.827467701754944*^9}, {3.827471543491213*^9, 3.8274715488008966`*^9}, {
   3.836278108933132*^9, 3.836278114187827*^9}, {3.8362819426280737`*^9, 
   3.83628195502315*^9}, {3.8364496937759247`*^9, 3.836449711676116*^9}, {
   3.836456651041934*^9, 3.836456655832328*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"bd4dac13-24d5-43d7-ae76-3f67079096f2"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"exampleDerangements", "=", " ", 
  RowBox[{
   RowBox[{"\[Not]", 
    RowBox[{"f", "[", 
     RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}]}], " ", "\[And]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Implies]", 
     RowBox[{"s1", "[", "\[FormalA]", "]"}]}], ")"}], "\[And]", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}], "\[Implies]", 
     RowBox[{"s2", "[", "\[FormalA]", "]"}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"weightsPositiveDerangements", "=", 
  RowBox[{"\[LeftAssociation]", 
   RowBox[{
    RowBox[{"f", "\[Rule]", "1"}], ",", 
    RowBox[{"s1", "\[Rule]", "1"}], ",", 
    RowBox[{"s2", "\[Rule]", "1"}]}], 
   "\[RightAssociation]"}]}], "\[IndentingNewLine]", 
 RowBox[{"weightsNegativeDerangements", "=", 
  RowBox[{"\[LeftAssociation]", 
   RowBox[{
    RowBox[{"f", "\[Rule]", "1"}], ",", 
    RowBox[{"s1", "\[Rule]", 
     RowBox[{"-", "1"}]}], ",", 
    RowBox[{"s2", "\[Rule]", 
     RowBox[{"-", "1"}]}]}], "\[RightAssociation]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s", "=", 
   RowBox[{"STerms", "[", 
    RowBox[{
    "exampleDerangements", ",", " ", "weightsPositiveDerangements", ",", " ", 
     "weightsNegativeDerangements"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"w", "=", 
   RowBox[{"WTerms", "[", 
    RowBox[{
    "exampleDerangements", ",", " ", "weightsPositiveDerangements", ",", " ", 
     "weightsNegativeDerangements"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r", "=", 
   RowBox[{"RTerms", "[", 
    RowBox[{
    "exampleDerangements", ",", " ", "weightsPositiveDerangements", ",", " ", 
     "weightsNegativeDerangements"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "r", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Cliques", "[", 
  RowBox[{"{", 
   RowBox[{"s", ",", "w", ",", "r"}], "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.826696981041272*^9, 3.826696981041636*^9}, {
  3.826702378820546*^9, 3.826702510883778*^9}, {3.826702587136442*^9, 
  3.826702610319283*^9}, {3.826702852625656*^9, 3.826702897223771*^9}, {
  3.826702940773076*^9, 3.8267029763798227`*^9}, {3.82670300689018*^9, 
  3.826703018049738*^9}, {3.826703058167557*^9, 3.826703081774447*^9}, {
  3.82670381663201*^9, 3.826703817949976*^9}, {3.826771473506196*^9, 
  3.826771511356617*^9}, {3.826780292468261*^9, 3.826780292634017*^9}, {
  3.8267982888200407`*^9, 3.826798427415094*^9}, {3.8267985390164633`*^9, 
  3.8267985842944202`*^9}, {3.826798632690894*^9, 3.826798659407157*^9}, {
  3.826802604969912*^9, 3.82680261255084*^9}, {3.827297465929699*^9, 
  3.8272974720970182`*^9}, {3.8272975162151337`*^9, 3.827297523918103*^9}, {
  3.827302587993596*^9, 3.827302596304904*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"622b1969-fc58-4ae9-8f5e-e2c8bd36032e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"!", 
   RowBox[{"f", "[", 
    RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}]}], "&&", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Implies]", 
    RowBox[{"s1", "[", "\[FormalA]", "]"}]}], ")"}], "&&", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}], "\[Implies]", 
    RowBox[{"s2", "[", "\[FormalA]", "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.826696982300784*^9, 3.826697230048061*^9, {3.826702488865617*^9, 
   3.8267025015546093`*^9}, 3.8267026144088917`*^9, 3.826702762333441*^9, 
   3.826703818555366*^9, 3.8267099217023478`*^9, 3.8267111446595993`*^9, 
   3.826767829675147*^9, 3.826771178601449*^9, 3.826771215950741*^9, 
   3.826771512159486*^9, 3.8267728991433153`*^9, 3.8267794795366917`*^9, 
   3.8267802938244753`*^9, 3.826780815294139*^9, {3.8267983456761827`*^9, 
   3.8267984277380733`*^9}, 3.826798491702149*^9, {3.826798540201313*^9, 
   3.826798579207993*^9}, 3.826798664911477*^9, 3.8268025260727158`*^9, {
   3.826802579310977*^9, 3.826802613004622*^9}, 3.82686083377431*^9, {
   3.8268609163722486`*^9, 3.826860932530357*^9}, 3.827201237776141*^9, 
   3.8272872471031017`*^9, 3.827297477522232*^9, 3.8272975243596067`*^9, 
   3.8272980866680317`*^9, 3.8272981487752542`*^9, {3.8273025967134*^9, 
   3.827302622916754*^9}, 3.827373100371805*^9, 3.827462466994236*^9, 
   3.827548905382824*^9, 3.836269632505393*^9, 3.8364496842512693`*^9, 
   3.837660504565434*^9, 3.837745785474065*^9, 3.8380907731602163`*^9},
 CellLabel->"Out[48]=",ExpressionUUID->"b176d9d9-2993-4494-8e9f-6980172c7194"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"f", "\[Rule]", "1"}], ",", 
   RowBox[{"s1", "\[Rule]", "1"}], ",", 
   RowBox[{"s2", "\[Rule]", "1"}]}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{
  3.826696982300784*^9, 3.826697230048061*^9, {3.826702488865617*^9, 
   3.8267025015546093`*^9}, 3.8267026144088917`*^9, 3.826702762333441*^9, 
   3.826703818555366*^9, 3.8267099217023478`*^9, 3.8267111446595993`*^9, 
   3.826767829675147*^9, 3.826771178601449*^9, 3.826771215950741*^9, 
   3.826771512159486*^9, 3.8267728991433153`*^9, 3.8267794795366917`*^9, 
   3.8267802938244753`*^9, 3.826780815294139*^9, {3.8267983456761827`*^9, 
   3.8267984277380733`*^9}, 3.826798491702149*^9, {3.826798540201313*^9, 
   3.826798579207993*^9}, 3.826798664911477*^9, 3.8268025260727158`*^9, {
   3.826802579310977*^9, 3.826802613004622*^9}, 3.82686083377431*^9, {
   3.8268609163722486`*^9, 3.826860932530357*^9}, 3.827201237776141*^9, 
   3.8272872471031017`*^9, 3.827297477522232*^9, 3.8272975243596067`*^9, 
   3.8272980866680317`*^9, 3.8272981487752542`*^9, {3.8273025967134*^9, 
   3.827302622916754*^9}, 3.827373100371805*^9, 3.827462466994236*^9, 
   3.827548905382824*^9, 3.836269632505393*^9, 3.8364496842512693`*^9, 
   3.837660504565434*^9, 3.837745785474065*^9, 3.8380907731928263`*^9},
 CellLabel->"Out[49]=",ExpressionUUID->"540718dc-7435-4ed7-b1df-c7f4996c529f"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"f", "\[Rule]", "1"}], ",", 
   RowBox[{"s1", "\[Rule]", 
    RowBox[{"-", "1"}]}], ",", 
   RowBox[{"s2", "\[Rule]", 
    RowBox[{"-", "1"}]}]}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{
  3.826696982300784*^9, 3.826697230048061*^9, {3.826702488865617*^9, 
   3.8267025015546093`*^9}, 3.8267026144088917`*^9, 3.826702762333441*^9, 
   3.826703818555366*^9, 3.8267099217023478`*^9, 3.8267111446595993`*^9, 
   3.826767829675147*^9, 3.826771178601449*^9, 3.826771215950741*^9, 
   3.826771512159486*^9, 3.8267728991433153`*^9, 3.8267794795366917`*^9, 
   3.8267802938244753`*^9, 3.826780815294139*^9, {3.8267983456761827`*^9, 
   3.8267984277380733`*^9}, 3.826798491702149*^9, {3.826798540201313*^9, 
   3.826798579207993*^9}, 3.826798664911477*^9, 3.8268025260727158`*^9, {
   3.826802579310977*^9, 3.826802613004622*^9}, 3.82686083377431*^9, {
   3.8268609163722486`*^9, 3.826860932530357*^9}, 3.827201237776141*^9, 
   3.8272872471031017`*^9, 3.827297477522232*^9, 3.8272975243596067`*^9, 
   3.8272980866680317`*^9, 3.8272981487752542`*^9, {3.8273025967134*^9, 
   3.827302622916754*^9}, 3.827373100371805*^9, 3.827462466994236*^9, 
   3.827548905382824*^9, 3.836269632505393*^9, 3.8364496842512693`*^9, 
   3.837660504565434*^9, 3.837745785474065*^9, 3.8380907731943893`*^9},
 CellLabel->"Out[50]=",ExpressionUUID->"f114db23-1cf0-4533-ad79-5826f8410466"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "1", "1", "0", "0", "0", "0", "0"},
     {"1", "1", "0", "0", "0", "0", "0", "0"},
     {"1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.826696982300784*^9, 3.826697230048061*^9, {3.826702488865617*^9, 
   3.8267025015546093`*^9}, 3.8267026144088917`*^9, 3.826702762333441*^9, 
   3.826703818555366*^9, 3.8267099217023478`*^9, 3.8267111446595993`*^9, 
   3.826767829675147*^9, 3.826771178601449*^9, 3.826771215950741*^9, 
   3.826771512159486*^9, 3.8267728991433153`*^9, 3.8267794795366917`*^9, 
   3.8267802938244753`*^9, 3.826780815294139*^9, {3.8267983456761827`*^9, 
   3.8267984277380733`*^9}, 3.826798491702149*^9, {3.826798540201313*^9, 
   3.826798579207993*^9}, 3.826798664911477*^9, 3.8268025260727158`*^9, {
   3.826802579310977*^9, 3.826802613004622*^9}, 3.82686083377431*^9, {
   3.8268609163722486`*^9, 3.826860932530357*^9}, 3.827201237776141*^9, 
   3.8272872471031017`*^9, 3.827297477522232*^9, 3.8272975243596067`*^9, 
   3.8272980866680317`*^9, 3.8272981487752542`*^9, {3.8273025967134*^9, 
   3.827302622916754*^9}, 3.827373100371805*^9, 3.827462466994236*^9, 
   3.827548905382824*^9, 3.836269632505393*^9, 3.8364496842512693`*^9, 
   3.837660504565434*^9, 3.837745785474065*^9, 3.838090773197167*^9},
 CellLabel->
  "Out[54]//MatrixForm=",ExpressionUUID->"2ad914a4-6d80-412e-b6d2-\
93dbd2b97716"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "1", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "6", ",", "7", ",", "8"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.826696982300784*^9, 3.826697230048061*^9, {3.826702488865617*^9, 
   3.8267025015546093`*^9}, 3.8267026144088917`*^9, 3.826702762333441*^9, 
   3.826703818555366*^9, 3.8267099217023478`*^9, 3.8267111446595993`*^9, 
   3.826767829675147*^9, 3.826771178601449*^9, 3.826771215950741*^9, 
   3.826771512159486*^9, 3.8267728991433153`*^9, 3.8267794795366917`*^9, 
   3.8267802938244753`*^9, 3.826780815294139*^9, {3.8267983456761827`*^9, 
   3.8267984277380733`*^9}, 3.826798491702149*^9, {3.826798540201313*^9, 
   3.826798579207993*^9}, 3.826798664911477*^9, 3.8268025260727158`*^9, {
   3.826802579310977*^9, 3.826802613004622*^9}, 3.82686083377431*^9, {
   3.8268609163722486`*^9, 3.826860932530357*^9}, 3.827201237776141*^9, 
   3.8272872471031017`*^9, 3.827297477522232*^9, 3.8272975243596067`*^9, 
   3.8272980866680317`*^9, 3.8272981487752542`*^9, {3.8273025967134*^9, 
   3.827302622916754*^9}, 3.827373100371805*^9, 3.827462466994236*^9, 
   3.827548905382824*^9, 3.836269632505393*^9, 3.8364496842512693`*^9, 
   3.837660504565434*^9, 3.837745785474065*^9, 3.8380907731993933`*^9},
 CellLabel->"Out[55]=",ExpressionUUID->"716655cd-ae17-4c18-8718-2b85fba19587"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Compatible", "[", 
  RowBox[{"7", ",", 
   RowBox[{"{", "8", "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"s", ",", "w", ",", "r"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.826801350660635*^9, 3.826801362325594*^9}, {
  3.826801841949338*^9, 3.826801862092627*^9}, {3.8268019379309807`*^9, 
  3.826801969160474*^9}, {3.8268026220197144`*^9, 3.82680264178094*^9}, {
  3.82729749025751*^9, 3.827297490567906*^9}, {3.827299659521373*^9, 
  3.827299679950248*^9}},
 CellLabel->"In[56]:=",ExpressionUUID->"a1dbc901-f48d-419c-b733-12c229e599cf"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.826696982300784*^9, 3.826697230048061*^9, {3.826702488865617*^9, 
   3.8267025015546093`*^9}, 3.8267026144088917`*^9, 3.826702762333441*^9, 
   3.826703818555366*^9, 3.8267099217023478`*^9, 3.8267111446595993`*^9, 
   3.826767829675147*^9, 3.826771178601449*^9, 3.826771215950741*^9, 
   3.826771512159486*^9, 3.8267728991433153`*^9, 3.8267794795366917`*^9, 
   3.8267802938244753`*^9, 3.826780815294139*^9, {3.8267983456761827`*^9, 
   3.8267984277380733`*^9}, 3.826798491702149*^9, {3.826798540201313*^9, 
   3.826798579207993*^9}, 3.82679866492896*^9, {3.8268018485734*^9, 
   3.826801862551759*^9}, {3.826801956403139*^9, 3.826801970324349*^9}, 
   3.826802642245599*^9, 3.826860833810317*^9, {3.8268609164011106`*^9, 
   3.826860932577302*^9}, 3.827201237821631*^9, 3.827287247148532*^9, 
   3.8272961611820717`*^9, 3.8272962323043613`*^9, 3.8272963598834753`*^9, {
   3.827297480375877*^9, 3.827297491121402*^9}, 3.827298152706089*^9, {
   3.82729966016712*^9, 3.827299681025053*^9}, 3.827373100394485*^9, 
   3.827462467019346*^9, 3.82754890546767*^9, 3.836269632529438*^9, 
   3.8364496843163967`*^9, 3.837660504635318*^9, 3.837745785530489*^9, 
   3.838090773210363*^9},
 CellLabel->"Out[56]=",ExpressionUUID->"370b62ad-633c-4898-8e6e-264a8727d766"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{"False", ",", " ", 
   RowBox[{
    RowBox[{"Print", "[", "1", "]"}], ";", " ", 
    RowBox[{"Print", "[", "2", "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.826798732214058*^9, 3.826799825313645*^9, {3.826799941115355*^9, 
   3.826799981579797*^9}, {3.8273025296306067`*^9, 3.8273025401714783`*^9}},
 CellLabel->"In[57]:=",ExpressionUUID->"b916310d-403e-4977-8e1a-9c79697094e5"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"PredicateSymbols", "[", "exampleDerangements", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"FOAtoms", "[", "exampleDerangements", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"CellAtoms", "[", 
  RowBox[{"%%", ",", "x"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"AllCells", "[", "%", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"exampleDerangements", " ", "/.", " ", "#"}], "&"}], "/@", 
  "%"}]}], "Input",
 CellChangeTimes->{
  3.826702998100162*^9, {3.826705412303548*^9, 3.826705418071356*^9}, {
   3.8267060073554497`*^9, 3.8267060129775343`*^9}, {3.8267061330045013`*^9, 
   3.826706157884408*^9}, {3.826706208118684*^9, 3.826706263213613*^9}, {
   3.8267063171071444`*^9, 3.826706405389917*^9}, {3.826707017126553*^9, 
   3.8267070210547323`*^9}, {3.826710201738904*^9, 3.826710208945135*^9}, {
   3.826711167338723*^9, 3.8267111813979387`*^9}, {3.826779086889*^9, 
   3.8267791057756357`*^9}, {3.826779203747251*^9, 3.82677920392413*^9}},
 CellLabel->"In[58]:=",ExpressionUUID->"07281651-e2d1-45bc-9b01-708e71ef79dc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"f", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"s1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"s2", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.826772899221485*^9, 3.826779069476976*^9, 3.8267791061698427`*^9, 
   3.826779204374352*^9, 3.8267794795861*^9, 3.826780815326229*^9, 
   3.8268608338386707`*^9, {3.8268609164305487`*^9, 3.8268609326116333`*^9}, 
   3.827201237849351*^9, 3.8272872471760263`*^9, 3.8273731004113207`*^9, 
   3.827462467035043*^9, 3.8275489054853497`*^9, 3.836269632548905*^9, 
   3.836449684336438*^9, 3.837660504663775*^9, 3.837745785547657*^9, 
   3.838090773244232*^9},
 CellLabel->"Out[58]=",ExpressionUUID->"cbd2408d-f320-467c-ae5f-d5ec39d29e64"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], ",", 
   RowBox[{"f", "[", 
    RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], ",", 
   RowBox[{"f", "[", 
    RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}], ",", 
   RowBox[{"s1", "[", "\[FormalA]", "]"}], ",", 
   RowBox[{"s2", "[", "\[FormalA]", "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.826772899221485*^9, 3.826779069476976*^9, 3.8267791061698427`*^9, 
   3.826779204374352*^9, 3.8267794795861*^9, 3.826780815326229*^9, 
   3.8268608338386707`*^9, {3.8268609164305487`*^9, 3.8268609326116333`*^9}, 
   3.827201237849351*^9, 3.8272872471760263`*^9, 3.8273731004113207`*^9, 
   3.827462467035043*^9, 3.8275489054853497`*^9, 3.836269632548905*^9, 
   3.836449684336438*^9, 3.837660504663775*^9, 3.837745785547657*^9, 
   3.8380907732473392`*^9},
 CellLabel->"Out[59]=",ExpressionUUID->"219028cd-9c7c-4d4a-8ebe-f724785e96ae"],

Cell[BoxData[
 RowBox[{"CellAtoms", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"f", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"s1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"s2", ",", "1"}], "}"}]}], "}"}], ",", "x"}], "]"}]], "Output",
 CellChangeTimes->{
  3.826772899221485*^9, 3.826779069476976*^9, 3.8267791061698427`*^9, 
   3.826779204374352*^9, 3.8267794795861*^9, 3.826780815326229*^9, 
   3.8268608338386707`*^9, {3.8268609164305487`*^9, 3.8268609326116333`*^9}, 
   3.827201237849351*^9, 3.8272872471760263`*^9, 3.8273731004113207`*^9, 
   3.827462467035043*^9, 3.8275489054853497`*^9, 3.836269632548905*^9, 
   3.836449684336438*^9, 3.837660504663775*^9, 3.837745785547657*^9, 
   3.8380907732487373`*^9},
 CellLabel->"Out[60]=",ExpressionUUID->"f3656d82-f83f-4c91-b143-93a2a78ee19a"],

Cell[BoxData[
 RowBox[{"AllCells", "[", 
  RowBox[{"CellAtoms", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"f", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"s1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"s2", ",", "1"}], "}"}]}], "}"}], ",", "x"}], "]"}], 
  "]"}]], "Output",
 CellChangeTimes->{
  3.826772899221485*^9, 3.826779069476976*^9, 3.8267791061698427`*^9, 
   3.826779204374352*^9, 3.8267794795861*^9, 3.826780815326229*^9, 
   3.8268608338386707`*^9, {3.8268609164305487`*^9, 3.8268609326116333`*^9}, 
   3.827201237849351*^9, 3.8272872471760263`*^9, 3.8273731004113207`*^9, 
   3.827462467035043*^9, 3.8275489054853497`*^9, 3.836269632548905*^9, 
   3.836449684336438*^9, 3.837660504663775*^9, 3.837745785547657*^9, 
   3.8380907732500772`*^9},
 CellLabel->"Out[61]=",ExpressionUUID->"8b47b988-4230-43c1-9cb7-0575ee3595cb"],

Cell[BoxData[
 TemplateBox[{
  "ReplaceAll", "reps", 
   "\"\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"CellAtoms\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"f\\\", \
\\\",\\\", \\\"2\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\
\"s1\\\", \\\",\\\", \\\"1\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"s2\\\", \\\",\\\", \\\"1\\\"}], \\\"}\\\"}]}], \\\"}\\\"}], \\\",\
\\\", \\\"x\\\"}], \\\"]\\\"}], \\\"}\\\"}]\\) is neither a list of \
replacement rules nor a valid dispatch table, and so cannot be used for \
replacing.\"", 2, 62, 1, 21188579855507435239, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.827462467077404*^9, 3.82754890549619*^9, 
  3.836269632554196*^9, 3.8364496843742437`*^9, 3.837660504700635*^9, 
  3.837745785583329*^9, 3.838090773286934*^9},
 CellLabel->
  "During evaluation of \
In[58]:=",ExpressionUUID->"6c266925-99c1-4e74-9220-12c8c9139e45"],

Cell[BoxData[
 RowBox[{"AllCells", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"!", 
     RowBox[{"f", "[", 
      RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}]}], "&&", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Implies]", 
      RowBox[{"s1", "[", "\[FormalA]", "]"}]}], ")"}], "&&", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}], "\[Implies]", 
      RowBox[{"s2", "[", "\[FormalA]", "]"}]}], ")"}]}], "/.", 
   "\[VeryThinSpace]", 
   RowBox[{"CellAtoms", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"f", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"s1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"s2", ",", "1"}], "}"}]}], "}"}], ",", "x"}], "]"}]}], 
  "]"}]], "Output",
 CellChangeTimes->{
  3.826772899221485*^9, 3.826779069476976*^9, 3.8267791061698427`*^9, 
   3.826779204374352*^9, 3.8267794795861*^9, 3.826780815326229*^9, 
   3.8268608338386707`*^9, {3.8268609164305487`*^9, 3.8268609326116333`*^9}, 
   3.827201237849351*^9, 3.8272872471760263`*^9, 3.8273731004113207`*^9, 
   3.827462467035043*^9, 3.8275489054853497`*^9, 3.836269632548905*^9, 
   3.836449684336438*^9, 3.837660504663775*^9, 3.837745785547657*^9, 
   3.8380907732947397`*^9},
 CellLabel->"Out[62]=",ExpressionUUID->"663f9b08-e60b-42ee-85bf-db07597a453a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CellGraphEdges", "[", "cells_", "]"}], " ", ":=", " ", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
         "cells", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
         "\[DirectedEdge]", " ", 
         RowBox[{
         "cells", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}], 
        ",", " ", 
        RowBox[{"{", 
         RowBox[{"j", ",", " ", "1", ",", " ", 
          RowBox[{"Length", "[", "cells", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"j", "-", "1"}]}], "}"}]}], "]"}], ",", "2"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CellGraph", "[", 
     RowBox[{
     "\[Phi]_", ",", "weightsPositive_", ",", " ", "weightsNegative_"}], 
     "]"}], ":=", " ", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"cells", " ", "=", 
         RowBox[{"FormulaCells", "[", "\[Phi]", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"edgeLabeling", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"cell1_", "\[DirectedEdge]", "cell2_"}], ")"}], 
          "\[RuleDelayed]", " ", 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"cell1", "\[DirectedEdge]", "cell2"}], ")"}], " ", 
            "\[Rule]", "\[IndentingNewLine]", 
            RowBox[{"RTerm", "[", 
             RowBox[{
             "\[Phi]", ",", " ", "cell1", ",", "cell2", ",", " ", 
              "weightsPositive", ",", " ", "weightsNegative"}], "]"}]}], 
           ")"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"vertexLabeling", "=", 
         RowBox[{"cell", "\[Function]", 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{"cell", " ", "\[Rule]", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"STerm", "[", 
               RowBox[{
               "\[Phi]", ",", " ", "cell", ",", " ", "weightsPositive", ",", 
                " ", "weightsNegative"}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"WTerm", "[", 
               RowBox[{
               "\[Phi]", ",", " ", "cell", ",", " ", "weightsPositive", ",", 
                " ", "weightsNegative"}], "]"}]}], "}"}]}], ")"}]}]}]}], 
       "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"With", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"edges", "=", " ", 
          RowBox[{"CellGraphEdges", "[", "cells", "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Graph", "[", "\[IndentingNewLine]", 
         RowBox[{"edges", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"EdgeLabels", "\[Rule]", " ", "edges"}], " ", "/.", " ", 
           "edgeLabeling"}], ",", "\[IndentingNewLine]", 
          RowBox[{"VertexLabels", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "vertexLabeling", ")"}], " ", "/@", " ", "cells"}]}],
           ",", "\[IndentingNewLine]", 
          RowBox[{"GraphLayout", "->", "\"\<CircularEmbedding\>\""}]}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"g", "=", 
    RowBox[{"CellGraph", "[", 
     RowBox[{
     "exampleDerangements", ",", "weightsPositiveDerangements", ",", 
      "weightsNegativeDerangements"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.82677631664717*^9, 3.826776392106119*^9}, {
   3.8267765332843943`*^9, 3.8267766975869493`*^9}, {3.826776732923592*^9, 
   3.826776879441977*^9}, {3.826776914408204*^9, 3.826777159010041*^9}, {
   3.8267772126363697`*^9, 3.826777281654173*^9}, {3.826777409263867*^9, 
   3.82677752628185*^9}, {3.826779530135537*^9, 3.8267795697076406`*^9}, {
   3.826779604479659*^9, 3.8267796593012533`*^9}, {3.826779690132078*^9, 
   3.826779735226982*^9}, {3.826779768791193*^9, 3.8267799442464542`*^9}, {
   3.826779999790695*^9, 3.826780008762195*^9}, {3.826780216348117*^9, 
   3.8267802165420732`*^9}, {3.826780247717576*^9, 3.826780251767538*^9}, {
   3.82678032029327*^9, 3.826780380809041*^9}, {3.826780641696588*^9, 
   3.826780668223263*^9}, 3.826781434212461*^9, {3.826781507117353*^9, 
   3.826781639628915*^9}, 3.826781671652635*^9, {3.826781728169271*^9, 
   3.826781762582808*^9}, {3.8267818619143267`*^9, 3.826781873473317*^9}, {
   3.8267819217592897`*^9, 3.826781945990067*^9}, {3.826781976836549*^9, 
   3.826782016579034*^9}, {3.826782048146036*^9, 3.826782048744166*^9}, {
   3.826787002171405*^9, 3.826787002506032*^9}, {3.8267873756492157`*^9, 
   3.8267873817162027`*^9}, {3.827374667603437*^9, 3.827374674262203*^9}},
 CellLabel->"In[63]:=",ExpressionUUID->"cb5ccc7e-7f44-46d8-b840-19729f63b518"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{{$CellContext`f[\[FormalA], \[FormalA]] -> 
        False, $CellContext`s1[\[FormalA]] -> 
        False, $CellContext`s2[\[FormalA]] -> 
        False}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
        False, $CellContext`s1[\[FormalA]] -> 
        False, $CellContext`s2[\[FormalA]] -> 
        True}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
        False, $CellContext`s1[\[FormalA]] -> 
        True, $CellContext`s2[\[FormalA]] -> 
        False}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
        False, $CellContext`s1[\[FormalA]] -> 
        True, $CellContext`s2[\[FormalA]] -> 
        True}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
        True, $CellContext`s1[\[FormalA]] -> 
        False, $CellContext`s2[\[FormalA]] -> 
        False}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
        True, $CellContext`s1[\[FormalA]] -> 
        False, $CellContext`s2[\[FormalA]] -> 
        True}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
        True, $CellContext`s1[\[FormalA]] -> 
        True, $CellContext`s2[\[FormalA]] -> 
        False}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
        True, $CellContext`s1[\[FormalA]] -> 
        True, $CellContext`s2[\[FormalA]] -> True}}, {{{1, 2}, {1, 3}, {2, 
       3}, {1, 4}, {2, 4}, {3, 4}, {1, 5}, {2, 5}, {3, 5}, {4, 5}, {1, 6}, {2,
        6}, {3, 6}, {4, 6}, {5, 6}, {1, 7}, {2, 7}, {3, 7}, {4, 7}, {5, 7}, {
       6, 7}, {1, 8}, {2, 8}, {3, 8}, {4, 8}, {5, 8}, {6, 8}, {7, 8}}, 
       Null}, {EdgeLabels -> {
        DirectedEdge[{$CellContext`f[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            False, $CellContext`s2[\[FormalA]] -> 
            True}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
            True, $CellContext`s1[\[FormalA]] -> 
            True, $CellContext`s2[\[FormalA]] -> False}] -> 0, 
         DirectedEdge[{$CellContext`f[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            True, $CellContext`s2[\[FormalA]] -> 
            False}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
            True, $CellContext`s1[\[FormalA]] -> 
            False, $CellContext`s2[\[FormalA]] -> False}] -> 0, 
         DirectedEdge[{$CellContext`f[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            True, $CellContext`s2[\[FormalA]] -> 
            False}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
            True, $CellContext`s1[\[FormalA]] -> 
            True, $CellContext`s2[\[FormalA]] -> True}] -> 0, 
         DirectedEdge[{$CellContext`f[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            True, $CellContext`s2[\[FormalA]] -> 
            True}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
            True, $CellContext`s1[\[FormalA]] -> 
            False, $CellContext`s2[\[FormalA]] -> True}] -> 0, 
         DirectedEdge[{$CellContext`f[\[FormalA], \[FormalA]] -> 
            True, $CellContext`s1[\[FormalA]] -> 
            False, $CellContext`s2[\[FormalA]] -> 
            False}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
            True, $CellContext`s1[\[FormalA]] -> 
            False, $CellContext`s2[\[FormalA]] -> True}] -> 0, 
         DirectedEdge[{$CellContext`f[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            False, $CellContext`s2[\[FormalA]] -> 
            False}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
            True, $CellContext`s1[\[FormalA]] -> 
            True, $CellContext`s2[\[FormalA]] -> True}] -> 0, 
         DirectedEdge[{$CellContext`f[\[FormalA], \[FormalA]] -> 
            True, $CellContext`s1[\[FormalA]] -> 
            False, $CellContext`s2[\[FormalA]] -> 
            True}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
            True, $CellContext`s1[\[FormalA]] -> 
            True, $CellContext`s2[\[FormalA]] -> False}] -> 0, 
         DirectedEdge[{$CellContext`f[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            False, $CellContext`s2[\[FormalA]] -> 
            False}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            True, $CellContext`s2[\[FormalA]] -> False}] -> 1, 
         DirectedEdge[{$CellContext`f[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            False, $CellContext`s2[\[FormalA]] -> 
            True}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
            True, $CellContext`s1[\[FormalA]] -> 
            False, $CellContext`s2[\[FormalA]] -> True}] -> 0, 
         DirectedEdge[{$CellContext`f[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            True, $CellContext`s2[\[FormalA]] -> 
            False}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
            True, $CellContext`s1[\[FormalA]] -> 
            True, $CellContext`s2[\[FormalA]] -> False}] -> 0, 
         DirectedEdge[{$CellContext`f[\[FormalA], \[FormalA]] -> 
            True, $CellContext`s1[\[FormalA]] -> 
            False, $CellContext`s2[\[FormalA]] -> 
            False}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
            True, $CellContext`s1[\[FormalA]] -> 
            True, $CellContext`s2[\[FormalA]] -> False}] -> 0, 
         DirectedEdge[{$CellContext`f[\[FormalA], \[FormalA]] -> 
            True, $CellContext`s1[\[FormalA]] -> 
            False, $CellContext`s2[\[FormalA]] -> 
            False}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
            True, $CellContext`s1[\[FormalA]] -> 
            True, $CellContext`s2[\[FormalA]] -> True}] -> 0, 
         DirectedEdge[{$CellContext`f[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            True, $CellContext`s2[\[FormalA]] -> 
            True}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
            True, $CellContext`s1[\[FormalA]] -> 
            True, $CellContext`s2[\[FormalA]] -> False}] -> 0, 
         DirectedEdge[{$CellContext`f[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            False, $CellContext`s2[\[FormalA]] -> 
            False}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
            True, $CellContext`s1[\[FormalA]] -> 
            False, $CellContext`s2[\[FormalA]] -> False}] -> 0, 
         DirectedEdge[{$CellContext`f[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            True, $CellContext`s2[\[FormalA]] -> 
            True}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
            True, $CellContext`s1[\[FormalA]] -> 
            True, $CellContext`s2[\[FormalA]] -> True}] -> 0, 
         DirectedEdge[{$CellContext`f[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            False, $CellContext`s2[\[FormalA]] -> 
            True}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            True, $CellContext`s2[\[FormalA]] -> False}] -> 1, 
         DirectedEdge[{$CellContext`f[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            False, $CellContext`s2[\[FormalA]] -> 
            False}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            True, $CellContext`s2[\[FormalA]] -> True}] -> 1, 
         DirectedEdge[{$CellContext`f[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            False, $CellContext`s2[\[FormalA]] -> 
            True}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
            True, $CellContext`s1[\[FormalA]] -> 
            True, $CellContext`s2[\[FormalA]] -> True}] -> 0, 
         DirectedEdge[{$CellContext`f[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            False, $CellContext`s2[\[FormalA]] -> 
            False}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
            True, $CellContext`s1[\[FormalA]] -> 
            True, $CellContext`s2[\[FormalA]] -> False}] -> 0, 
         DirectedEdge[{$CellContext`f[\[FormalA], \[FormalA]] -> 
            True, $CellContext`s1[\[FormalA]] -> 
            True, $CellContext`s2[\[FormalA]] -> 
            False}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
            True, $CellContext`s1[\[FormalA]] -> 
            True, $CellContext`s2[\[FormalA]] -> True}] -> 0, 
         DirectedEdge[{$CellContext`f[\[FormalA], \[FormalA]] -> 
            True, $CellContext`s1[\[FormalA]] -> 
            False, $CellContext`s2[\[FormalA]] -> 
            True}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
            True, $CellContext`s1[\[FormalA]] -> 
            True, $CellContext`s2[\[FormalA]] -> True}] -> 0, 
         DirectedEdge[{$CellContext`f[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            False, $CellContext`s2[\[FormalA]] -> 
            False}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            False, $CellContext`s2[\[FormalA]] -> True}] -> 1, 
         DirectedEdge[{$CellContext`f[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            False, $CellContext`s2[\[FormalA]] -> 
            True}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            True, $CellContext`s2[\[FormalA]] -> True}] -> 1, 
         DirectedEdge[{$CellContext`f[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            True, $CellContext`s2[\[FormalA]] -> 
            True}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
            True, $CellContext`s1[\[FormalA]] -> 
            False, $CellContext`s2[\[FormalA]] -> False}] -> 0, 
         DirectedEdge[{$CellContext`f[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            False, $CellContext`s2[\[FormalA]] -> 
            True}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
            True, $CellContext`s1[\[FormalA]] -> 
            False, $CellContext`s2[\[FormalA]] -> False}] -> 0, 
         DirectedEdge[{$CellContext`f[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            True, $CellContext`s2[\[FormalA]] -> 
            False}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            True, $CellContext`s2[\[FormalA]] -> True}] -> 1, 
         DirectedEdge[{$CellContext`f[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            False, $CellContext`s2[\[FormalA]] -> 
            False}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
            True, $CellContext`s1[\[FormalA]] -> 
            False, $CellContext`s2[\[FormalA]] -> True}] -> 0, 
         DirectedEdge[{$CellContext`f[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            True, $CellContext`s2[\[FormalA]] -> 
            False}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
            True, $CellContext`s1[\[FormalA]] -> 
            False, $CellContext`s2[\[FormalA]] -> True}] -> 0}, GraphLayout -> 
       "CircularEmbedding", 
       VertexLabels -> {{$CellContext`f[\[FormalA], \[FormalA]] -> 
           False, $CellContext`s1[\[FormalA]] -> 
           True, $CellContext`s2[\[FormalA]] -> False} -> {1, 
          1}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
           True, $CellContext`s1[\[FormalA]] -> 
           True, $CellContext`s2[\[FormalA]] -> False} -> {0, 
          0}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
           False, $CellContext`s1[\[FormalA]] -> 
           False, $CellContext`s2[\[FormalA]] -> False} -> {1, 
          1}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
           False, $CellContext`s1[\[FormalA]] -> 
           False, $CellContext`s2[\[FormalA]] -> True} -> {1, 
          1}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
           True, $CellContext`s1[\[FormalA]] -> 
           False, $CellContext`s2[\[FormalA]] -> True} -> {0, 
          0}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
           True, $CellContext`s1[\[FormalA]] -> 
           True, $CellContext`s2[\[FormalA]] -> True} -> {0, 
          0}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
           False, $CellContext`s1[\[FormalA]] -> 
           True, $CellContext`s2[\[FormalA]] -> True} -> {1, 
          1}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
           True, $CellContext`s1[\[FormalA]] -> 
           False, $CellContext`s2[\[FormalA]] -> False} -> {0, 0}}}]]}, 
    TagBox[GraphicsGroupBox[{
       {Hue[0.6, 0.7, 0.5], Opacity[0.7], Arrowheads[
        Medium], {
         ArrowBox[{{-0.707106781186548, 
          0.7071067811865482}, {-7.044813998280222*^-16, 1.}}, 
          0.02261146496815286], 
         InsetBox["1", {-0.35355339059327434, 0.8535533905932742}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{-0.707106781186548, 0.7071067811865482}, {
          0.707106781186547, 0.7071067811865467}}, 0.02261146496815286], 
         InsetBox["1", {-4.996003610813204*^-16, 0.7071067811865475}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{-0.707106781186548, 0.7071067811865482}, {
          1., -1.133107779529596*^-15}}, 0.02261146496815286], 
         InsetBox["1", {0.146446609406726, 0.35355339059327356}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{-0.707106781186548, 0.7071067811865482}, {
          0.7071067811865481, -0.7071067811865483}}, 0.02261146496815286], 
         InsetBox["0", {5.551115123125783*^-17, -5.551115123125783*^-17}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{-0.707106781186548, 0.7071067811865482}, {
          6.049014748177263*^-16, -1.}}, 0.02261146496815286], 
         InsetBox["0", {-0.35355339059327373, -0.14644660940672588}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{-0.707106781186548, 
          0.7071067811865482}, {-0.7071067811865471, -0.7071067811865468}}, 
          0.02261146496815286], 
         InsetBox["0", {-0.7071067811865476, 7.216449660063518*^-16}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{-0.707106781186548, 0.7071067811865482}, {-1., 
          1.0106430996148606`*^-15}}, 0.02261146496815286], 
         InsetBox["0", {-0.853553390593274, 0.3535533905932746}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{-7.044813998280222*^-16, 1.}, {0.707106781186547, 
          0.7071067811865467}}, 0.02261146496815286], 
         InsetBox["1", {0.3535533905932732, 0.8535533905932733}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{-7.044813998280222*^-16, 1.}, {
          1., -1.133107779529596*^-15}}, 0.02261146496815286], 
         InsetBox["1", {0.49999999999999967, 0.49999999999999944}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{-7.044813998280222*^-16, 1.}, {
          0.7071067811865481, -0.7071067811865483}}, 0.02261146496815286], 
         InsetBox["0", {0.35355339059327373, 0.14644660940672583}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{-7.044813998280222*^-16, 1.}, {
          6.049014748177263*^-16, -1.}}, 0.02261146496815286], 
         InsetBox["0", {-4.978996250514798*^-17, 0.}, ImageScaled[{0.5, 0.5}],
          
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{-7.044813998280222*^-16, 
          1.}, {-0.7071067811865471, -0.7071067811865468}}, 
          0.02261146496815286], 
         InsetBox["0", {-0.3535533905932739, 0.1464466094067266}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{-7.044813998280222*^-16, 1.}, {-1., 
          1.0106430996148606`*^-15}}, 0.02261146496815286], 
         InsetBox["0", {-0.5000000000000003, 0.5000000000000006}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{0.707106781186547, 0.7071067811865467}, {
          1., -1.133107779529596*^-15}}, 0.02261146496815286], 
         InsetBox["1", {0.8535533905932735, 0.3535533905932728}, ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{0.707106781186547, 0.7071067811865467}, {
          0.7071067811865481, -0.7071067811865483}}, 0.02261146496815286], 
         InsetBox["0", {0.7071067811865476, -8.326672684688674*^-16}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{0.707106781186547, 0.7071067811865467}, {
          6.049014748177263*^-16, -1.}}, 0.02261146496815286], 
         InsetBox["0", {0.3535533905932738, -0.14644660940672666}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{0.707106781186547, 
          0.7071067811865467}, {-0.7071067811865471, -0.7071067811865468}}, 
          0.02261146496815286], 
         InsetBox["0", {-5.551115123125783*^-17, -5.551115123125783*^-17}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{0.707106781186547, 0.7071067811865467}, {-1., 
          1.0106430996148606`*^-15}}, 0.02261146496815286], 
         InsetBox["0", {-0.1464466094067265, 0.35355339059327384}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{1., -1.133107779529596*^-15}, {
          0.7071067811865481, -0.7071067811865483}}, 0.02261146496815286], 
         InsetBox["0", {0.8535533905932741, -0.35355339059327473}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{1., -1.133107779529596*^-15}, {
          6.049014748177263*^-16, -1.}}, 0.02261146496815286], 
         InsetBox["0", {0.5000000000000003, -0.5000000000000006}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{
          1., -1.133107779529596*^-15}, {-0.7071067811865471, \
-0.7071067811865468}}, 0.02261146496815286], 
         InsetBox["0", {0.14644660940672644, -0.35355339059327395}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{1., -1.133107779529596*^-15}, {-1., 
          1.0106430996148606`*^-15}}, 0.02261146496815286], 
         InsetBox["0", {0., -6.123233995736767*^-17}, ImageScaled[{0.5, 0.5}],
          
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{0.7071067811865481, -0.7071067811865483}, {
          6.049014748177263*^-16, -1.}}, 0.02261146496815286], 
         InsetBox["0", {0.35355339059327434, -0.8535533905932742}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{
          0.7071067811865481, -0.7071067811865483}, {-0.7071067811865471, \
-0.7071067811865468}}, 0.02261146496815286], 
         InsetBox["0", {4.996003610813204*^-16, -0.7071067811865476}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{0.7071067811865481, -0.7071067811865483}, {-1., 
          1.0106430996148606`*^-15}}, 0.02261146496815286], 
         InsetBox["0", {-0.14644660940672594, -0.3535533905932737}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{
          6.049014748177263*^-16, -1.}, {-0.7071067811865471, \
-0.7071067811865468}}, 0.02261146496815286], 
         InsetBox["0", {-0.3535533905932733, -0.8535533905932734}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{6.049014748177263*^-16, -1.}, {-1., 
          1.0106430996148606`*^-15}}, 0.02261146496815286], 
         InsetBox["0", {-0.4999999999999997, -0.4999999999999995}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{-0.7071067811865471, -0.7071067811865468}, {-1., 
          1.0106430996148606`*^-15}}, 0.02261146496815286], 
         InsetBox["0", {-0.8535533905932735, -0.3535533905932729}, 
          ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}}, 
       {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
        DiskBox[{-0.707106781186548, 0.7071067811865482}, 
         0.02261146496815286], 
        DiskBox[{-7.044813998280222*^-16, 1.}, 0.02261146496815286], 
        DiskBox[{0.707106781186547, 0.7071067811865467}, 0.02261146496815286],
         DiskBox[{1., -1.133107779529596*^-15}, 0.02261146496815286], 
        DiskBox[{0.7071067811865481, -0.7071067811865483}, 
         0.02261146496815286], 
        DiskBox[{6.049014748177263*^-16, -1.}, 0.02261146496815286], 
        DiskBox[{-0.7071067811865471, -0.7071067811865468}, 
         0.02261146496815286], 
        DiskBox[{-1., 1.0106430996148606*^-15}, 0.02261146496815286]}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameTicks->None,
  ImageSize->{918.8910891089109, Automatic}]], "Output",
 CellChangeTimes->{
  3.826780217077115*^9, 3.8267802522017517`*^9, {3.8267803346474*^9, 
   3.826780373231633*^9}, {3.8267806421737213`*^9, 3.8267806688445873`*^9}, 
   3.826780815366444*^9, 3.826781450295142*^9, {3.8267816496814737`*^9, 
   3.826781672205987*^9}, {3.8267817492620783`*^9, 3.826781763592647*^9}, {
   3.8267819136800947`*^9, 3.826781946945999*^9}, {3.826781987110038*^9, 
   3.826782017064035*^9}, 3.8267820511738157`*^9, 3.8267870030832453`*^9, 
   3.826787384876696*^9, {3.826860916492393*^9, 3.826860932677967*^9}, 
   3.827201237919807*^9, 3.827287247242787*^9, 3.8273731004446983`*^9, 
   3.827374674998238*^9, 3.827462467136628*^9, 3.827548905541114*^9, 
   3.836269632584982*^9, 3.8364496844218082`*^9, 3.837660504743149*^9, 
   3.83774578562612*^9, 3.838090773352538*^9},
 CellLabel->"Out[65]=",ExpressionUUID->"81752584-dc65-4df7-adb8-daaabb6ba0ca"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Implementation", " ", "of", " ", "WFOMC", " ", "according", " ", "to", 
     " ", "formula", " ", 
     RowBox[{"(", "1", ")"}], " ", "in", " ", "Faster", " ", "Lifting", " ", 
     "for", " ", "Two"}], "-", 
    RowBox[{
    "Variable", " ", "Logic", " ", "using", " ", "Cell", " ", "Graphs"}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"OrderedPartitions", "[", 
     RowBox[{"n_Integer", ",", "m_Integer"}], "]"}], ":=", " ", 
    RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Permutations", "[", 
         RowBox[{"PadRight", "[", 
          RowBox[{"#", ",", "m"}], "]"}], "]"}], "&"}], "\[IndentingNewLine]",
        "/@", 
       RowBox[{"IntegerPartitions", "[", 
        RowBox[{"n", ",", "m"}], "]"}]}], ",", "\[IndentingNewLine]", "1"}], 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Pow", "[", 
     RowBox[{"0", ",", "0"}], "]"}], ":=", "1"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Pow", "[", 
     RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
    RowBox[{"a", "^", "b"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"WFOMC1", "[", 
     RowBox[{
     "\[Phi]_", ",", "n_", ",", "weightsPositive_", ",", " ", 
      "weightsNegative_"}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"s", "=", 
         RowBox[{"STerms", "[", 
          RowBox[{
          "\[Phi]", ",", " ", "weightsPositiveDerangements", ",", " ", 
           "weightsNegativeDerangements"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"w", "=", 
         RowBox[{"WTerms", "[", 
          RowBox[{
          "\[Phi]", ",", " ", "weightsPositiveDerangements", ",", " ", 
           "weightsNegativeDerangements"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"r", "=", 
         RowBox[{"RTerms", "[", 
          RowBox[{
          "\[Phi]", ",", " ", "weightsPositiveDerangements", ",", " ", 
           "weightsNegativeDerangements"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"u", "=", 
         RowBox[{"2", "^", 
          RowBox[{"(", 
           RowBox[{"Length", "@", 
            RowBox[{"PredicateSymbols", "[", "\[Phi]", "]"}]}], " ", 
           ")"}]}]}], ",", "\[IndentingNewLine]", "i", ",", "j"}], "}"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{"Total", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"partition", " ", "|->", " ", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Multinomial", "[", 
            RowBox[{"Sequence", "@@", "partition"}], "]"}], " ", "*", 
           "\[IndentingNewLine]", 
           RowBox[{"Product", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"r", "\[LeftDoubleBracket]", 
               RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "~", "Pow",
               "~", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "partition", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}], "*", 
                RowBox[{
                "partition", "\[LeftDoubleBracket]", "j", 
                 "\[RightDoubleBracket]"}]}], ")"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", "u"}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", " ", ",", " ", 
               RowBox[{"j", "-", "1"}]}], "}"}]}], "]"}], "*", 
           "\[IndentingNewLine]", 
           RowBox[{"Product", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
               "s", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
               "~", "Pow", "~", 
               RowBox[{"Binomial", "[", 
                RowBox[{
                 RowBox[{
                 "partition", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}], ",", "2"}], "]"}]}], " ", "*", 
              "\[IndentingNewLine]", " ", 
              RowBox[{
               RowBox[{
               "w", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
               "~", "Pow", "~", 
               RowBox[{
               "partition", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "u"}], "}"}]}], "]"}]}]}], 
         "\[IndentingNewLine]", ")"}], " ", "/@", " ", 
        RowBox[{"OrderedPartitions", "[", 
         RowBox[{"n", ",", " ", "u"}], "]"}]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.837671520214148*^9, 3.837671559005844*^9}, {
  3.83767175868404*^9, 3.837671836650036*^9}, {3.837676078777917*^9, 
  3.8376761046086807`*^9}, {3.837677350649568*^9, 3.837677351937161*^9}, {
  3.837678843118335*^9, 3.837678850990128*^9}, {3.837678890276106*^9, 
  3.837678925290481*^9}, {3.837678958848846*^9, 3.837678976703998*^9}, {
  3.837679016694084*^9, 3.8376793311201487`*^9}, {3.8377469641332273`*^9, 
  3.837746978068305*^9}, {3.837747023042777*^9, 3.837747067350965*^9}, {
  3.8377472368946753`*^9, 3.8377472703717403`*^9}, {3.837747438573263*^9, 
  3.837747440265904*^9}, {3.837747477906584*^9, 3.837747496104636*^9}},
 CellLabel->"In[66]:=",ExpressionUUID->"de9d90ff-36d4-4acd-a124-54bc81661d37"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"WFOMC1", "[", "\[IndentingNewLine]", 
    RowBox[{
    "exampleDerangements", ",", "n", ",", "weightsPositiveDerangements", ",", 
     "weightsNegativeDerangements"}], "]"}], ",", "\[IndentingNewLine]", " ", 
   
   RowBox[{"{", 
    RowBox[{"n", ",", " ", "0", ",", " ", "5"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.837671569973804*^9, 3.8376715949630013`*^9}, {
  3.837671627206588*^9, 3.837671631546236*^9}, {3.837678818766939*^9, 
  3.837678831829865*^9}, {3.837678937946063*^9, 3.8376789529351254`*^9}, {
  3.837679364693651*^9, 3.837679417960854*^9}},
 CellLabel->"In[70]:=",ExpressionUUID->"3967da30-0426-4e51-8fed-f7c482dc836e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "4", ",", "8", ",", "16", ",", "32", ",", "64"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.837671573612368*^9, 3.837671595498357*^9}, 
   3.837671631855782*^9, {3.837678823257477*^9, 3.837678832158881*^9}, {
   3.837678939241272*^9, 3.83767895328126*^9}, {3.8376793938334217`*^9, 
   3.837679420199458*^9}, 3.837745785659285*^9, 3.837746983196039*^9, {
   3.837747250296301*^9, 3.8377472724534893`*^9}, 3.837747464566654*^9, 
   3.838090773490415*^9},
 CellLabel->"Out[70]=",ExpressionUUID->"43b35755-d178-4894-a101-65d853446699"]
}, Open  ]]
},
WindowSize->{1368.7128712871288`, 749.2277227722773},
WindowMargins->{{1368.7128712871288`, Automatic}, {0, Automatic}},
FrontEndVersion->"12.3 for Linux x86 (64-bit) (June 19, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"3f7ebace-b87e-4310-9597-9cae25c330a8"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 26627, 616, 2133, "Input",ExpressionUUID->"bd4dac13-24d5-43d7-ae76-3f67079096f2"],
Cell[CellGroupData[{
Cell[27210, 640, 2941, 66, 176, "Input",ExpressionUUID->"622b1969-fc58-4ae9-8f5e-e2c8bd36032e"],
Cell[30154, 708, 1683, 31, 36, "Output",ExpressionUUID->"b176d9d9-2993-4494-8e9f-6980172c7194"],
Cell[31840, 741, 1401, 22, 35, "Output",ExpressionUUID->"540718dc-7435-4ed7-b1df-c7f4996c529f"],
Cell[33244, 765, 1441, 24, 35, "Output",ExpressionUUID->"f114db23-1cf0-4533-ad79-5826f8410466"],
Cell[34688, 791, 2030, 40, 164, "Output",ExpressionUUID->"2ad914a4-6d80-412e-b6d2-93dbd2b97716"],
Cell[36721, 833, 1426, 24, 33, "Output",ExpressionUUID->"716655cd-ae17-4c18-8718-2b85fba19587"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38184, 862, 573, 11, 29, "Input",ExpressionUUID->"a1dbc901-f48d-419c-b733-12c229e599cf"],
Cell[38760, 875, 1314, 19, 33, "Output",ExpressionUUID->"370b62ad-633c-4898-8e6e-264a8727d766"]
}, Open  ]],
Cell[40089, 897, 430, 9, 29, "Input",ExpressionUUID->"b916310d-403e-4977-8e1a-9c79697094e5"],
Cell[CellGroupData[{
Cell[40544, 910, 1066, 20, 112, "Input",ExpressionUUID->"07281651-e2d1-45bc-9b01-708e71ef79dc"],
Cell[41613, 932, 790, 17, 33, "Output",ExpressionUUID->"cbd2408d-f320-467c-ae5f-d5ec39d29e64"],
Cell[42406, 951, 957, 19, 36, "Output",ExpressionUUID->"219028cd-9c7c-4d4a-8ebe-f724785e96ae"],
Cell[43366, 972, 866, 19, 33, "Output",ExpressionUUID->"f3656d82-f83f-4c91-b143-93a2a78ee19a"],
Cell[44235, 993, 913, 21, 33, "Output",ExpressionUUID->"8b47b988-4230-43c1-9cb7-0575ee3595cb"],
Cell[45151, 1016, 967, 17, 28, "Message",ExpressionUUID->"6c266925-99c1-4e74-9220-12c8c9139e45"],
Cell[46121, 1035, 1463, 37, 36, "Output",ExpressionUUID->"663f9b08-e60b-42ee-85bf-db07597a453a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47621, 1077, 4998, 105, 501, "Input",ExpressionUUID->"cb5ccc7e-7f44-46d8-b840-19729f63b518"],
Cell[52622, 1184, 22190, 402, 934, "Output",ExpressionUUID->"81752584-dc65-4df7-adb8-daaabb6ba0ca"]
}, Open  ]],
Cell[74827, 1589, 5608, 133, 522, "Input",ExpressionUUID->"de9d90ff-36d4-4acd-a124-54bc81661d37"],
Cell[CellGroupData[{
Cell[80460, 1726, 730, 14, 91, "Input",ExpressionUUID->"3967da30-0426-4e51-8fed-f7c482dc836e"],
Cell[81193, 1742, 581, 10, 33, "Output",ExpressionUUID->"43b35755-d178-4894-a101-65d853446699"]
}, Open  ]]
}
]
*)

