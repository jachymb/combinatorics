(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    231158,       5061]
NotebookOptionsPosition[    225351,       4962]
NotebookOutlinePosition[    225834,       4980]
CellTagsIndexPosition[    225791,       4977]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PredicateName", "[", "p_Symbol", "]"}], ":=", " ", "p"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Special", " ", "case", " ", "usable", " ", "for", " ", "simpler", " ", 
    "representation", " ", "of", " ", "propositional", " ", "logic"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PredicateName", "[", 
   RowBox[{"p_", "[", "x___", "]"}], "]"}], ":=", 
  "p"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PredicateSymbols", "[", 
   RowBox[{"Not", "[", "a_", "]"}], "]"}], " ", ":=", " ", 
  RowBox[{"PredicateSymbols", "[", "a", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PredicateSymbols", "[", 
   RowBox[{"a_", "\[And]", "b_"}], "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"PredicateSymbols", "[", "a", "]"}], "\[Union]", 
   RowBox[{"PredicateSymbols", "[", "b", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PredicateSymbols", "[", 
   RowBox[{"a_", "\[Or]", "b_"}], "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"PredicateSymbols", "[", "a", "]"}], "\[Union]", 
   RowBox[{"PredicateSymbols", "[", "b", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PredicateSymbols", "[", 
   RowBox[{"a_", "\[Xor]", "b_"}], "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"PredicateSymbols", "[", "a", "]"}], "\[Union]", 
   RowBox[{"PredicateSymbols", "[", "b", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PredicateSymbols", "[", 
   RowBox[{"a_", "\[Implies]", "b_"}], "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"PredicateSymbols", "[", "a", "]"}], "\[Union]", 
   RowBox[{"PredicateSymbols", "[", "b", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PredicateSymbols", "[", 
   RowBox[{"a_", "\[Equivalent]", "b_"}], "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"PredicateSymbols", "[", "a", "]"}], "\[Union]", 
   RowBox[{"PredicateSymbols", "[", "b", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PredicateSymbols", "[", 
   RowBox[{"p_Symbol", "[", "x_", "]"}], "]"}], ":=", " ", 
  RowBox[{"{", 
   RowBox[{"{", 
    RowBox[{"p", ",", " ", "1"}], "}"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PredicateSymbols", "[", 
   RowBox[{"p_Symbol", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{"{", 
    RowBox[{"p", ",", "2"}], "}"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BinaryPredicateSymbols", "[", "\[Phi]_", "]"}], ":=", 
  RowBox[{"First", " ", "/@", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"PredicateSymbols", "[", "\[Phi]", "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "==", "2"}], "&"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"UnaryPredicateSymbols", "[", "\[Phi]_", "]"}], ":=", 
  RowBox[{"First", " ", "/@", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"PredicateSymbols", "[", "\[Phi]", "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "==", "1"}], "&"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BinaryNonreflexiveAtoms", "[", "\[Phi]_", "]"}], ":=", 
  RowBox[{"Flatten", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], ",", 
       RowBox[{"#", "[", 
        RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}]}], "}"}], "&"}], "/@",
     " ", 
    RowBox[{"BinaryPredicateSymbols", "[", "\[Phi]", "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PredicateToAtom", "[", 
   RowBox[{"{", 
    RowBox[{"p_", ",", "1"}], "}"}], "]"}], ":=", 
  RowBox[{"p", "[", "\[FormalA]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PredicateToAtom", "[", 
   RowBox[{"{", 
    RowBox[{"p_", ",", "2"}], "}"}], "]"}], ":=", 
  RowBox[{"p", "[", 
   RowBox[{"\[FormalA]", ",", "\[FormalA]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"UnaryAndReflexiveAtoms", "[", "\[Phi]_", "]"}], ":=", " ", 
  RowBox[{"PredicateToAtom", "/@", " ", 
   RowBox[{
   "PredicateSymbols", "[", "\[Phi]", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FOAtoms", "[", "False", "]"}], " ", ":=", " ", 
  RowBox[{"{", "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FOAtoms", "[", "True", "]"}], " ", ":=", " ", 
  RowBox[{"{", "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FOAtoms", "[", 
   RowBox[{"Not", "[", "\[Phi]_", "]"}], "]"}], " ", ":=", " ", 
  RowBox[{"FOAtoms", "[", "\[Phi]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FOAtoms", "[", 
   RowBox[{"\[Phi]_", "\[And]", "\[Psi]_"}], "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"FOAtoms", "[", "\[Phi]", "]"}], "\[Union]", 
   RowBox[{"FOAtoms", "[", "\[Psi]", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FOAtoms", "[", 
   RowBox[{"\[Phi]_", "\[Or]", "\[Psi]_"}], "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"FOAtoms", "[", "\[Phi]", "]"}], "\[Union]", 
   RowBox[{"FOAtoms", "[", "\[Psi]", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FOAtoms", "[", 
   RowBox[{"\[Phi]_", "\[Implies]", "\[Psi]_"}], "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"FOAtoms", "[", "\[Phi]", "]"}], "\[Union]", 
   RowBox[{"FOAtoms", "[", "\[Psi]", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FOAtoms", "[", "atom_", "]"}], ":=", " ", 
  RowBox[{"{", "atom", "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PositiveAtoms", "[", "model_List", "]"}], ":=", 
  RowBox[{"model", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"a_", "\[Rule]", "False"}], ")"}], " ", "\[RuleDelayed]", " ", 
      "Nothing"}], ",", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"a_", "\[Rule]", "True"}], ")"}], " ", "\[RuleDelayed]", " ", 
      "a"}]}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NegativeAtoms", "[", "model_List", "]"}], ":=", 
  RowBox[{"model", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"a_", "\[Rule]", "True"}], ")"}], " ", "\[RuleDelayed]", " ", 
      "Nothing"}], ",", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"a_", "\[Rule]", "False"}], ")"}], " ", "\[RuleDelayed]", " ", 
      "a"}]}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PredicateSymbol", "[", 
   RowBox[{"p_Symbol", "[", "x___", "]"}], "]"}], ":=", " ", 
  RowBox[{"{", 
   RowBox[{"p", ",", " ", 
    RowBox[{"Length", "[", "x", "]"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PredicateSymbols", "[", "\[Phi]_", "]"}], ":=", " ", 
  RowBox[{"PredicateSymbol", "/@", " ", 
   RowBox[{"FOAtoms", "[", "\[Phi]", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MakeLiteral", "[", 
   RowBox[{"a_", "->", "True"}], "]"}], ":=", " ", 
  "a"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MakeLiteral", "[", 
   RowBox[{"b_", "->", "False"}], "]"}], ":=", " ", 
  RowBox[{"\[Not]", "b"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"InterpretationToFormula", "[", "f_List", "]"}], ":=", " ", 
  RowBox[{"And", "@@", 
   RowBox[{"(", 
    RowBox[{"MakeLiteral", " ", "/@", " ", "f"}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SymbolSetWeight", "[", 
   RowBox[{"set_List", ",", " ", "weights_"}], "]"}], ":=", " ", 
  RowBox[{"Times", "@@", " ", 
   RowBox[{"(", 
    RowBox[{"weights", " ", "/@", "set"}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GroundAtomSetWeight", "[", 
   RowBox[{"set_List", ",", " ", "weights_"}], "]"}], ":=", 
  RowBox[{"SymbolSetWeight", "[", 
   RowBox[{
    RowBox[{"PredicateName", "/@", " ", "set"}], ",", " ", "weights"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ModelWeight", "[", 
   RowBox[{
   "model_", ",", " ", "weightsPositive_", ",", " ", "weightsNegative_"}], 
   "]"}], ":=", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"FIXME", " ", "-", " ", 
    RowBox[{
    "this", " ", "should", " ", "be", " ", "easy", " ", "to", " ", "make", 
     " ", "2", "x", " ", "faster"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"GroundAtomSetWeight", "[", 
    RowBox[{
     RowBox[{"PositiveAtoms", "[", "model", "]"}], ",", " ", 
     "weightsPositive"}], "]"}], " ", "*", " ", 
   RowBox[{"GroundAtomSetWeight", "[", 
    RowBox[{
     RowBox[{"NegativeAtoms", "[", "model", "]"}], ",", " ", 
     "weightsNegative"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AllModels", "[", 
    RowBox[{"False", ",", "v_"}], "]"}], ":=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AllModels", "[", 
   RowBox[{"\[Phi]_", ",", 
    RowBox[{"{", "}"}]}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{"{", "}"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AllModels", "[", 
   RowBox[{"\[Phi]_", ",", "variables_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "result", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"modelBool", "\[Function]", 
       RowBox[{"Thread", "[", 
        RowBox[{"variables", "\[Rule]", "modelBool"}], "]"}]}], ")"}], "/@", 
     "\[IndentingNewLine]", 
     RowBox[{"SatisfiabilityInstances", "[", 
      RowBox[{"\[Phi]", ",", "variables", ",", "All"}], "]"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Print", "[", "result", "]"}], ";", "\[IndentingNewLine]", 
     "result"}], "*)"}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WeightedModels", "[", 
   RowBox[{
   "\[Phi]_", ",", "weightsPositive_", ",", " ", "weightsNegative_", ",", " ",
     "variables_"}], "]"}], ":=", 
  RowBox[{"Total", "[", " ", 
   RowBox[{"(*", 
    RowBox[{
    "naive", " ", "WMC", " ", "implementation", " ", "using", " ", "SAT"}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"model", " ", "\[Function]", 
      RowBox[{"ModelWeight", "[", 
       RowBox[{
       "model", ",", " ", "weightsPositive", ",", " ", "weightsNegative"}], 
       "]"}]}], ")"}], "/@", "\[IndentingNewLine]", 
    RowBox[{"AllModels", "[", 
     RowBox[{"\[Phi]", ",", "variables"}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PredicateToAtom", "[", 
   RowBox[{"{", 
    RowBox[{"p_", ",", "1"}], "}"}], "]"}], ":=", " ", 
  RowBox[{"p", "[", "\[FormalA]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PredicateToAtom", "[", 
   RowBox[{"{", 
    RowBox[{"p_", ",", "2"}], "}"}], "]"}], ":=", " ", 
  RowBox[{"p", "[", 
   RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}]}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{"CellAtoms", "[", "predicates_List", "]"}], ":=", 
   RowBox[{"PredicateToAtom", "/@", " ", "predicates"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"MakeCell", "[", 
     RowBox[{"atoms_List", ",", "fs_List"}], "]"}], ":=", "  ", 
    RowBox[{"And", "@@", 
     RowBox[{"MapThread", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"#1", "[", "#2", "]"}], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{"fs", ",", "atoms"}], "}"}]}], "]"}]}]}], " ", "*)"}], 
  RowBox[{"(*", " ", 
   RowBox[{
   "just", " ", "a", " ", "helper", " ", "function", " ", "for", " ", 
    "AllCells"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MakeCell", "[", 
   RowBox[{"atoms_List", ",", "boolVec_List"}], "]"}], ":=", " ", 
  RowBox[{"Thread", "[", 
   RowBox[{"atoms", "\[Rule]", "boolVec"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AllCells", "[", "atoms_List", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"boolVec", " ", "\[Function]", 
     RowBox[{"MakeCell", "[", 
      RowBox[{"atoms", ",", "boolVec"}], "]"}]}], ")"}], "/@", 
   "\[IndentingNewLine]", 
   RowBox[{"Tuples", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"False", ",", "True"}], "}"}], ",", " ", 
     RowBox[{"Length", "[", "atoms", "]"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FormulaCells", "[", "\[Phi]_", "]"}], ":=", " ", 
   RowBox[{"Sort", "@", 
    RowBox[{"AllCells", "@", 
     RowBox[{"CellAtoms", "@", 
      RowBox[{"PredicateSymbols", "[", "\[Phi]", "]"}]}]}]}]}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Sort", " ", "probably", " ", "not", " ", "needed"}], " ", "-", 
    " ", 
    RowBox[{
    "added", " ", "just", " ", "in", " ", "case", " ", "to", " ", "ensure", 
     " ", "function", " ", "purity"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FormulaCellsValid", "[", "\[Phi]_", "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"cells", "=", 
      RowBox[{"FormulaCells", "[", "\[Phi]", "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Pick", "[", 
     RowBox[{"cells", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"SatisfiableQ", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\[Phi]", "/.", " ", 
            RowBox[{"\[FormalB]", "->", "\[FormalA]"}]}], ")"}], "/.", "#"}], 
         "]"}], "&"}], " ", "/@", " ", "cells"}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SwapVariables", "[", "object_", "]"}], ":=", " ", 
  RowBox[{"object", " ", "/.", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[FormalA]", "\[Rule]", "\[FormalB]"}], ",", " ", 
     RowBox[{"\[FormalB]", "\[Rule]", "\[FormalA]"}]}], 
    "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FormulaSymmetric", "[", "\[Psi]_", "]"}], ":=", 
  RowBox[{"\[Psi]", "\[And]", 
   RowBox[{"SwapVariables", "[", "\[Psi]", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FormulaReflexive", "[", "\[Psi]_", "]"}], ":=", " ", 
  RowBox[{"\[Psi]", " ", "/.", " ", 
   RowBox[{"\[FormalB]", "\[Rule]", "\[FormalA]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FormulaSimplified", "[", 
   RowBox[{"\[Psi]_", ",", " ", "cell1_", ",", " ", "cell2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"FormulaSymmetric", "[", "\[Psi]", "]"}], " ", "/.", 
   RowBox[{"Join", "[", 
    RowBox[{"cell1", ",", " ", 
     RowBox[{"SwapVariables", "[", "cell2", "]"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FormulaSimplified", "[", 
   RowBox[{"\[Psi]_", ",", "cell_"}], "]"}], ":=", 
  RowBox[{"FormulaSimplified", "[", 
   RowBox[{"\[Psi]", ",", " ", "cell", ",", " ", "cell"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RTerm", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\[Psi]_", ",", "weightsPositive_", ",", " ", "weightsNegative_"}], 
     "}"}], ",", "cell1_", ",", "cell2_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"unaryWeights", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"#", "->", "1"}], ")"}], "&"}], "/@", " ", 
       RowBox[{"UnaryPredicateSymbols", "[", "\[Psi]", "]"}]}]}], "}"}], ",", 
    " ", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"Podle", " ", "Timova", " ", "k\[OAcute]du"}], " ", "-", " ", 
      RowBox[{"nech\[AAcute]pu", " ", "pro\[CHacek]"}]}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"WeightedModels", "[", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Alternative", " ", ":", " ", 
        RowBox[{"syntactic", " ", "approach", " ", "to", " ", "cells"}], ":", 
        "\[IndentingNewLine]", 
        RowBox[{"Simplify", "[", 
         RowBox[{
          RowBox[{"FormulaSymmetric", "[", "\[Psi]", "]"}], "\[And]", " ", 
          RowBox[{"InterpretationToFormula", "[", "cell1", "]"}], "\[And]", 
          RowBox[{"InterpretationToFormula", "@", 
           RowBox[{"SwapVariables", "[", "cell2", "]"}]}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Semantic", ":", "\[IndentingNewLine]", 
        RowBox[{"FormulaSimplified2Cell", "[", 
         RowBox[{"\[Psi]", ",", " ", "cell1", ",", " ", "cell2"}], "]"}]}], 
       ","}], "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FormulaSimplified", "[", 
       RowBox[{"\[Psi]", ",", " ", "cell1", ",", " ", "cell2"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Association", "[", 
       RowBox[{"weightsPositive", ",", "unaryWeights"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Association", "[", 
       RowBox[{"weightsNegative", ",", "unaryWeights"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"BinaryNonreflexiveAtoms", "[", "\[Psi]", "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"STerm", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\[Psi]_", ",", "weightsPositive_", ",", " ", "weightsNegative_"}], 
     "}"}], ",", "cell_"}], "]"}], ":=", 
  RowBox[{"RTerm", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\[Psi]", ",", " ", "weightsPositive", ",", " ", "weightsNegative"}], 
     "}"}], ",", " ", "cell", ",", " ", "cell"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WTerm", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\[Psi]_", ",", "weightsPositive_", ",", " ", "weightsNegative_"}], 
     "}"}], ",", "cell_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"WeightedModels", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FormulaReflexive", "[", "\[Psi]", "]"}], "\[And]", " ", 
     RowBox[{"InterpretationToFormula", "[", "cell", "]"}]}], ",", 
    "\[IndentingNewLine]", "weightsPositive", ",", " ", "weightsNegative", 
    ",", "\[IndentingNewLine]", 
    RowBox[{"UnaryAndReflexiveAtoms", "[", "\[Psi]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"STerms", "[", 
   RowBox[{"{", 
    RowBox[{
    "\[Psi]_", ",", " ", "weightsPositive_", ",", " ", "weightsNegative_"}], 
    "}"}], "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"cell", "\[Function]", 
     RowBox[{"STerm", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\[Psi]", ",", " ", "weightsPositive", ",", " ", "weightsNegative"}], 
        "}"}], ",", " ", "cell"}], "]"}]}], ")"}], " ", "/@", " ", 
   RowBox[{
   "FormulaCellsValid", "[", "\[Psi]", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WTerms", "[", 
   RowBox[{"{", 
    RowBox[{
    "\[Psi]_", ",", " ", "weightsPositive_", ",", " ", "weightsNegative_"}], 
    "}"}], "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"cell", "\[Function]", 
     RowBox[{"WTerm", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\[Psi]", ",", " ", "weightsPositive", ",", " ", "weightsNegative"}], 
        "}"}], ",", " ", "cell"}], "]"}]}], ")"}], " ", "/@", " ", 
   RowBox[{
   "FormulaCellsValid", "[", "\[Psi]", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RTerms", "[", 
   RowBox[{"{", 
    RowBox[{
    "\[Psi]_", ",", " ", "weightsPositive_", ",", " ", "weightsNegative_"}], 
    "}"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"cells", " ", "=", " ", 
       RowBox[{"FormulaCellsValid", "[", "\[Psi]", "]"}]}], ",", 
      "\[IndentingNewLine]", "length"}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"length", " ", "=", " ", 
      RowBox[{"Length", "[", "cells", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"row", " ", "\[Function]", 
        RowBox[{"PadRight", "[", 
         RowBox[{"row", ",", " ", "length"}], "]"}]}], ")"}], " ", "/@", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"RTerm", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\[Psi]", ",", " ", "weightsPositive", ",", "weightsNegative"}], 
           "}"}], ",", 
          RowBox[{
          "cells", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
          ",", " ", 
          RowBox[{
          "cells", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "1", ",", " ", "length"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", " ", "1", ",", " ", 
          RowBox[{"i", "-", "1"}]}], "}"}]}], "\[IndentingNewLine]", 
       "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RTermsFull", "[", 
   RowBox[{"{", 
    RowBox[{
    "\[Psi]_", ",", " ", "weightsPositive_", ",", " ", "weightsNegative_"}], 
    "}"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"cells", " ", "=", " ", 
       RowBox[{"FormulaCellsValid", "[", "\[Psi]", "]"}]}], ",", " ", 
      "length"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"length", " ", "=", " ", 
      RowBox[{"Length", "[", "cells", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"row", " ", "\[Function]", 
        RowBox[{"PadRight", "[", 
         RowBox[{"row", ",", " ", "length"}], "]"}]}], ")"}], " ", "/@", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"RTerm", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\[Psi]", ",", " ", "weightsPositive", ",", "weightsNegative"}], 
           "}"}], ",", 
          RowBox[{
          "cells", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
          ",", " ", 
          RowBox[{
          "cells", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "1", ",", " ", "length"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", " ", "1", ",", " ", "length"}], "}"}]}], 
       "\[IndentingNewLine]", "]"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SWR", "[", "property_", "]"}], " ", ":=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"STerms", "[", "property", "]"}], ",", 
    RowBox[{"WTerms", "[", "property", "]"}], ",", 
    RowBox[{"RTermsFull", "[", "property", "]"}]}], " ", 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SRMat", "[", 
   RowBox[{"s_", ",", "r_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"DiagonalMatrix", "[", "s", "]"}], "+", "r", "+", 
   RowBox[{"Transpose", "[", "r", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CompatibilityCondition1", "[", 
   RowBox[{"i_Integer", ",", "cliquePart_List", ",", "s_"}], "]"}], ":=", 
  RowBox[{"AllTrue", "[", 
   RowBox[{"cliquePart", ",", 
    RowBox[{"j", "\[Function]", 
     RowBox[{
      RowBox[{"s", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], "===", 
      RowBox[{
      "s", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CompatibilityCondition2", "[", 
   RowBox[{"i_Integer", ",", "cliquePart_List", ",", "w_"}], "]"}], ":=", 
  RowBox[{"AllTrue", "[", 
   RowBox[{"cliquePart", ",", 
    RowBox[{"j", "\[Function]", 
     RowBox[{
      RowBox[{"w", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], "===", 
      RowBox[{
      "w", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CompatibilityCondition3", "[", 
   RowBox[{"i_Integer", ",", "cliquePart_List", ",", "r_"}], "]"}], ":=", 
  RowBox[{"AllTrue", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Tuples", "[", 
     RowBox[{"{", 
      RowBox[{"cliquePart", ",", 
       RowBox[{"Complement", "[", 
        RowBox[{
         RowBox[{"Range", "@", 
          RowBox[{"Length", "[", "r", "]"}]}], ",", " ", "cliquePart"}], 
        "]"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Replace", "[", 
      RowBox[{"#", ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"j_", ",", "k_"}], "}"}], "\[RuleDelayed]", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"j", "<", "k"}], "\[And]", " ", 
           RowBox[{"i", "!=", " ", "j"}]}], ")"}], "\[Implies]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"r", "\[LeftDoubleBracket]", 
            RowBox[{"i", ",", "k"}], "\[RightDoubleBracket]"}], "===", 
           RowBox[{"r", "\[LeftDoubleBracket]", 
            RowBox[{"j", ",", "k"}], "\[RightDoubleBracket]"}]}], ")"}]}]}]}],
       "]"}], "&"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{"CompatibilityCondition4", "[", 
    RowBox[{"i_Integer", ",", "cliquePart_List", ",", "r_"}], "]"}], ":=", 
   RowBox[{"AllTrue", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Tuples", "[", 
      RowBox[{"{", 
       RowBox[{"cliquePart", ",", "cliquePart", ",", " ", "cliquePart"}], 
       "}"}], "]"}], ",", "\[IndentingNewLine]", " ", 
     RowBox[{
      RowBox[{"Replace", "[", 
       RowBox[{"#", ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"j_", ",", "k_", ",", "l_"}], "}"}], "\[RuleDelayed]", " ", 
         
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"i", "<", "j"}], "\[And]", 
            RowBox[{"k", "<", "l"}]}], ")"}], "\[Implies]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"r", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "===", 
            RowBox[{"r", "\[LeftDoubleBracket]", 
             RowBox[{"k", ",", "l"}], "\[RightDoubleBracket]"}]}], 
           ")"}]}]}]}], "]"}], "&"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Compatible", "[", 
     RowBox[{"i_Integer", ",", " ", "cliquePart_List", ",", " ", 
      RowBox[{"{", 
       RowBox[{"s_", ",", "w_", ",", "r_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"all", "=", 
         RowBox[{"Range", "@", 
          RowBox[{"Length", "[", "s", "]"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"cond3", "=", " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"j_", ",", "k_"}], "}"}], "\[RuleDelayed]", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"j", "<", "k"}], "\[And]", " ", 
             RowBox[{"i", "!=", " ", "j"}]}], ")"}], "\[Implies]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"r", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "k"}], "\[RightDoubleBracket]"}], "===", 
             RowBox[{"r", "\[LeftDoubleBracket]", 
              RowBox[{"j", ",", "k"}], "\[RightDoubleBracket]"}]}], 
            ")"}]}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"cond4", "=", " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"j_", ",", "k_", ",", "l_"}], "}"}], "\[RuleDelayed]", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"i", "<", "j"}], "\[And]", 
             RowBox[{"k", "<", "l"}]}], ")"}], "\[Implies]", " ", 
           RowBox[{
            RowBox[{"r", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "===", 
            RowBox[{"r", "\[LeftDoubleBracket]", 
             RowBox[{"k", ",", "l"}], "\[RightDoubleBracket]"}]}]}]}]}]}], 
       "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"And", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AllTrue", "[", 
         RowBox[{"cliquePart", ",", 
          RowBox[{"j", "\[Function]", 
           RowBox[{
            RowBox[{
            "s", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], "===", 
            RowBox[{
            "s", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}]}]}],
          "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"AllTrue", "[", 
         RowBox[{"cliquePart", ",", 
          RowBox[{"j", "\[Function]", 
           RowBox[{
            RowBox[{
            "w", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], "===", 
            RowBox[{
            "w", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}]}]}],
          "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"And", "@@", 
          RowBox[{"Tuples", "[", 
           RowBox[{"{", 
            RowBox[{"cliquePart", ",", 
             RowBox[{"Complement", "[", 
              RowBox[{"all", ",", " ", "cliquePart"}], "]"}]}], "}"}], 
           "]"}]}], "/.", "cond3"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"And", "@@", 
          RowBox[{"Tuples", "[", 
           RowBox[{"{", 
            RowBox[{
            "cliquePart", ",", " ", "cliquePart", ",", " ", "cliquePart"}], 
            "}"}], "]"}]}], "/.", "cond4"}]}], "\[IndentingNewLine]", "]"}]}],
      "\[IndentingNewLine]", "]"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SRratio", "[", 
   RowBox[{"s_", ",", "r_", ",", " ", 
    RowBox[{"{", 
     RowBox[{"c1_", ",", "c2_", ",", " ", "rest___"}], "}"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  FractionBox[
   RowBox[{"s", "[", 
    RowBox[{"[", "c1", "]"}], "]"}], 
   RowBox[{"r", "[", 
    RowBox[{"[", 
     RowBox[{"c2", ",", "c1"}], "]"}], "]"}]]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Compatible", "[", 
   RowBox[{"i_Integer", ",", " ", "cliquePart_List", ",", " ", 
    RowBox[{"{", 
     RowBox[{"s_", ",", "w_", ",", "r_"}], "}"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"CompatibilityCondition1", "[", 
    RowBox[{"i", ",", "cliquePart", ",", "s"}], "]"}], "\[And]", " ", 
   "\[IndentingNewLine]", 
   RowBox[{"CompatibilityCondition2", "[", 
    RowBox[{"i", ",", "cliquePart", ",", "w"}], "]"}], "\[And]", 
   "\[IndentingNewLine]", 
   RowBox[{"CompatibilityCondition3", "[", 
    RowBox[{"i", ",", "cliquePart", ",", "r"}], "]"}], "\[And]", 
   "\[IndentingNewLine]", 
   RowBox[{"CompatibilityCondition4", "[", 
    RowBox[{"i", ",", "cliquePart", ",", "r"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Cliques", "[", 
   RowBox[{"{", 
    RowBox[{"s_", ",", "w_", ",", "r_"}], "}"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i", ",", " ", "j", ",", " ", 
      RowBox[{"cliques", "=", 
       RowBox[{"{", "}"}]}], ",", " ", 
      RowBox[{"length", " ", "=", " ", 
       RowBox[{"Length", "[", "s", "]"}]}], ",", "current", ",", " ", "all"}],
      "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"all", " ", "=", " ", 
      RowBox[{"Range", "[", "length", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "all", "]"}], ">", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"current", " ", "=", " ", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"cell", "\[Function]", " ", 
           RowBox[{"If", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Compatible", "[", 
              RowBox[{"cell", ",", " ", "current", ",", " ", 
               RowBox[{"{", 
                RowBox[{"s", ",", "w", ",", "r"}], "}"}]}], "]"}], " ", ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"AppendTo", "[", 
               RowBox[{"current", ",", " ", "cell"}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"all", " ", "=", " ", 
               RowBox[{"all", " ", "/.", " ", 
                RowBox[{"cell", " ", "\[Rule]", " ", "Nothing"}]}]}], ";"}]}],
             "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", ")"}], 
         " ", "/@", " ", "all"}], ";", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"cliques", ",", " ", "current"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "cliques"}]}],
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExtractClique", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"s_", ",", "w_", ",", "r_"}], "}"}], ",", "clique_List"}], 
    "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"s", "[", 
      RowBox[{"[", "clique", "]"}], "]"}], ",", " ", 
     RowBox[{"w", "[", 
      RowBox[{"[", "clique", "]"}], "]"}], ",", " ", 
     RowBox[{"r", "[", 
      RowBox[{"[", 
       RowBox[{"clique", ",", " ", "clique"}], "]"}], "]"}]}], "}"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GetGTerm", "[", 
     RowBox[{"0", ",", " ", "n_Integer", ",", "cliqueIds_List"}], "]"}], ":=",
     " ", 
    RowBox[{
     RowBox[{"GetGTerm", "[", 
      RowBox[{"0", ",", " ", "n", ",", "cliqueIds"}], "]"}], " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"Module", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"i", "\[Function]"}], " ", ")"}], " ", "/@", " ", 
         RowBox[{"Range", "[", 
          RowBox[{"1", ",", "k"}], "]"}]}], "\[IndentingNewLine]", "]"}], 
       "\[IndentingNewLine]", 
       RowBox[{"GetGTerm", "[", 
        RowBox[{"p_Integer", ",", " ", "n_Integer", ",", "cliqueIds_List"}], 
        "]"}]}], ":=", " ", 
      RowBox[{
       RowBox[{"GetGTerm", "[", 
        RowBox[{"p", ",", " ", "n", ",", "cliqueIds"}], "]"}], " ", "=", " ", 
       
       RowBox[{"Module", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"s", "=", "0"}], "}"}], ","}], "\[IndentingNewLine]", 
        "]"}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"TODO", " ", "-", " ", "memoization"}], " ", 
   "*)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.826691908173477*^9, 3.826691923275236*^9}, {
   3.8266943734494*^9, 3.826694384949321*^9}, {3.826696719597742*^9, 
   3.826696741314296*^9}, {3.826696887890477*^9, 3.826696890586649*^9}, {
   3.826698545236833*^9, 3.82669854743611*^9}, {3.8266989941890793`*^9, 
   3.826699042378667*^9}, {3.826699112856061*^9, 3.826699123718796*^9}, {
   3.82669940165061*^9, 3.826699419960739*^9}, {3.826699598801098*^9, 
   3.826699632078167*^9}, {3.8266996655265017`*^9, 3.826699720825424*^9}, {
   3.826699786981991*^9, 3.826699813892815*^9}, {3.826699879796061*^9, 
   3.826699883905335*^9}, {3.8266999194673777`*^9, 3.826699933158588*^9}, 
   3.826699969104002*^9, {3.826700012274729*^9, 3.826700043681284*^9}, {
   3.826700086880082*^9, 3.826700150171782*^9}, {3.826700225590479*^9, 
   3.826700333466172*^9}, {3.8267003641925297`*^9, 3.826700408846528*^9}, {
   3.826700444903625*^9, 3.826700449460507*^9}, {3.8267005340590563`*^9, 
   3.826700568662376*^9}, {3.826700766822391*^9, 3.826700795346916*^9}, {
   3.8267010424257193`*^9, 3.826701045861957*^9}, {3.8267012253125687`*^9, 
   3.826701246347601*^9}, {3.826701284937923*^9, 3.826701427354864*^9}, {
   3.826701463580579*^9, 3.826701471848776*^9}, {3.8267018740990057`*^9, 
   3.826701917416954*^9}, 3.826702283191683*^9, {3.826705194988215*^9, 
   3.826705337877451*^9}, {3.8267053814033117`*^9, 3.826705404970828*^9}, {
   3.826705442371807*^9, 3.826705464311863*^9}, {3.82670553421457*^9, 
   3.826705573762063*^9}, {3.826705692294456*^9, 3.826705894606629*^9}, {
   3.826706740393756*^9, 3.8267067571069717`*^9}, {3.8267068413362913`*^9, 
   3.8267069970710087`*^9}, {3.826707033722508*^9, 3.8267070366287813`*^9}, {
   3.826709236360263*^9, 3.8267092488614683`*^9}, {3.826709840693407*^9, 
   3.826709919313323*^9}, {3.826710353655128*^9, 3.826710358971368*^9}, {
   3.826710446022162*^9, 3.826710454829954*^9}, {3.826710528785511*^9, 
   3.826710552908914*^9}, {3.826711140107106*^9, 3.826711141034778*^9}, {
   3.826770141889476*^9, 3.826770147009123*^9}, {3.826770465766946*^9, 
   3.826770583510621*^9}, {3.826770684871632*^9, 3.826770702422164*^9}, {
   3.826770853485091*^9, 3.826770931323544*^9}, {3.8267709849139338`*^9, 
   3.826771003352418*^9}, {3.82677107493321*^9, 3.826771154186501*^9}, {
   3.826771190888564*^9, 3.8267712068558197`*^9}, {3.826772324555181*^9, 
   3.826772352986643*^9}, {3.8267724847155113`*^9, 3.826772491503093*^9}, {
   3.826772532967822*^9, 3.826772591075437*^9}, {3.826772779313925*^9, 
   3.8267727818571167`*^9}, {3.826772819333974*^9, 3.826772911132647*^9}, {
   3.826772999117989*^9, 3.826773025234232*^9}, {3.8267731298730307`*^9, 
   3.8267731410045633`*^9}, 3.82677340296294*^9, {3.8267734611022253`*^9, 
   3.826773487118004*^9}, {3.826773774201734*^9, 3.826773776430725*^9}, {
   3.826773915864647*^9, 3.826773954867942*^9}, {3.826774019441201*^9, 
   3.8267740362696047`*^9}, {3.826774075764183*^9, 3.8267742614049807`*^9}, {
   3.826774297889739*^9, 3.826774319116613*^9}, {3.826774375630319*^9, 
   3.826774547985279*^9}, {3.8267745976747923`*^9, 3.8267746369191236`*^9}, {
   3.8267746952389174`*^9, 3.826774717378902*^9}, {3.826776432780423*^9, 
   3.826776511622465*^9}, {3.826777602795004*^9, 3.826777629127974*^9}, {
   3.826778605190192*^9, 3.8267786290803833`*^9}, {3.826778665013783*^9, 
   3.826778863719534*^9}, {3.826779048235779*^9, 3.826779057911319*^9}, {
   3.826779251029684*^9, 3.826779287002925*^9}, {3.826779343329282*^9, 
   3.826779357336011*^9}, {3.826779431518835*^9, 3.8267794511221933`*^9}, {
   3.826780141591258*^9, 3.826780149126049*^9}, {3.826780206185391*^9, 
   3.82678020703806*^9}, {3.8267808097394133`*^9, 3.8267808098912582`*^9}, {
   3.82678139198076*^9, 3.8267813922233887`*^9}, {3.826781444096285*^9, 
   3.826781444232154*^9}, {3.826797198806508*^9, 3.826797243076335*^9}, {
   3.8267973019466677`*^9, 3.826797389530806*^9}, {3.826797814909292*^9, 
   3.826797999365364*^9}, {3.826798110502787*^9, 3.826798276387518*^9}, {
   3.82679849770181*^9, 3.8267984990031843`*^9}, 3.826799113849916*^9, {
   3.826799370299933*^9, 3.826799423792611*^9}, {3.82679946759827*^9, 
   3.826799639354917*^9}, {3.82679979565377*^9, 3.826799814261026*^9}, {
   3.826800043313301*^9, 3.826800068607938*^9}, {3.8268001037298822`*^9, 
   3.8268003503377037`*^9}, {3.826800392231367*^9, 3.826800397919237*^9}, {
   3.826801380495721*^9, 3.826801382343668*^9}, {3.826801893974278*^9, 
   3.8268019177732153`*^9}, {3.826802102011656*^9, 3.826802342928423*^9}, {
   3.826802373332333*^9, 3.8268023960322943`*^9}, {3.826802458834202*^9, 
   3.826802541404107*^9}, {3.827296223325539*^9, 3.827296225605289*^9}, {
   3.827296263986578*^9, 3.827296291465073*^9}, {3.827296332863793*^9, 
   3.827296353125709*^9}, {3.8272976190386257`*^9, 3.8272976326292343`*^9}, {
   3.827298035763824*^9, 3.827298067790472*^9}, {3.827298117709277*^9, 
   3.8272981384407578`*^9}, 3.827300239749887*^9, {3.827301154141986*^9, 
   3.827301239976479*^9}, {3.827301828810267*^9, 3.827301861393035*^9}, {
   3.827301892239365*^9, 3.8273019997861423`*^9}, {3.827302031544429*^9, 
   3.827302255543271*^9}, {3.827302304523499*^9, 3.827302321580572*^9}, {
   3.82730248286719*^9, 3.8273025455406637`*^9}, {3.827302608101035*^9, 
   3.827302617630672*^9}, {3.827465227052306*^9, 3.8274652357712183`*^9}, {
   3.827465453730818*^9, 3.8274654953603287`*^9}, {3.827466585441311*^9, 
   3.827466614087874*^9}, {3.827467552881259*^9, 3.827467558249358*^9}, {
   3.827467610911867*^9, 3.827467618280074*^9}, {3.8274676677975388`*^9, 
   3.827467701754944*^9}, {3.827471543491213*^9, 3.8274715488008966`*^9}, {
   3.836278108933132*^9, 3.836278114187827*^9}, {3.8362819426280737`*^9, 
   3.83628195502315*^9}, {3.8364496937759247`*^9, 3.836449711676116*^9}, {
   3.836456651041934*^9, 3.836456655832328*^9}, {3.838100534554991*^9, 
   3.838100605720351*^9}, 3.838101269334474*^9, {3.8381020227796707`*^9, 
   3.838102023306238*^9}, {3.838102168928934*^9, 3.838102370223971*^9}, {
   3.8381080347049103`*^9, 3.8381080661841497`*^9}, {3.838111708903923*^9, 
   3.8381117597921257`*^9}, {3.838122424492795*^9, 3.8381224247200613`*^9}, {
   3.838122515320002*^9, 3.838122540114081*^9}, {3.8381225771795473`*^9, 
   3.838122605654173*^9}, {3.83812343625648*^9, 3.838123437520603*^9}, {
   3.838123516788821*^9, 3.8381235187720137`*^9}, {3.838184360478383*^9, 
   3.8381844836167383`*^9}, {3.838184578091997*^9, 3.838184579179769*^9}, {
   3.8381886954017773`*^9, 3.838188725654476*^9}, {3.8381892313484917`*^9, 
   3.83818923159582*^9}, {3.838189276202713*^9, 3.838189280298307*^9}, {
   3.838190002261059*^9, 3.8381900353954973`*^9}, {3.838190120096134*^9, 
   3.838190132071341*^9}, {3.8381914350321217`*^9, 3.838191444540365*^9}, 
   3.838191526761639*^9, {3.838191587309626*^9, 3.8381916119806223`*^9}, {
   3.838191686560042*^9, 3.838191705175729*^9}, {3.838191747236854*^9, 
   3.838191862416596*^9}, {3.83819192810434*^9, 3.838191947260088*^9}, {
   3.8381919846209707`*^9, 3.838191985994561*^9}, {3.8381935988945427`*^9, 
   3.838193662655756*^9}, {3.83819509839776*^9, 3.8381951039734993`*^9}, {
   3.838197016459901*^9, 3.838197033220586*^9}, {3.8381970764112387`*^9, 
   3.838197083408684*^9}, {3.8381974671047773`*^9, 3.8381974712206573`*^9}, {
   3.8381975070272217`*^9, 3.838197533530995*^9}, {3.838354421593877*^9, 
   3.838354428516543*^9}, {3.838354495013659*^9, 3.838354500591889*^9}, {
   3.8387000014189177`*^9, 3.838700040586*^9}, {3.838884462753167*^9, 
   3.838884488264164*^9}, {3.8388846579365187`*^9, 3.838884718858076*^9}, {
   3.838886576521461*^9, 3.838886581895876*^9}, {3.838957099851025*^9, 
   3.83895711017019*^9}, {3.839924546896613*^9, 3.8399245696914377`*^9}, {
   3.839925433256225*^9, 3.8399254333940477`*^9}, {3.839925587260982*^9, 
   3.839925614183669*^9}, {3.839925999640648*^9, 3.839926000328596*^9}, {
   3.8399268152486153`*^9, 3.839926860177307*^9}, {3.839926995151889*^9, 
   3.8399270005958967`*^9}, {3.839927260900875*^9, 3.8399272923240757`*^9}, {
   3.839927344265706*^9, 3.8399273741193647`*^9}, {3.839927449932732*^9, 
   3.8399274620131207`*^9}, {3.839927497146934*^9, 3.839927671803705*^9}, {
   3.8399277079784937`*^9, 3.839927717916993*^9}, {3.839927770987331*^9, 
   3.839927896064042*^9}, {3.8399899620051928`*^9, 3.839989972656386*^9}, {
   3.839990069061261*^9, 3.839990158472969*^9}, {3.839990210906145*^9, 
   3.839990252681596*^9}, {3.83999074064861*^9, 3.8399907829938374`*^9}, {
   3.8399913126625347`*^9, 3.83999141226851*^9}, {3.839991715545762*^9, 
   3.8399917671669827`*^9}, 3.839994682243854*^9, {3.83999493691151*^9, 
   3.839994957468689*^9}, {3.83999502067029*^9, 3.839995029328231*^9}, 
   3.840005796651864*^9, 3.840080508257257*^9, {3.840080577050498*^9, 
   3.8400805811687193`*^9}, {3.8400809423971233`*^9, 3.840080955248723*^9}, {
   3.841724898116145*^9, 3.8417249126844063`*^9}, {3.841725071815797*^9, 
   3.841725075548442*^9}, {3.84197990135568*^9, 3.841979951554397*^9}, {
   3.84206825682718*^9, 3.84206825862787*^9}, {3.842070142177874*^9, 
   3.8420701477547207`*^9}, {3.842071263582336*^9, 3.842071286653947*^9}, {
   3.842073232353438*^9, 3.842073243320953*^9}, {3.8420775307077703`*^9, 
   3.8420775639714327`*^9}, {3.842077600016333*^9, 3.842077614458185*^9}, {
   3.842077649138726*^9, 3.842077674271883*^9}, 3.842077760616824*^9, {
   3.842077837638926*^9, 3.842077848947378*^9}, {3.842077958257687*^9, 
   3.842077972677231*^9}, {3.84208689123807*^9, 3.842086910970099*^9}, {
   3.842087081921216*^9, 3.842087128843708*^9}, {3.842087163603962*^9, 
   3.842087184719132*^9}, {3.842087408435212*^9, 3.842087410904152*^9}, {
   3.842087442897276*^9, 3.842087456184155*^9}, {3.84208752832938*^9, 
   3.8420876970659323`*^9}, {3.842087760070369*^9, 3.842087765956793*^9}, {
   3.842087878743634*^9, 3.8420878868211718`*^9}, {3.84208791850214*^9, 
   3.842087924860622*^9}, {3.842089078568522*^9, 3.84208915386769*^9}, {
   3.842256336987688*^9, 3.842256341628521*^9}, {3.842493671844802*^9, 
   3.842493677032359*^9}, {3.842497514200756*^9, 3.8424975289840508`*^9}, {
   3.842602636406027*^9, 3.8426026592537203`*^9}, {3.842677796713739*^9, 
   3.842677806759116*^9}, {3.8426786588852663`*^9, 3.842678700073963*^9}, {
   3.8426787495118847`*^9, 3.84267879317968*^9}, {3.842678894440647*^9, 
   3.842678938342349*^9}, {3.842678984527708*^9, 3.842679002250808*^9}, {
   3.8426790459048862`*^9, 3.8426790851519947`*^9}, {3.842691255531337*^9, 
   3.842691257806942*^9}, {3.8426913362896233`*^9, 3.8426913560579157`*^9}, {
   3.842931609498891*^9, 3.8429316167512913`*^9}, 3.842932960274722*^9, {
   3.843023168171145*^9, 3.843023176490438*^9}, {3.843024235659808*^9, 
   3.843024239552055*^9}, {3.843030745256369*^9, 3.843030758215242*^9}, {
   3.8430308163570747`*^9, 3.8430308927281847`*^9}, {3.843031797307029*^9, 
   3.8430317997062263`*^9}, {3.843033842329843*^9, 3.8430338505250607`*^9}, {
   3.8430339568215322`*^9, 3.843034141707782*^9}, {3.843034355593574*^9, 
   3.843034362438611*^9}, {3.843034637627597*^9, 3.84303463913725*^9}, {
   3.8430347492594957`*^9, 3.843034872572866*^9}, {3.8430349142023287`*^9, 
   3.843034953216464*^9}, {3.84303504004652*^9, 3.843035088362002*^9}, {
   3.843035124786152*^9, 3.84303513777003*^9}, {3.843035170209634*^9, 
   3.843035233135317*^9}, {3.843035298679887*^9, 3.843035304007552*^9}, {
   3.843035334918089*^9, 3.84303537257972*^9}, {3.843037627368753*^9, 
   3.8430376359234543`*^9}, {3.843105096699276*^9, 3.843105210835134*^9}, 
   3.843105324833179*^9, {3.843120649688952*^9, 3.8431206596261463`*^9}, {
   3.843204698118567*^9, 3.843204720519299*^9}, {3.843542430071013*^9, 
   3.843542622124868*^9}, {3.843543768930314*^9, 3.843543849078364*^9}, {
   3.8435441930119247`*^9, 3.843544260169079*^9}, {3.8435444098879766`*^9, 
   3.843544542369069*^9}, {3.8435446924252453`*^9, 3.843544693889188*^9}, {
   3.843545144937175*^9, 3.84354516294597*^9}, {3.843545253548407*^9, 
   3.843545261873849*^9}, {3.843545339092008*^9, 3.8435453393841047`*^9}, {
   3.843545379351143*^9, 3.8435453966545477`*^9}, {3.843545948849144*^9, 
   3.843546054603691*^9}, {3.8435461068890533`*^9, 3.843546151898247*^9}, {
   3.843547937234488*^9, 3.843547985002557*^9}, {3.845798590553437*^9, 
   3.8457986116356153`*^9}, {3.8458009018720713`*^9, 3.84580090976023*^9}, {
   3.847202169590519*^9, 3.847202173149824*^9}, {3.847320851535874*^9, 
   3.847320887904624*^9}, {3.847320958655612*^9, 3.847320976942315*^9}, {
   3.848679647346079*^9, 3.848679648270583*^9}},
 CellLabel->
  "In[151]:=",ExpressionUUID->"bd4dac13-24d5-43d7-ae76-3f67079096f2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"exampleDerangements", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Not]", 
         RowBox[{"f", "[", 
          RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}]}], " ", "\[And]", 
        " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Implies]", 
          RowBox[{"s1", "[", "\[FormalA]", "]"}]}], ")"}], "\[And]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}], "\[Implies]", 
          RowBox[{"s2", "[", "\[FormalA]", "]"}]}], ")"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{
         RowBox[{"f", "\[Rule]", "\[FormalZ]"}], ",", 
         RowBox[{"s1", "\[Rule]", "1"}], ",", 
         RowBox[{"s2", "\[Rule]", "1"}]}], "\[RightAssociation]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{
         RowBox[{"f", "\[Rule]", "1"}], ",", 
         RowBox[{"s1", "\[Rule]", 
          RowBox[{"-", "1"}]}], ",", 
         RowBox[{"s2", "\[Rule]", 
          RowBox[{"-", "1"}]}]}], "\[RightAssociation]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"examplePermutations", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Implies]", 
          RowBox[{"s1", "[", "\[FormalA]", "]"}]}], ")"}], "\[And]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}], "\[Implies]", 
          RowBox[{"s2", "[", "\[FormalA]", "]"}]}], ")"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{
         RowBox[{"f", "\[Rule]", "\[FormalZ]"}], ",", 
         RowBox[{"s1", "\[Rule]", "1"}], ",", 
         RowBox[{"s2", "\[Rule]", "1"}]}], "\[RightAssociation]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{
         RowBox[{"f", "\[Rule]", "1"}], ",", 
         RowBox[{"s1", "\[Rule]", 
          RowBox[{"-", "1"}]}], ",", 
         RowBox[{"s2", "\[Rule]", 
          RowBox[{"-", "1"}]}]}], "\[RightAssociation]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"exampleFunctions", " ", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Implies]", 
        RowBox[{"s1", "[", "\[FormalA]", "]"}]}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"\[LeftAssociation]", 
        RowBox[{
         RowBox[{"f", "\[Rule]", "\[FormalZ]"}], ",", 
         RowBox[{"s1", "\[Rule]", "1"}]}], "\[RightAssociation]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{
         RowBox[{"f", "\[Rule]", "1"}], ",", 
         RowBox[{"s1", "\[Rule]", 
          RowBox[{"-", "1"}]}]}], "\[RightAssociation]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"exampleInvolutions", " ", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Implies]", 
          RowBox[{"s1", "[", "\[FormalA]", "]"}]}], ")"}], "\[And]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Implies]", 
          RowBox[{"f", "[", 
           RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}]}], ")"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{
         RowBox[{"f", "\[Rule]", "\[FormalZ]"}], ",", 
         RowBox[{"s1", "\[Rule]", "1"}]}], "\[RightAssociation]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{
         RowBox[{"f", "\[Rule]", "1"}], ",", 
         RowBox[{"s1", "\[Rule]", 
          RowBox[{"-", "1"}]}]}], "\[RightAssociation]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"example1Regularity", " ", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Not]", 
         RowBox[{"f", "[", 
          RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}]}], " ", "\[And]", 
        " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Implies]", 
          RowBox[{"s1", "[", "\[FormalA]", "]"}]}], ")"}], "\[And]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}], "\[Implies]", 
          RowBox[{"s2", "[", "\[FormalA]", "]"}]}], ")"}], "\[And]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Implies]", 
          RowBox[{"f", "[", 
           RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}]}], ")"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{
         RowBox[{"f", "\[Rule]", "\[FormalZ]"}], ",", 
         RowBox[{"s1", "\[Rule]", "1"}], ",", 
         RowBox[{"s2", "\[Rule]", "1"}]}], "\[RightAssociation]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{
         RowBox[{"f", "\[Rule]", "1"}], ",", 
         RowBox[{"s1", "\[Rule]", 
          RowBox[{"-", "1"}]}], ",", 
         RowBox[{"s2", "\[Rule]", 
          RowBox[{"-", "1"}]}]}], "\[RightAssociation]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"example2Regularity", " ", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Not]", 
         RowBox[{"e", "[", 
          RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}]}], "\[And]", 
        "\[IndentingNewLine]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"e", "[", 
           RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Equivalent]", 
          
          RowBox[{"e", "[", 
           RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}]}], ")"}], 
        "\[And]", "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"f1", "[", 
           RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Implies]", 
          RowBox[{"s1", "[", "\[FormalA]", "]"}]}], ")"}], "\[And]", 
        "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"f2", "[", 
           RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Implies]", 
          RowBox[{"s2", "[", "\[FormalA]", "]"}]}], ")"}], "\[And]", 
        "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"e", "[", 
           RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Equivalent]", 
          
          RowBox[{"(", 
           RowBox[{
            RowBox[{"f1", "[", 
             RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Or]", 
            RowBox[{"f2", "[", 
             RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}]}], ")"}]}], 
         ")"}], "\[And]", " ", "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Not]", 
           RowBox[{"f1", "[", 
            RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}]}], "\[Or]", 
          RowBox[{"\[Not]", 
           RowBox[{"f2", "[", 
            RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}]}]}], ")"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{
         RowBox[{"e", "\[Rule]", "\[FormalZ]"}], ",", 
         RowBox[{"s1", "\[Rule]", "1"}], ",", 
         RowBox[{"s2", "\[Rule]", "1"}], ",", 
         RowBox[{"f1", "\[Rule]", "1"}], ",", 
         RowBox[{"f2", "\[Rule]", "1"}]}], "\[RightAssociation]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{
         RowBox[{"e", "\[Rule]", "1"}], ",", 
         RowBox[{"s1", "\[Rule]", 
          RowBox[{"-", "1"}]}], ",", 
         RowBox[{"s2", "\[Rule]", 
          RowBox[{"-", "1"}]}], ",", 
         RowBox[{"f1", "\[Rule]", "1"}], ",", 
         RowBox[{"f2", "\[Rule]", "1"}]}], "\[RightAssociation]"}]}], 
      "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"example3Regularity", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Not]", 
         RowBox[{"e", "[", 
          RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}]}], "\[And]", 
        "\[IndentingNewLine]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"e", "[", 
           RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Implies]", 
          RowBox[{"e", "[", 
           RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}]}], ")"}], 
        "\[And]", "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"f1", "[", 
           RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Implies]", 
          RowBox[{"s1", "[", "\[FormalA]", "]"}]}], ")"}], "\[And]", 
        "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"f2", "[", 
           RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Implies]", 
          RowBox[{"s2", "[", "\[FormalA]", "]"}]}], ")"}], "\[And]", 
        "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"f3", "[", 
           RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Implies]", 
          RowBox[{"s3", "[", "\[FormalA]", "]"}]}], ")"}], "\[And]", 
        "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"e", "[", 
           RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Equivalent]", 
          
          RowBox[{"(", 
           RowBox[{
            RowBox[{"f1", "[", 
             RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Or]", 
            RowBox[{"f2", "[", 
             RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Or]", 
            RowBox[{"f3", "[", 
             RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}]}], ")"}]}], 
         ")"}], "\[And]", "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Not]", 
           RowBox[{"f1", "[", 
            RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}]}], "\[Or]", 
          RowBox[{"\[Not]", 
           RowBox[{"f2", "[", 
            RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}]}]}], ")"}], 
        "\[And]", "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Not]", 
           RowBox[{"f1", "[", 
            RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}]}], "\[Or]", 
          RowBox[{"\[Not]", 
           RowBox[{"f3", "[", 
            RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}]}]}], ")"}], 
        "\[And]", "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Not]", 
           RowBox[{"f2", "[", 
            RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}]}], "\[Or]", 
          RowBox[{"\[Not]", 
           RowBox[{"f3", "[", 
            RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}]}]}], ")"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{
         RowBox[{"e", "\[Rule]", "\[FormalZ]"}], ",", 
         RowBox[{"s1", "\[Rule]", "1"}], ",", 
         RowBox[{"s2", "\[Rule]", "1"}], ",", 
         RowBox[{"s3", "\[Rule]", "1"}], ",", 
         RowBox[{"f1", "\[Rule]", "1"}], ",", 
         RowBox[{"f2", "\[Rule]", "1"}], ",", 
         RowBox[{"f3", "\[Rule]", "1"}]}], "\[RightAssociation]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{
         RowBox[{"e", "\[Rule]", "1"}], ",", 
         RowBox[{"s1", "\[Rule]", 
          RowBox[{"-", "1"}]}], ",", 
         RowBox[{"s2", "\[Rule]", 
          RowBox[{"-", "1"}]}], ",", 
         RowBox[{"s3", "\[Rule]", 
          RowBox[{"-", "1"}]}], ",", 
         RowBox[{"f1", "\[Rule]", "1"}], ",", 
         RowBox[{"f2", "\[Rule]", "1"}], ",", 
         RowBox[{"f3", "\[Rule]", "1"}]}], "\[RightAssociation]"}]}], 
      "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"example3Coloredness", "=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Not]", 
         RowBox[{"e", "[", 
          RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}]}], "\[And]", 
        "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"e", "[", 
           RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Implies]", 
          RowBox[{"e", "[", 
           RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}]}], ")"}], 
        "\[And]", "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c1", "[", "\[FormalA]", "]"}], "\[Or]", 
          RowBox[{"c2", "[", "\[FormalA]", "]"}], "\[Or]", 
          RowBox[{"c3", "[", "\[FormalA]", "]"}]}], ")"}], "\[And]", 
        "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Not]", 
           RowBox[{"c1", "[", "\[FormalA]", "]"}]}], "\[Or]", " ", 
          RowBox[{"\[Not]", 
           RowBox[{"c2", "[", "\[FormalA]", "]"}]}]}], ")"}], "\[And]", 
        "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Not]", 
           RowBox[{"c3", "[", "\[FormalA]", "]"}]}], "\[Or]", " ", 
          RowBox[{"\[Not]", 
           RowBox[{"c2", "[", "\[FormalA]", "]"}]}]}], ")"}], "\[And]", 
        "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Not]", 
           RowBox[{"c1", "[", "\[FormalA]", "]"}]}], "\[Or]", " ", 
          RowBox[{"\[Not]", 
           RowBox[{"c3", "[", "\[FormalA]", "]"}]}]}], ")"}], "\[And]", 
        "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"e", "[", 
           RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Implies]", 
          " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Not]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"c1", "[", "\[FormalA]", "]"}], "\[And]", 
               RowBox[{"c1", "[", "\[FormalB]", "]"}]}], ")"}]}], "\[And]", 
            RowBox[{"\[Not]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"c2", "[", "\[FormalA]", "]"}], "\[And]", 
               RowBox[{"c2", "[", "\[FormalB]", "]"}]}], ")"}]}], "\[And]", 
            RowBox[{"\[Not]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"c3", "[", "\[FormalA]", "]"}], "\[And]", 
               RowBox[{"c3", "[", "\[FormalB]", "]"}]}], ")"}]}]}], ")"}]}], 
         ")"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{
         RowBox[{"e", "\[Rule]", "1"}], ",", 
         RowBox[{"c1", "\[Rule]", "1"}], ",", 
         RowBox[{"c2", "\[Rule]", "1"}], ",", 
         RowBox[{"c3", "\[Rule]", "1"}]}], "\[RightAssociation]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{
         RowBox[{"e", "\[Rule]", "1"}], ",", 
         RowBox[{"c1", "\[Rule]", "1"}], ",", 
         RowBox[{"c2", "\[Rule]", "1"}], ",", 
         RowBox[{"c3", "\[Rule]", "1"}]}], "\[RightAssociation]"}]}], 
      "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"example2Coloredness", "=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Not]", 
         RowBox[{"e", "[", 
          RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}]}], "\[And]", 
        "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"e", "[", 
           RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Implies]", 
          RowBox[{"e", "[", 
           RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}]}], ")"}], 
        "\[And]", "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c1", "[", "\[FormalA]", "]"}], "\[Xor]", " ", 
          RowBox[{"c2", "[", "\[FormalA]", "]"}]}], ")"}], "\[And]", 
        "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"e", "[", 
           RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Implies]", 
          " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Not]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"c1", "[", "\[FormalA]", "]"}], "\[And]", 
               RowBox[{"c1", "[", "\[FormalB]", "]"}]}], ")"}]}], "\[And]", 
            RowBox[{"\[Not]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"c2", "[", "\[FormalA]", "]"}], "\[And]", 
               RowBox[{"c2", "[", "\[FormalB]", "]"}]}], ")"}]}]}], ")"}]}], 
         ")"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{
         RowBox[{"e", "\[Rule]", "1"}], ",", 
         RowBox[{"c1", "\[Rule]", "1"}], ",", 
         RowBox[{"c2", "\[Rule]", "1"}]}], "\[RightAssociation]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{
         RowBox[{"e", "\[Rule]", "1"}], ",", 
         RowBox[{"c1", "\[Rule]", "1"}], ",", 
         RowBox[{"c2", "\[Rule]", "1"}]}], "\[RightAssociation]"}]}], 
      "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"sder", ",", "wder", ",", "rder"}], "}"}], "=", 
     RowBox[{"SWR", "[", "exampleDerangements", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"sfunc", ",", "wfunc", ",", "rfunc"}], "}"}], " ", "=", 
     RowBox[{"SWR", "[", "exampleFunctions", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"sinvol", ",", "winvol", ",", "rinvol"}], "}"}], " ", "=", 
     RowBox[{"SWR", "[", "exampleFunctions", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"s1reg", ",", "w1reg", ",", "r1reg"}], "}"}], " ", "=", " ", 
     RowBox[{"SWR", "[", "example1Regularity", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"s2reg", ",", "w2reg", ",", "r2reg"}], "}"}], " ", "=", " ", 
     RowBox[{"SWR", "[", "example2Regularity", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"s2col", ",", "w2col", ",", "r2col"}], "}"}], " ", "=", " ", 
     RowBox[{"SWR", "[", "example2Coloredness", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"s3col", ",", "w3col", ",", "r3col"}], "}"}], " ", "=", " ", 
     RowBox[{"SWR", "[", "example3Coloredness", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"example", " ", "=", " ", "example2Regularity"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"s", ",", "w", ",", "r"}], "}"}], "=", 
     RowBox[{"SWR", "[", "example", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rfull", "=", 
     RowBox[{"RTermsFull", "[", "example", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"MatrixForm", "[", "r", "]"}], "\[IndentingNewLine]", 
   RowBox[{"MatrixForm", "[", "rfull", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.840005860385851*^9, 3.8400058692333927`*^9}, {
   3.840078754646974*^9, 3.84007878629392*^9}, {3.840080472913*^9, 
   3.8400804806196632`*^9}, {3.8400809661903477`*^9, 3.840080973638291*^9}, {
   3.840268883762092*^9, 3.840269038706477*^9}, {3.8417249311286163`*^9, 
   3.841725021219054*^9}, {3.8417388258742657`*^9, 3.841738833286767*^9}, {
   3.841978769619272*^9, 3.841978778370488*^9}, {3.841978934298024*^9, 
   3.84197898572052*^9}, {3.841979037125477*^9, 3.8419791272095118`*^9}, {
   3.841979174487116*^9, 3.841979417110361*^9}, {3.841979958311084*^9, 
   3.841980028340973*^9}, {3.84198354019487*^9, 3.84198355090236*^9}, {
   3.841983582785203*^9, 3.841983669108244*^9}, {3.841983740346431*^9, 
   3.841983778572781*^9}, {3.842256010832583*^9, 3.84225628978911*^9}, {
   3.8422563858164062`*^9, 3.842256388755805*^9}, {3.842256442569722*^9, 
   3.8422564461291237`*^9}, {3.842256486057455*^9, 3.8422565981606073`*^9}, {
   3.84225663165132*^9, 3.84225663839228*^9}, {3.8424924675410137`*^9, 
   3.842492491560334*^9}, {3.842498802219186*^9, 3.842498831512241*^9}, {
   3.842502004812948*^9, 3.842502033937065*^9}, {3.842504527847623*^9, 
   3.8425045549185057`*^9}, {3.842677626951592*^9, 3.842677631350041*^9}, {
   3.842677685236588*^9, 3.842677688867722*^9}, {3.842684577416483*^9, 
   3.842684582695046*^9}, {3.8426846557097816`*^9, 3.842684655843658*^9}, 
   3.8426849893185253`*^9, 3.84268504396909*^9, 3.842686752578504*^9, {
   3.8426881216748857`*^9, 3.842688123882313*^9}, {3.842688196941394*^9, 
   3.842688241555835*^9}, {3.8429497259752703`*^9, 3.842949734302512*^9}, {
   3.843118794958046*^9, 3.843118798904464*^9}, {3.843119044641137*^9, 
   3.843119055134924*^9}, {3.843119361249031*^9, 3.843119425148756*^9}, {
   3.843120006114753*^9, 3.843120006623542*^9}, {3.843121924472622*^9, 
   3.843121939672483*^9}, {3.8431219871010427`*^9, 3.843121987929388*^9}, {
   3.8432047346356373`*^9, 3.84320476793417*^9}, {3.843205117816002*^9, 
   3.8432051296323633`*^9}, {3.8486795932204247`*^9, 3.848679598857358*^9}, {
   3.848679694977809*^9, 3.848679706364831*^9}},
 CellLabel->
  "In[217]:=",ExpressionUUID->"e916d1d5-57da-4d6d-a398-e237d7a69b52"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "1", "1", "1"},
     {"1", 
      RowBox[{"1", "+", 
       SuperscriptBox["\[FormalZ]", "2"]}], 
      RowBox[{"1", "+", 
       SuperscriptBox["\[FormalZ]", "2"]}], 
      RowBox[{"1", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["\[FormalZ]", "2"]}]}]},
     {"1", 
      RowBox[{"1", "+", 
       SuperscriptBox["\[FormalZ]", "2"]}], 
      RowBox[{"1", "+", 
       SuperscriptBox["\[FormalZ]", "2"]}], 
      RowBox[{"1", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["\[FormalZ]", "2"]}]}]},
     {"1", 
      RowBox[{"1", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["\[FormalZ]", "2"]}]}], 
      RowBox[{"1", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["\[FormalZ]", "2"]}]}], 
      RowBox[{"1", "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["\[FormalZ]", "2"]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.841979417865926*^9, {3.84198002187663*^9, 3.841980029217977*^9}, 
   3.8419836157711143`*^9, 3.841983779418131*^9, 3.8420675631804113`*^9, 
   3.8420682808390303`*^9, 3.842239485968123*^9, {3.84225626871572*^9, 
   3.8422562913414793`*^9}, 3.8422563468786983`*^9, 3.8422563895901413`*^9, {
   3.842256569993216*^9, 3.8422565990348673`*^9}, 3.84225663937055*^9, 
   3.842411363510233*^9, 3.842491549976253*^9, 3.8424937334347878`*^9, 
   3.8424945683377533`*^9, 3.8424975365209227`*^9, 3.842498832800283*^9, 
   3.842502057214665*^9, {3.842504529203577*^9, 3.84250455921907*^9}, 
   3.842578860762966*^9, 3.842670358014145*^9, 3.842677631863576*^9, 
   3.842677690302784*^9, 3.842678810028841*^9, 3.842678965060239*^9, 
   3.8426790091715384`*^9, 3.842679096553687*^9, {3.842679371680718*^9, 
   3.842679386323763*^9}, 3.842684595032153*^9, 3.842684657830386*^9, 
   3.842684991948852*^9, 3.842685141766384*^9, 3.8426867540826273`*^9, 
   3.842688125202389*^9, {3.842688205828285*^9, 3.8426882306321793`*^9}, 
   3.842931585821308*^9, 3.8429316208546333`*^9, {3.842932943185989*^9, 
   3.842932964201899*^9}, {3.842949727743442*^9, 3.8429497348132353`*^9}, 
   3.843017513248612*^9, 3.843103639024083*^9, 3.843105295302717*^9, 
   3.843105327548687*^9, 3.8431194310649853`*^9, 3.843120007225803*^9, 
   3.843121990519133*^9, 3.843204645371642*^9, 3.843204677338328*^9, 
   3.843204771218285*^9, 3.843205130197806*^9, 3.843538171686195*^9, 
   3.843789502961727*^9, 3.844867153092415*^9, 3.844867258934554*^9, 
   3.845797760350844*^9, 3.845800935164113*^9, 3.8471992332857113`*^9, 
   3.8473205106292963`*^9, 3.847321195941099*^9, {3.84732126768707*^9, 
   3.847321295274485*^9}, 3.8473214311177464`*^9, 3.84732315467171*^9, 
   3.847323222411366*^9, 3.8473232753468037`*^9, 3.847323363127256*^9, 
   3.847323582799931*^9, 3.847323632658443*^9, 3.8473236926854362`*^9, 
   3.8473238733003283`*^9, 3.8486738775870733`*^9, 3.848679599281925*^9, {
   3.848679673120295*^9, 3.848679707686487*^9}, 3.850810129410351*^9, 
   3.8508103136113577`*^9},
 CellLabel->
  "Out[236]//MatrixForm=",ExpressionUUID->"8397cb8f-71e2-4c17-a965-\
a1339f9266ba"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "1", "1", "1"},
     {"1", 
      RowBox[{"1", "+", 
       SuperscriptBox["\[FormalZ]", "2"]}], 
      RowBox[{"1", "+", 
       SuperscriptBox["\[FormalZ]", "2"]}], 
      RowBox[{"1", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["\[FormalZ]", "2"]}]}]},
     {"1", 
      RowBox[{"1", "+", 
       SuperscriptBox["\[FormalZ]", "2"]}], 
      RowBox[{"1", "+", 
       SuperscriptBox["\[FormalZ]", "2"]}], 
      RowBox[{"1", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["\[FormalZ]", "2"]}]}]},
     {"1", 
      RowBox[{"1", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["\[FormalZ]", "2"]}]}], 
      RowBox[{"1", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["\[FormalZ]", "2"]}]}], 
      RowBox[{"1", "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["\[FormalZ]", "2"]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.841979417865926*^9, {3.84198002187663*^9, 3.841980029217977*^9}, 
   3.8419836157711143`*^9, 3.841983779418131*^9, 3.8420675631804113`*^9, 
   3.8420682808390303`*^9, 3.842239485968123*^9, {3.84225626871572*^9, 
   3.8422562913414793`*^9}, 3.8422563468786983`*^9, 3.8422563895901413`*^9, {
   3.842256569993216*^9, 3.8422565990348673`*^9}, 3.84225663937055*^9, 
   3.842411363510233*^9, 3.842491549976253*^9, 3.8424937334347878`*^9, 
   3.8424945683377533`*^9, 3.8424975365209227`*^9, 3.842498832800283*^9, 
   3.842502057214665*^9, {3.842504529203577*^9, 3.84250455921907*^9}, 
   3.842578860762966*^9, 3.842670358014145*^9, 3.842677631863576*^9, 
   3.842677690302784*^9, 3.842678810028841*^9, 3.842678965060239*^9, 
   3.8426790091715384`*^9, 3.842679096553687*^9, {3.842679371680718*^9, 
   3.842679386323763*^9}, 3.842684595032153*^9, 3.842684657830386*^9, 
   3.842684991948852*^9, 3.842685141766384*^9, 3.8426867540826273`*^9, 
   3.842688125202389*^9, {3.842688205828285*^9, 3.8426882306321793`*^9}, 
   3.842931585821308*^9, 3.8429316208546333`*^9, {3.842932943185989*^9, 
   3.842932964201899*^9}, {3.842949727743442*^9, 3.8429497348132353`*^9}, 
   3.843017513248612*^9, 3.843103639024083*^9, 3.843105295302717*^9, 
   3.843105327548687*^9, 3.8431194310649853`*^9, 3.843120007225803*^9, 
   3.843121990519133*^9, 3.843204645371642*^9, 3.843204677338328*^9, 
   3.843204771218285*^9, 3.843205130197806*^9, 3.843538171686195*^9, 
   3.843789502961727*^9, 3.844867153092415*^9, 3.844867258934554*^9, 
   3.845797760350844*^9, 3.845800935164113*^9, 3.8471992332857113`*^9, 
   3.8473205106292963`*^9, 3.847321195941099*^9, {3.84732126768707*^9, 
   3.847321295274485*^9}, 3.8473214311177464`*^9, 3.84732315467171*^9, 
   3.847323222411366*^9, 3.8473232753468037`*^9, 3.847323363127256*^9, 
   3.847323582799931*^9, 3.847323632658443*^9, 3.8473236926854362`*^9, 
   3.8473238733003283`*^9, 3.8486738775870733`*^9, 3.848679599281925*^9, {
   3.848679673120295*^9, 3.848679707686487*^9}, 3.850810129410351*^9, 
   3.850810313613267*^9},
 CellLabel->
  "Out[237]//MatrixForm=",ExpressionUUID->"198dd81f-4fc9-499b-a775-\
791b567d0ec3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CellGraphEdges", "[", "cells_", "]"}], " ", ":=", " ", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
         "cells", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
         "\[UndirectedEdge]", " ", 
         RowBox[{
         "cells", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}], 
        ",", " ", 
        RowBox[{"{", 
         RowBox[{"j", ",", " ", "1", ",", " ", 
          RowBox[{"Length", "[", "cells", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "j"}], "}"}]}], "]"}], ",", "2"}], 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CellGraph", "[", "specification_", "]"}], ":=", " ", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"cells", " ", "=", 
         RowBox[{"FormulaCellsValid", "[", 
          RowBox[{"First", "[", "specification", "]"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"edgeLabeling", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"cell1_", "\[UndirectedEdge]", "cell2_"}], ")"}], 
          "\[RuleDelayed]", " ", 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"cell1", "\[UndirectedEdge]", "cell2"}], ")"}], " ", 
            "\[Rule]", "\[IndentingNewLine]", 
            RowBox[{"RTerm", "[", 
             RowBox[{"specification", ",", " ", "cell1", ",", "cell2"}], 
             "]"}]}], ")"}]}]}], ",", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"Note", ":", " ", 
          RowBox[{
           RowBox[{"This", " ", "automagically", " ", "coumputes", " ", "S"}],
            "-", 
           RowBox[{"terms", " ", "at", " ", "loops"}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"vertexLabeling", "=", 
         RowBox[{"cell", "\[Function]", 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{"cell", " ", "\[Rule]", 
            RowBox[{"WTerm", "[", 
             RowBox[{"specification", ",", " ", "cell"}], "]"}]}], 
           ")"}]}]}]}], "\[IndentingNewLine]", "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"With", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"edges", "=", " ", 
          RowBox[{"CellGraphEdges", "[", "cells", "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Graph", "[", "\[IndentingNewLine]", 
         RowBox[{"edges", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"EdgeWeight", "\[Rule]", " ", "edges"}], " ", "/.", " ", 
           "edgeLabeling"}], ",", "\[IndentingNewLine]", 
          RowBox[{"EdgeLabels", "\[Rule]", "\"\<EdgeWeight\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"VertexLabels", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "vertexLabeling", ")"}], " ", "/@", " ", "cells"}]}],
           ",", "\[IndentingNewLine]", 
          RowBox[{"GraphLayout", "->", "\"\<CircularEmbedding\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"EdgeLabelStyle", "\[Rule]", "Green"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"VertexLabelStyle", "->", "Red"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "\[IndentingNewLine]",
          "]"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LoopQ", "[", 
     RowBox[{"a_", "\[DirectedEdge]", "b_"}], "]"}], ":=", 
    RowBox[{"a", "==", "b"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LoopQ", "[", 
     RowBox[{"a_", "\[UndirectedEdge]", "b_"}], "]"}], ":=", 
    RowBox[{"a", "==", "b"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LoopList", "[", "g_", "]"}], ":=", " ", 
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{"EdgeList", "[", "g", "]"}], ",", " ", "LoopQ"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LoopyVertexDelete", "[", "g_", "]"}], ":=", 
    RowBox[{"VertexDelete", "[", 
     RowBox[{"g", ",", " ", 
      RowBox[{"First", "/@", " ", 
       RowBox[{"LoopList", "[", "g", "]"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FindIndependentVertexSetNoloop", "[", "g_", "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"EmptyGraphQ", "[", "g", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"First", "@", 
       RowBox[{"FindIndependentVertexSet", "@", 
        RowBox[{"LoopyVertexDelete", "[", "g", "]"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"EdgeWeights", "[", "g_", "]"}], ":=", 
    RowBox[{"Thread", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"EdgeList", "[", "g", "]"}], ",", 
       RowBox[{"AnnotationValue", "[", 
        RowBox[{"g", ",", "EdgeWeight"}], "]"}]}], "}"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CellGraphCollapsed", "[", "specification_", "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"g", "=", 
         RowBox[{"CellGraph", "[", "specification", "]"}]}], ",", " ", 
        RowBox[{"cliques", " ", "=", " ", 
         RowBox[{"Cliques", "@", 
          RowBox[{"SWR", "[", "specification", "]"}]}]}], ",", "cells"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"cells", "=", 
        RowBox[{"VertexList", "[", "g", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"VertexDelete", "[", 
        RowBox[{"g", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"cells", "[", 
            RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Rest", "/@", " ", "cliques"}], "]"}]}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CellGraphIndependent", "[", "specification_", "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"g", "=", 
        RowBox[{"CellGraphCollapsed", "[", "specification", "]"}]}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"EdgeDelete", "[", 
       RowBox[{"g", ",", "\[IndentingNewLine]", 
        RowBox[{"First", "/@", 
         RowBox[{"Select", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"EdgeWeights", "[", "g", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Last", "[", "#", "]"}], "==", "1"}], "&"}]}], 
          "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CellGraphIndependentReduced", "[", 
     RowBox[{"cellGraphIndependent_", ",", " ", "i1_"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"VertexDelete", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"EdgeDelete", "[", 
       RowBox[{"cellGraphIndependent", ",", " ", 
        RowBox[{"LoopList", "[", "cellGraphIndependent", "]"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"VertexList", "@", 
       RowBox[{"NeighborhoodGraph", "[", 
        RowBox[{"cellGraphIndependent", ",", "i1"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"IndependetSets", "[", "specification_", "]"}], ":=", " ", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"cellGraphIndependent", "=", 
         RowBox[{"CellGraphIndependent", "[", "specification", "]"}]}], ",", 
        "cellGraphIndependentReduced", ",", "i1", ",", "i2"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"i1", " ", "=", " ", 
        RowBox[{
        "FindIndependentVertexSetNoloop", "[", "cellGraphIndependent", 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"cellGraphIndependentReduced", "=", 
        RowBox[{"CellGraphIndependentReduced", "[", 
         RowBox[{"cellGraphIndependent", ",", "i1"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"i2", "=", " ", 
        RowBox[{
        "FindIndependentVertexSet", "[", "cellGraphIndependentReduced", 
         "]"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"Naturally", " ", "loopless"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i1", ",", "i2"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"example", "=", "example2Regularity"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i1", ",", "i2"}], "}"}], "=", 
    RowBox[{"IndependetSets", "[", "example", "]"}]}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"cellGraph", " ", "=", " ", 
     RowBox[{"CellGraph", "[", "example", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cellGraphIndependent", " ", "=", " ", 
     RowBox[{"CellGraphIndependent", "[", "example", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cellGraphIndependentReduced", "=", 
     RowBox[{"CellGraphIndependentReduced", "[", 
      RowBox[{"cellGraphIndependent", ",", "i1"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"cliques", "=", 
    RowBox[{"Cliques", "[", 
     RowBox[{"SWR", "[", "example", "]"}], " ", "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"Column", "[", 
    RowBox[{"{", 
     RowBox[{"cellGraph", ",", 
      RowBox[{"HighlightGraph", "[", 
       RowBox[{"cellGraphIndependent", ",", "i1"}], "]"}], ",", 
      RowBox[{"HighlightGraph", "[", 
       RowBox[{"cellGraphIndependentReduced", ",", "i2"}], "]"}]}], "}"}], 
    "]"}], "\[IndentingNewLine]", 
   RowBox[{"IndependetSets", "[", "example", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.82677631664717*^9, 3.826776392106119*^9}, {
   3.8267765332843943`*^9, 3.8267766975869493`*^9}, {3.826776732923592*^9, 
   3.826776879441977*^9}, {3.826776914408204*^9, 3.826777159010041*^9}, {
   3.8267772126363697`*^9, 3.826777281654173*^9}, {3.826777409263867*^9, 
   3.82677752628185*^9}, {3.826779530135537*^9, 3.8267795697076406`*^9}, {
   3.826779604479659*^9, 3.8267796593012533`*^9}, {3.826779690132078*^9, 
   3.826779735226982*^9}, {3.826779768791193*^9, 3.8267799442464542`*^9}, {
   3.826779999790695*^9, 3.826780008762195*^9}, {3.826780216348117*^9, 
   3.8267802165420732`*^9}, {3.826780247717576*^9, 3.826780251767538*^9}, {
   3.82678032029327*^9, 3.826780380809041*^9}, {3.826780641696588*^9, 
   3.826780668223263*^9}, 3.826781434212461*^9, {3.826781507117353*^9, 
   3.826781639628915*^9}, 3.826781671652635*^9, {3.826781728169271*^9, 
   3.826781762582808*^9}, {3.8267818619143267`*^9, 3.826781873473317*^9}, {
   3.8267819217592897`*^9, 3.826781945990067*^9}, {3.826781976836549*^9, 
   3.826782016579034*^9}, {3.826782048146036*^9, 3.826782048744166*^9}, {
   3.826787002171405*^9, 3.826787002506032*^9}, {3.8267873756492157`*^9, 
   3.8267873817162027`*^9}, {3.827374667603437*^9, 3.827374674262203*^9}, {
   3.839990023453744*^9, 3.839990025503839*^9}, {3.8399949779423923`*^9, 
   3.839995006431424*^9}, {3.841738849521451*^9, 3.841738855360211*^9}, {
   3.841980869970791*^9, 3.841980890917142*^9}, {3.8420899036626587`*^9, 
   3.842089918628214*^9}, {3.842089966871708*^9, 3.8420899871192427`*^9}, {
   3.843024455807733*^9, 3.8430244596930227`*^9}, {3.843105231548208*^9, 
   3.843105282918071*^9}, {3.8431057287863073`*^9, 3.843105812317233*^9}, {
   3.8431058484282017`*^9, 3.843105928407014*^9}, {3.8431059798342113`*^9, 
   3.843106008805435*^9}, {3.843106630247072*^9, 3.843106766158869*^9}, {
   3.843117501310306*^9, 3.843117502113502*^9}, {3.843117555172702*^9, 
   3.8431175575682592`*^9}, {3.843118680608117*^9, 3.843118732785239*^9}, {
   3.8431205698448067`*^9, 3.843120599393984*^9}, {3.8431206747582293`*^9, 
   3.84312070447647*^9}, 3.843121049035801*^9, {3.843122026283421*^9, 
   3.843122041981823*^9}, {3.843122091237214*^9, 3.84312211792118*^9}, {
   3.8431223001227016`*^9, 3.8431223699913473`*^9}, {3.843122414178328*^9, 
   3.843122419749008*^9}, {3.843122922699553*^9, 3.843123044517785*^9}, {
   3.8431230801171017`*^9, 3.843123115564638*^9}, {3.843124077972109*^9, 
   3.84312409486526*^9}, {3.843124152104596*^9, 3.84312417872506*^9}, {
   3.8431248579714518`*^9, 3.8431248757460403`*^9}, {3.843125600561597*^9, 
   3.843125606347663*^9}, 3.843126412388007*^9, {3.8431264784886847`*^9, 
   3.843126484136108*^9}, 3.843126518482505*^9, 3.843127219550322*^9, {
   3.843127766610414*^9, 3.843127865815694*^9}, {3.843139696046556*^9, 
   3.843139722098288*^9}, {3.8432024034077663`*^9, 3.843202422032796*^9}, 
   3.84320307945236*^9, {3.843203202900042*^9, 3.843203221443708*^9}, {
   3.843203297795351*^9, 3.843203385196747*^9}, {3.843203546930708*^9, 
   3.843203586722767*^9}, {3.8432036942406673`*^9, 3.843203905307506*^9}, {
   3.843203943241658*^9, 3.8432039582720203`*^9}, {3.843203993327159*^9, 
   3.843204047823101*^9}, {3.84320408246733*^9, 3.84320424954543*^9}, {
   3.843204357849657*^9, 3.843204478118034*^9}, {3.8432045123446836`*^9, 
   3.843204523683424*^9}, 3.843204750796854*^9, {3.843546497547608*^9, 
   3.843546511327755*^9}, {3.8435484875080013`*^9, 3.8435484962243032`*^9}, {
   3.843548646557125*^9, 3.843548718601706*^9}, {3.8437913082033663`*^9, 
   3.843791335530816*^9}, {3.843792482310151*^9, 3.843792610296769*^9}, {
   3.843792661232439*^9, 3.843792708311154*^9}, {3.843792741587981*^9, 
   3.8437927423406343`*^9}, {3.843792787537321*^9, 3.843792789044362*^9}, {
   3.848674446629093*^9, 3.848674447406382*^9}, {3.848674497474197*^9, 
   3.848674498376719*^9}, 3.848681323147386*^9},
 CellLabel->
  "In[238]:=",ExpressionUUID->"cb5ccc7e-7f44-46d8-b840-19729f63b518"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"e", "[", 
        RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", 
       "False"}], ",", 
      RowBox[{
       RowBox[{"f1", "[", 
        RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", 
       "False"}], ",", 
      RowBox[{
       RowBox[{"f2", "[", 
        RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", 
       "False"}], ",", 
      RowBox[{
       RowBox[{"s1", "[", "\[FormalA]", "]"}], "\[Rule]", "False"}], ",", 
      RowBox[{
       RowBox[{"s2", "[", "\[FormalA]", "]"}], "\[Rule]", "False"}]}], "}"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"e", "[", 
         RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", 
        "False"}], ",", 
       RowBox[{
        RowBox[{"f1", "[", 
         RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", 
        "False"}], ",", 
       RowBox[{
        RowBox[{"f2", "[", 
         RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", 
        "False"}], ",", 
       RowBox[{
        RowBox[{"s1", "[", "\[FormalA]", "]"}], "\[Rule]", "False"}], ",", 
       RowBox[{
        RowBox[{"s2", "[", "\[FormalA]", "]"}], "\[Rule]", "True"}]}], "}"}], 
     "}"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.839994992149252*^9, 3.839995007026175*^9}, 
   3.839995038766769*^9, 3.839995124023505*^9, {3.8400057762395897`*^9, 
   3.840005799784596*^9}, 3.840005875207528*^9, 3.840078628183957*^9, {
   3.8400805385418873`*^9, 3.840080545873246*^9}, 3.840080591591329*^9, 
   3.8402688548086853`*^9, 3.840528032646559*^9, 3.841112940905177*^9, 
   3.841716900317541*^9, {3.841725056166939*^9, 3.841725081203833*^9}, {
   3.8417388434872837`*^9, 3.8417388562912617`*^9}, 3.841738935696185*^9, 
   3.841739491369882*^9, 3.8419750588331137`*^9, 3.841978762034347*^9, {
   3.841980872899082*^9, 3.8419808912941303`*^9}, 3.8420675632335443`*^9, 
   3.8420682808672733`*^9, {3.8420898790541477`*^9, 3.842089904738566*^9}, {
   3.842089971165962*^9, 3.842089987689747*^9}, 3.842239486006727*^9, 
   3.842256346891267*^9, 3.842411363552512*^9, 3.8424915500134087`*^9, 
   3.842493733475758*^9, 3.842494568366165*^9, 3.842497536538418*^9, 
   3.842502057233458*^9, {3.8425045372182198`*^9, 3.842504559237763*^9}, 
   3.842578860819373*^9, 3.842670358054867*^9, 3.842678810045169*^9, 
   3.842678965302392*^9, 3.84267900918524*^9, 3.842679096571191*^9, {
   3.842679371702304*^9, 3.842679386346599*^9}, 3.842931585881022*^9, 
   3.84293162086908*^9, {3.842932943209056*^9, 3.842932964219071*^9}, 
   3.843017513290777*^9, 3.8430244608624487`*^9, 3.8431036390635157`*^9, {
   3.843105289569127*^9, 3.843105295323182*^9}, 3.843105327564489*^9, {
   3.843105918661429*^9, 3.843105928715012*^9}, 3.843106009802006*^9, {
   3.8431067023305693`*^9, 3.8431067287831993`*^9}, 3.843106766845043*^9, 
   3.843117504973673*^9, 3.843117558035187*^9, {3.843118724548862*^9, 
   3.8431187331431217`*^9}, 3.843120709874757*^9, 3.843121050603915*^9, {
   3.843122033952897*^9, 3.843122043200193*^9}, 3.843122118535816*^9, {
   3.843123093731669*^9, 3.843123115926646*^9}, 3.843124877360867*^9, 
   3.843125606762615*^9, 3.84312641293804*^9, 3.843126484822681*^9, 
   3.843126519511985*^9, 3.843127220385944*^9, 3.8431273527223263`*^9, {
   3.843127769641077*^9, 3.843127866100389*^9}, {3.8431396968573933`*^9, 
   3.843139722605144*^9}, 3.8432024228164597`*^9, {3.8432030637666407`*^9, 
   3.8432030801512737`*^9}, 3.843203224999167*^9, 3.8432035887207727`*^9, {
   3.843203709525338*^9, 3.843203747956937*^9}, 3.8432037917278547`*^9, 
   3.84320398722408*^9, 3.8432040535046263`*^9, {3.843204204134214*^9, 
   3.843204212061029*^9}, 3.84320425063477*^9, {3.843204365908083*^9, 
   3.843204374130272*^9}, {3.8432044396054792`*^9, 3.8432044787361927`*^9}, 
   3.8432045279625587`*^9, 3.843204645412889*^9, 3.843204677370372*^9, 
   3.843538171725819*^9, 3.843546511733903*^9, 3.8435484968549747`*^9, 
   3.843548719837331*^9, 3.8437895029940653`*^9, 3.843792610901285*^9, {
   3.843792717835121*^9, 3.843792748355729*^9}, 3.843792789328775*^9, 
   3.844867153135803*^9, 3.844867258957437*^9, 3.845797760435773*^9, 
   3.8458009351861477`*^9, 3.847199233338107*^9, 3.84732051067939*^9, 
   3.847321195964217*^9, {3.847321267709346*^9, 3.847321295296616*^9}, 
   3.847321431140243*^9, 3.847323154697687*^9, 3.847323222434959*^9, 
   3.847323275377268*^9, 3.8473233631503687`*^9, 3.8473235828230762`*^9, 
   3.84732363268618*^9, 3.847323692708169*^9, 3.847323873324561*^9, 
   3.8486738776249437`*^9, 3.8486744477905703`*^9, 3.8486744987771072`*^9, 
   3.848681324384931*^9, 3.850810129462141*^9, 3.850810313647002*^9},
 CellLabel->
  "Out[251]=",ExpressionUUID->"03be03e4-90f5-481a-922f-462bb7cc1caa"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "1", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", "4", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.839994992149252*^9, 3.839995007026175*^9}, 
   3.839995038766769*^9, 3.839995124023505*^9, {3.8400057762395897`*^9, 
   3.840005799784596*^9}, 3.840005875207528*^9, 3.840078628183957*^9, {
   3.8400805385418873`*^9, 3.840080545873246*^9}, 3.840080591591329*^9, 
   3.8402688548086853`*^9, 3.840528032646559*^9, 3.841112940905177*^9, 
   3.841716900317541*^9, {3.841725056166939*^9, 3.841725081203833*^9}, {
   3.8417388434872837`*^9, 3.8417388562912617`*^9}, 3.841738935696185*^9, 
   3.841739491369882*^9, 3.8419750588331137`*^9, 3.841978762034347*^9, {
   3.841980872899082*^9, 3.8419808912941303`*^9}, 3.8420675632335443`*^9, 
   3.8420682808672733`*^9, {3.8420898790541477`*^9, 3.842089904738566*^9}, {
   3.842089971165962*^9, 3.842089987689747*^9}, 3.842239486006727*^9, 
   3.842256346891267*^9, 3.842411363552512*^9, 3.8424915500134087`*^9, 
   3.842493733475758*^9, 3.842494568366165*^9, 3.842497536538418*^9, 
   3.842502057233458*^9, {3.8425045372182198`*^9, 3.842504559237763*^9}, 
   3.842578860819373*^9, 3.842670358054867*^9, 3.842678810045169*^9, 
   3.842678965302392*^9, 3.84267900918524*^9, 3.842679096571191*^9, {
   3.842679371702304*^9, 3.842679386346599*^9}, 3.842931585881022*^9, 
   3.84293162086908*^9, {3.842932943209056*^9, 3.842932964219071*^9}, 
   3.843017513290777*^9, 3.8430244608624487`*^9, 3.8431036390635157`*^9, {
   3.843105289569127*^9, 3.843105295323182*^9}, 3.843105327564489*^9, {
   3.843105918661429*^9, 3.843105928715012*^9}, 3.843106009802006*^9, {
   3.8431067023305693`*^9, 3.8431067287831993`*^9}, 3.843106766845043*^9, 
   3.843117504973673*^9, 3.843117558035187*^9, {3.843118724548862*^9, 
   3.8431187331431217`*^9}, 3.843120709874757*^9, 3.843121050603915*^9, {
   3.843122033952897*^9, 3.843122043200193*^9}, 3.843122118535816*^9, {
   3.843123093731669*^9, 3.843123115926646*^9}, 3.843124877360867*^9, 
   3.843125606762615*^9, 3.84312641293804*^9, 3.843126484822681*^9, 
   3.843126519511985*^9, 3.843127220385944*^9, 3.8431273527223263`*^9, {
   3.843127769641077*^9, 3.843127866100389*^9}, {3.8431396968573933`*^9, 
   3.843139722605144*^9}, 3.8432024228164597`*^9, {3.8432030637666407`*^9, 
   3.8432030801512737`*^9}, 3.843203224999167*^9, 3.8432035887207727`*^9, {
   3.843203709525338*^9, 3.843203747956937*^9}, 3.8432037917278547`*^9, 
   3.84320398722408*^9, 3.8432040535046263`*^9, {3.843204204134214*^9, 
   3.843204212061029*^9}, 3.84320425063477*^9, {3.843204365908083*^9, 
   3.843204374130272*^9}, {3.8432044396054792`*^9, 3.8432044787361927`*^9}, 
   3.8432045279625587`*^9, 3.843204645412889*^9, 3.843204677370372*^9, 
   3.843538171725819*^9, 3.843546511733903*^9, 3.8435484968549747`*^9, 
   3.843548719837331*^9, 3.8437895029940653`*^9, 3.843792610901285*^9, {
   3.843792717835121*^9, 3.843792748355729*^9}, 3.843792789328775*^9, 
   3.844867153135803*^9, 3.844867258957437*^9, 3.845797760435773*^9, 
   3.8458009351861477`*^9, 3.847199233338107*^9, 3.84732051067939*^9, 
   3.847321195964217*^9, {3.847321267709346*^9, 3.847321295296616*^9}, 
   3.847321431140243*^9, 3.847323154697687*^9, 3.847323222434959*^9, 
   3.847323275377268*^9, 3.8473233631503687`*^9, 3.8473235828230762`*^9, 
   3.84732363268618*^9, 3.847323692708169*^9, 3.847323873324561*^9, 
   3.8486738776249437`*^9, 3.8486744477905703`*^9, 3.8486744987771072`*^9, 
   3.848681324384931*^9, 3.850810129462141*^9, 3.850810313683935*^9},
 CellLabel->
  "Out[255]=",ExpressionUUID->"9d310732-1618-4927-baae-c79e3d08b1f9"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     GraphicsBox[
      NamespaceBox["NetworkGraphics",
       DynamicModuleBox[{Typeset`graph = HoldComplete[
         Graph[{{$CellContext`e[\[FormalA], \[FormalA]] -> 
            False, $CellContext`f1[\[FormalA], \[FormalA]] -> 
            False, $CellContext`f2[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            False, $CellContext`s2[\[FormalA]] -> 
            False}, {$CellContext`e[\[FormalA], \[FormalA]] -> 
            False, $CellContext`f1[\[FormalA], \[FormalA]] -> 
            False, $CellContext`f2[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            False, $CellContext`s2[\[FormalA]] -> 
            True}, {$CellContext`e[\[FormalA], \[FormalA]] -> 
            False, $CellContext`f1[\[FormalA], \[FormalA]] -> 
            False, $CellContext`f2[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            True, $CellContext`s2[\[FormalA]] -> 
            False}, {$CellContext`e[\[FormalA], \[FormalA]] -> 
            False, $CellContext`f1[\[FormalA], \[FormalA]] -> 
            False, $CellContext`f2[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            True, $CellContext`s2[\[FormalA]] -> True}}, {
          Null, {{1, 1}, {1, 2}, {2, 2}, {1, 3}, {2, 3}, {3, 3}, {1, 4}, {2, 
           4}, {3, 4}, {4, 4}}}, {
          EdgeLabels -> {"EdgeWeight"}, EdgeLabelStyle -> {
             RGBColor[0, 1, 0]}, 
           EdgeWeight -> {
            1, 1, 1 + \[FormalZ]^2, 1, 1 + \[FormalZ]^2, 1 + \[FormalZ]^2, 1, 
             1 + 2 \[FormalZ]^2, 1 + 2 \[FormalZ]^2, 1 + 4 \[FormalZ]^2}, 
           GraphLayout -> "CircularEmbedding", ImageSize -> Medium, 
           VertexLabels -> {{$CellContext`e[\[FormalA], \[FormalA]] -> 
               False, $CellContext`f1[\[FormalA], \[FormalA]] -> 
               False, $CellContext`f2[\[FormalA], \[FormalA]] -> 
               False, $CellContext`s1[\[FormalA]] -> 
               False, $CellContext`s2[\[FormalA]] -> False} -> 
             1, {$CellContext`e[\[FormalA], \[FormalA]] -> 
               False, $CellContext`f1[\[FormalA], \[FormalA]] -> 
               False, $CellContext`f2[\[FormalA], \[FormalA]] -> 
               False, $CellContext`s1[\[FormalA]] -> 
               False, $CellContext`s2[\[FormalA]] -> 
               True} -> -1, {$CellContext`e[\[FormalA], \[FormalA]] -> 
               False, $CellContext`f1[\[FormalA], \[FormalA]] -> 
               False, $CellContext`f2[\[FormalA], \[FormalA]] -> 
               False, $CellContext`s1[\[FormalA]] -> 
               True, $CellContext`s2[\[FormalA]] -> True} -> 
             1, {$CellContext`e[\[FormalA], \[FormalA]] -> 
               False, $CellContext`f1[\[FormalA], \[FormalA]] -> 
               False, $CellContext`f2[\[FormalA], \[FormalA]] -> 
               False, $CellContext`s1[\[FormalA]] -> 
               True, $CellContext`s2[\[FormalA]] -> False} -> -1}, 
           VertexLabelStyle -> {
             RGBColor[1, 0, 0]}}]]}, 
        TagBox[GraphicsGroupBox[{
           {Hue[0.6, 0.7, 0.5], Opacity[0.7], {
             {Arrowheads[0.], 
              ArrowBox[BezierCurveBox[{{-1., 
               1.0106430996148606`*^-15}, {-1.1444860191449147`, \
-0.31154820377982595`}, {-1.4692532130040235`, -0.40364288207231813`}, \
{-1.6769219731596998`, -0.30736637558997687`}, {-1.6769219731596998`, 
               0.30736637558997876`}, {-1.4692532130040235`, 
               0.40364288207232}, {-1.1444860191449147`, 
               0.31154820377982784`}, {-1., 1.0106430996148606`*^-15}},
               SplineDegree->7], 0.02261146496815286]}, InsetBox[
              StyleBox["1",
               StripOnInput->False,
               LineColor->RGBColor[0, 1, 0],
               FrontFaceColor->RGBColor[0, 1, 0],
               BackFaceColor->RGBColor[0, 1, 0],
               GraphicsColor->RGBColor[0, 1, 0],
               FontColor->RGBColor[0, 1, 0]], {-1.816496580927726, 1.0123033888837733*^-15},
               ImageScaled[{0.5, 0.5}],
              BaseStyle->"Graphics"]}, {
             {Arrowheads[0.], 
              ArrowBox[{{-1., 
               1.0106430996148606`*^-15}, {-7.044813998280222*^-16, 1.}}, 
               0.02261146496815286]}, InsetBox[
              StyleBox["1",
               StripOnInput->False,
               LineColor->RGBColor[0, 1, 0],
               FrontFaceColor->RGBColor[0, 1, 0],
               BackFaceColor->RGBColor[0, 1, 0],
               GraphicsColor->RGBColor[0, 1, 0],
               FontColor->RGBColor[0, 1, 0]], {-0.5000000000000003, 0.5000000000000006},
               ImageScaled[{0.5, 0.5}],
              BaseStyle->"Graphics"]}, {
             {Arrowheads[0.], 
              ArrowBox[{{-1., 1.0106430996148606`*^-15}, {
               1., -1.133107779529596*^-15}}, 0.02261146496815286]}, 
             InsetBox[
              StyleBox["1",
               StripOnInput->False,
               LineColor->RGBColor[0, 1, 0],
               FrontFaceColor->RGBColor[0, 1, 0],
               BackFaceColor->RGBColor[0, 1, 0],
               GraphicsColor->RGBColor[0, 1, 0],
               FontColor->RGBColor[0, 1, 0]], {0., -6.123233995736767*^-17}, 
              ImageScaled[{0.5, 0.5}],
              BaseStyle->"Graphics"]}, {
             {Arrowheads[0.], 
              ArrowBox[{{-1., 1.0106430996148606`*^-15}, {
               6.049014748177263*^-16, -1.}}, 0.02261146496815286]}, 
             InsetBox[
              StyleBox["1",
               StripOnInput->False,
               LineColor->RGBColor[0, 1, 0],
               FrontFaceColor->RGBColor[0, 1, 0],
               BackFaceColor->RGBColor[0, 1, 0],
               GraphicsColor->RGBColor[0, 1, 0],
               FontColor->RGBColor[0, 1, 0]], {-0.4999999999999997, -0.4999999999999995},
               ImageScaled[{0.5, 0.5}],
              BaseStyle->"Graphics"]}, {
             {Arrowheads[0.], 
              ArrowBox[BezierCurveBox[{{-7.044813998280222*^-16, 
               1.}, {-0.3115482037801113, 
               1.1444860191443031`}, {-0.40364288207268745`, 
               1.4692532130037075`}, {-0.30736637559025887`, 
               1.6769219731595726`}, {0.3073663755902559, 
               1.6769219731595733`}, {0.403642882072685, 
               1.4692532130037081`}, {0.3115482037801094, 
               1.1444860191443036`}, {-7.044813998280222*^-16, 1.}},
               SplineDegree->7], 0.02261146496815286]}, InsetBox[
              StyleBox[
               RowBox[{
                SuperscriptBox["\[FormalZ]", "2"], "+", "1"}],
               StripOnInput->False,
               LineColor->RGBColor[0, 1, 0],
               FrontFaceColor->RGBColor[0, 1, 0],
               BackFaceColor->RGBColor[0, 1, 0],
               GraphicsColor->RGBColor[0, 1, 0],
               FontColor->RGBColor[0, 1, 0]], {-1.3763594680115602*^-15, 1.8164965809277263},
               ImageScaled[{0.5, 0.5}],
              BaseStyle->"Graphics"]}, {
             {Arrowheads[0.], 
              ArrowBox[{{-7.044813998280222*^-16, 1.}, {
               1., -1.133107779529596*^-15}}, 0.02261146496815286]}, 
             InsetBox[
              StyleBox[
               RowBox[{
                SuperscriptBox["\[FormalZ]", "2"], "+", "1"}],
               StripOnInput->False,
               LineColor->RGBColor[0, 1, 0],
               FrontFaceColor->RGBColor[0, 1, 0],
               BackFaceColor->RGBColor[0, 1, 0],
               GraphicsColor->RGBColor[0, 1, 0],
               FontColor->RGBColor[0, 1, 0]], {0.49999999999999967, 0.49999999999999944},
               ImageScaled[{0.5, 0.5}],
              BaseStyle->"Graphics"]}, {
             {Arrowheads[0.], 
              ArrowBox[{{-7.044813998280222*^-16, 1.}, {
               6.049014748177263*^-16, -1.}}, 0.02261146496815286]}, 
             InsetBox[
              StyleBox[
               RowBox[{
                RowBox[{"2", " ", 
                 SuperscriptBox["\[FormalZ]", "2"]}], "+", "1"}],
               StripOnInput->False,
               LineColor->RGBColor[0, 1, 0],
               FrontFaceColor->RGBColor[0, 1, 0],
               BackFaceColor->RGBColor[0, 1, 0],
               GraphicsColor->RGBColor[0, 1, 0],
               FontColor->RGBColor[0, 1, 0]], {-4.978996250514798*^-17, 0.}, 
              ImageScaled[{0.5, 0.5}],
              BaseStyle->"Graphics"]}, {
             {Arrowheads[0.], 
              ArrowBox[BezierCurveBox[{{1., -1.133107779529596*^-15}, {
               1.1444860191449144`, 0.3115482037798257}, {1.4692532130040232`,
                0.4036428820723181}, {1.6769219731596996`, 
               0.3073663755899768}, {
               1.6769219731596998`, -0.3073663755899788}, {
               1.4692532130040235`, -0.40364288207232013`}, {
               1.1444860191449147`, -0.311548203779828}, {
               1., -1.133107779529596*^-15}},
               SplineDegree->7], 0.02261146496815286]}, InsetBox[
              StyleBox[
               RowBox[{
                SuperscriptBox["\[FormalZ]", "2"], "+", "1"}],
               StripOnInput->False,
               LineColor->RGBColor[0, 1, 0],
               FrontFaceColor->RGBColor[0, 1, 0],
               BackFaceColor->RGBColor[0, 1, 0],
               GraphicsColor->RGBColor[0, 1, 0],
               FontColor->RGBColor[0, 1, 0]], {1.8164965809277263, -1.2634937101970492*^-15},
               ImageScaled[{0.5, 0.5}],
              BaseStyle->"Graphics"]}, {
             {Arrowheads[0.], 
              ArrowBox[{{1., -1.133107779529596*^-15}, {
               6.049014748177263*^-16, -1.}}, 0.02261146496815286]}, 
             InsetBox[
              StyleBox[
               RowBox[{
                RowBox[{"2", " ", 
                 SuperscriptBox["\[FormalZ]", "2"]}], "+", "1"}],
               StripOnInput->False,
               LineColor->RGBColor[0, 1, 0],
               FrontFaceColor->RGBColor[0, 1, 0],
               BackFaceColor->RGBColor[0, 1, 0],
               GraphicsColor->RGBColor[0, 1, 0],
               FontColor->RGBColor[0, 1, 0]], {0.5000000000000003, -0.5000000000000006},
               ImageScaled[{0.5, 0.5}],
              BaseStyle->"Graphics"]}, {
             {Arrowheads[0.], 
              ArrowBox[BezierCurveBox[{{6.049014748177263*^-16, -1.}, {
               0.3115482037798275, -1.1444860191449147`}, {
               0.4036428820723197, -1.4692532130040235`}, {
               0.3073663755899784, -1.6769219731596998`}, \
{-0.3073663755899772, -1.6769219731596998`}, {-0.4036428820723185, \
-1.4692532130040235`}, {-0.3115482037798263, -1.1444860191449147`}, {
               6.049014748177263*^-16, -1.}},
               SplineDegree->7], 0.02261146496815286]}, InsetBox[
              StyleBox[
               RowBox[{
                RowBox[{"4", " ", 
                 SuperscriptBox["\[FormalZ]", "2"]}], "+", "1"}],
               StripOnInput->False,
               LineColor->RGBColor[0, 1, 0],
               FrontFaceColor->RGBColor[0, 1, 0],
               BackFaceColor->RGBColor[0, 1, 0],
               GraphicsColor->RGBColor[0, 1, 0],
               FontColor->RGBColor[0, 1, 0]], {7.692562879517862*^-16, -1.816496580927726},
               ImageScaled[{0.5, 0.5}],
              BaseStyle->"Graphics"]}}, 
           {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[
            0.7]}], {
             DiskBox[{-1., 1.0106430996148606*^-15}, 0.02261146496815286], 
             InsetBox[
              StyleBox["1",
               StripOnInput->False,
               LineColor->RGBColor[1, 0, 0],
               FrontFaceColor->RGBColor[1, 0, 0],
               BackFaceColor->RGBColor[1, 0, 0],
               GraphicsColor->RGBColor[1, 0, 0],
               FontColor->RGBColor[1, 0, 0]], 
              Offset[{-2., 2.021286199229721*^-15}, \
{-1.0226114649681528, 1.0334952206571073*^-15}], ImageScaled[{1., 0.4999999999999995}],
              BaseStyle->"Graphics"]}, {
             DiskBox[{-7.044813998280222*^-16, 1.}, 0.02261146496815286], 
             InsetBox[
              StyleBox[
               RowBox[{"-", "1"}],
               StripOnInput->False,
               LineColor->RGBColor[1, 0, 0],
               FrontFaceColor->RGBColor[1, 0, 0],
               BackFaceColor->RGBColor[1, 0, 0],
               GraphicsColor->RGBColor[1, 0, 0],
               FontColor->RGBColor[1, 0, 0]], 
              Offset[{-1.4089627996560444*^-15, 2.}, \
{-7.204107563209488*^-16, 1.0226114649681528}], ImageScaled[{0.5000000000000003, 0.}],
              BaseStyle->"Graphics"]}, {
             DiskBox[{1., -1.133107779529596*^-15}, 0.02261146496815286], 
             InsetBox[
              StyleBox[
               RowBox[{"-", "1"}],
               StripOnInput->False,
               LineColor->RGBColor[1, 0, 0],
               FrontFaceColor->RGBColor[1, 0, 0],
               BackFaceColor->RGBColor[1, 0, 0],
               GraphicsColor->RGBColor[1, 0, 0],
               FontColor->RGBColor[1, 0, 0]], 
              Offset[{2., -2.266215559059192*^-15}, \
{1.0226114649681528, -1.1587290063915707*^-15}], ImageScaled[{0., 0.5000000000000006}],
              BaseStyle->"Graphics"]}, {
             DiskBox[{6.049014748177263*^-16, -1.}, 0.02261146496815286], 
             InsetBox[
              StyleBox["1",
               StripOnInput->False,
               LineColor->RGBColor[1, 0, 0],
               FrontFaceColor->RGBColor[1, 0, 0],
               BackFaceColor->RGBColor[1, 0, 0],
               GraphicsColor->RGBColor[1, 0, 0],
               FontColor->RGBColor[1, 0, 0]], 
              Offset[{1.2098029496354525*^-15, -2.}, \
{6.185791833247513*^-16, -1.0226114649681528}], ImageScaled[{0.4999999999999997, 1.}],
              BaseStyle->"Graphics"]}}}],
         MouseAppearanceTag["NetworkGraphics"]],
        AllowKernelInitialization->False]],
      DefaultBaseStyle->{
       "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> 
        Hue[0.8, 1., 0.6]},
      FormatType->TraditionalForm,
      FrameTicks->None,
      ImageSize->Medium]},
    {
     GraphicsBox[
      NamespaceBox["NetworkGraphics",
       DynamicModuleBox[{Typeset`graph = HoldComplete[
         Graph[{{$CellContext`e[\[FormalA], \[FormalA]] -> 
            False, $CellContext`f1[\[FormalA], \[FormalA]] -> 
            False, $CellContext`f2[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            False, $CellContext`s2[\[FormalA]] -> 
            False}, {$CellContext`e[\[FormalA], \[FormalA]] -> 
            False, $CellContext`f1[\[FormalA], \[FormalA]] -> 
            False, $CellContext`f2[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            False, $CellContext`s2[\[FormalA]] -> 
            True}, {$CellContext`e[\[FormalA], \[FormalA]] -> 
            False, $CellContext`f1[\[FormalA], \[FormalA]] -> 
            False, $CellContext`f2[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            True, $CellContext`s2[\[FormalA]] -> True}}, {
          Null, {{2, 2}, {2, 3}, {3, 3}}}, {
          EdgeLabels -> {"EdgeWeight"}, EdgeLabelStyle -> {
             RGBColor[0, 1, 0]}, 
           EdgeWeight -> {
            1 + \[FormalZ]^2, 1 + 2 \[FormalZ]^2, 1 + 4 \[FormalZ]^2}, 
           GraphHighlight -> {{$CellContext`e[\[FormalA], \[FormalA]] -> 
              False, $CellContext`f1[\[FormalA], \[FormalA]] -> 
              False, $CellContext`f2[\[FormalA], \[FormalA]] -> 
              False, $CellContext`s1[\[FormalA]] -> 
              False, $CellContext`s2[\[FormalA]] -> False}}, GraphLayout -> 
           "CircularEmbedding", ImageSize -> Medium, 
           VertexLabels -> {{$CellContext`e[\[FormalA], \[FormalA]] -> 
               False, $CellContext`f1[\[FormalA], \[FormalA]] -> 
               False, $CellContext`f2[\[FormalA], \[FormalA]] -> 
               False, $CellContext`s1[\[FormalA]] -> 
               False, $CellContext`s2[\[FormalA]] -> 
               True} -> -1, {$CellContext`e[\[FormalA], \[FormalA]] -> 
               False, $CellContext`f1[\[FormalA], \[FormalA]] -> 
               False, $CellContext`f2[\[FormalA], \[FormalA]] -> 
               False, $CellContext`s1[\[FormalA]] -> 
               True, $CellContext`s2[\[FormalA]] -> True} -> 
             1, {$CellContext`e[\[FormalA], \[FormalA]] -> 
               False, $CellContext`f1[\[FormalA], \[FormalA]] -> 
               False, $CellContext`f2[\[FormalA], \[FormalA]] -> 
               False, $CellContext`s1[\[FormalA]] -> 
               False, $CellContext`s2[\[FormalA]] -> False} -> 1}, 
           VertexLabelStyle -> {
             RGBColor[1, 0, 0]}}]]}, 
        TagBox[GraphicsGroupBox[{
           {Hue[0.6, 0.7, 0.5], Opacity[0.7], {
             {Arrowheads[0.], 
              ArrowBox[BezierCurveBox[{{
               0.8660254037844389, -0.5000000000000012}, {
               1.2288259853054067`, -0.4674954975322388}, {
               1.4856541628098245`, -0.716972635189764}, {
               1.5073515360575258`, -0.9587868998534107}, {
               0.9426834478444563, -1.2847981725860183`}, {
               0.744114838272135, -1.1451005638262928`}, {
               0.6564753881494994, -0.7979422688710457}, {0.8660254037844389, 
               -0.5000000000000012}},
               SplineDegree->7], 0.020399597244776385`]}, InsetBox[
              StyleBox[
               RowBox[{
                SuperscriptBox["\[FormalZ]", "2"], "+", "1"}],
               StripOnInput->False,
               LineColor->RGBColor[0, 1, 0],
               FrontFaceColor->RGBColor[0, 1, 0],
               BackFaceColor->RGBColor[0, 1, 0],
               GraphicsColor->RGBColor[0, 1, 0],
               FontColor->RGBColor[0, 1, 0]], {1.2990381056766591, -1.2500000000000013},
               ImageScaled[{0.5, 0.5}],
              BaseStyle->"Graphics"]}, {
             {Arrowheads[0.], 
              ArrowBox[{{0.8660254037844389, -0.5000000000000012}, {
               1.8369701987210297`*^-16, 1.}}, 0.020399597244776385`]}, 
             InsetBox[
              StyleBox[
               RowBox[{
                RowBox[{"2", " ", 
                 SuperscriptBox["\[FormalZ]", "2"]}], "+", "1"}],
               StripOnInput->False,
               LineColor->RGBColor[0, 1, 0],
               FrontFaceColor->RGBColor[0, 1, 0],
               BackFaceColor->RGBColor[0, 1, 0],
               GraphicsColor->RGBColor[0, 1, 0],
               FontColor->RGBColor[0, 1, 0]], {0.4330127018922196, 0.2499999999999994},
               ImageScaled[{0.5, 0.5}],
              BaseStyle->"Graphics"]}, {
             {Arrowheads[0.], 
              ArrowBox[BezierCurveBox[{{1.8369701987210297`*^-16, 
               1.}, {-0.3628005815209674, 
               0.9674954975322381}, {-0.6196287590253851, 
               1.2169726351897634`}, {-0.6413261322730861, 
               1.4587868998534101`}, {-0.07665804406001622, 
               1.7847981725860171`}, {0.12191056551230489`, 
               1.6451005638262917`}, {0.2095500156349402, 
               1.297942268871044}, {1.8369701987210297`*^-16, 1.}},
               SplineDegree->7], 0.020399597244776385`]}, InsetBox[
              StyleBox[
               RowBox[{
                RowBox[{"4", " ", 
                 SuperscriptBox["\[FormalZ]", "2"]}], "+", "1"}],
               StripOnInput->False,
               LineColor->RGBColor[0, 1, 0],
               FrontFaceColor->RGBColor[0, 1, 0],
               BackFaceColor->RGBColor[0, 1, 0],
               GraphicsColor->RGBColor[0, 1, 0],
               FontColor->RGBColor[0, 1, 0]], {-0.4330127018922189, 1.750000000000001},
               ImageScaled[{0.5, 0.5}],
              BaseStyle->"Graphics"]}}, 
           {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], {
             {Hue[1, 1, 0.7], EdgeForm[{Hue[1, 1, 0.7], Opacity[1]}], 
              DiskBox[{-0.8660254037844384, -0.4999999999999994}, 
               0.020399597244776385]}, InsetBox[
              StyleBox["1",
               StripOnInput->False,
               LineColor->RGBColor[1, 0, 0],
               FrontFaceColor->RGBColor[1, 0, 0],
               BackFaceColor->RGBColor[1, 0, 0],
               GraphicsColor->RGBColor[1, 0, 0],
               FontColor->RGBColor[1, 0, 0]], 
              Offset[{-2., -1.1547005383792506}, \
{-0.8850584871273002, -0.5109887557915092}], ImageScaled[{1., 0.7886751345948126}],
              BaseStyle->"Graphics"]}, {
             DiskBox[{0.8660254037844389, -0.5000000000000012}, 
              0.020399597244776385], InsetBox[
              StyleBox[
               RowBox[{"-", "1"}],
               StripOnInput->False,
               LineColor->RGBColor[1, 0, 0],
               FrontFaceColor->RGBColor[1, 0, 0],
               BackFaceColor->RGBColor[1, 0, 0],
               GraphicsColor->RGBColor[1, 0, 0],
               FontColor->RGBColor[1, 0, 0]], 
              Offset[{2., -1.1547005383792541}, \
{0.8850584871273008, -0.5109887557915112}], ImageScaled[{0., 0.7886751345948135}],
              BaseStyle->"Graphics"]}, {
             DiskBox[{1.8369701987210297*^-16, 1.}, 0.020399597244776385], 
             InsetBox[
              StyleBox["1",
               StripOnInput->False,
               LineColor->RGBColor[1, 0, 0],
               FrontFaceColor->RGBColor[1, 0, 0],
               BackFaceColor->RGBColor[1, 0, 0],
               GraphicsColor->RGBColor[1, 0, 0],
               FontColor->RGBColor[1, 0, 0]], 
              Offset[{3.6739403974420594*^-16, 2.}, \
{1.8744436509255954*^-16, 1.0203995972447764}], ImageScaled[{0.4999999999999999, 0.}],
              BaseStyle->"Graphics"]}}}],
         MouseAppearanceTag["NetworkGraphics"]],
        AllowKernelInitialization->False]],
      DefaultBaseStyle->{
       "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> 
        Hue[0.8, 1., 0.6]},
      FormatType->TraditionalForm,
      FrameTicks->None,
      ImageSize->Medium]},
    {
     GraphicsBox[
      NamespaceBox["NetworkGraphics",
       DynamicModuleBox[{Typeset`graph = HoldComplete[
         Graph[{{$CellContext`e[\[FormalA], \[FormalA]] -> 
            False, $CellContext`f1[\[FormalA], \[FormalA]] -> 
            False, $CellContext`f2[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            False, $CellContext`s2[\[FormalA]] -> 
            True}, {$CellContext`e[\[FormalA], \[FormalA]] -> 
            False, $CellContext`f1[\[FormalA], \[FormalA]] -> 
            False, $CellContext`f2[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            True, $CellContext`s2[\[FormalA]] -> True}}, {Null, {{1, 2}}}, {
          EdgeLabels -> {"EdgeWeight"}, EdgeLabelStyle -> {
             RGBColor[0, 1, 0]}, EdgeWeight -> {1 + 2 \[FormalZ]^2}, 
           GraphHighlight -> {{$CellContext`e[\[FormalA], \[FormalA]] -> 
              False, $CellContext`f1[\[FormalA], \[FormalA]] -> 
              False, $CellContext`f2[\[FormalA], \[FormalA]] -> 
              False, $CellContext`s1[\[FormalA]] -> 
              False, $CellContext`s2[\[FormalA]] -> True}}, GraphLayout -> 
           "CircularEmbedding", ImageSize -> Medium, 
           VertexLabels -> {{$CellContext`e[\[FormalA], \[FormalA]] -> 
               False, $CellContext`f1[\[FormalA], \[FormalA]] -> 
               False, $CellContext`f2[\[FormalA], \[FormalA]] -> 
               False, $CellContext`s1[\[FormalA]] -> 
               False, $CellContext`s2[\[FormalA]] -> 
               True} -> -1, {$CellContext`e[\[FormalA], \[FormalA]] -> 
               False, $CellContext`f1[\[FormalA], \[FormalA]] -> 
               False, $CellContext`f2[\[FormalA], \[FormalA]] -> 
               False, $CellContext`s1[\[FormalA]] -> 
               True, $CellContext`s2[\[FormalA]] -> True} -> 1}, 
           VertexLabelStyle -> {
             RGBColor[1, 0, 0]}}]]}, 
        TagBox[GraphicsGroupBox[{
           {Hue[0.6, 0.7, 0.5], Opacity[0.7], 
            {Arrowheads[0.], 
             ArrowBox[{{1., 0.}, {-1., 0.}}, 0.02261146496815286]}, InsetBox[
             StyleBox[
              RowBox[{
               RowBox[{"2", " ", 
                SuperscriptBox["\[FormalZ]", "2"]}], "+", "1"}],
              StripOnInput->False,
              LineColor->RGBColor[0, 1, 0],
              FrontFaceColor->RGBColor[0, 1, 0],
              BackFaceColor->RGBColor[0, 1, 0],
              GraphicsColor->RGBColor[0, 1, 0],
              FontColor->RGBColor[0, 1, 0]], {0., 0.}, ImageScaled[{0.5, 0.5}],
             BaseStyle->"Graphics"]}, 
           {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], {
             {Hue[1, 1, 0.7], EdgeForm[{Hue[1, 1, 0.7], Opacity[1]}], 
              DiskBox[{1., 0.}, 0.02261146496815286]}, InsetBox[
              StyleBox[
               RowBox[{"-", "1"}],
               StripOnInput->False,
               LineColor->RGBColor[1, 0, 0],
               FrontFaceColor->RGBColor[1, 0, 0],
               BackFaceColor->RGBColor[1, 0, 0],
               GraphicsColor->RGBColor[1, 0, 0],
               FontColor->RGBColor[1, 0, 0]], 
              Offset[{2., 0.}, {1.0226114649681528, 0.}], ImageScaled[{0., 0.5}],
              BaseStyle->"Graphics"]}, {
             DiskBox[{-1., 0.}, 0.02261146496815286], InsetBox[
              StyleBox["1",
               StripOnInput->False,
               LineColor->RGBColor[1, 0, 0],
               FrontFaceColor->RGBColor[1, 0, 0],
               BackFaceColor->RGBColor[1, 0, 0],
               GraphicsColor->RGBColor[1, 0, 0],
               FontColor->RGBColor[1, 0, 0]], 
              Offset[{-2., 0.}, {-1.0226114649681528, 0.}], ImageScaled[{1., 0.5}],
              BaseStyle->"Graphics"]}}}],
         MouseAppearanceTag["NetworkGraphics"]],
        AllowKernelInitialization->False]],
      DefaultBaseStyle->{
       "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> 
        Hue[0.8, 1., 0.6]},
      FormatType->TraditionalForm,
      FrameTicks->None,
      ImageSize->Medium]}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Output",
 CellChangeTimes->{{3.839994992149252*^9, 3.839995007026175*^9}, 
   3.839995038766769*^9, 3.839995124023505*^9, {3.8400057762395897`*^9, 
   3.840005799784596*^9}, 3.840005875207528*^9, 3.840078628183957*^9, {
   3.8400805385418873`*^9, 3.840080545873246*^9}, 3.840080591591329*^9, 
   3.8402688548086853`*^9, 3.840528032646559*^9, 3.841112940905177*^9, 
   3.841716900317541*^9, {3.841725056166939*^9, 3.841725081203833*^9}, {
   3.8417388434872837`*^9, 3.8417388562912617`*^9}, 3.841738935696185*^9, 
   3.841739491369882*^9, 3.8419750588331137`*^9, 3.841978762034347*^9, {
   3.841980872899082*^9, 3.8419808912941303`*^9}, 3.8420675632335443`*^9, 
   3.8420682808672733`*^9, {3.8420898790541477`*^9, 3.842089904738566*^9}, {
   3.842089971165962*^9, 3.842089987689747*^9}, 3.842239486006727*^9, 
   3.842256346891267*^9, 3.842411363552512*^9, 3.8424915500134087`*^9, 
   3.842493733475758*^9, 3.842494568366165*^9, 3.842497536538418*^9, 
   3.842502057233458*^9, {3.8425045372182198`*^9, 3.842504559237763*^9}, 
   3.842578860819373*^9, 3.842670358054867*^9, 3.842678810045169*^9, 
   3.842678965302392*^9, 3.84267900918524*^9, 3.842679096571191*^9, {
   3.842679371702304*^9, 3.842679386346599*^9}, 3.842931585881022*^9, 
   3.84293162086908*^9, {3.842932943209056*^9, 3.842932964219071*^9}, 
   3.843017513290777*^9, 3.8430244608624487`*^9, 3.8431036390635157`*^9, {
   3.843105289569127*^9, 3.843105295323182*^9}, 3.843105327564489*^9, {
   3.843105918661429*^9, 3.843105928715012*^9}, 3.843106009802006*^9, {
   3.8431067023305693`*^9, 3.8431067287831993`*^9}, 3.843106766845043*^9, 
   3.843117504973673*^9, 3.843117558035187*^9, {3.843118724548862*^9, 
   3.8431187331431217`*^9}, 3.843120709874757*^9, 3.843121050603915*^9, {
   3.843122033952897*^9, 3.843122043200193*^9}, 3.843122118535816*^9, {
   3.843123093731669*^9, 3.843123115926646*^9}, 3.843124877360867*^9, 
   3.843125606762615*^9, 3.84312641293804*^9, 3.843126484822681*^9, 
   3.843126519511985*^9, 3.843127220385944*^9, 3.8431273527223263`*^9, {
   3.843127769641077*^9, 3.843127866100389*^9}, {3.8431396968573933`*^9, 
   3.843139722605144*^9}, 3.8432024228164597`*^9, {3.8432030637666407`*^9, 
   3.8432030801512737`*^9}, 3.843203224999167*^9, 3.8432035887207727`*^9, {
   3.843203709525338*^9, 3.843203747956937*^9}, 3.8432037917278547`*^9, 
   3.84320398722408*^9, 3.8432040535046263`*^9, {3.843204204134214*^9, 
   3.843204212061029*^9}, 3.84320425063477*^9, {3.843204365908083*^9, 
   3.843204374130272*^9}, {3.8432044396054792`*^9, 3.8432044787361927`*^9}, 
   3.8432045279625587`*^9, 3.843204645412889*^9, 3.843204677370372*^9, 
   3.843538171725819*^9, 3.843546511733903*^9, 3.8435484968549747`*^9, 
   3.843548719837331*^9, 3.8437895029940653`*^9, 3.843792610901285*^9, {
   3.843792717835121*^9, 3.843792748355729*^9}, 3.843792789328775*^9, 
   3.844867153135803*^9, 3.844867258957437*^9, 3.845797760435773*^9, 
   3.8458009351861477`*^9, 3.847199233338107*^9, 3.84732051067939*^9, 
   3.847321195964217*^9, {3.847321267709346*^9, 3.847321295296616*^9}, 
   3.847321431140243*^9, 3.847323154697687*^9, 3.847323222434959*^9, 
   3.847323275377268*^9, 3.8473233631503687`*^9, 3.8473235828230762`*^9, 
   3.84732363268618*^9, 3.847323692708169*^9, 3.847323873324561*^9, 
   3.8486738776249437`*^9, 3.8486744477905703`*^9, 3.8486744987771072`*^9, 
   3.848681324384931*^9, 3.850810129462141*^9, 3.850810313714346*^9},
 CellLabel->
  "Out[256]=",ExpressionUUID->"5bae7efe-7a8a-46a2-970c-d4978411e61d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"e", "[", 
        RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", 
       "False"}], ",", 
      RowBox[{
       RowBox[{"f1", "[", 
        RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", 
       "False"}], ",", 
      RowBox[{
       RowBox[{"f2", "[", 
        RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", 
       "False"}], ",", 
      RowBox[{
       RowBox[{"s1", "[", "\[FormalA]", "]"}], "\[Rule]", "False"}], ",", 
      RowBox[{
       RowBox[{"s2", "[", "\[FormalA]", "]"}], "\[Rule]", "False"}]}], "}"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"e", "[", 
         RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", 
        "False"}], ",", 
       RowBox[{
        RowBox[{"f1", "[", 
         RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", 
        "False"}], ",", 
       RowBox[{
        RowBox[{"f2", "[", 
         RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", 
        "False"}], ",", 
       RowBox[{
        RowBox[{"s1", "[", "\[FormalA]", "]"}], "\[Rule]", "False"}], ",", 
       RowBox[{
        RowBox[{"s2", "[", "\[FormalA]", "]"}], "\[Rule]", "True"}]}], "}"}], 
     "}"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.839994992149252*^9, 3.839995007026175*^9}, 
   3.839995038766769*^9, 3.839995124023505*^9, {3.8400057762395897`*^9, 
   3.840005799784596*^9}, 3.840005875207528*^9, 3.840078628183957*^9, {
   3.8400805385418873`*^9, 3.840080545873246*^9}, 3.840080591591329*^9, 
   3.8402688548086853`*^9, 3.840528032646559*^9, 3.841112940905177*^9, 
   3.841716900317541*^9, {3.841725056166939*^9, 3.841725081203833*^9}, {
   3.8417388434872837`*^9, 3.8417388562912617`*^9}, 3.841738935696185*^9, 
   3.841739491369882*^9, 3.8419750588331137`*^9, 3.841978762034347*^9, {
   3.841980872899082*^9, 3.8419808912941303`*^9}, 3.8420675632335443`*^9, 
   3.8420682808672733`*^9, {3.8420898790541477`*^9, 3.842089904738566*^9}, {
   3.842089971165962*^9, 3.842089987689747*^9}, 3.842239486006727*^9, 
   3.842256346891267*^9, 3.842411363552512*^9, 3.8424915500134087`*^9, 
   3.842493733475758*^9, 3.842494568366165*^9, 3.842497536538418*^9, 
   3.842502057233458*^9, {3.8425045372182198`*^9, 3.842504559237763*^9}, 
   3.842578860819373*^9, 3.842670358054867*^9, 3.842678810045169*^9, 
   3.842678965302392*^9, 3.84267900918524*^9, 3.842679096571191*^9, {
   3.842679371702304*^9, 3.842679386346599*^9}, 3.842931585881022*^9, 
   3.84293162086908*^9, {3.842932943209056*^9, 3.842932964219071*^9}, 
   3.843017513290777*^9, 3.8430244608624487`*^9, 3.8431036390635157`*^9, {
   3.843105289569127*^9, 3.843105295323182*^9}, 3.843105327564489*^9, {
   3.843105918661429*^9, 3.843105928715012*^9}, 3.843106009802006*^9, {
   3.8431067023305693`*^9, 3.8431067287831993`*^9}, 3.843106766845043*^9, 
   3.843117504973673*^9, 3.843117558035187*^9, {3.843118724548862*^9, 
   3.8431187331431217`*^9}, 3.843120709874757*^9, 3.843121050603915*^9, {
   3.843122033952897*^9, 3.843122043200193*^9}, 3.843122118535816*^9, {
   3.843123093731669*^9, 3.843123115926646*^9}, 3.843124877360867*^9, 
   3.843125606762615*^9, 3.84312641293804*^9, 3.843126484822681*^9, 
   3.843126519511985*^9, 3.843127220385944*^9, 3.8431273527223263`*^9, {
   3.843127769641077*^9, 3.843127866100389*^9}, {3.8431396968573933`*^9, 
   3.843139722605144*^9}, 3.8432024228164597`*^9, {3.8432030637666407`*^9, 
   3.8432030801512737`*^9}, 3.843203224999167*^9, 3.8432035887207727`*^9, {
   3.843203709525338*^9, 3.843203747956937*^9}, 3.8432037917278547`*^9, 
   3.84320398722408*^9, 3.8432040535046263`*^9, {3.843204204134214*^9, 
   3.843204212061029*^9}, 3.84320425063477*^9, {3.843204365908083*^9, 
   3.843204374130272*^9}, {3.8432044396054792`*^9, 3.8432044787361927`*^9}, 
   3.8432045279625587`*^9, 3.843204645412889*^9, 3.843204677370372*^9, 
   3.843538171725819*^9, 3.843546511733903*^9, 3.8435484968549747`*^9, 
   3.843548719837331*^9, 3.8437895029940653`*^9, 3.843792610901285*^9, {
   3.843792717835121*^9, 3.843792748355729*^9}, 3.843792789328775*^9, 
   3.844867153135803*^9, 3.844867258957437*^9, 3.845797760435773*^9, 
   3.8458009351861477`*^9, 3.847199233338107*^9, 3.84732051067939*^9, 
   3.847321195964217*^9, {3.847321267709346*^9, 3.847321295296616*^9}, 
   3.847321431140243*^9, 3.847323154697687*^9, 3.847323222434959*^9, 
   3.847323275377268*^9, 3.8473233631503687`*^9, 3.8473235828230762`*^9, 
   3.84732363268618*^9, 3.847323692708169*^9, 3.847323873324561*^9, 
   3.8486738776249437`*^9, 3.8486744477905703`*^9, 3.8486744987771072`*^9, 
   3.848681324384931*^9, 3.850810129462141*^9, 3.85081031373595*^9},
 CellLabel->
  "Out[257]=",ExpressionUUID->"68c3d502-5007-4dc8-abf0-7624df940101"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"PolyToEGF", "[", 
   RowBox[{"poly_", ",", "var_"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"coefs", "=", 
      RowBox[{"CoefficientList", "[", 
       RowBox[{"poly", ",", "var"}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Sum", "[", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"coefs", "[", 
         RowBox[{"[", 
          RowBox[{"i", "+", "1"}], "]"}], "]"}], " ", "*", 
        RowBox[{"var", "^", "i"}]}], 
       RowBox[{"i", "!"}]], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", 
        RowBox[{
         RowBox[{"Length", "[", "coefs", "]"}], "-", "1"}]}], "}"}]}], 
     "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.84199707042507*^9, 3.841997075352816*^9}},
 CellLabel->
  "In[258]:=",ExpressionUUID->"5fe55467-7b28-4389-a85d-cb7549b1264d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Implementation", " ", "of", " ", "WFOMC", " ", "according", " ", "to", 
     " ", "formula", " ", 
     RowBox[{"(", "1", ")"}], " ", "in", " ", "Faster", " ", "Lifting", " ", 
     "for", " ", "Two"}], "-", 
    RowBox[{
    "Variable", " ", "Logic", " ", "using", " ", "Cell", " ", "Graphs"}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"OrderedPartitions", "[", 
     RowBox[{"n_Integer", ",", "m_Integer"}], "]"}], ":=", " ", 
    RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Permutations", "[", 
         RowBox[{"PadRight", "[", 
          RowBox[{"#", ",", "m"}], "]"}], "]"}], "&"}], "\[IndentingNewLine]",
        "/@", 
       RowBox[{"IntegerPartitions", "[", 
        RowBox[{"n", ",", "m"}], "]"}]}], ",", "\[IndentingNewLine]", "1"}], 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"OrderedPartitionsUpTo", "[", 
     RowBox[{"n_Integer", ",", "m_Integer"}], "]"}], ":=", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"Catenate", "@", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"OrderedPartitions", "[", 
        RowBox[{"i", ",", "m"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "n"}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Pow", "[", 
     RowBox[{"0", ",", "0"}], "]"}], ":=", "1"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Pow", "[", 
     RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
    RowBox[{"a", "^", "b"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"GetDTerm", "[", 
      RowBox[{"k_", ",", "n_", ",", " ", "srratio_"}], "]"}], " ", ":=", " ", 
     
     RowBox[{
      RowBox[{
       RowBox[{"GetDTerm", "[", 
        RowBox[{"1", ",", " ", "k", ",", "n"}], "]"}], " ", 
       "\[IndentingNewLine]", 
       RowBox[{"GetDTerm", "[", 
        RowBox[{"i_", ",", " ", "k_", ",", "n_", ",", "srratio_"}], "]"}]}], 
      " ", ":=", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"i", "==", "k"}], ",", "\[IndentingNewLine]", 
          RowBox[{"srratio", "^", 
           RowBox[{"Binomial", "[", 
            RowBox[{"n", ",", "2"}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Sum", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Binomial", "[", 
              RowBox[{"n", ",", "ni"}], "]"}], "*", 
             RowBox[{"srratio", "^", 
              RowBox[{"Binomial", "[", 
               RowBox[{"ni", ",", "2"}], "]"}]}], "*", 
             RowBox[{"GetDTerm", "[", 
              RowBox[{
               RowBox[{"i", "+", "1"}], ",", " ", "k", ",", 
               RowBox[{"n", "-", "ni"}], ",", "srratio"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"ni", ",", "0", ",", "n"}], "}"}]}], "]"}]}], 
         "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
        RowBox[{"GetJTerm", "[", 
         RowBox[{
          RowBox[{"{", "cell_", "}"}], ",", "n_", ",", " ", "s_", ",", "r_"}],
          "]"}]}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"s", "[", 
           RowBox[{"[", "cell", "]"}], "]"}], "^", 
          RowBox[{"Binomial", "[", 
           RowBox[{"n", ",", "2"}], "]"}]}], "\[IndentingNewLine]", 
         RowBox[{"GetJTerm", "[", 
          RowBox[{"clique_List", ",", "n_", ",", " ", "s_", ",", "r_"}], 
          "]"}]}], " ", ":=", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Module", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"srratio", "=", 
               RowBox[{"SRratio", "[", 
                RowBox[{"s", ",", "r", ",", "clique"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"k", "=", 
               RowBox[{"Length", "[", "clique", "]"}]}]}], 
             "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"r", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"clique", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{"clique", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "^", 
              RowBox[{"Binomial", "[", 
               RowBox[{"n", ",", "2"}], "]"}]}], " ", "*", " ", 
             RowBox[{"GetDTerm", "[", 
              RowBox[{"k", ",", "n", ",", "srratio"}], "]"}]}]}], 
           "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"GetGTerm", "[", 
           RowBox[{
           "0", ",", "n_", ",", "partition_", ",", " ", "N_", ",", " ", "k_", 
            ",", "l_", ",", " ", 
            RowBox[{"{", 
             RowBox[{"s_", ",", "w_", ",", "r_"}], "}"}]}], "]"}]}], ":=", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"w", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "*", 
               RowBox[{"Product", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"r", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], " ", "~", "Pow", 
                  "~", " ", 
                  RowBox[{"partition", "[", 
                   RowBox[{"[", 
                    RowBox[{"j", "-", "k", "-", "l"}], "]"}], "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", 
                   RowBox[{"k", "+", "l", "+", "1"}], ",", 
                   RowBox[{"Length", "[", "r", "]"}]}], "}"}]}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "k"}], "}"}]}], "]"}], "~", "Pow", 
            "~", 
            RowBox[{"(", 
             RowBox[{"n", "-", "N", "-", 
              RowBox[{"Total", "[", "partition", "]"}]}], ")"}]}], 
           "\[IndentingNewLine]", 
           RowBox[{"GetGTerm", "[", 
            RowBox[{
            "p_", ",", "n_", ",", "partition_", ",", " ", "N_", ",", " ", 
             "k_", ",", "l_", ",", " ", 
             RowBox[{"{", 
              RowBox[{"s_", ",", "w_", ",", "r_"}], "}"}]}], "]"}]}], ":=", 
          RowBox[{"Module", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"ub", "=", 
              RowBox[{"n", "-", "N", "-", 
               RowBox[{"Total", "[", "partition", "]"}]}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Sum", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"Binomial", "[", 
                RowBox[{"ub", ",", "nkp"}], "]"}], "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"w", "[", 
                  RowBox[{"[", 
                   RowBox[{"k", "+", "p"}], "]"}], "]"}], "~", "Pow", "~", 
                 "nkp"}], ")"}], "*", 
               RowBox[{"GetJTerm", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"k", "+", "p"}], "}"}], ",", "nkp", ",", "s", ",", 
                 "r"}], "]"}], "*", 
               RowBox[{"Product", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"r", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"k", "+", "p"}], ",", "j"}], "]"}], "]"}], "~", 
                  "Pow", "~", 
                  RowBox[{"(", 
                   RowBox[{"nkp", "*", 
                    RowBox[{"partition", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "-", "k", "-", "l"}], "]"}], "]"}]}], 
                   ")"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", 
                   RowBox[{"k", "+", "l", "+", "1"}], ",", 
                   RowBox[{"Length", "[", "r", "]"}]}], "}"}]}], "]"}], "*", 
               RowBox[{"GetGTerm", "[", 
                RowBox[{
                 RowBox[{"p", "-", "1"}], ",", " ", "n", ",", "partition", 
                 ",", 
                 RowBox[{"N", "+", "nkp"}], ",", " ", "k", ",", "l", ",", 
                 RowBox[{"{", 
                  RowBox[{"s", ",", "w", ",", "r"}], "}"}]}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"nkp", ",", "0", ",", "ub"}], "}"}]}], 
             "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
           "]"}]}]}]}]}]}]}], "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"WFOMC1", "[", 
     RowBox[{"n_Integer", ",", "property_"}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"s", ",", "w", ",", "r", ",", "u", ",", "i", ",", "j"}], 
       "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"s", ",", "w", ",", "r"}], "}"}], "=", 
        RowBox[{"SWR", "[", "property", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"u", "=", 
        RowBox[{"Length", "[", "s", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Total", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"partition", " ", "|->", " ", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Multinomial", "[", 
             RowBox[{"Sequence", "@@", "partition"}], "]"}], " ", "*", 
            "\[IndentingNewLine]", 
            RowBox[{"Product", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"r", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "~", 
               "Pow", "~", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                 "partition", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}], "*", 
                 RowBox[{
                 "partition", "\[LeftDoubleBracket]", "j", 
                  "\[RightDoubleBracket]"}]}], ")"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "u"}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", " ", ",", " ", 
                RowBox[{"i", "-", "1"}]}], "}"}]}], "]"}], "*", 
            "\[IndentingNewLine]", 
            RowBox[{"Product", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                "s", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
                "~", "Pow", "~", 
                RowBox[{"Binomial", "[", 
                 RowBox[{
                  RowBox[{
                  "partition", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}], ",", "2"}], "]"}]}], " ", "*", 
               "\[IndentingNewLine]", " ", 
               RowBox[{
                RowBox[{
                "w", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
                "~", "Pow", "~", 
                RowBox[{
                "partition", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}]}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "u"}], "}"}]}], "]"}]}]}], 
          "\[IndentingNewLine]", ")"}], " ", "/@", " ", 
         RowBox[{"OrderedPartitions", "[", 
          RowBox[{"n", ",", " ", "u"}], "]"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GetJTermDef", "[", 
     RowBox[{"n_", ",", " ", 
      RowBox[{"{", 
       RowBox[{"s_", ",", "w_", ",", "r_"}], "}"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{"(*", " ", 
      RowBox[{
      "J", " ", "term", " ", "by", " ", "unnumberder", " ", "equation", " ", 
       "at", " ", 
       RowBox[{"p", ".", " ", "6"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", ",", "j", ",", "\[IndentingNewLine]", 
        RowBox[{"s1", "=", 
         RowBox[{"First", "[", "s", "]"}]}], ",", "\[IndentingNewLine]", " ", 
        
        RowBox[{"k", "=", 
         RowBox[{"Length", "[", "r", "]"}]}]}], "\[IndentingNewLine]", "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"Total", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"partition", " ", "|->", " ", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Multinomial", "[", 
            RowBox[{"Sequence", "@@", "partition"}], "]"}], " ", "*", 
           "\[IndentingNewLine]", 
           RowBox[{"s1", "~", "Pow", "~", " ", 
            RowBox[{"(", 
             RowBox[{"Total", "@", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Binomial", "[", 
                  RowBox[{"#", ",", "2"}], "]"}], "&"}], ",", " ", 
                "partition"}], "]"}]}], ")"}]}], "*", "\[IndentingNewLine]", 
           RowBox[{"Product", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"r", "\[LeftDoubleBracket]", 
               RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "~", "Pow",
               "~", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "partition", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}], "*", 
                RowBox[{
                "partition", "\[LeftDoubleBracket]", "j", 
                 "\[RightDoubleBracket]"}]}], ")"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "k"}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", 
               RowBox[{"i", "-", "1"}]}], "}"}]}], "]"}]}]}], 
         "\[IndentingNewLine]", ")"}], "\[IndentingNewLine]", "/@", " ", 
        RowBox[{"OrderedPartitions", "[", 
         RowBox[{"n", ",", " ", "k"}], "]"}]}], "\[IndentingNewLine]", 
       "]"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"WFOMC5", "[", 
     RowBox[{"n_Integer", ",", "property_"}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
       "s", ",", "w", ",", "r", ",", "u", ",", "i", ",", "j", ",", 
        "\[IndentingNewLine]", "cliques", ",", "cliqueReps"}], 
       "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"s", ",", "w", ",", "r"}], "}"}], "=", 
        RowBox[{"SWR", "[", "property", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"cliques", "=", 
        RowBox[{"Cliques", "[", 
         RowBox[{"{", 
          RowBox[{"s", ",", "w", ",", "r"}], "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"cliqueReps", "=", 
        RowBox[{"First", "/@", "cliques"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"u", "=", 
        RowBox[{"Length", "[", "cliques", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Total", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"partition", " ", "|->", " ", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Multinomial", "[", 
             RowBox[{"Sequence", "@@", "partition"}], "]"}], " ", "*", 
            "\[IndentingNewLine]", 
            RowBox[{"Product", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"r", "\[LeftDoubleBracket]", 
                RowBox[{
                 RowBox[{"cliqueReps", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", 
                 RowBox[{"cliqueReps", "[", 
                  RowBox[{"[", "j", "]"}], "]"}]}], "\[RightDoubleBracket]"}],
                "~", "Pow", "~", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                 "partition", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}], "*", 
                 RowBox[{
                 "partition", "\[LeftDoubleBracket]", "j", 
                  "\[RightDoubleBracket]"}]}], ")"}]}], ",", " ", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "u"}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", " ", ",", " ", 
                RowBox[{"i", "-", "1"}]}], "}"}]}], "]"}], "*", 
            "\[IndentingNewLine]", 
            RowBox[{"Product", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"GetJTermDef", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                 "partition", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"ExtractClique", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"s", ",", "w", ",", "r"}], "}"}], ",", " ", 
                   RowBox[{"cliques", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], 
                "\[IndentingNewLine]", "]"}], "*", 
               RowBox[{
                RowBox[{"w", "\[LeftDoubleBracket]", 
                 RowBox[{"cliqueReps", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "\[RightDoubleBracket]"}], 
                "~", "Pow", "~", 
                RowBox[{
                "partition", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}]}]}], " ", "\[IndentingNewLine]", 
              ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "u"}], "}"}]}], 
             "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", ")"}], 
         " ", "/@", " ", 
         RowBox[{"OrderedPartitions", "[", 
          RowBox[{"n", ",", " ", "u"}], "]"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GetGTerm", "[", 
     RowBox[{"0", ",", "k_Integer", ",", "l_Integer", ",", 
      RowBox[{"{", 
       RowBox[{"s_", ",", "w_", ",", "r_"}], "}"}], ",", "partition_", ",", 
      " ", "n_Integer", ",", " ", "bigN_Integer"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{"Sum", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"w", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "*", 
         RowBox[{"Product", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"r", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], "~", "Pow", "~", 
            RowBox[{"partition", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"j", ",", 
             RowBox[{"k", "+", "l", "+", "1"}], ",", 
             RowBox[{"Length", "[", "partition", "]"}]}], "}"}]}], "]"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "k"}], "}"}]}], "]"}], 
      "\[IndentingNewLine]", ")"}], "~", "Pow", "~", 
     RowBox[{"(", 
      RowBox[{"n", "-", "bigN", "-", 
       RowBox[{"Total", "[", "partition", "]"}]}], ")"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GetGTerm", "[", 
     RowBox[{"p_Integer", ",", "k_Integer", ",", "l_Integer", ",", 
      RowBox[{"{", 
       RowBox[{"s_", ",", "w_", ",", "r_"}], "}"}], ",", "partition_", ",", 
      " ", "n_Integer"}], "]"}], ":=", "Nothing"}], " ", 
   RowBox[{"(*", "TODO", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"WFOMC5K", "[", 
     RowBox[{"n_Integer", ",", "property_"}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
       "s", ",", "w", ",", "r", ",", "u", ",", "i", ",", "j", ",", "k", ",", 
        "l", ",", "\[IndentingNewLine]", "cliques", ",", "cliqueReps"}], 
       "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"s", ",", "w", ",", "r"}], "}"}], "=", 
        RowBox[{"SWR", "[", "property", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"cliques", "=", 
        RowBox[{"Cliques", "[", 
         RowBox[{"{", 
          RowBox[{"s", ",", "w", ",", "r"}], "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"k", ",", "l"}], "}"}], "=", 
        RowBox[{"Length", "/@", 
         RowBox[{"IndependetSets", "[", "property", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"l", "=", "0"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"cliqueReps", "=", 
        RowBox[{"First", "/@", "cliques"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"u", "=", 
        RowBox[{"Length", "[", "cliqueReps", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Total", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"partition", " ", "|->", " ", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Multinomial", "[", 
             RowBox[{"Sequence", "@@", "partition"}], "]"}], " ", "*", 
            "\[IndentingNewLine]", 
            RowBox[{"Product", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"r", "\[LeftDoubleBracket]", 
                RowBox[{
                 RowBox[{"cliqueReps", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", 
                 RowBox[{"cliqueReps", "[", 
                  RowBox[{"[", "j", "]"}], "]"}]}], "\[RightDoubleBracket]"}],
                "~", "Pow", "~", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                 "partition", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}], "*", 
                 RowBox[{
                 "partition", "\[LeftDoubleBracket]", "j", 
                  "\[RightDoubleBracket]"}]}], ")"}]}], ",", " ", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"k", "+", "l", "+", "1"}], ",", "u"}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"j", ",", 
                RowBox[{"k", "+", "l", "+", "1"}], " ", ",", " ", 
                RowBox[{"i", "-", "1"}]}], "}"}]}], "]"}], "*", 
            "\[IndentingNewLine]", 
            RowBox[{"Product", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"GetJTermDef", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                 "partition", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"ExtractClique", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"s", ",", "w", ",", "r"}], "}"}], ",", " ", 
                   RowBox[{"cliques", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], 
                "\[IndentingNewLine]", "]"}], "*", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"w", "\[LeftDoubleBracket]", 
                 RowBox[{"cliqueReps", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "\[RightDoubleBracket]"}], 
                "~", "Pow", "~", 
                RowBox[{
                "partition", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}]}], " ", "*", "\[IndentingNewLine]", 
               RowBox[{"GetGTerm", "[", 
                RowBox[{"l", ",", "k", ",", "l", ",", 
                 RowBox[{"ExtractClique", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"s", ",", "w", ",", "r"}], "}"}], ",", 
                   "cliqueReps"}], "]"}], ",", "partition", ",", "n", ",", 
                 "0"}], "]"}]}], "\[IndentingNewLine]", ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"1", "+", "k", "+", "l"}], ",", "u"}], "}"}]}], 
             "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", ")"}], 
         " ", "/@", " ", 
         RowBox[{"OrderedPartitionsUpTo", "[", 
          RowBox[{"n", ",", " ", "u"}], "]"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"FastWFOMC", "[", 
      RowBox[{"n_Integer", ",", " ", "property_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
        "s", ",", "w", ",", "r", ",", "k", " ", ",", " ", "l", ",", 
         "ncliques"}], "\[IndentingNewLine]", "}"}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"s", ",", "w", ",", "r"}], "}"}], "=", 
         RowBox[{"SWR", "[", "property", "]"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"ncliques", "=", 
         RowBox[{"Length", "@", 
          RowBox[{"Cliques", "[", 
           RowBox[{"{", 
            RowBox[{"s", ",", "w", ",", "r"}], "}"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"k", ",", "l"}], "}"}], "=", 
         RowBox[{"Length", "/@", 
          RowBox[{"IndependetSets", "[", "property", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"k", ",", "l"}], "}"}], "=", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Total", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"partition", "|->", " ", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Multinomial", "[", 
              RowBox[{"Sequence", "@@", "partition"}], "]"}], "*", 
             "\[IndentingNewLine]", 
             RowBox[{"Product", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"Evaluate", "[", 
                 RowBox[{"r", "\[LeftDoubleBracket]", 
                  RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "]"}], 
                "~", "Pow", "~", 
                RowBox[{"Evaluate", "[", 
                 RowBox[{
                  RowBox[{
                  "partition", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}], "*", 
                  RowBox[{
                  "partition", "\[LeftDoubleBracket]", "j", 
                   "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"k", "+", "l", "+", "1"}], ",", "ncliques"}], "}"}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"j", ",", 
                 RowBox[{"k", "+", "l", "+", "1"}], " ", ",", " ", 
                 RowBox[{"i", "-", "1"}]}], "}"}]}], "]"}], "*", 
             "\[IndentingNewLine]", 
             RowBox[{"Product", "[", "\[IndentingNewLine]", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                  "w", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
                   "~", "Pow", "~", 
                  RowBox[{
                  "partition", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}]}], ")"}], "*", 
                RowBox[{"GetJTerm", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"partition", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "}"}], ",", "n", ",", "s",
                   ",", "r"}], "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"k", "+", "l", "+", "1"}], ",", "ncliques"}], 
                "}"}]}], "]"}], "*", "\[IndentingNewLine]", 
             RowBox[{"GetGTerm", "[", 
              RowBox[{
              "l", ",", "n", ",", "partition", ",", "0", ",", "k", ",", "l", 
               ",", 
               RowBox[{"{", 
                RowBox[{"s", ",", "w", ",", "r"}], "}"}]}], "]"}]}]}], 
           "\[IndentingNewLine]", ")"}], "/@", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"PadLeft", "[", 
              RowBox[{"#", ",", "ncliques"}], "]"}], "&"}], "/@", 
            RowBox[{"OrderedPartitionsUpTo", "[", 
             RowBox[{"n", ",", " ", 
              RowBox[{"ncliques", "-", "k", "-", "l", "-", "1"}]}], "]"}]}], 
           ")"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.837671520214148*^9, 3.837671559005844*^9}, {
   3.83767175868404*^9, 3.837671836650036*^9}, {3.837676078777917*^9, 
   3.8376761046086807`*^9}, {3.837677350649568*^9, 3.837677351937161*^9}, {
   3.837678843118335*^9, 3.837678850990128*^9}, {3.837678890276106*^9, 
   3.837678925290481*^9}, {3.837678958848846*^9, 3.837678976703998*^9}, {
   3.837679016694084*^9, 3.8376793311201487`*^9}, {3.8377469641332273`*^9, 
   3.837746978068305*^9}, {3.837747023042777*^9, 3.837747067350965*^9}, {
   3.8377472368946753`*^9, 3.8377472703717403`*^9}, {3.837747438573263*^9, 
   3.837747440265904*^9}, {3.837747477906584*^9, 3.837747496104636*^9}, {
   3.838367477804426*^9, 3.8383674923385878`*^9}, {3.8384456841657877`*^9, 
   3.838445684684894*^9}, {3.838695013887693*^9, 3.8386950144711227`*^9}, {
   3.8399950845981693`*^9, 3.8399951087709637`*^9}, {3.840080629114437*^9, 
   3.840080634328938*^9}, {3.841738871210875*^9, 3.8417388930313587`*^9}, {
   3.84174088895819*^9, 3.841740937441914*^9}, {3.843546207162071*^9, 
   3.843546258295329*^9}, {3.843546309382169*^9, 3.843546476514271*^9}, {
   3.8435465279040337`*^9, 3.843546587732418*^9}, {3.843546765575453*^9, 
   3.8435468013480377`*^9}, {3.8435468338365192`*^9, 
   3.8435468688330317`*^9}, {3.8435469513951178`*^9, 
   3.8435470169691467`*^9}, {3.843547062108459*^9, 3.843547143336925*^9}, {
   3.843547270578678*^9, 3.843547368331028*^9}, {3.843547403373273*^9, 
   3.843547407364812*^9}, {3.8435474523948708`*^9, 3.843547483256618*^9}, {
   3.843547892707745*^9, 3.843547903340156*^9}, {3.8435479921120453`*^9, 
   3.843547992828886*^9}, {3.843548064120701*^9, 3.843548112769742*^9}, {
   3.843548148431923*^9, 3.843548162191758*^9}, {3.843548198021101*^9, 
   3.843548282352811*^9}, 3.843548334334537*^9, {3.8437971251263933`*^9, 
   3.843797138444415*^9}, {3.843797394374338*^9, 3.8437974215350103`*^9}, {
   3.8437980167998962`*^9, 3.8437980242550707`*^9}, {3.8437980623999653`*^9, 
   3.8437980710848227`*^9}, {3.8437994752325907`*^9, 3.843799495157251*^9}, {
   3.843799951639153*^9, 3.843799988354475*^9}, {3.8438010967787323`*^9, 
   3.843801170327034*^9}, 3.8438028258067007`*^9, {3.844867184942027*^9, 
   3.8448671917160053`*^9}, {3.844867244659994*^9, 3.844867253869062*^9}, {
   3.844867785444788*^9, 3.8448677907*^9}, {3.847202445588766*^9, 
   3.847202451868947*^9}, {3.8472024827070427`*^9, 3.847202483492236*^9}, {
   3.847202551792053*^9, 3.847202560291841*^9}, {3.847203087239107*^9, 
   3.847203090201397*^9}, {3.847203229344811*^9, 3.8472032302803907`*^9}, {
   3.847203321656039*^9, 3.8472033538058643`*^9}, {3.8472034838364964`*^9, 
   3.8472035994000053`*^9}, {3.847203640029006*^9, 3.847203678103642*^9}, {
   3.84720375480301*^9, 3.847203781057691*^9}, {3.84720385173307*^9, 
   3.847203853917227*^9}, {3.84720448357936*^9, 3.847204487027367*^9}, {
   3.847204539788816*^9, 3.84720462634824*^9}, {3.847204760968877*^9, 
   3.847204762313919*^9}, {3.8472048268260717`*^9, 3.847204828441997*^9}, {
   3.847204863152194*^9, 3.8472049081020308`*^9}, {3.847204943852404*^9, 
   3.847204972675003*^9}, {3.847205050399124*^9, 3.847205141186502*^9}, {
   3.847205227318194*^9, 3.847205229814171*^9}, {3.847205667550552*^9, 
   3.84720568295018*^9}, {3.847320557890974*^9, 3.84732059559466*^9}, {
   3.847321020732841*^9, 3.8473211538002777`*^9}, {3.84732122540841*^9, 
   3.847321292345743*^9}, {3.84732140907098*^9, 3.8473214148383703`*^9}, {
   3.8473215108827267`*^9, 3.847321511058214*^9}, {3.8473230983658867`*^9, 
   3.847323131498889*^9}, {3.8473231858175173`*^9, 3.847323217536232*^9}, {
   3.8473233203172607`*^9, 3.8473233588720407`*^9}, {3.847323522947816*^9, 
   3.847323565691546*^9}, {3.8473236644438753`*^9, 3.847323684499598*^9}, {
   3.847323775470459*^9, 3.84732379158974*^9}, {3.847323883226325*^9, 
   3.847323889650834*^9}, {3.847324624368692*^9, 3.847324672401794*^9}, {
   3.847324704774159*^9, 3.847324752384884*^9}, {3.847324821415454*^9, 
   3.847324827616331*^9}, {3.848674269032506*^9, 3.848674328778432*^9}, {
   3.8486745830614443`*^9, 3.84867458859791*^9}, {3.848674673802854*^9, 
   3.8486747729828777`*^9}, {3.8486748293106813`*^9, 
   3.8486748914526854`*^9}, {3.848675051429625*^9, 3.8486750840841312`*^9}, {
   3.848675697305347*^9, 3.848675745098153*^9}, {3.848675836237754*^9, 
   3.848675878484573*^9}, {3.848675937194085*^9, 3.84867593953835*^9}, {
   3.8486759712085123`*^9, 3.84867597212854*^9}, {3.848676022895049*^9, 
   3.848676023350955*^9}, {3.84867608692428*^9, 3.84867610519879*^9}, {
   3.848676158813027*^9, 3.8486763087015343`*^9}, {3.8486767819872637`*^9, 
   3.848676788878832*^9}, {3.848676902163513*^9, 3.8486769030958443`*^9}, {
   3.848677073682303*^9, 3.848677084036203*^9}, {3.848677126606049*^9, 
   3.848677178337009*^9}, {3.8486779642439413`*^9, 3.848678202246583*^9}, {
   3.848678246332098*^9, 3.848678258523261*^9}, {3.8486784025796547`*^9, 
   3.8486784120222282`*^9}, {3.848678741834424*^9, 3.84867874304176*^9}, {
   3.848679237647085*^9, 3.848679240880933*^9}, {3.848679316596281*^9, 
   3.848679318513324*^9}, {3.848679357793902*^9, 3.848679359847418*^9}, {
   3.848679764405698*^9, 3.848679798660019*^9}, {3.848679939371924*^9, 
   3.8486799427152452`*^9}, {3.848680074078043*^9, 3.848680094160306*^9}, {
   3.848680206542138*^9, 3.848680227881358*^9}, {3.85081030556612*^9, 
   3.850810307726795*^9}},
 CellLabel->
  "In[259]:=",ExpressionUUID->"de9d90ff-36d4-4acd-a124-54bc81661d37"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"maxN", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wfomc", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"WFOMC1", "[", 
      RowBox[{"n", ",", "example1Regularity"}], "]"}], ",", 
     "\[IndentingNewLine]", " ", 
     RowBox[{"{", 
      RowBox[{"n", ",", " ", "0", ",", " ", "maxN"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Simplify", "[", "wfomc", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"wfomcCc", " ", "=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{
      RowBox[{"wfomc", "[", 
       RowBox[{"[", 
        RowBox[{"n", "+", "1"}], "]"}], "]"}], ",", "\[FormalZ]", ",", "n"}], 
     "]"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"n", ",", "0", ",", "maxN"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.837671569973804*^9, 3.8376715949630013`*^9}, {
   3.837671627206588*^9, 3.837671631546236*^9}, {3.837678818766939*^9, 
   3.837678831829865*^9}, {3.837678937946063*^9, 3.8376789529351254`*^9}, {
   3.837679364693651*^9, 3.837679417960854*^9}, {3.838111781844524*^9, 
   3.838111784124291*^9}, {3.8381118428259373`*^9, 3.838111910430691*^9}, {
   3.838698894148209*^9, 3.838698906137195*^9}, {3.838699871003758*^9, 
   3.8386998807575274`*^9}, {3.8387000986729717`*^9, 3.838700114533228*^9}, {
   3.838884395033263*^9, 3.838884442692211*^9}, 3.838885201886492*^9, {
   3.839925781031042*^9, 3.83992578198174*^9}, {3.839990422206552*^9, 
   3.839990711507616*^9}, {3.8399950578864613`*^9, 3.839995058842905*^9}, {
   3.84173890023422*^9, 3.841738906317997*^9}, 3.841738955804636*^9, {
   3.8424114733924713`*^9, 3.8424114754811907`*^9}, {3.842498320074768*^9, 
   3.842498323514279*^9}, {3.842498407005143*^9, 3.842498432216782*^9}, {
   3.842504902397052*^9, 3.842504907235993*^9}, {3.84251199905208*^9, 
   3.842512000157771*^9}, {3.842684664202684*^9, 3.842684665596312*^9}, 
   3.842685090396718*^9, 3.842685151201456*^9, {3.8426868026457157`*^9, 
   3.842686807361463*^9}, 3.84268802199098*^9, {3.842949796663443*^9, 
   3.842949843564514*^9}, {3.842949938090705*^9, 3.842949938616262*^9}, 
   3.843119985715637*^9, 3.8431200389916277`*^9, 3.84312010649266*^9, {
   3.8431201406241283`*^9, 3.843120141838829*^9}, 3.843120889811881*^9, {
   3.844867210404648*^9, 3.844867218239257*^9}, {3.848678690619937*^9, 
   3.848678690760083*^9}, {3.84868093982367*^9, 3.848680947861065*^9}, 
   3.848681065821166*^9, {3.848681189146052*^9, 3.8486812012804813`*^9}},
 CellLabel->
  "In[269]:=",ExpressionUUID->"3967da30-0426-4e51-8fed-f7c482dc836e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1", ",", "0", ",", "1", ",", "0", ",", "3", ",", "0", ",", "15", ",", "0", 
   ",", "105", ",", "0", ",", "945"}], "}"}]], "Output",
 CellChangeTimes->{{3.837671573612368*^9, 3.837671595498357*^9}, 
   3.837671631855782*^9, {3.837678823257477*^9, 3.837678832158881*^9}, {
   3.837678939241272*^9, 3.83767895328126*^9}, {3.8376793938334217`*^9, 
   3.837679420199458*^9}, 3.837745785659285*^9, 3.837746983196039*^9, {
   3.837747250296301*^9, 3.8377472724534893`*^9}, 3.837747464566654*^9, 
   3.838090773490415*^9, 3.838092410185232*^9, 3.838093499868433*^9, {
   3.838093576075965*^9, 3.8380935923208027`*^9}, 3.838094131970779*^9, {
   3.838099053156966*^9, 3.8380990650603533`*^9}, 3.838102379617313*^9, 
   3.838103145302347*^9, 3.838108071159771*^9, {3.838111744725732*^9, 
   3.838111784742243*^9}, {3.838111906302454*^9, 3.838111911175551*^9}, 
   3.83812255757415*^9, 3.838122610587903*^9, 3.8381234411805*^9, 
   3.838183710998446*^9, 3.838184258966941*^9, {3.838184374123165*^9, 
   3.838184488370401*^9}, 3.838184583949355*^9, {3.83818870993018*^9, 
   3.838188730323399*^9}, 3.838189245691696*^9, 3.8381892837754993`*^9, 
   3.838191834650038*^9, 3.838191865897613*^9, {3.838191930535947*^9, 
   3.8381919512149963`*^9}, 3.838191989338784*^9, 3.838193627078986*^9, 
   3.838193666058004*^9, 3.8381969996710587`*^9, 3.838197036964589*^9, 
   3.83819708790653*^9, 3.838197474412085*^9, {3.838197518412426*^9, 
   3.838197537022626*^9}, 3.838354173953002*^9, 3.8383544325390043`*^9, {
   3.838354559879693*^9, 3.8383545844135427`*^9}, 3.838437454340425*^9, 
   3.8386949610540257`*^9, {3.838698889811092*^9, 3.838698906779139*^9}, {
   3.838699821471425*^9, 3.83869988477948*^9}, {3.838700087249617*^9, 
   3.838700115149205*^9}, 3.838883982557371*^9, {3.838884425674006*^9, 
   3.838884466446857*^9}, {3.838884509684677*^9, 3.838884519082439*^9}, {
   3.838884679375298*^9, 3.838884722427343*^9}, 3.8388852023435917`*^9, 
   3.8388865547976103`*^9, 3.838886585295733*^9, 3.8389565196962357`*^9, 
   3.838957068295257*^9, 3.838957113777787*^9, 3.839300318239327*^9, 
   3.839907181322254*^9, 3.839922473547883*^9, 3.839925437534092*^9, 
   3.839925619759066*^9, {3.839925769851269*^9, 3.839925782866544*^9}, 
   3.839926017961771*^9, 3.839926863715646*^9, 3.8399279849063396`*^9, 
   3.8399881568252697`*^9, 3.8399899837842407`*^9, 3.8399901625326967`*^9, 
   3.839990393910696*^9, {3.8399904384614763`*^9, 3.839990500460194*^9}, {
   3.839990577014641*^9, 3.8399906022248363`*^9}, {3.839990651629342*^9, 
   3.839990714802765*^9}, 3.8399907905538397`*^9, 3.8399913500436907`*^9, 
   3.8399914200377483`*^9, {3.8399917374893837`*^9, 3.839991773360799*^9}, 
   3.839991844492547*^9, {3.839995053980176*^9, 3.8399950602845707`*^9}, {
   3.839995114539592*^9, 3.839995124070311*^9}, {3.840005776393983*^9, 
   3.840005799898006*^9}, 3.840005875259334*^9, 3.8400786282227383`*^9, {
   3.840080538610586*^9, 3.840080545918857*^9}, 3.8400806065379343`*^9, 
   3.840080637277802*^9, 3.840268854842648*^9, 3.840528032691893*^9, 
   3.841112940951008*^9, 3.841716900365094*^9, {3.841725056293642*^9, 
   3.841725081266758*^9}, 3.841738843627206*^9, {3.8417389072677717`*^9, 
   3.841738956173457*^9}, {3.841739486663186*^9, 3.8417394914218817`*^9}, 
   3.841740850381817*^9, 3.8417409250508738`*^9, 3.841975058878697*^9, 
   3.8419787620753*^9, 3.842067564924415*^9, 3.842068280900497*^9, 
   3.842239486063857*^9, 3.842256346928388*^9, 3.842411363614459*^9, 
   3.8424114759352427`*^9, 3.84249155006269*^9, 3.842493733557475*^9, 
   3.84249456840998*^9, 3.842497536592144*^9, 3.842498323846835*^9, {
   3.842498409710412*^9, 3.842498432707316*^9}, 3.8424988429300833`*^9, 
   3.842502057313094*^9, {3.8425045373043737`*^9, 3.842504559302311*^9}, {
   3.842504902915909*^9, 3.842504907779996*^9}, 3.8425120005139103`*^9, 
   3.8425788609320107`*^9, 3.8426703581415873`*^9, 3.842677638722488*^9, 
   3.842678810110403*^9, 3.842678965419258*^9, {3.842679009250581*^9, 
   3.842679021747843*^9}, {3.842679096636393*^9, 3.8426791225331373`*^9}, {
   3.842679371773077*^9, 3.842679386412108*^9}, 3.842684665936859*^9, {
   3.842685151916936*^9, 3.842685170554677*^9}, 3.842685235917677*^9, {
   3.842686782804693*^9, 3.842686808115036*^9}, 3.842688023223915*^9, 
   3.842688130135625*^9, 3.842688210947959*^9, 3.842931586019629*^9, 
   3.842931620951811*^9, {3.842932939020261*^9, 3.8429329642854156`*^9}, 
   3.842949745216279*^9, 3.842949812910612*^9, 3.8429498439561043`*^9, 
   3.8429499391391363`*^9, 3.84301751340419*^9, 3.843103639163394*^9, 
   3.843105295455724*^9, 3.843105327644846*^9, 3.843119987009317*^9, {
   3.843120022155202*^9, 3.843120040567951*^9}, 3.8431201074518538`*^9, {
   3.843120868577064*^9, 3.843120891384077*^9}, 3.8431220117032547`*^9, 
   3.843204645997534*^9, 3.843204677948079*^9, 3.843538172506921*^9, 
   3.843546567188149*^9, 3.843789503831716*^9, 3.844867157395656*^9, {
   3.84486719827738*^9, 3.8448672189872437`*^9}, 3.844867259079626*^9, 
   3.84579776073307*^9, 3.84580093530514*^9, 3.847199233845786*^9, 
   3.847320511121031*^9, 3.847321196102179*^9, {3.847321267858863*^9, 
   3.847321295403536*^9}, 3.847321431296432*^9, 3.8473231548338213`*^9, 
   3.847323222544901*^9, 3.847323275535832*^9, 3.8473233632582903`*^9, 
   3.847323582948038*^9, 3.847323632911172*^9, 3.847323692897523*^9, 
   3.847323873424378*^9, 3.848673877834632*^9, 3.848678691295682*^9, 
   3.8486798247556562`*^9, 3.848680212332933*^9, {3.848680940683055*^9, 
   3.8486809487558413`*^9}, 3.8486810710090322`*^9, {3.848681189881049*^9, 
   3.848681207960766*^9}, 3.850810129909398*^9, 3.850810313830804*^9},
 CellLabel->
  "Out[272]=",ExpressionUUID->"9d504fd5-f938-4e65-ad14-45047a21c2ad"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"maxN", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wfomc", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"WFOMC5", "[", 
      RowBox[{"n", ",", "example1Regularity"}], "]"}], ",", 
     "\[IndentingNewLine]", " ", 
     RowBox[{"{", 
      RowBox[{"n", ",", " ", "0", ",", " ", "maxN"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Simplify", "[", "wfomc", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"wfomcCc", " ", "=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{
      RowBox[{"wfomc", "[", 
       RowBox[{"[", 
        RowBox[{"n", "+", "1"}], "]"}], "]"}], ",", "\[FormalZ]", ",", "n"}], 
     "]"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"n", ",", "0", ",", "maxN"}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8429498323722887`*^9, 3.8429498392365923`*^9}, {
   3.8435468757054033`*^9, 3.843546880011199*^9}, {3.84354717883934*^9, 
   3.843547206491946*^9}, {3.843547308405616*^9, 3.84354731016232*^9}, {
   3.843548296647484*^9, 3.8435483126393642`*^9}, {3.843801113628674*^9, 
   3.843801115226584*^9}, 3.843801183941454*^9, {3.847321189078753*^9, 
   3.847321191605629*^9}, {3.847323249760727*^9, 3.847323259567906*^9}, {
   3.847323618203614*^9, 3.84732362985568*^9}, {3.8486786968755207`*^9, 
   3.8486786970316687`*^9}, {3.8486809504691896`*^9, 3.848680956339301*^9}, 
   3.848681067011128*^9, {3.848681196921722*^9, 3.848681204759378*^9}},
 CellLabel->
  "In[273]:=",ExpressionUUID->"683368db-8a73-4cfb-935a-6b3f32f4c0b6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1", ",", "0", ",", "1", ",", "0", ",", "3", ",", "0", ",", "15", ",", "0", 
   ",", "105", ",", "0", ",", "945"}], "}"}]], "Output",
 CellChangeTimes->{{3.837671573612368*^9, 3.837671595498357*^9}, 
   3.837671631855782*^9, {3.837678823257477*^9, 3.837678832158881*^9}, {
   3.837678939241272*^9, 3.83767895328126*^9}, {3.8376793938334217`*^9, 
   3.837679420199458*^9}, 3.837745785659285*^9, 3.837746983196039*^9, {
   3.837747250296301*^9, 3.8377472724534893`*^9}, 3.837747464566654*^9, 
   3.838090773490415*^9, 3.838092410185232*^9, 3.838093499868433*^9, {
   3.838093576075965*^9, 3.8380935923208027`*^9}, 3.838094131970779*^9, {
   3.838099053156966*^9, 3.8380990650603533`*^9}, 3.838102379617313*^9, 
   3.838103145302347*^9, 3.838108071159771*^9, {3.838111744725732*^9, 
   3.838111784742243*^9}, {3.838111906302454*^9, 3.838111911175551*^9}, 
   3.83812255757415*^9, 3.838122610587903*^9, 3.8381234411805*^9, 
   3.838183710998446*^9, 3.838184258966941*^9, {3.838184374123165*^9, 
   3.838184488370401*^9}, 3.838184583949355*^9, {3.83818870993018*^9, 
   3.838188730323399*^9}, 3.838189245691696*^9, 3.8381892837754993`*^9, 
   3.838191834650038*^9, 3.838191865897613*^9, {3.838191930535947*^9, 
   3.8381919512149963`*^9}, 3.838191989338784*^9, 3.838193627078986*^9, 
   3.838193666058004*^9, 3.8381969996710587`*^9, 3.838197036964589*^9, 
   3.83819708790653*^9, 3.838197474412085*^9, {3.838197518412426*^9, 
   3.838197537022626*^9}, 3.838354173953002*^9, 3.8383544325390043`*^9, {
   3.838354559879693*^9, 3.8383545844135427`*^9}, 3.838437454340425*^9, 
   3.8386949610540257`*^9, {3.838698889811092*^9, 3.838698906779139*^9}, {
   3.838699821471425*^9, 3.83869988477948*^9}, {3.838700087249617*^9, 
   3.838700115149205*^9}, 3.838883982557371*^9, {3.838884425674006*^9, 
   3.838884466446857*^9}, {3.838884509684677*^9, 3.838884519082439*^9}, {
   3.838884679375298*^9, 3.838884722427343*^9}, 3.8388852023435917`*^9, 
   3.8388865547976103`*^9, 3.838886585295733*^9, 3.8389565196962357`*^9, 
   3.838957068295257*^9, 3.838957113777787*^9, 3.839300318239327*^9, 
   3.839907181322254*^9, 3.839922473547883*^9, 3.839925437534092*^9, 
   3.839925619759066*^9, {3.839925769851269*^9, 3.839925782866544*^9}, 
   3.839926017961771*^9, 3.839926863715646*^9, 3.8399279849063396`*^9, 
   3.8399881568252697`*^9, 3.8399899837842407`*^9, 3.8399901625326967`*^9, 
   3.839990393910696*^9, {3.8399904384614763`*^9, 3.839990500460194*^9}, {
   3.839990577014641*^9, 3.8399906022248363`*^9}, {3.839990651629342*^9, 
   3.839990714802765*^9}, 3.8399907905538397`*^9, 3.8399913500436907`*^9, 
   3.8399914200377483`*^9, {3.8399917374893837`*^9, 3.839991773360799*^9}, 
   3.839991844492547*^9, {3.839995053980176*^9, 3.8399950602845707`*^9}, {
   3.839995114539592*^9, 3.839995124070311*^9}, {3.840005776393983*^9, 
   3.840005799898006*^9}, 3.840005875259334*^9, 3.8400786282227383`*^9, {
   3.840080538610586*^9, 3.840080545918857*^9}, 3.8400806065379343`*^9, 
   3.840080637277802*^9, 3.840268854842648*^9, 3.840528032691893*^9, 
   3.841112940951008*^9, 3.841716900365094*^9, {3.841725056293642*^9, 
   3.841725081266758*^9}, 3.841738843627206*^9, {3.8417389072677717`*^9, 
   3.841738956173457*^9}, {3.841739486663186*^9, 3.8417394914218817`*^9}, 
   3.841740850381817*^9, 3.8417409250508738`*^9, 3.841975058878697*^9, 
   3.8419787620753*^9, 3.842067564924415*^9, 3.842068280900497*^9, 
   3.842239486063857*^9, 3.842256346928388*^9, 3.842411363614459*^9, 
   3.8424114759352427`*^9, 3.84249155006269*^9, 3.842493733557475*^9, 
   3.84249456840998*^9, 3.842497536592144*^9, 3.842498323846835*^9, {
   3.842498409710412*^9, 3.842498432707316*^9}, 3.8424988429300833`*^9, 
   3.842502057313094*^9, {3.8425045373043737`*^9, 3.842504559302311*^9}, {
   3.842504902915909*^9, 3.842504907779996*^9}, 3.8425120005139103`*^9, 
   3.8425788609320107`*^9, 3.8426703581415873`*^9, 3.842677638722488*^9, 
   3.842678810110403*^9, 3.842678965419258*^9, {3.842679009250581*^9, 
   3.842679021747843*^9}, {3.842679096636393*^9, 3.8426791225331373`*^9}, {
   3.842679371773077*^9, 3.842679386412108*^9}, 3.842684665936859*^9, {
   3.842685151916936*^9, 3.842685170554677*^9}, 3.842685235917677*^9, {
   3.842686782804693*^9, 3.842686808115036*^9}, 3.842688023223915*^9, 
   3.842688130135625*^9, 3.842688210947959*^9, 3.842931586019629*^9, 
   3.842931620951811*^9, {3.842932939020261*^9, 3.8429329642854156`*^9}, 
   3.842949745216279*^9, {3.8429498129151897`*^9, 3.842949840169348*^9}, 
   3.8430175134513283`*^9, 3.843103639206169*^9, 3.8431052963613358`*^9, 
   3.843105327661302*^9, 3.8432046460247717`*^9, 3.8432046779756613`*^9, 
   3.843538172532076*^9, 3.8435468804650793`*^9, 3.843548313008213*^9, 
   3.843548409738111*^9, 3.843789504090852*^9, 3.843795248681952*^9, 
   3.843797143215765*^9, 3.8437975006811037`*^9, 3.843798030290427*^9, 
   3.84379809928992*^9, 3.8437995051192408`*^9, {3.84379996575911*^9, 
   3.843799995429706*^9}, 3.843800504490286*^9, 3.843801116018118*^9, {
   3.8438011587138357`*^9, 3.84380118477372*^9}, 3.843802833372725*^9, 
   3.844867157965579*^9, 3.844867259185585*^9, 3.844867794624888*^9, 
   3.845797760947771*^9, 3.845800935436488*^9, 3.845805728066412*^9, 
   3.847199234105349*^9, 3.847320511344701*^9, 3.847321196679702*^9, {
   3.847321268385971*^9, 3.8473212959311123`*^9}, {3.847321431714003*^9, 
   3.847321435997304*^9}, 3.847323114146286*^9, {3.847323149808105*^9, 
   3.847323161431017*^9}, 3.847323229211738*^9, {3.847323266708045*^9, 
   3.847323282208414*^9}, 3.8473233699615517`*^9, 3.847323589575272*^9, {
   3.847323621643312*^9, 3.8473236395620327`*^9}, 3.847323699582781*^9, 
   3.847323873476856*^9, 3.8473246795204144`*^9, 3.8473247164544764`*^9, 
   3.84732477036835*^9, 3.848673877892243*^9, 3.84867455642272*^9, {
   3.848678682604033*^9, 3.84867869751586*^9}, 3.8486798224156218`*^9, 
   3.848680081541864*^9, 3.84868021397467*^9, 3.848680957015903*^9, 
   3.848681072694577*^9, {3.848681197556178*^9, 3.8486812057033854`*^9}, 
   3.850810130019562*^9, 3.8508103139152937`*^9},
 CellLabel->
  "Out[276]=",ExpressionUUID->"49f2e522-dcfd-4314-926d-8fde4a9b1fac"]
}, Open  ]],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{3.847323621746594*^9},
 CellLabel->
  "In[277]:=",ExpressionUUID->"bd2714d0-b946-4a77-8bbf-8865f34cead2"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"maxN", "=", "6"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wfomc", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"WFOMC5K", "[", 
      RowBox[{"n", ",", "example1Regularity"}], "]"}], ",", 
     "\[IndentingNewLine]", " ", 
     RowBox[{"{", 
      RowBox[{"n", ",", " ", "0", ",", " ", "maxN"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", "wfomc", "]"}], "\[IndentingNewLine]", 
 RowBox[{"wfomcCc", " ", "=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{
      RowBox[{"wfomc", "[", 
       RowBox[{"[", 
        RowBox[{"n", "+", "1"}], "]"}], "]"}], ",", "\[FormalZ]", ",", "n"}], 
     "]"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"n", ",", "0", ",", "maxN"}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.842426670494026*^9, 3.8424266811921864`*^9}, {
   3.8424946177722673`*^9, 3.842494659467057*^9}, {3.842946351843321*^9, 
   3.842946409196913*^9}, {3.842948939013582*^9, 3.842949041877284*^9}, {
   3.847320707350383*^9, 3.847320709857473*^9}, {3.847320765789495*^9, 
   3.8473207696030703`*^9}, {3.8486787061030073`*^9, 3.848678710551343*^9}, 
   3.848681068530726*^9},
 CellLabel->
  "In[278]:=",ExpressionUUID->"fe0a984a-b40b-4fd3-a472-cf44d95b7e7d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "3", ",", 
   RowBox[{"9", "+", 
    SuperscriptBox["\[FormalZ]", "2"]}], ",", 
   RowBox[{"27", "+", 
    RowBox[{"9", " ", 
     SuperscriptBox["\[FormalZ]", "2"]}], "+", 
    RowBox[{"3", " ", 
     SuperscriptBox["\[FormalZ]", "4"]}], "+", 
    SuperscriptBox["\[FormalZ]", "6"]}], ",", 
   RowBox[{"48", "+", 
    RowBox[{"24", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       SuperscriptBox["\[FormalZ]", "2"]}], ")"}]}], "+", 
    RowBox[{"8", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["\[FormalZ]", "2"]}], ")"}], "3"]}], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "+", 
       SuperscriptBox["\[FormalZ]", "2"]}], ")"}], "6"]}], ",", 
   RowBox[{"112", "+", 
    RowBox[{"80", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       SuperscriptBox["\[FormalZ]", "2"]}], ")"}]}], "+", 
    RowBox[{"40", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["\[FormalZ]", "2"]}], ")"}], "3"]}], "+", 
    RowBox[{"10", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["\[FormalZ]", "2"]}], ")"}], "6"]}], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "+", 
       SuperscriptBox["\[FormalZ]", "2"]}], ")"}], "10"]}], ",", 
   RowBox[{"256", "+", 
    RowBox[{"240", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       SuperscriptBox["\[FormalZ]", "2"]}], ")"}]}], "+", 
    RowBox[{"160", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["\[FormalZ]", "2"]}], ")"}], "3"]}], "+", 
    RowBox[{"60", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["\[FormalZ]", "2"]}], ")"}], "6"]}], "+", 
    RowBox[{"12", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["\[FormalZ]", "2"]}], ")"}], "10"]}], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "+", 
       SuperscriptBox["\[FormalZ]", "2"]}], ")"}], "15"]}]}], "}"}]], "Output",\

 CellChangeTimes->{
  3.842494661045968*^9, 3.842497536767804*^9, 3.8425020574541187`*^9, {
   3.8425045374709787`*^9, 3.8425045594579906`*^9}, 3.842578861219552*^9, 
   3.842670358313191*^9, 3.842678810253913*^9, 3.842678965632924*^9, 
   3.842679009394916*^9, 3.842679096778264*^9, {3.842679371932672*^9, 
   3.842679386555375*^9}, 3.842931588898726*^9, 3.842931621104723*^9, {
   3.8429329434871273`*^9, 3.84293296445893*^9}, {3.842946353128191*^9, 
   3.842946372025078*^9}, 3.84294641221021*^9, {3.84294894014196*^9, 
   3.842948962964452*^9}, {3.8429489936672773`*^9, 3.842949042363619*^9}, 
   3.843017513509437*^9, 3.843103639261375*^9, 3.84310529646*^9, 
   3.843105327711995*^9, 3.843204646137689*^9, 3.8432046780365553`*^9, 
   3.8435381726323957`*^9, 3.843789504151237*^9, 3.844867157979562*^9, 
   3.844867259197407*^9, 3.8457977609627333`*^9, 3.845800935455208*^9, 
   3.847199234124092*^9, 3.847320511369692*^9, 3.847320710281025*^9, 
   3.847320769948882*^9, 3.8473211969226093`*^9, {3.847321268579549*^9, 
   3.847321296139552*^9}, 3.8473214318039827`*^9, 3.847323161578899*^9, 
   3.847323229354063*^9, 3.847323282358783*^9, 3.8473233701169243`*^9, 
   3.847323589756275*^9, 3.847323639715642*^9, 3.847323699738048*^9, 
   3.847323873495473*^9, 3.848673877914296*^9, 3.8486787113368397`*^9, 
   3.8486787485100727`*^9, 3.848679323468067*^9, 3.848679404301177*^9, 
   3.84867972454216*^9, 3.848679827013796*^9, {3.84867994884485*^9, 
   3.848679960323292*^9}, 3.8486802161292953`*^9, 3.8486810756254377`*^9, 
   3.850810130177411*^9, 3.850810314071108*^9},
 CellLabel->
  "Out[280]=",ExpressionUUID->"cf6af831-c863-492a-bf99-6d9fc252ce11"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1", ",", "0", ",", "1", ",", "0", ",", "39", ",", "0", ",", "3255"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.842494661045968*^9, 3.842497536767804*^9, 3.8425020574541187`*^9, {
   3.8425045374709787`*^9, 3.8425045594579906`*^9}, 3.842578861219552*^9, 
   3.842670358313191*^9, 3.842678810253913*^9, 3.842678965632924*^9, 
   3.842679009394916*^9, 3.842679096778264*^9, {3.842679371932672*^9, 
   3.842679386555375*^9}, 3.842931588898726*^9, 3.842931621104723*^9, {
   3.8429329434871273`*^9, 3.84293296445893*^9}, {3.842946353128191*^9, 
   3.842946372025078*^9}, 3.84294641221021*^9, {3.84294894014196*^9, 
   3.842948962964452*^9}, {3.8429489936672773`*^9, 3.842949042363619*^9}, 
   3.843017513509437*^9, 3.843103639261375*^9, 3.84310529646*^9, 
   3.843105327711995*^9, 3.843204646137689*^9, 3.8432046780365553`*^9, 
   3.8435381726323957`*^9, 3.843789504151237*^9, 3.844867157979562*^9, 
   3.844867259197407*^9, 3.8457977609627333`*^9, 3.845800935455208*^9, 
   3.847199234124092*^9, 3.847320511369692*^9, 3.847320710281025*^9, 
   3.847320769948882*^9, 3.8473211969226093`*^9, {3.847321268579549*^9, 
   3.847321296139552*^9}, 3.8473214318039827`*^9, 3.847323161578899*^9, 
   3.847323229354063*^9, 3.847323282358783*^9, 3.8473233701169243`*^9, 
   3.847323589756275*^9, 3.847323639715642*^9, 3.847323699738048*^9, 
   3.847323873495473*^9, 3.848673877914296*^9, 3.8486787113368397`*^9, 
   3.8486787485100727`*^9, 3.848679323468067*^9, 3.848679404301177*^9, 
   3.84867972454216*^9, 3.848679827013796*^9, {3.84867994884485*^9, 
   3.848679960323292*^9}, 3.8486802161292953`*^9, 3.8486810756254377`*^9, 
   3.850810130177411*^9, 3.8508103140729923`*^9},
 CellLabel->
  "Out[281]=",ExpressionUUID->"61530b4c-3ea3-460d-9577-87f46559bda0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Length", "/@", 
    RowBox[{"IndependetSets", "[", "exampleDerangements", "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"Length", "/@", 
    RowBox[{"IndependetSets", "[", "example1Regularity", "]"}]}]}]}]], "Input",\

 CellChangeTimes->{{3.842424199806501*^9, 3.842424243193194*^9}, {
  3.8424266398346243`*^9, 3.842426660344995*^9}, {3.8425969514390783`*^9, 
  3.8425969534404173`*^9}, {3.8426024538342133`*^9, 3.842602453998652*^9}, {
  3.842602599984399*^9, 3.842602620702224*^9}, {3.848681009499847*^9, 
  3.848681057328233*^9}},
 CellLabel->
  "In[282]:=",ExpressionUUID->"c75e1d7a-620f-4cb2-947a-cd33f46e90d6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.8424242142215023`*^9, 3.842424243606419*^9}, 
   3.842426642521994*^9, 3.842491550305375*^9, {3.842493729494198*^9, 
   3.842493733949793*^9}, 3.842494568622232*^9, {3.842497536780237*^9, 
   3.842497551205678*^9}, 3.8425020574666033`*^9, {3.8425045374857883`*^9, 
   3.8425045594726152`*^9}, 3.842578861234462*^9, {3.842596945999043*^9, 
   3.84259695375585*^9}, 3.842602454515995*^9, {3.842602602327146*^9, 
   3.8426026167014236`*^9}, 3.842670358326449*^9, 3.842678810264473*^9, 
   3.842678965644209*^9, 3.8426790094050407`*^9, 3.842679096789125*^9, {
   3.8426793719473*^9, 3.8426793865667667`*^9}, 3.842931588911899*^9, 
   3.842931621116248*^9, {3.842932943505303*^9, 3.8429329644704313`*^9}, 
   3.8430175135243073`*^9, 3.843103639275936*^9, 3.843105296473823*^9, 
   3.843105327723154*^9, 3.843204646164763*^9, 3.8432046780531282`*^9, 
   3.843538172647829*^9, 3.84378950416467*^9, 3.8448671579926243`*^9, 
   3.844867259211981*^9, 3.8457977609764223`*^9, 3.84580093547373*^9, 
   3.8471992341411037`*^9, 3.847320511386039*^9, 3.847321196949007*^9, {
   3.847321268589686*^9, 3.8473212961690607`*^9}, 3.8473214318138533`*^9, 
   3.847323161597726*^9, 3.847323229364224*^9, 3.847323282378792*^9, 
   3.8473233701364117`*^9, 3.847323589775116*^9, 3.8473236397358513`*^9, 
   3.847323699757951*^9, 3.847323873504436*^9, 3.84867387792658*^9, {
   3.848681019024824*^9, 3.848681057655862*^9}, 3.850810130196189*^9, 
   3.850810314097519*^9},
 CellLabel->
  "Out[282]=",ExpressionUUID->"017bc562-8faa-4bf4-8d5c-49090010aaf9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{{3.8424242142215023`*^9, 3.842424243606419*^9}, 
   3.842426642521994*^9, 3.842491550305375*^9, {3.842493729494198*^9, 
   3.842493733949793*^9}, 3.842494568622232*^9, {3.842497536780237*^9, 
   3.842497551205678*^9}, 3.8425020574666033`*^9, {3.8425045374857883`*^9, 
   3.8425045594726152`*^9}, 3.842578861234462*^9, {3.842596945999043*^9, 
   3.84259695375585*^9}, 3.842602454515995*^9, {3.842602602327146*^9, 
   3.8426026167014236`*^9}, 3.842670358326449*^9, 3.842678810264473*^9, 
   3.842678965644209*^9, 3.8426790094050407`*^9, 3.842679096789125*^9, {
   3.8426793719473*^9, 3.8426793865667667`*^9}, 3.842931588911899*^9, 
   3.842931621116248*^9, {3.842932943505303*^9, 3.8429329644704313`*^9}, 
   3.8430175135243073`*^9, 3.843103639275936*^9, 3.843105296473823*^9, 
   3.843105327723154*^9, 3.843204646164763*^9, 3.8432046780531282`*^9, 
   3.843538172647829*^9, 3.84378950416467*^9, 3.8448671579926243`*^9, 
   3.844867259211981*^9, 3.8457977609764223`*^9, 3.84580093547373*^9, 
   3.8471992341411037`*^9, 3.847320511386039*^9, 3.847321196949007*^9, {
   3.847321268589686*^9, 3.8473212961690607`*^9}, 3.8473214318138533`*^9, 
   3.847323161597726*^9, 3.847323229364224*^9, 3.847323282378792*^9, 
   3.8473233701364117`*^9, 3.847323589775116*^9, 3.8473236397358513`*^9, 
   3.847323699757951*^9, 3.847323873504436*^9, 3.84867387792658*^9, {
   3.848681019024824*^9, 3.848681057655862*^9}, 3.850810130196189*^9, 
   3.850810314112265*^9},
 CellLabel->
  "Out[283]=",ExpressionUUID->"8f5ba232-73cd-40ba-b940-a323ac6a615d"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.842501897759088*^9, 3.842501981346961*^9}, {
   3.8486810998173532`*^9, 3.84868113087292*^9}, 3.848681169970584*^9},
 CellLabel->
  "In[284]:=",ExpressionUUID->"433b46ea-1aab-4939-a788-2b2fcf74139a"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.842677739887353*^9, 3.842677768284544*^9}, {
  3.842677819338941*^9, 3.84267786061169*^9}, {3.842678345872422*^9, 
  3.842678369077306*^9}, {3.842678725189828*^9, 3.8426787260350857`*^9}, {
  3.848681287958466*^9, 3.848681289480199*^9}},
 CellLabel->
  "In[285]:=",ExpressionUUID->"90def5fd-d3ca-4dad-9f1d-3362578ad2d5"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8426912035796967`*^9, 3.842691205686574*^9}},
 CellLabel->
  "In[286]:=",ExpressionUUID->"53be15de-9c20-4ffc-8406-9c5b002d3f28"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"STerm", "[", 
  RowBox[{
   RowBox[{"example2Regularity", "[", 
    RowBox[{"[", "1", "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"e", "[", 
       RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", "False"}],
      ",", 
     RowBox[{
      RowBox[{"f1", "[", 
       RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", "False"}],
      ",", 
     RowBox[{
      RowBox[{"f2", "[", 
       RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", "False"}],
      ",", 
     RowBox[{
      RowBox[{"s1", "[", "\[FormalA]", "]"}], "\[Rule]", "False"}], ",", 
     RowBox[{
      RowBox[{"s2", "[", "\[FormalA]", "]"}], "\[Rule]", "False"}]}], "}"}], 
   ",", 
   RowBox[{"example2Regularity", "[", 
    RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
   RowBox[{"example2Regularity", "[", 
    RowBox[{"[", "3", "]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.842691263942565*^9, 3.842691287562791*^9}},
 CellLabel->
  "In[287]:=",ExpressionUUID->"245cbaa0-c0c1-4efc-94be-e104cd1c5f7b"],

Cell[BoxData[
 RowBox[{"STerm", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"!", 
     RowBox[{"e", "[", 
      RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}]}], "&&", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"e", "[", 
       RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Equivalent]", 
      RowBox[{"e", "[", 
       RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}]}], ")"}], "&&", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"f1", "[", 
       RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Implies]", 
      RowBox[{"s1", "[", "\[FormalA]", "]"}]}], ")"}], "&&", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"f2", "[", 
       RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Implies]", 
      RowBox[{"s2", "[", "\[FormalA]", "]"}]}], ")"}], "&&", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"e", "[", 
       RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Equivalent]", 
      RowBox[{
       RowBox[{"f1", "[", 
        RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "||", 
       RowBox[{"f2", "[", 
        RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}]}]}], ")"}], "&&", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"!", 
       RowBox[{"f1", "[", 
        RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}]}], "||", 
      RowBox[{"!", 
       RowBox[{"f2", "[", 
        RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}]}]}], ")"}]}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"e", "[", 
       RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", "False"}],
      ",", 
     RowBox[{
      RowBox[{"f1", "[", 
       RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", "False"}],
      ",", 
     RowBox[{
      RowBox[{"f2", "[", 
       RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", "False"}],
      ",", 
     RowBox[{
      RowBox[{"s1", "[", "\[FormalA]", "]"}], "\[Rule]", "False"}], ",", 
     RowBox[{
      RowBox[{"s2", "[", "\[FormalA]", "]"}], "\[Rule]", "False"}]}], "}"}], 
   ",", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"e", "\[Rule]", "\[FormalZ]"}], ",", 
     RowBox[{"s1", "\[Rule]", "1"}], ",", 
     RowBox[{"s2", "\[Rule]", "1"}], ",", 
     RowBox[{"f1", "\[Rule]", "1"}], ",", 
     RowBox[{"f2", "\[Rule]", "1"}]}], "\[RightAssociation]"}], ",", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"e", "\[Rule]", "1"}], ",", 
     RowBox[{"s1", "\[Rule]", 
      RowBox[{"-", "1"}]}], ",", 
     RowBox[{"s2", "\[Rule]", 
      RowBox[{"-", "1"}]}], ",", 
     RowBox[{"f1", "\[Rule]", "1"}], ",", 
     RowBox[{"f2", "\[Rule]", "1"}]}], "\[RightAssociation]"}]}], 
  "]"}]], "Output",
 CellChangeTimes->{
  3.842691288002749*^9, 3.842691361736292*^9, 3.8429315889718122`*^9, 
   3.842931621177846*^9, {3.842932943575015*^9, 3.842932964518599*^9}, 
   3.843017513576345*^9, 3.843103639326075*^9, 3.843105296538877*^9, 
   3.843105327767174*^9, 3.8432046462385902`*^9, 3.843204678108815*^9, 
   3.843538172713759*^9, 3.843789504220296*^9, 3.844867158039901*^9, 
   3.844867259265841*^9, 3.845797761017449*^9, 3.8458009355304317`*^9, 
   3.847199234345375*^9, 3.847320511438151*^9, 3.847321197037561*^9, {
   3.8473212686245813`*^9, 3.8473212962639713`*^9}, 3.847321431849329*^9, 
   3.8473231616632643`*^9, 3.847323229404976*^9, 3.8473232824360533`*^9, 
   3.847323370216626*^9, 3.847323589835182*^9, 3.847323639801301*^9, 
   3.847323699825039*^9, 3.847323873541127*^9, 3.848673877984687*^9, 
   3.8508101302320957`*^9, 3.850810314133677*^9},
 CellLabel->
  "Out[287]=",ExpressionUUID->"b51cdf60-19ab-4ab5-a930-992549be0882"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"example2Regularity", "[", 
   RowBox[{"[", "1", "]"}], "]"}], " ", "/.", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"e", "[", 
      RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", "False"}], 
    ",", 
    RowBox[{
     RowBox[{"f1", "[", 
      RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", "False"}], 
    ",", 
    RowBox[{
     RowBox[{"f2", "[", 
      RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", "False"}], 
    ",", 
    RowBox[{
     RowBox[{"s1", "[", "\[FormalA]", "]"}], "\[Rule]", "False"}], ",", 
    RowBox[{
     RowBox[{"s2", "[", "\[FormalA]", "]"}], "\[Rule]", "False"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FormulaSymmetric", "[", 
    RowBox[{"example2Regularity", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "]"}], " ", "/.", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"e", "[", 
       RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", "False"}],
      ",", 
     RowBox[{
      RowBox[{"f1", "[", 
       RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", "False"}],
      ",", 
     RowBox[{
      RowBox[{"f2", "[", 
       RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", "False"}],
      ",", 
     RowBox[{
      RowBox[{"s1", "[", "\[FormalA]", "]"}], "\[Rule]", "False"}], ",", 
     RowBox[{
      RowBox[{"s2", "[", "\[FormalA]", "]"}], "\[Rule]", "False"}]}], "}"}]}],
   " ", "/.", " ", 
  RowBox[{"(", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"e", "[", 
        RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", 
       "False"}], ",", 
      RowBox[{
       RowBox[{"f1", "[", 
        RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", 
       "False"}], ",", 
      RowBox[{
       RowBox[{"f2", "[", 
        RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", 
       "False"}], ",", 
      RowBox[{
       RowBox[{"s1", "[", "\[FormalA]", "]"}], "\[Rule]", "False"}], ",", 
      RowBox[{
       RowBox[{"s2", "[", "\[FormalA]", "]"}], "\[Rule]", "False"}]}], "}"}], 
    " ", "/.", 
    RowBox[{"\[FormalA]", "->", "\[FormalB]"}]}], ")"}]}]}], "Input",
 CellChangeTimes->{{3.84269140905194*^9, 3.842691495423662*^9}},
 CellLabel->
  "In[288]:=",ExpressionUUID->"8e7ee854-7a2d-4b14-ba44-4c18477302b6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"e", "[", 
     RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Equivalent]", 
    RowBox[{"e", "[", 
     RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}]}], ")"}], "&&", 
  RowBox[{"!", 
   RowBox[{"f1", "[", 
    RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}]}], "&&", 
  RowBox[{"!", 
   RowBox[{"f2", "[", 
    RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}]}], "&&", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"e", "[", 
     RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Equivalent]", 
    RowBox[{
     RowBox[{"f1", "[", 
      RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "||", 
     RowBox[{"f2", "[", 
      RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}]}]}], ")"}], "&&", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"f1", "[", 
      RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}]}], "||", 
    RowBox[{"!", 
     RowBox[{"f2", "[", 
      RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}]}]}], ")"}]}]], "Output",\

 CellChangeTimes->{
  3.8426914174481688`*^9, 3.842691451331513*^9, 3.842691496312664*^9, 
   3.8429315889848948`*^9, 3.842931621184436*^9, {3.842932943593611*^9, 
   3.84293296452975*^9}, 3.843017513590455*^9, 3.843103639338789*^9, 
   3.8431052965511227`*^9, 3.843105327777405*^9, 3.843204646251945*^9, 
   3.843204678124363*^9, 3.843538172730674*^9, 3.8437895042333*^9, 
   3.844867158053626*^9, 3.844867259277717*^9, 3.845797761030357*^9, 
   3.845800935546447*^9, 3.847199234361424*^9, 3.8473205114536867`*^9, 
   3.847321197064826*^9, {3.847321268633017*^9, 3.8473212962914124`*^9}, 
   3.847321431858529*^9, 3.8473231616819963`*^9, 3.8473232294151793`*^9, 
   3.847323282455657*^9, 3.847323370236302*^9, 3.847323589853674*^9, 
   3.84732363982196*^9, 3.847323699845812*^9, 3.84732387355173*^9, 
   3.8486738779974413`*^9, 3.850810130244821*^9, 3.85081031414305*^9},
 CellLabel->
  "Out[288]=",ExpressionUUID->"cddfebff-bddc-420d-8488-195da767ab17"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"e", "[", 
     RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Equivalent]", 
    RowBox[{"e", "[", 
     RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}]}], ")"}], "&&", 
  RowBox[{"!", 
   RowBox[{"f1", "[", 
    RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}]}], "&&", 
  RowBox[{"!", 
   RowBox[{"f2", "[", 
    RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}]}], "&&", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"e", "[", 
     RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Equivalent]", 
    RowBox[{
     RowBox[{"f1", "[", 
      RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "||", 
     RowBox[{"f2", "[", 
      RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}]}]}], ")"}], "&&", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"f1", "[", 
      RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}]}], "||", 
    RowBox[{"!", 
     RowBox[{"f2", "[", 
      RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}]}]}], ")"}], "&&", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"e", "[", 
     RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Equivalent]", 
    RowBox[{"e", "[", 
     RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}]}], ")"}], "&&", 
  RowBox[{"!", 
   RowBox[{"f1", "[", 
    RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}]}], "&&", 
  RowBox[{"!", 
   RowBox[{"f2", "[", 
    RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}]}], "&&", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"e", "[", 
     RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}], "\[Equivalent]", 
    RowBox[{
     RowBox[{"f1", "[", 
      RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}], "||", 
     RowBox[{"f2", "[", 
      RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}]}]}], ")"}], "&&", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"f1", "[", 
      RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}]}], "||", 
    RowBox[{"!", 
     RowBox[{"f2", "[", 
      RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}]}]}], ")"}]}]], "Output",\

 CellChangeTimes->{
  3.8426914174481688`*^9, 3.842691451331513*^9, 3.842691496312664*^9, 
   3.8429315889848948`*^9, 3.842931621184436*^9, {3.842932943593611*^9, 
   3.84293296452975*^9}, 3.843017513590455*^9, 3.843103639338789*^9, 
   3.8431052965511227`*^9, 3.843105327777405*^9, 3.843204646251945*^9, 
   3.843204678124363*^9, 3.843538172730674*^9, 3.8437895042333*^9, 
   3.844867158053626*^9, 3.844867259277717*^9, 3.845797761030357*^9, 
   3.845800935546447*^9, 3.847199234361424*^9, 3.8473205114536867`*^9, 
   3.847321197064826*^9, {3.847321268633017*^9, 3.8473212962914124`*^9}, 
   3.847321431858529*^9, 3.8473231616819963`*^9, 3.8473232294151793`*^9, 
   3.847323282455657*^9, 3.847323370236302*^9, 3.847323589853674*^9, 
   3.84732363982196*^9, 3.847323699845812*^9, 3.84732387355173*^9, 
   3.8486738779974413`*^9, 3.850810130244821*^9, 3.850810314147303*^9},
 CellLabel->
  "Out[289]=",ExpressionUUID->"5c12f95c-cdb0-42a1-9010-feb0ae2e301c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"s2reg", " ", "//", " ", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.842950055035297*^9, 3.842950087687544*^9}},
 CellLabel->
  "In[290]:=",ExpressionUUID->"af98fb1e-3d23-4eda-9258-f17bc46e8c0b"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"1"},
      {
       RowBox[{"1", "+", 
        SuperscriptBox["\[FormalZ]", "2"]}]},
      {
       RowBox[{"1", "+", 
        SuperscriptBox["\[FormalZ]", "2"]}]},
      {
       RowBox[{"1", "+", 
        RowBox[{"4", " ", 
         SuperscriptBox["\[FormalZ]", "2"]}]}]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8429500588904123`*^9, 3.842950088058281*^9}, 
   3.843017513606585*^9, 3.843103639353582*^9, 3.843105296567019*^9, 
   3.8431053277912073`*^9, 3.8432046462722397`*^9, 3.843204678140897*^9, 
   3.8435381727509537`*^9, 3.8437895042498293`*^9, 3.844867158066564*^9, 
   3.844867259293826*^9, 3.845797761042742*^9, 3.84580093556356*^9, 
   3.847199234377749*^9, 3.847320511469371*^9, 3.8473211970933857`*^9, {
   3.847321268643626*^9, 3.847321296321496*^9}, 3.847321431869812*^9, 
   3.847323161706691*^9, 3.847323229436943*^9, 3.847323282479721*^9, 
   3.847323370259591*^9, 3.847323589873898*^9, 3.847323639844054*^9, 
   3.8473236998681707`*^9, 3.847323873564024*^9, 3.848673878011587*^9, 
   3.850810130258133*^9, 3.8508103141559057`*^9},
 CellLabel->
  "Out[290]//MatrixForm=",ExpressionUUID->"9d496944-4386-44ce-b640-\
b69d0d652c65"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"1", "+", 
     RowBox[{"4", " ", 
      SuperscriptBox["\[FormalZ]", "2"]}]}], "==", "0"}], ",", "\[FormalZ]"}],
   "]"}]], "Input",
 CellChangeTimes->{{3.843022205333358*^9, 3.843022220823015*^9}},
 CellLabel->
  "In[291]:=",ExpressionUUID->"d442a6bd-5619-4721-a4a8-561bd53fb87d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[FormalZ]", "\[Rule]", 
     RowBox[{"-", 
      FractionBox["\[ImaginaryI]", "2"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[FormalZ]", "\[Rule]", 
     FractionBox["\[ImaginaryI]", "2"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.843022221341955*^9, 3.8431036393720617`*^9, 3.843105296582614*^9, 
   3.8431053278036203`*^9, 3.843204646288365*^9, 3.843204678155766*^9, 
   3.843538172773057*^9, 3.843789504270203*^9, 3.8448671580782347`*^9, 
   3.844867259307457*^9, 3.845797761059928*^9, 3.8458009355804787`*^9, 
   3.8471992343968077`*^9, 3.847320511522735*^9, 3.847321197120919*^9, {
   3.847321268663742*^9, 3.8473212963500633`*^9}, 3.8473214318802137`*^9, 
   3.8473231617261543`*^9, 3.847323229447456*^9, 3.847323282506228*^9, 
   3.847323370280978*^9, 3.847323589893108*^9, 3.8473236398645897`*^9, 
   3.847323699888476*^9, 3.847323873575086*^9, 3.8486738780377073`*^9, 
   3.8508101302754307`*^9, 3.850810314167688*^9},
 CellLabel->
  "Out[291]=",ExpressionUUID->"3e2bb98b-8182-481f-ad37-889a82baba94"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.84302424581693*^9, 3.843024249862726*^9}, {
  3.843024352473624*^9, 3.8430243645691633`*^9}, {3.8430244152871923`*^9, 
  3.843024442396989*^9}},
 CellLabel->
  "In[292]:=",ExpressionUUID->"8bfd1b06-e7d4-448f-80b2-1dc3ad6832da"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"s", "[", 
  RowBox[{"[", 
   RowBox[{"cliques", "[", 
    RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8430244676937237`*^9, 3.843024486923085*^9}, {
  3.843024968044166*^9, 3.843024973930616*^9}},
 CellLabel->
  "In[293]:=",ExpressionUUID->"278795bc-cbcc-4ad3-8537-eac89ccdf9be"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", "+", 
   RowBox[{"4", " ", 
    SuperscriptBox["\[FormalZ]", "2"]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.843024471675465*^9, 3.843024487509843*^9}, {
   3.843024969596785*^9, 3.8430249742943296`*^9}, 3.843103639390649*^9, 
   3.8431052966021442`*^9, 3.8431053278217487`*^9, 3.8432046463077517`*^9, 
   3.8432046781766157`*^9, 3.843538172795302*^9, 3.843789504289*^9, 
   3.8448671580940523`*^9, 3.844867259330661*^9, 3.845797761075433*^9, 
   3.845800935601048*^9, 3.847199234416634*^9, 3.8473205115543137`*^9, 
   3.8473211971530437`*^9, {3.847321268675509*^9, 3.847321296382238*^9}, 
   3.847321431895853*^9, 3.847323161748536*^9, 3.847323229461968*^9, 
   3.847323282537137*^9, 3.847323370310095*^9, 3.8473235899146223`*^9, 
   3.847323639888756*^9, 3.847323699911573*^9, 3.847323873589204*^9, 
   3.848673878080463*^9, 3.850810130321403*^9, 3.850810314185946*^9},
 CellLabel->
  "Out[293]=",ExpressionUUID->"a921dd81-5046-419a-a796-e22c90fd324d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"#", "[", 
    RowBox[{"[", 
     RowBox[{"cliques", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "&"}], "/@", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"r", "+", 
     RowBox[{"Transpose", "[", "r", "]"}]}], ")"}], "[", 
   RowBox[{"[", 
    RowBox[{"cliques", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.843024489925268*^9, 3.843024498017353*^9}, {
  3.843024544801491*^9, 3.843024554503744*^9}, {3.843024837994681*^9, 
  3.843024841961253*^9}},
 CellLabel->
  "In[294]:=",ExpressionUUID->"4b14b352-9182-4a2d-bedd-946b30c95fac"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"2", "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["\[FormalZ]", "2"]}]}], ",", 
     RowBox[{"2", "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["\[FormalZ]", "2"]}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"2", "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["\[FormalZ]", "2"]}]}], ",", 
     RowBox[{"2", "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["\[FormalZ]", "2"]}]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.843024490298761*^9, 3.843024498420444*^9}, 
   3.843024555165662*^9, 3.8430248425089493`*^9, 3.843103639404676*^9, 
   3.8431052966142693`*^9, 3.84310532783119*^9, 3.8432046463200397`*^9, 
   3.843204678189868*^9, 3.84353817280654*^9, 3.8437895043001013`*^9, 
   3.8448671581052237`*^9, 3.84486725934235*^9, 3.845797761087759*^9, 
   3.845800935616233*^9, 3.847199234431162*^9, 3.847320511568017*^9, 
   3.847321197183215*^9, {3.847321268683906*^9, 3.847321296410706*^9}, 
   3.8473214319046917`*^9, 3.847323161767375*^9, 3.8473232294725847`*^9, 
   3.847323282556378*^9, 3.8473233703314447`*^9, 3.847323589932148*^9, 
   3.847323639909471*^9, 3.847323699930875*^9, 3.847323873598431*^9, 
   3.848673878096599*^9, 3.8508101303347054`*^9, 3.850810314195857*^9},
 CellLabel->
  "Out[294]=",ExpressionUUID->"81325518-179c-4dd2-bdab-7383959d5c24"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["cliques"], "Input",
 CellChangeTimes->{{3.843024625358433*^9, 3.8430246261190453`*^9}},
 CellLabel->
  "In[295]:=",ExpressionUUID->"72c4e250-cf4a-4040-9f75-e567b5afa601"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "1", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", "4", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.843024626406014*^9, 3.84310363941676*^9, 3.8431052966285543`*^9, 
   3.843105327843047*^9, 3.843204646332532*^9, 3.843204678203891*^9, 
   3.8435381728212633`*^9, 3.843789504316298*^9, 3.844867158117923*^9, 
   3.844867259354912*^9, 3.845797761100337*^9, 3.845800935643762*^9, 
   3.847199234445743*^9, 3.8473205115821667`*^9, 3.84732119721693*^9, {
   3.847321268693383*^9, 3.847321296437889*^9}, 3.847321431914319*^9, 
   3.847323161787866*^9, 3.8473232294835377`*^9, 3.847323282577271*^9, 
   3.847323370361631*^9, 3.8473235899508877`*^9, 3.8473236399298763`*^9, 
   3.847323699953451*^9, 3.8473238736079073`*^9, 3.8486738781148787`*^9, 
   3.850810130346261*^9, 3.850810314209097*^9},
 CellLabel->
  "Out[295]=",ExpressionUUID->"5b449cb9-698f-4316-9cdf-85b9410cb2a4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"r", "[", 
  RowBox[{"[", 
   RowBox[{"2", ",", "3"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"r", "[", 
  RowBox[{"[", 
   RowBox[{"3", ",", "2"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.843024716041768*^9, 3.84302472721484*^9}},
 CellLabel->
  "In[296]:=",ExpressionUUID->"c25c8f52-626d-4e22-864d-c897854e3a00"],

Cell[BoxData[
 RowBox[{"1", "+", 
  SuperscriptBox["\[FormalZ]", "2"]}]], "Output",
 CellChangeTimes->{{3.843024718776146*^9, 3.843024727682603*^9}, 
   3.843103639436366*^9, 3.843105296643153*^9, 3.843105327855549*^9, 
   3.843204646355295*^9, 3.843204678218816*^9, 3.843538172836474*^9, 
   3.8437895043331203`*^9, 3.8448671581309433`*^9, 3.84486725936817*^9, 
   3.8457977611129637`*^9, 3.845800935662553*^9, 3.847199234460503*^9, 
   3.8473205115962887`*^9, 3.847321197247178*^9, {3.84732126870292*^9, 
   3.847321296466195*^9}, 3.8473214319239683`*^9, 3.847323161809761*^9, 
   3.847323229495064*^9, 3.847323282604357*^9, 3.8473233703980427`*^9, 
   3.847323589970602*^9, 3.847323639949978*^9, 3.8473236999732113`*^9, 
   3.847323873618239*^9, 3.8486738781330433`*^9, 3.8508101303584757`*^9, 
   3.850810314224594*^9},
 CellLabel->
  "Out[296]=",ExpressionUUID->"00d72762-7bba-479a-afdb-cac2fb227a73"],

Cell[BoxData[
 RowBox[{"1", "+", 
  SuperscriptBox["\[FormalZ]", "2"]}]], "Output",
 CellChangeTimes->{{3.843024718776146*^9, 3.843024727682603*^9}, 
   3.843103639436366*^9, 3.843105296643153*^9, 3.843105327855549*^9, 
   3.843204646355295*^9, 3.843204678218816*^9, 3.843538172836474*^9, 
   3.8437895043331203`*^9, 3.8448671581309433`*^9, 3.84486725936817*^9, 
   3.8457977611129637`*^9, 3.845800935662553*^9, 3.847199234460503*^9, 
   3.8473205115962887`*^9, 3.847321197247178*^9, {3.84732126870292*^9, 
   3.847321296466195*^9}, 3.8473214319239683`*^9, 3.847323161809761*^9, 
   3.847323229495064*^9, 3.847323282604357*^9, 3.8473233703980427`*^9, 
   3.847323589970602*^9, 3.847323639949978*^9, 3.8473236999732113`*^9, 
   3.847323873618239*^9, 3.8486738781330433`*^9, 3.8508101303584757`*^9, 
   3.850810314228797*^9},
 CellLabel->
  "Out[297]=",ExpressionUUID->"fa867cbd-3071-486c-b74b-3766ec2cdc5a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["cliques"], "Input",
 CellChangeTimes->{{3.8430317717509727`*^9, 3.843031772506024*^9}},
 CellLabel->
  "In[298]:=",ExpressionUUID->"15d4a89d-b0cf-4452-b819-43059d71adbe"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "1", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", "4", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8430317728268013`*^9, 3.84310529665917*^9, 3.8431053278689327`*^9, 
   3.8432046463693047`*^9, 3.843204678235024*^9, 3.843538172852298*^9, 
   3.843789504350362*^9, 3.844867158144575*^9, 3.844867259381845*^9, 
   3.845797761125231*^9, 3.845800935685706*^9, 3.847199234476351*^9, 
   3.847320511611143*^9, 3.847321197276093*^9, {3.847321268713479*^9, 
   3.8473212964948187`*^9}, 3.847321431935459*^9, 3.847323161833047*^9, 
   3.84732322950916*^9, 3.847323282628306*^9, 3.84732337041123*^9, 
   3.847323589990531*^9, 3.847323639971179*^9, 3.847323699995254*^9, 
   3.847323873630389*^9, 3.848673878152335*^9, 3.8508101303652554`*^9, 
   3.8508103142394753`*^9},
 CellLabel->
  "Out[298]=",ExpressionUUID->"ad4b6baa-b7a3-4fbf-9aab-c5dc65f5191f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SRratio", "[", 
  RowBox[{"s", ",", "r", ",", 
   RowBox[{"cliques", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8430317587372637`*^9, 3.843031766758976*^9}},
 CellLabel->
  "In[299]:=",ExpressionUUID->"768e878d-6962-4f99-9921-f5489ad8d0ca"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{
  3.8430317672771273`*^9, 3.843031810194171*^9, 3.843103639451549*^9, 
   3.843105296673456*^9, 3.843105327882214*^9, 3.8432046463820972`*^9, 
   3.843204678249406*^9, 3.843538172867566*^9, 3.843789504368424*^9, 
   3.844867158157124*^9, 3.8448672593943443`*^9, 3.84579776113669*^9, 
   3.845800935705269*^9, 3.847199234491074*^9, 3.8473205116259003`*^9, 
   3.8473211973046837`*^9, {3.847321268722926*^9, 3.847321296522838*^9}, 
   3.847321431945959*^9, 3.8473231618553267`*^9, 3.847323229519945*^9, 
   3.847323282655204*^9, 3.847323370452633*^9, 3.8473235900085583`*^9, 
   3.847323639992045*^9, 3.847323700016102*^9, 3.847323873640469*^9, 
   3.848673878173286*^9, 3.8508101303772*^9, 3.850810314253416*^9},
 CellLabel->
  "Out[299]=",ExpressionUUID->"0b034aa1-cd23-40d2-8bff-45413e26c66d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"SRMat", "[", 
   RowBox[{"s", ",", "r"}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.84320478263941*^9, 3.843204799316416*^9}, {
  3.843204847581664*^9, 3.843204851476675*^9}, {3.8432048943882303`*^9, 
  3.843204894543859*^9}},
 CellLabel->
  "In[300]:=",ExpressionUUID->"efe070bb-d38e-4bf3-b050-8fd88f5ed6fa"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"3", "2", "2", "2"},
     {"2", 
      RowBox[{"3", "+", 
       RowBox[{"3", " ", 
        SuperscriptBox["\[FormalZ]", "2"]}]}], 
      RowBox[{"2", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["\[FormalZ]", "2"]}]}], 
      RowBox[{"2", "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["\[FormalZ]", "2"]}]}]},
     {"2", 
      RowBox[{"2", "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["\[FormalZ]", "2"]}]}], 
      RowBox[{"3", "+", 
       RowBox[{"3", " ", 
        SuperscriptBox["\[FormalZ]", "2"]}]}], 
      RowBox[{"2", "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["\[FormalZ]", "2"]}]}]},
     {"2", 
      RowBox[{"2", "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["\[FormalZ]", "2"]}]}], 
      RowBox[{"2", "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["\[FormalZ]", "2"]}]}], 
      RowBox[{"3", "+", 
       RowBox[{"12", " ", 
        SuperscriptBox["\[FormalZ]", "2"]}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8432047894106483`*^9, 3.843204799762082*^9}, 
   3.843204851926957*^9, 3.8432048949148273`*^9, 3.843538172883853*^9, 
   3.843789504385687*^9, 3.844867158169663*^9, 3.844867259405765*^9, 
   3.845797761148958*^9, 3.845800935725362*^9, 3.847199234506177*^9, 
   3.847320511640279*^9, 3.847321197333399*^9, {3.8473212687319813`*^9, 
   3.8473212965506973`*^9}, 3.847321431957027*^9, 3.847323161880554*^9, 
   3.847323229531088*^9, 3.847323282676467*^9, 3.847323370490699*^9, 
   3.847323590026842*^9, 3.847323640012282*^9, 3.847323700037279*^9, 
   3.847323873650889*^9, 3.848673878196762*^9, 3.850810130389196*^9, 
   3.850810314267714*^9},
 CellLabel->
  "Out[300]//MatrixForm=",ExpressionUUID->"5e4e6f9b-b4e1-437f-91f5-\
e6f2862883fc"]
}, Open  ]]
},
WindowSize->{1368.7128712871288`, 723.5643564356436},
WindowMargins->{{0, Automatic}, {Automatic, 20.673267326732674`}},
DockedCells->{},
Magnification:>0.8 Inherited,
FrontEndVersion->"12.3 for Linux x86 (64-bit) (June 19, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"3f7ebace-b87e-4310-9597-9cae25c330a8"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 46702, 1068, 2843, "Input",ExpressionUUID->"bd4dac13-24d5-43d7-ae76-3f67079096f2"],
Cell[CellGroupData[{
Cell[47285, 1092, 22035, 538, 1311, "Input",ExpressionUUID->"e916d1d5-57da-4d6d-a398-e237d7a69b52"],
Cell[69323, 1632, 3450, 73, 87, "Output",ExpressionUUID->"8397cb8f-71e2-4c17-a965-a1339f9266ba"],
Cell[72776, 1707, 3448, 73, 77, "Output",ExpressionUUID->"198dd81f-4fc9-499b-a775-791b567d0ec3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[76261, 1785, 14157, 301, 1238, "Input",ExpressionUUID->"cb5ccc7e-7f44-46d8-b840-19729f63b518"],
Cell[90421, 2088, 4894, 92, 28, "Output",ExpressionUUID->"03be03e4-90f5-481a-922f-462bb7cc1caa"],
Cell[95318, 2182, 3664, 55, 26, "Output",ExpressionUUID->"9d310732-1618-4927-baae-c79e3d08b1f9"],
Cell[98985, 2239, 29870, 574, 670, "Output",ExpressionUUID->"5bae7efe-7a8a-46a2-970c-d4978411e61d"],
Cell[128858, 2815, 4893, 92, 28, "Output",ExpressionUUID->"68c3d502-5007-4dc8-abf0-7624df940101"]
}, Open  ]],
Cell[133766, 2910, 948, 27, 103, "Input",ExpressionUUID->"5fe55467-7b28-4389-a85d-cb7549b1264d"],
Cell[134717, 2939, 34860, 771, 2623, "Input",ExpressionUUID->"de9d90ff-36d4-4acd-a124-54bc81661d37"],
Cell[CellGroupData[{
Cell[169602, 3714, 2668, 51, 128, "Input",ExpressionUUID->"3967da30-0426-4e51-8fed-f7c482dc836e"],
Cell[172273, 3767, 5745, 82, 26, "Output",ExpressionUUID->"9d504fd5-f938-4e65-ad14-45047a21c2ad"]
}, Open  ]],
Cell[CellGroupData[{
Cell[178055, 3854, 1620, 36, 112, "Input",ExpressionUUID->"683368db-8a73-4cfb-935a-6b3f32f4c0b6"],
Cell[179678, 3892, 6162, 88, 26, "Output",ExpressionUUID->"49f2e522-dcfd-4314-926d-8fde4a9b1fac"]
}, Open  ]],
Cell[185855, 3983, 170, 3, 40, "Input",ExpressionUUID->"bd2714d0-b946-4a77-8bbf-8865f34cead2"],
Cell[CellGroupData[{
Cell[186050, 3990, 1335, 32, 112, "Input",ExpressionUUID->"fe0a984a-b40b-4fd3-a472-cf44d95b7e7d"],
Cell[187388, 4024, 3798, 93, 28, "Output",ExpressionUUID->"cf6af831-c863-492a-bf99-6d9fc252ce11"],
Cell[191189, 4119, 1792, 29, 26, "Output",ExpressionUUID->"61530b4c-3ea3-460d-9577-87f46559bda0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[193018, 4153, 689, 15, 57, "Input",ExpressionUUID->"c75e1d7a-620f-4cb2-947a-cd33f46e90d6"],
Cell[193710, 4170, 1624, 25, 26, "Output",ExpressionUUID->"017bc562-8faa-4bf4-8d5c-49090010aaf9"],
Cell[195337, 4197, 1624, 25, 26, "Output",ExpressionUUID->"8f5ba232-73cd-40ba-b940-a323ac6a615d"]
}, Open  ]],
Cell[196976, 4225, 248, 4, 23, "Input",ExpressionUUID->"433b46ea-1aab-4939-a788-2b2fcf74139a"],
Cell[197227, 4231, 369, 6, 23, "Input",ExpressionUUID->"90def5fd-d3ca-4dad-9f1d-3362578ad2d5"],
Cell[197599, 4239, 177, 3, 23, "Input",ExpressionUUID->"53be15de-9c20-4ffc-8406-9c5b002d3f28"],
Cell[CellGroupData[{
Cell[197801, 4246, 1069, 30, 25, "Input",ExpressionUUID->"245cbaa0-c0c1-4efc-94be-e104cd1c5f7b"],
Cell[198873, 4278, 3590, 90, 46, "Output",ExpressionUUID->"b51cdf60-19ab-4ab5-a930-992549be0882"]
}, Open  ]],
Cell[CellGroupData[{
Cell[202500, 4373, 2399, 71, 43, "Input",ExpressionUUID->"8e7ee854-7a2d-4b14-ba44-4c18477302b6"],
Cell[204902, 4446, 1986, 46, 28, "Output",ExpressionUUID->"cddfebff-bddc-420d-8488-195da767ab17"],
Cell[206891, 4494, 2986, 75, 28, "Output",ExpressionUUID->"5c12f95c-cdb0-42a1-9010-feb0ae2e301c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[209914, 4574, 222, 4, 24, "Input",ExpressionUUID->"af98fb1e-3d23-4eda-9258-f17bc46e8c0b"],
Cell[210139, 4580, 1637, 40, 87, "Output",ExpressionUUID->"9d496944-4386-44ce-b640-b69d0d652c65"]
}, Open  ]],
Cell[CellGroupData[{
Cell[211813, 4625, 355, 10, 25, "Input",ExpressionUUID->"d442a6bd-5619-4721-a4a8-561bd53fb87d"],
Cell[212171, 4637, 1099, 22, 40, "Output",ExpressionUUID->"3e2bb98b-8182-481f-ad37-889a82baba94"]
}, Open  ]],
Cell[213285, 4662, 276, 5, 23, "Input",ExpressionUUID->"8bfd1b06-e7d4-448f-80b2-1dc3ad6832da"],
Cell[CellGroupData[{
Cell[213586, 4671, 337, 8, 25, "Input",ExpressionUUID->"278795bc-cbcc-4ad3-8537-eac89ccdf9be"],
Cell[213926, 4681, 1000, 17, 28, "Output",ExpressionUUID->"a921dd81-5046-419a-a796-e22c90fd324d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[214963, 4703, 635, 18, 25, "Input",ExpressionUUID->"4b14b352-9182-4a2d-bedd-946b30c95fac"],
Cell[215601, 4723, 1401, 31, 28, "Output",ExpressionUUID->"81325518-179c-4dd2-bdab-7383959d5c24"]
}, Open  ]],
Cell[CellGroupData[{
Cell[217039, 4759, 184, 3, 23, "Input",ExpressionUUID->"72c4e250-cf4a-4040-9f75-e567b5afa601"],
Cell[217226, 4764, 976, 19, 26, "Output",ExpressionUUID->"5b449cb9-698f-4316-9cdf-85b9410cb2a4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[218239, 4788, 353, 9, 40, "Input",ExpressionUUID->"c25c8f52-626d-4e22-864d-c897854e3a00"],
Cell[218595, 4799, 906, 15, 28, "Output",ExpressionUUID->"00d72762-7bba-479a-afdb-cac2fb227a73"],
Cell[219504, 4816, 906, 15, 28, "Output",ExpressionUUID->"fa867cbd-3071-486c-b74b-3766ec2cdc5a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[220447, 4836, 184, 3, 23, "Input",ExpressionUUID->"15d4a89d-b0cf-4452-b819-43059d71adbe"],
Cell[220634, 4841, 949, 19, 26, "Output",ExpressionUUID->"ad4b6baa-b7a3-4fbf-9aab-c5dc65f5191f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[221620, 4865, 304, 7, 25, "Input",ExpressionUUID->"768e878d-6962-4f99-9921-f5489ad8d0ca"],
Cell[221927, 4874, 843, 13, 26, "Output",ExpressionUUID->"0b034aa1-cd23-40d2-8bff-45413e26c66d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[222807, 4892, 363, 8, 23, "Input",ExpressionUUID->"efe070bb-d38e-4bf3-b050-8fd88f5ed6fa"],
Cell[223173, 4902, 2162, 57, 87, "Output",ExpressionUUID->"5e4e6f9b-b4e1-437f-91f5-e6f2862883fc"]
}, Open  ]]
}
]
*)

