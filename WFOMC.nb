(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    171050,       3853]
NotebookOptionsPosition[    164470,       3741]
NotebookOutlinePosition[    164954,       3759]
CellTagsIndexPosition[    164911,       3756]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PredicateName", "[", "p_Symbol", "]"}], ":=", " ", "p"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Special", " ", "case", " ", "usable", " ", "for", " ", "simpler", " ", 
    "representation", " ", "of", " ", "propositional", " ", "logic"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PredicateName", "[", 
   RowBox[{"p_", "[", "x___", "]"}], "]"}], ":=", 
  "p"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PredicateSymbols", "[", 
   RowBox[{"Not", "[", "a_", "]"}], "]"}], " ", ":=", " ", 
  RowBox[{"PredicateSymbols", "[", "a", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PredicateSymbols", "[", 
   RowBox[{"a_", "\[And]", "b_"}], "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"PredicateSymbols", "[", "a", "]"}], "\[Union]", 
   RowBox[{"PredicateSymbols", "[", "b", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PredicateSymbols", "[", 
   RowBox[{"a_", "\[Or]", "b_"}], "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"PredicateSymbols", "[", "a", "]"}], "\[Union]", 
   RowBox[{"PredicateSymbols", "[", "b", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PredicateSymbols", "[", 
   RowBox[{"a_", "\[Xor]", "b_"}], "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"PredicateSymbols", "[", "a", "]"}], "\[Union]", 
   RowBox[{"PredicateSymbols", "[", "b", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PredicateSymbols", "[", 
   RowBox[{"a_", "\[Implies]", "b_"}], "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"PredicateSymbols", "[", "a", "]"}], "\[Union]", 
   RowBox[{"PredicateSymbols", "[", "b", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PredicateSymbols", "[", 
   RowBox[{"a_", "\[Equivalent]", "b_"}], "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"PredicateSymbols", "[", "a", "]"}], "\[Union]", 
   RowBox[{"PredicateSymbols", "[", "b", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PredicateSymbols", "[", 
   RowBox[{"p_Symbol", "[", "x_", "]"}], "]"}], ":=", " ", 
  RowBox[{"{", 
   RowBox[{"{", 
    RowBox[{"p", ",", " ", "1"}], "}"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PredicateSymbols", "[", 
   RowBox[{"p_Symbol", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{"{", 
    RowBox[{"p", ",", "2"}], "}"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BinaryPredicateSymbols", "[", "\[Phi]_", "]"}], ":=", 
  RowBox[{"First", " ", "/@", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"PredicateSymbols", "[", "\[Phi]", "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "==", "2"}], "&"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"UnaryPredicateSymbols", "[", "\[Phi]_", "]"}], ":=", 
  RowBox[{"First", " ", "/@", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"PredicateSymbols", "[", "\[Phi]", "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "==", "1"}], "&"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BinaryNonreflexiveAtoms", "[", "\[Phi]_", "]"}], ":=", 
  RowBox[{"Flatten", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], ",", 
       RowBox[{"#", "[", 
        RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}]}], "}"}], "&"}], "/@",
     " ", 
    RowBox[{"BinaryPredicateSymbols", "[", "\[Phi]", "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PredicateToAtom", "[", 
   RowBox[{"{", 
    RowBox[{"p_", ",", "1"}], "}"}], "]"}], ":=", 
  RowBox[{"p", "[", "\[FormalA]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PredicateToAtom", "[", 
   RowBox[{"{", 
    RowBox[{"p_", ",", "2"}], "}"}], "]"}], ":=", 
  RowBox[{"p", "[", 
   RowBox[{"\[FormalA]", ",", "\[FormalA]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"UnaryAndReflexiveAtoms", "[", "\[Phi]_", "]"}], ":=", " ", 
  RowBox[{"PredicateToAtom", "/@", " ", 
   RowBox[{
   "PredicateSymbols", "[", "\[Phi]", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FOAtoms", "[", "False", "]"}], " ", ":=", " ", 
  RowBox[{"{", "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FOAtoms", "[", "True", "]"}], " ", ":=", " ", 
  RowBox[{"{", "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FOAtoms", "[", 
   RowBox[{"Not", "[", "\[Phi]_", "]"}], "]"}], " ", ":=", " ", 
  RowBox[{"FOAtoms", "[", "\[Phi]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FOAtoms", "[", 
   RowBox[{"\[Phi]_", "\[And]", "\[Psi]_"}], "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"FOAtoms", "[", "\[Phi]", "]"}], "\[Union]", 
   RowBox[{"FOAtoms", "[", "\[Psi]", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FOAtoms", "[", 
   RowBox[{"\[Phi]_", "\[Or]", "\[Psi]_"}], "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"FOAtoms", "[", "\[Phi]", "]"}], "\[Union]", 
   RowBox[{"FOAtoms", "[", "\[Psi]", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FOAtoms", "[", 
   RowBox[{"\[Phi]_", "\[Implies]", "\[Psi]_"}], "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"FOAtoms", "[", "\[Phi]", "]"}], "\[Union]", 
   RowBox[{"FOAtoms", "[", "\[Psi]", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FOAtoms", "[", "atom_", "]"}], ":=", " ", 
  RowBox[{"{", "atom", "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PositiveAtoms", "[", "model_List", "]"}], ":=", 
  RowBox[{"model", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"a_", "\[Rule]", "False"}], ")"}], " ", "\[RuleDelayed]", " ", 
      "Nothing"}], ",", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"a_", "\[Rule]", "True"}], ")"}], " ", "\[RuleDelayed]", " ", 
      "a"}]}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NegativeAtoms", "[", "model_List", "]"}], ":=", 
  RowBox[{"model", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"a_", "\[Rule]", "True"}], ")"}], " ", "\[RuleDelayed]", " ", 
      "Nothing"}], ",", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"a_", "\[Rule]", "False"}], ")"}], " ", "\[RuleDelayed]", " ", 
      "a"}]}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PredicateSymbol", "[", 
   RowBox[{"p_Symbol", "[", "x___", "]"}], "]"}], ":=", " ", 
  RowBox[{"{", 
   RowBox[{"p", ",", " ", 
    RowBox[{"Length", "[", "x", "]"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PredicateSymbols", "[", "\[Phi]_", "]"}], ":=", " ", 
  RowBox[{"PredicateSymbol", "/@", " ", 
   RowBox[{"FOAtoms", "[", "\[Phi]", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MakeLiteral", "[", 
   RowBox[{"a_", "->", "True"}], "]"}], ":=", " ", 
  "a"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MakeLiteral", "[", 
   RowBox[{"b_", "->", "False"}], "]"}], ":=", " ", 
  RowBox[{"\[Not]", "b"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"InterpretationToFormula", "[", "f_List", "]"}], ":=", " ", 
  RowBox[{"And", "@@", 
   RowBox[{"(", 
    RowBox[{"MakeLiteral", " ", "/@", " ", "f"}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SymbolSetWeight", "[", 
   RowBox[{"set_List", ",", " ", "weights_"}], "]"}], ":=", " ", 
  RowBox[{"Times", "@@", " ", 
   RowBox[{"(", 
    RowBox[{"weights", " ", "/@", "set"}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GroundAtomSetWeight", "[", 
   RowBox[{"set_List", ",", " ", "weights_"}], "]"}], ":=", 
  RowBox[{"SymbolSetWeight", "[", 
   RowBox[{
    RowBox[{"PredicateName", "/@", " ", "set"}], ",", " ", "weights"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ModelWeight", "[", 
   RowBox[{
   "model_", ",", " ", "weightsPositive_", ",", " ", "weightsNegative_"}], 
   "]"}], ":=", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"FIXME", " ", "-", " ", 
    RowBox[{
    "this", " ", "should", " ", "be", " ", "easy", " ", "to", " ", "make", 
     " ", "2", "x", " ", "faster"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"GroundAtomSetWeight", "[", 
    RowBox[{
     RowBox[{"PositiveAtoms", "[", "model", "]"}], ",", " ", 
     "weightsPositive"}], "]"}], " ", "*", " ", 
   RowBox[{"GroundAtomSetWeight", "[", 
    RowBox[{
     RowBox[{"NegativeAtoms", "[", "model", "]"}], ",", " ", 
     "weightsNegative"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AllModels", "[", "False", "]"}], ":=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AllModels", "[", 
   RowBox[{"\[Phi]_", ",", "variables_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "result", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"modelBool", "\[Function]", 
       RowBox[{"Thread", "[", 
        RowBox[{"variables", "\[Rule]", "modelBool"}], "]"}]}], ")"}], "/@", 
     "\[IndentingNewLine]", 
     RowBox[{"SatisfiabilityInstances", "[", 
      RowBox[{"\[Phi]", ",", "variables", ",", "All"}], "]"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Print", "[", "result", "]"}], ";", "\[IndentingNewLine]", 
     "result"}], "*)"}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WeightedModels", "[", 
   RowBox[{
   "\[Phi]_", ",", "weightsPositive_", ",", " ", "weightsNegative_", ",", " ",
     "variables_"}], "]"}], ":=", 
  RowBox[{"Total", "[", " ", 
   RowBox[{"(*", 
    RowBox[{
    "naive", " ", "WMC", " ", "implementation", " ", "using", " ", "SAT"}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"model", " ", "\[Function]", 
      RowBox[{"ModelWeight", "[", 
       RowBox[{
       "model", ",", " ", "weightsPositive", ",", " ", "weightsNegative"}], 
       "]"}]}], ")"}], "/@", "\[IndentingNewLine]", 
    RowBox[{"AllModels", "[", 
     RowBox[{"\[Phi]", ",", "variables"}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PredicateToAtom", "[", 
   RowBox[{"{", 
    RowBox[{"p_", ",", "1"}], "}"}], "]"}], ":=", " ", 
  RowBox[{"p", "[", "\[FormalA]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PredicateToAtom", "[", 
   RowBox[{"{", 
    RowBox[{"p_", ",", "2"}], "}"}], "]"}], ":=", " ", 
  RowBox[{"p", "[", 
   RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}]}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{"CellAtoms", "[", "predicates_List", "]"}], ":=", 
   RowBox[{"PredicateToAtom", "/@", " ", "predicates"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"MakeCell", "[", 
     RowBox[{"atoms_List", ",", "fs_List"}], "]"}], ":=", "  ", 
    RowBox[{"And", "@@", 
     RowBox[{"MapThread", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"#1", "[", "#2", "]"}], "&"}], ",", 
       RowBox[{"{", 
        RowBox[{"fs", ",", "atoms"}], "}"}]}], "]"}]}]}], " ", "*)"}], 
  RowBox[{"(*", " ", 
   RowBox[{
   "just", " ", "a", " ", "helper", " ", "function", " ", "for", " ", 
    "AllCells"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MakeCell", "[", 
   RowBox[{"atoms_List", ",", "boolVec_List"}], "]"}], ":=", " ", 
  RowBox[{"Thread", "[", 
   RowBox[{"atoms", "\[Rule]", "boolVec"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AllCells", "[", "atoms_List", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"boolVec", " ", "\[Function]", 
     RowBox[{"MakeCell", "[", 
      RowBox[{"atoms", ",", "boolVec"}], "]"}]}], ")"}], "/@", 
   "\[IndentingNewLine]", 
   RowBox[{"Tuples", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"False", ",", "True"}], "}"}], ",", " ", 
     RowBox[{"Length", "[", "atoms", "]"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FormulaCells", "[", "\[Phi]_", "]"}], ":=", " ", 
   RowBox[{"Sort", "@", 
    RowBox[{"AllCells", "@", 
     RowBox[{"CellAtoms", "@", 
      RowBox[{"PredicateSymbols", "[", "\[Phi]", "]"}]}]}]}]}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Sort", " ", "probably", " ", "not", " ", "needed"}], " ", "-", 
    " ", 
    RowBox[{
    "added", " ", "just", " ", "in", " ", "case", " ", "to", " ", "ensure", 
     " ", "function", " ", "purity"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FormulaCellsValid", "[", "\[Phi]_", "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"cells", "=", 
      RowBox[{"FormulaCells", "[", "\[Phi]", "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Pick", "[", 
     RowBox[{"cells", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"SatisfiableQ", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\[Phi]", "/.", " ", 
            RowBox[{"\[FormalB]", "->", "\[FormalA]"}]}], ")"}], "/.", "#"}], 
         "]"}], "&"}], " ", "/@", " ", "cells"}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SwapVariables", "[", "object_", "]"}], ":=", " ", 
  RowBox[{"object", " ", "/.", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[FormalA]", "\[Rule]", "\[FormalB]"}], ",", " ", 
     RowBox[{"\[FormalB]", "\[Rule]", "\[FormalA]"}]}], 
    "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FormulaSymmetric", "[", "\[Psi]_", "]"}], ":=", 
  RowBox[{"\[Psi]", "\[And]", 
   RowBox[{"SwapVariables", "[", "\[Psi]", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FormulaReflexive", "[", "\[Psi]_", "]"}], ":=", " ", 
  RowBox[{"\[Psi]", " ", "/.", " ", 
   RowBox[{"\[FormalB]", "\[Rule]", "\[FormalA]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FormulaSimplified", "[", 
   RowBox[{"\[Psi]_", ",", " ", "cell1_", ",", " ", "cell2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"FormulaSymmetric", "[", "\[Psi]", "]"}], " ", "/.", 
   RowBox[{"Join", "[", 
    RowBox[{"cell1", ",", " ", 
     RowBox[{"SwapVariables", "[", "cell2", "]"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FormulaSimplified", "[", 
   RowBox[{"\[Psi]_", ",", "cell_"}], "]"}], ":=", 
  RowBox[{"FormulaSimplified", "[", 
   RowBox[{"\[Psi]", ",", " ", "cell", ",", " ", "cell"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RTerm", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\[Psi]_", ",", "weightsPositive_", ",", " ", "weightsNegative_"}], 
     "}"}], ",", "cell1_", ",", "cell2_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"unaryWeights", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"#", "->", "1"}], ")"}], "&"}], "/@", " ", 
       RowBox[{"UnaryPredicateSymbols", "[", "\[Psi]", "]"}]}]}], "}"}], ",", 
    " ", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"Podle", " ", "Timova", " ", "k\[OAcute]du"}], " ", "-", " ", 
      RowBox[{"nech\[AAcute]pu", " ", "pro\[CHacek]"}]}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"WeightedModels", "[", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Alternative", " ", ":", " ", 
        RowBox[{"syntactic", " ", "approach", " ", "to", " ", "cells"}], ":", 
        "\[IndentingNewLine]", 
        RowBox[{"Simplify", "[", 
         RowBox[{
          RowBox[{"FormulaSymmetric", "[", "\[Psi]", "]"}], "\[And]", " ", 
          RowBox[{"InterpretationToFormula", "[", "cell1", "]"}], "\[And]", 
          RowBox[{"InterpretationToFormula", "@", 
           RowBox[{"SwapVariables", "[", "cell2", "]"}]}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Semantic", ":", "\[IndentingNewLine]", 
        RowBox[{"FormulaSimplified2Cell", "[", 
         RowBox[{"\[Psi]", ",", " ", "cell1", ",", " ", "cell2"}], "]"}]}], 
       ","}], "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FormulaSimplified", "[", 
       RowBox[{"\[Psi]", ",", " ", "cell1", ",", " ", "cell2"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Association", "[", 
       RowBox[{"weightsPositive", ",", "unaryWeights"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Association", "[", 
       RowBox[{"weightsNegative", ",", "unaryWeights"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"BinaryNonreflexiveAtoms", "[", "\[Psi]", "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"STerm", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\[Psi]_", ",", "weightsPositive_", ",", " ", "weightsNegative_"}], 
     "}"}], ",", "cell_"}], "]"}], ":=", 
  RowBox[{"RTerm", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\[Psi]", ",", " ", "weightsPositive", ",", " ", "weightsNegative"}], 
     "}"}], ",", " ", "cell", ",", " ", "cell"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WTerm", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\[Psi]_", ",", "weightsPositive_", ",", " ", "weightsNegative_"}], 
     "}"}], ",", "cell_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"WeightedModels", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FormulaReflexive", "[", "\[Psi]", "]"}], "\[And]", " ", 
     RowBox[{"InterpretationToFormula", "[", "cell", "]"}]}], ",", 
    "\[IndentingNewLine]", "weightsPositive", ",", " ", "weightsNegative", 
    ",", "\[IndentingNewLine]", 
    RowBox[{"UnaryAndReflexiveAtoms", "[", "\[Psi]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"STerms", "[", 
   RowBox[{"{", 
    RowBox[{
    "\[Psi]_", ",", " ", "weightsPositive_", ",", " ", "weightsNegative_"}], 
    "}"}], "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"cell", "\[Function]", 
     RowBox[{"STerm", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\[Psi]", ",", " ", "weightsPositive", ",", " ", "weightsNegative"}], 
        "}"}], ",", " ", "cell"}], "]"}]}], ")"}], " ", "/@", " ", 
   RowBox[{
   "FormulaCellsValid", "[", "\[Psi]", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WTerms", "[", 
   RowBox[{"{", 
    RowBox[{
    "\[Psi]_", ",", " ", "weightsPositive_", ",", " ", "weightsNegative_"}], 
    "}"}], "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"cell", "\[Function]", 
     RowBox[{"WTerm", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\[Psi]", ",", " ", "weightsPositive", ",", " ", "weightsNegative"}], 
        "}"}], ",", " ", "cell"}], "]"}]}], ")"}], " ", "/@", " ", 
   RowBox[{
   "FormulaCellsValid", "[", "\[Psi]", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RTerms", "[", 
   RowBox[{"{", 
    RowBox[{
    "\[Psi]_", ",", " ", "weightsPositive_", ",", " ", "weightsNegative_"}], 
    "}"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"cells", " ", "=", " ", 
       RowBox[{"FormulaCellsValid", "[", "\[Psi]", "]"}]}], ",", 
      "\[IndentingNewLine]", "length"}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"length", " ", "=", " ", 
      RowBox[{"Length", "[", "cells", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"row", " ", "\[Function]", 
        RowBox[{"PadRight", "[", 
         RowBox[{"row", ",", " ", "length"}], "]"}]}], ")"}], " ", "/@", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"RTerm", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\[Psi]", ",", " ", "weightsPositive", ",", "weightsNegative"}], 
           "}"}], ",", 
          RowBox[{
          "cells", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
          ",", " ", 
          RowBox[{
          "cells", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "1", ",", " ", "length"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", " ", "1", ",", " ", 
          RowBox[{"i", "-", "1"}]}], "}"}]}], "\[IndentingNewLine]", 
       "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RTermsFull", "[", 
   RowBox[{"{", 
    RowBox[{
    "\[Psi]_", ",", " ", "weightsPositive_", ",", " ", "weightsNegative_"}], 
    "}"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"cells", " ", "=", " ", 
       RowBox[{"FormulaCellsValid", "[", "\[Psi]", "]"}]}], ",", " ", 
      "length"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"length", " ", "=", " ", 
      RowBox[{"Length", "[", "cells", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"row", " ", "\[Function]", 
        RowBox[{"PadRight", "[", 
         RowBox[{"row", ",", " ", "length"}], "]"}]}], ")"}], " ", "/@", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"RTerm", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\[Psi]", ",", " ", "weightsPositive", ",", "weightsNegative"}], 
           "}"}], ",", 
          RowBox[{
          "cells", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
          ",", " ", 
          RowBox[{
          "cells", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "1", ",", " ", "length"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", " ", "1", ",", " ", "length"}], "}"}]}], 
       "\[IndentingNewLine]", "]"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SWR", "[", "property_", "]"}], " ", ":=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"STerms", "[", "property", "]"}], ",", 
    RowBox[{"WTerms", "[", "property", "]"}], ",", 
    RowBox[{"RTerms", "[", "property", "]"}]}], " ", 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CompatibilityCondition1", "[", 
   RowBox[{"i_Integer", ",", "cliquePart_List", ",", "s_"}], "]"}], ":=", 
  RowBox[{"AllTrue", "[", 
   RowBox[{"cliquePart", ",", 
    RowBox[{"j", "\[Function]", 
     RowBox[{
      RowBox[{"s", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], "===", 
      RowBox[{
      "s", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CompatibilityCondition2", "[", 
   RowBox[{"i_Integer", ",", "cliquePart_List", ",", "w_"}], "]"}], ":=", 
  RowBox[{"AllTrue", "[", 
   RowBox[{"cliquePart", ",", 
    RowBox[{"j", "\[Function]", 
     RowBox[{
      RowBox[{"w", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], "===", 
      RowBox[{
      "w", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CompatibilityCondition3", "[", 
   RowBox[{"i_Integer", ",", "cliquePart_List", ",", "r_"}], "]"}], ":=", 
  RowBox[{"AllTrue", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Tuples", "[", 
     RowBox[{"{", 
      RowBox[{"cliquePart", ",", 
       RowBox[{"Complement", "[", 
        RowBox[{
         RowBox[{"Range", "@", 
          RowBox[{"Length", "[", "r", "]"}]}], ",", " ", "cliquePart"}], 
        "]"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Replace", "[", 
      RowBox[{"#", ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"j_", ",", "k_"}], "}"}], "\[RuleDelayed]", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"j", "<", "k"}], "\[And]", " ", 
           RowBox[{"i", "!=", " ", "j"}]}], ")"}], "\[Implies]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"r", "\[LeftDoubleBracket]", 
            RowBox[{"i", ",", "k"}], "\[RightDoubleBracket]"}], "===", 
           RowBox[{"r", "\[LeftDoubleBracket]", 
            RowBox[{"j", ",", "k"}], "\[RightDoubleBracket]"}]}], ")"}]}]}]}],
       "]"}], "&"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{"CompatibilityCondition4", "[", 
    RowBox[{"i_Integer", ",", "cliquePart_List", ",", "r_"}], "]"}], ":=", 
   RowBox[{"AllTrue", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Tuples", "[", 
      RowBox[{"{", 
       RowBox[{"cliquePart", ",", "cliquePart", ",", " ", "cliquePart"}], 
       "}"}], "]"}], ",", "\[IndentingNewLine]", " ", 
     RowBox[{
      RowBox[{"Replace", "[", 
       RowBox[{"#", ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"j_", ",", "k_", ",", "l_"}], "}"}], "\[RuleDelayed]", " ", 
         
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"i", "<", "j"}], "\[And]", 
            RowBox[{"k", "<", "l"}]}], ")"}], "\[Implies]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"r", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "===", 
            RowBox[{"r", "\[LeftDoubleBracket]", 
             RowBox[{"k", ",", "l"}], "\[RightDoubleBracket]"}]}], 
           ")"}]}]}]}], "]"}], "&"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Compatible", "[", 
     RowBox[{"i_Integer", ",", " ", "cliquePart_List", ",", " ", 
      RowBox[{"{", 
       RowBox[{"s_", ",", "w_", ",", "r_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"all", "=", 
         RowBox[{"Range", "@", 
          RowBox[{"Length", "[", "s", "]"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"cond3", "=", " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"j_", ",", "k_"}], "}"}], "\[RuleDelayed]", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"j", "<", "k"}], "\[And]", " ", 
             RowBox[{"i", "!=", " ", "j"}]}], ")"}], "\[Implies]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"r", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "k"}], "\[RightDoubleBracket]"}], "===", 
             RowBox[{"r", "\[LeftDoubleBracket]", 
              RowBox[{"j", ",", "k"}], "\[RightDoubleBracket]"}]}], 
            ")"}]}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"cond4", "=", " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"j_", ",", "k_", ",", "l_"}], "}"}], "\[RuleDelayed]", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"i", "<", "j"}], "\[And]", 
             RowBox[{"k", "<", "l"}]}], ")"}], "\[Implies]", " ", 
           RowBox[{
            RowBox[{"r", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "===", 
            RowBox[{"r", "\[LeftDoubleBracket]", 
             RowBox[{"k", ",", "l"}], "\[RightDoubleBracket]"}]}]}]}]}]}], 
       "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"And", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AllTrue", "[", 
         RowBox[{"cliquePart", ",", 
          RowBox[{"j", "\[Function]", 
           RowBox[{
            RowBox[{
            "s", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], "===", 
            RowBox[{
            "s", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}]}]}],
          "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"AllTrue", "[", 
         RowBox[{"cliquePart", ",", 
          RowBox[{"j", "\[Function]", 
           RowBox[{
            RowBox[{
            "w", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], "===", 
            RowBox[{
            "w", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}]}]}],
          "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"And", "@@", 
          RowBox[{"Tuples", "[", 
           RowBox[{"{", 
            RowBox[{"cliquePart", ",", 
             RowBox[{"Complement", "[", 
              RowBox[{"all", ",", " ", "cliquePart"}], "]"}]}], "}"}], 
           "]"}]}], "/.", "cond3"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"And", "@@", 
          RowBox[{"Tuples", "[", 
           RowBox[{"{", 
            RowBox[{
            "cliquePart", ",", " ", "cliquePart", ",", " ", "cliquePart"}], 
            "}"}], "]"}]}], "/.", "cond4"}]}], "\[IndentingNewLine]", "]"}]}],
      "\[IndentingNewLine]", "]"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SRratio", "[", 
   RowBox[{"s_", ",", "r_", ",", " ", 
    RowBox[{"{", 
     RowBox[{"c1_", ",", "c2_", ",", " ", "rest___"}], "}"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  FractionBox[
   RowBox[{"s", "[", 
    RowBox[{"[", "c1", "]"}], "]"}], 
   RowBox[{"r", "[", 
    RowBox[{"[", 
     RowBox[{"c2", ",", "c1"}], "]"}], "]"}]]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Compatible", "[", 
   RowBox[{"i_Integer", ",", " ", "cliquePart_List", ",", " ", 
    RowBox[{"{", 
     RowBox[{"s_", ",", "w_", ",", "r_"}], "}"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"CompatibilityCondition1", "[", 
    RowBox[{"i", ",", "cliquePart", ",", "s"}], "]"}], "\[And]", " ", 
   "\[IndentingNewLine]", 
   RowBox[{"CompatibilityCondition2", "[", 
    RowBox[{"i", ",", "cliquePart", ",", "w"}], "]"}], "\[And]", 
   "\[IndentingNewLine]", 
   RowBox[{"CompatibilityCondition3", "[", 
    RowBox[{"i", ",", "cliquePart", ",", "r"}], "]"}], "\[And]", 
   "\[IndentingNewLine]", 
   RowBox[{"CompatibilityCondition4", "[", 
    RowBox[{"i", ",", "cliquePart", ",", "r"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cliques", "[", 
    RowBox[{"{", 
     RowBox[{"s_", ",", "w_", ",", "r_"}], "}"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "j", ",", " ", 
       RowBox[{"cliques", "=", 
        RowBox[{"{", "}"}]}], ",", " ", 
       RowBox[{"length", " ", "=", " ", 
        RowBox[{"Length", "[", "s", "]"}]}], ",", "current", ",", " ", 
       "all"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"all", " ", "=", " ", 
       RowBox[{"Range", "[", "length", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "all", "]"}], ">", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"current", " ", "=", " ", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"cell", "\[Function]", " ", 
            RowBox[{"If", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Compatible", "[", 
               RowBox[{"cell", ",", " ", "current", ",", " ", 
                RowBox[{"{", 
                 RowBox[{"s", ",", "w", ",", "r"}], "}"}]}], "]"}], " ", ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"AppendTo", "[", 
                RowBox[{"current", ",", " ", "cell"}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"all", " ", "=", " ", 
                RowBox[{"all", " ", "/.", " ", 
                 RowBox[{"cell", " ", "\[Rule]", " ", "Nothing"}]}]}], 
               ";"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]",
            ")"}], " ", "/@", " ", "all"}], ";", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"cliques", ",", " ", "current"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "cliques"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GetGTerm", "[", 
     RowBox[{"0", ",", " ", "n_Integer", ",", "cliqueIds_List"}], "]"}], ":=",
     " ", 
    RowBox[{
     RowBox[{"GetGTerm", "[", 
      RowBox[{"0", ",", " ", "n", ",", "cliqueIds"}], "]"}], " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"Module", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"i", "\[Function]"}], " ", ")"}], " ", "/@", " ", 
         RowBox[{"Range", "[", 
          RowBox[{"1", ",", "k"}], "]"}]}], "\[IndentingNewLine]", "]"}], 
       "\[IndentingNewLine]", 
       RowBox[{"GetGTerm", "[", 
        RowBox[{"p_Integer", ",", " ", "n_Integer", ",", "cliqueIds_List"}], 
        "]"}]}], ":=", " ", 
      RowBox[{
       RowBox[{"GetGTerm", "[", 
        RowBox[{"p", ",", " ", "n", ",", "cliqueIds"}], "]"}], " ", "=", " ", 
       
       RowBox[{"Module", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"s", "=", "0"}], "}"}], ","}], "\[IndentingNewLine]", 
        "]"}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"TODO", " ", "-", " ", "memoization"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetDTerm", "[", 
    RowBox[{"k_", ",", "n_", ",", " ", "srratio_"}], "]"}], " ", ":=", " ", 
   RowBox[{"GetDTerm", "[", 
    RowBox[{"1", ",", " ", "k", ",", "n"}], "]"}]}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GetDTerm", "[", 
   RowBox[{"i_", ",", " ", "k_", ",", "n_", ",", "srratio_"}], "]"}], " ", ":=",
   " ", "\[IndentingNewLine]", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"i", "==", "k"}], ",", "\[IndentingNewLine]", 
    RowBox[{"srratio", "^", 
     RowBox[{"Binomial", "[", 
      RowBox[{"n", ",", "2"}], "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"Sum", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Binomial", "[", 
        RowBox[{"n", ",", "ni"}], "]"}], "*", 
       RowBox[{"srratio", "^", 
        RowBox[{"Binomial", "[", 
         RowBox[{"ni", ",", "2"}], "]"}]}], "*", 
       RowBox[{"GetDTerm", "[", 
        RowBox[{
         RowBox[{"i", "+", "1"}], ",", " ", "k", ",", 
         RowBox[{"n", "-", "ni"}], ",", "srratio"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"ni", ",", "0", ",", "n"}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GetJTerm", "[", 
   RowBox[{
    RowBox[{"{", "cell_", "}"}], ",", "n_", ",", " ", "s_", ",", "r_"}], 
   "]"}], ":=", 
  RowBox[{
   RowBox[{"s", "[", 
    RowBox[{"[", "cell", "]"}], "]"}], "^", 
   RowBox[{"Binomial", "[", 
    RowBox[{"n", ",", "2"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GetJTerm", "[", 
   RowBox[{"clique_List", ",", "n_", ",", " ", "s_", ",", "r_"}], "]"}], " ", 
  ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"srratio", "=", 
       RowBox[{"SRratio", "[", 
        RowBox[{"s", ",", "r", ",", "clique"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"k", "=", 
       RowBox[{"Length", "[", "clique", "]"}]}]}], "\[IndentingNewLine]", 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"r", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"clique", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{"clique", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "^", 
      RowBox[{"Binomial", "[", 
       RowBox[{"n", ",", "2"}], "]"}]}], " ", "*", " ", 
     RowBox[{"GetDTerm", "[", 
      RowBox[{"k", ",", "n", ",", "srratio"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.826691908173477*^9, 3.826691923275236*^9}, {
   3.8266943734494*^9, 3.826694384949321*^9}, {3.826696719597742*^9, 
   3.826696741314296*^9}, {3.826696887890477*^9, 3.826696890586649*^9}, {
   3.826698545236833*^9, 3.82669854743611*^9}, {3.8266989941890793`*^9, 
   3.826699042378667*^9}, {3.826699112856061*^9, 3.826699123718796*^9}, {
   3.82669940165061*^9, 3.826699419960739*^9}, {3.826699598801098*^9, 
   3.826699632078167*^9}, {3.8266996655265017`*^9, 3.826699720825424*^9}, {
   3.826699786981991*^9, 3.826699813892815*^9}, {3.826699879796061*^9, 
   3.826699883905335*^9}, {3.8266999194673777`*^9, 3.826699933158588*^9}, 
   3.826699969104002*^9, {3.826700012274729*^9, 3.826700043681284*^9}, {
   3.826700086880082*^9, 3.826700150171782*^9}, {3.826700225590479*^9, 
   3.826700333466172*^9}, {3.8267003641925297`*^9, 3.826700408846528*^9}, {
   3.826700444903625*^9, 3.826700449460507*^9}, {3.8267005340590563`*^9, 
   3.826700568662376*^9}, {3.826700766822391*^9, 3.826700795346916*^9}, {
   3.8267010424257193`*^9, 3.826701045861957*^9}, {3.8267012253125687`*^9, 
   3.826701246347601*^9}, {3.826701284937923*^9, 3.826701427354864*^9}, {
   3.826701463580579*^9, 3.826701471848776*^9}, {3.8267018740990057`*^9, 
   3.826701917416954*^9}, 3.826702283191683*^9, {3.826705194988215*^9, 
   3.826705337877451*^9}, {3.8267053814033117`*^9, 3.826705404970828*^9}, {
   3.826705442371807*^9, 3.826705464311863*^9}, {3.82670553421457*^9, 
   3.826705573762063*^9}, {3.826705692294456*^9, 3.826705894606629*^9}, {
   3.826706740393756*^9, 3.8267067571069717`*^9}, {3.8267068413362913`*^9, 
   3.8267069970710087`*^9}, {3.826707033722508*^9, 3.8267070366287813`*^9}, {
   3.826709236360263*^9, 3.8267092488614683`*^9}, {3.826709840693407*^9, 
   3.826709919313323*^9}, {3.826710353655128*^9, 3.826710358971368*^9}, {
   3.826710446022162*^9, 3.826710454829954*^9}, {3.826710528785511*^9, 
   3.826710552908914*^9}, {3.826711140107106*^9, 3.826711141034778*^9}, {
   3.826770141889476*^9, 3.826770147009123*^9}, {3.826770465766946*^9, 
   3.826770583510621*^9}, {3.826770684871632*^9, 3.826770702422164*^9}, {
   3.826770853485091*^9, 3.826770931323544*^9}, {3.8267709849139338`*^9, 
   3.826771003352418*^9}, {3.82677107493321*^9, 3.826771154186501*^9}, {
   3.826771190888564*^9, 3.8267712068558197`*^9}, {3.826772324555181*^9, 
   3.826772352986643*^9}, {3.8267724847155113`*^9, 3.826772491503093*^9}, {
   3.826772532967822*^9, 3.826772591075437*^9}, {3.826772779313925*^9, 
   3.8267727818571167`*^9}, {3.826772819333974*^9, 3.826772911132647*^9}, {
   3.826772999117989*^9, 3.826773025234232*^9}, {3.8267731298730307`*^9, 
   3.8267731410045633`*^9}, 3.82677340296294*^9, {3.8267734611022253`*^9, 
   3.826773487118004*^9}, {3.826773774201734*^9, 3.826773776430725*^9}, {
   3.826773915864647*^9, 3.826773954867942*^9}, {3.826774019441201*^9, 
   3.8267740362696047`*^9}, {3.826774075764183*^9, 3.8267742614049807`*^9}, {
   3.826774297889739*^9, 3.826774319116613*^9}, {3.826774375630319*^9, 
   3.826774547985279*^9}, {3.8267745976747923`*^9, 3.8267746369191236`*^9}, {
   3.8267746952389174`*^9, 3.826774717378902*^9}, {3.826776432780423*^9, 
   3.826776511622465*^9}, {3.826777602795004*^9, 3.826777629127974*^9}, {
   3.826778605190192*^9, 3.8267786290803833`*^9}, {3.826778665013783*^9, 
   3.826778863719534*^9}, {3.826779048235779*^9, 3.826779057911319*^9}, {
   3.826779251029684*^9, 3.826779287002925*^9}, {3.826779343329282*^9, 
   3.826779357336011*^9}, {3.826779431518835*^9, 3.8267794511221933`*^9}, {
   3.826780141591258*^9, 3.826780149126049*^9}, {3.826780206185391*^9, 
   3.82678020703806*^9}, {3.8267808097394133`*^9, 3.8267808098912582`*^9}, {
   3.82678139198076*^9, 3.8267813922233887`*^9}, {3.826781444096285*^9, 
   3.826781444232154*^9}, {3.826797198806508*^9, 3.826797243076335*^9}, {
   3.8267973019466677`*^9, 3.826797389530806*^9}, {3.826797814909292*^9, 
   3.826797999365364*^9}, {3.826798110502787*^9, 3.826798276387518*^9}, {
   3.82679849770181*^9, 3.8267984990031843`*^9}, 3.826799113849916*^9, {
   3.826799370299933*^9, 3.826799423792611*^9}, {3.82679946759827*^9, 
   3.826799639354917*^9}, {3.82679979565377*^9, 3.826799814261026*^9}, {
   3.826800043313301*^9, 3.826800068607938*^9}, {3.8268001037298822`*^9, 
   3.8268003503377037`*^9}, {3.826800392231367*^9, 3.826800397919237*^9}, {
   3.826801380495721*^9, 3.826801382343668*^9}, {3.826801893974278*^9, 
   3.8268019177732153`*^9}, {3.826802102011656*^9, 3.826802342928423*^9}, {
   3.826802373332333*^9, 3.8268023960322943`*^9}, {3.826802458834202*^9, 
   3.826802541404107*^9}, {3.827296223325539*^9, 3.827296225605289*^9}, {
   3.827296263986578*^9, 3.827296291465073*^9}, {3.827296332863793*^9, 
   3.827296353125709*^9}, {3.8272976190386257`*^9, 3.8272976326292343`*^9}, {
   3.827298035763824*^9, 3.827298067790472*^9}, {3.827298117709277*^9, 
   3.8272981384407578`*^9}, 3.827300239749887*^9, {3.827301154141986*^9, 
   3.827301239976479*^9}, {3.827301828810267*^9, 3.827301861393035*^9}, {
   3.827301892239365*^9, 3.8273019997861423`*^9}, {3.827302031544429*^9, 
   3.827302255543271*^9}, {3.827302304523499*^9, 3.827302321580572*^9}, {
   3.82730248286719*^9, 3.8273025455406637`*^9}, {3.827302608101035*^9, 
   3.827302617630672*^9}, {3.827465227052306*^9, 3.8274652357712183`*^9}, {
   3.827465453730818*^9, 3.8274654953603287`*^9}, {3.827466585441311*^9, 
   3.827466614087874*^9}, {3.827467552881259*^9, 3.827467558249358*^9}, {
   3.827467610911867*^9, 3.827467618280074*^9}, {3.8274676677975388`*^9, 
   3.827467701754944*^9}, {3.827471543491213*^9, 3.8274715488008966`*^9}, {
   3.836278108933132*^9, 3.836278114187827*^9}, {3.8362819426280737`*^9, 
   3.83628195502315*^9}, {3.8364496937759247`*^9, 3.836449711676116*^9}, {
   3.836456651041934*^9, 3.836456655832328*^9}, {3.838100534554991*^9, 
   3.838100605720351*^9}, 3.838101269334474*^9, {3.8381020227796707`*^9, 
   3.838102023306238*^9}, {3.838102168928934*^9, 3.838102370223971*^9}, {
   3.8381080347049103`*^9, 3.8381080661841497`*^9}, {3.838111708903923*^9, 
   3.8381117597921257`*^9}, {3.838122424492795*^9, 3.8381224247200613`*^9}, {
   3.838122515320002*^9, 3.838122540114081*^9}, {3.8381225771795473`*^9, 
   3.838122605654173*^9}, {3.83812343625648*^9, 3.838123437520603*^9}, {
   3.838123516788821*^9, 3.8381235187720137`*^9}, {3.838184360478383*^9, 
   3.8381844836167383`*^9}, {3.838184578091997*^9, 3.838184579179769*^9}, {
   3.8381886954017773`*^9, 3.838188725654476*^9}, {3.8381892313484917`*^9, 
   3.83818923159582*^9}, {3.838189276202713*^9, 3.838189280298307*^9}, {
   3.838190002261059*^9, 3.8381900353954973`*^9}, {3.838190120096134*^9, 
   3.838190132071341*^9}, {3.8381914350321217`*^9, 3.838191444540365*^9}, 
   3.838191526761639*^9, {3.838191587309626*^9, 3.8381916119806223`*^9}, {
   3.838191686560042*^9, 3.838191705175729*^9}, {3.838191747236854*^9, 
   3.838191862416596*^9}, {3.83819192810434*^9, 3.838191947260088*^9}, {
   3.8381919846209707`*^9, 3.838191985994561*^9}, {3.8381935988945427`*^9, 
   3.838193662655756*^9}, {3.83819509839776*^9, 3.8381951039734993`*^9}, {
   3.838197016459901*^9, 3.838197033220586*^9}, {3.8381970764112387`*^9, 
   3.838197083408684*^9}, {3.8381974671047773`*^9, 3.8381974712206573`*^9}, {
   3.8381975070272217`*^9, 3.838197533530995*^9}, {3.838354421593877*^9, 
   3.838354428516543*^9}, {3.838354495013659*^9, 3.838354500591889*^9}, {
   3.8387000014189177`*^9, 3.838700040586*^9}, {3.838884462753167*^9, 
   3.838884488264164*^9}, {3.8388846579365187`*^9, 3.838884718858076*^9}, {
   3.838886576521461*^9, 3.838886581895876*^9}, {3.838957099851025*^9, 
   3.83895711017019*^9}, {3.839924546896613*^9, 3.8399245696914377`*^9}, {
   3.839925433256225*^9, 3.8399254333940477`*^9}, {3.839925587260982*^9, 
   3.839925614183669*^9}, {3.839925999640648*^9, 3.839926000328596*^9}, {
   3.8399268152486153`*^9, 3.839926860177307*^9}, {3.839926995151889*^9, 
   3.8399270005958967`*^9}, {3.839927260900875*^9, 3.8399272923240757`*^9}, {
   3.839927344265706*^9, 3.8399273741193647`*^9}, {3.839927449932732*^9, 
   3.8399274620131207`*^9}, {3.839927497146934*^9, 3.839927671803705*^9}, {
   3.8399277079784937`*^9, 3.839927717916993*^9}, {3.839927770987331*^9, 
   3.839927896064042*^9}, {3.8399899620051928`*^9, 3.839989972656386*^9}, {
   3.839990069061261*^9, 3.839990158472969*^9}, {3.839990210906145*^9, 
   3.839990252681596*^9}, {3.83999074064861*^9, 3.8399907829938374`*^9}, {
   3.8399913126625347`*^9, 3.83999141226851*^9}, {3.839991715545762*^9, 
   3.8399917671669827`*^9}, 3.839994682243854*^9, {3.83999493691151*^9, 
   3.839994957468689*^9}, {3.83999502067029*^9, 3.839995029328231*^9}, 
   3.840005796651864*^9, 3.840080508257257*^9, {3.840080577050498*^9, 
   3.8400805811687193`*^9}, {3.8400809423971233`*^9, 3.840080955248723*^9}, {
   3.841724898116145*^9, 3.8417249126844063`*^9}, {3.841725071815797*^9, 
   3.841725075548442*^9}, {3.84197990135568*^9, 3.841979951554397*^9}, {
   3.84206825682718*^9, 3.84206825862787*^9}, {3.842070142177874*^9, 
   3.8420701477547207`*^9}, {3.842071263582336*^9, 3.842071286653947*^9}, {
   3.842073232353438*^9, 3.842073243320953*^9}, {3.8420775307077703`*^9, 
   3.8420775639714327`*^9}, {3.842077600016333*^9, 3.842077614458185*^9}, {
   3.842077649138726*^9, 3.842077674271883*^9}, 3.842077760616824*^9, {
   3.842077837638926*^9, 3.842077848947378*^9}, {3.842077958257687*^9, 
   3.842077972677231*^9}, {3.84208689123807*^9, 3.842086910970099*^9}, {
   3.842087081921216*^9, 3.842087128843708*^9}, {3.842087163603962*^9, 
   3.842087184719132*^9}, {3.842087408435212*^9, 3.842087410904152*^9}, {
   3.842087442897276*^9, 3.842087456184155*^9}, {3.84208752832938*^9, 
   3.8420876970659323`*^9}, {3.842087760070369*^9, 3.842087765956793*^9}, {
   3.842087878743634*^9, 3.8420878868211718`*^9}, {3.84208791850214*^9, 
   3.842087924860622*^9}, {3.842089078568522*^9, 3.84208915386769*^9}, {
   3.842256336987688*^9, 3.842256341628521*^9}, {3.842493671844802*^9, 
   3.842493677032359*^9}, {3.842497514200756*^9, 3.8424975289840508`*^9}, {
   3.842602636406027*^9, 3.8426026592537203`*^9}, {3.842677796713739*^9, 
   3.842677806759116*^9}, {3.8426786588852663`*^9, 3.842678700073963*^9}, {
   3.8426787495118847`*^9, 3.84267879317968*^9}, {3.842678894440647*^9, 
   3.842678938342349*^9}, {3.842678984527708*^9, 3.842679002250808*^9}, {
   3.8426790459048862`*^9, 3.8426790851519947`*^9}, {3.842691255531337*^9, 
   3.842691257806942*^9}, {3.8426913362896233`*^9, 3.8426913560579157`*^9}, {
   3.842931609498891*^9, 3.8429316167512913`*^9}, 3.842932960274722*^9, {
   3.843023168171145*^9, 3.843023176490438*^9}, {3.843024235659808*^9, 
   3.843024239552055*^9}, {3.843030745256369*^9, 3.843030758215242*^9}, {
   3.8430308163570747`*^9, 3.8430308927281847`*^9}, {3.843031797307029*^9, 
   3.8430317997062263`*^9}, {3.843033842329843*^9, 3.8430338505250607`*^9}, {
   3.8430339568215322`*^9, 3.843034141707782*^9}, {3.843034355593574*^9, 
   3.843034362438611*^9}, {3.843034637627597*^9, 3.84303463913725*^9}, {
   3.8430347492594957`*^9, 3.843034872572866*^9}, {3.8430349142023287`*^9, 
   3.843034953216464*^9}, {3.84303504004652*^9, 3.843035088362002*^9}, {
   3.843035124786152*^9, 3.84303513777003*^9}, {3.843035170209634*^9, 
   3.843035233135317*^9}, {3.843035298679887*^9, 3.843035304007552*^9}, {
   3.843035334918089*^9, 3.84303537257972*^9}, {3.843037627368753*^9, 
   3.8430376359234543`*^9}, {3.843105096699276*^9, 3.843105210835134*^9}, 
   3.843105324833179*^9, {3.843120649688952*^9, 
   3.8431206596261463`*^9}},ExpressionUUID->"bd4dac13-24d5-43d7-ae76-\
3f67079096f2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"exampleDerangements", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Not]", 
         RowBox[{"f", "[", 
          RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}]}], " ", "\[And]", 
        " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Implies]", 
          RowBox[{"s1", "[", "\[FormalA]", "]"}]}], ")"}], "\[And]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}], "\[Implies]", 
          RowBox[{"s2", "[", "\[FormalA]", "]"}]}], ")"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{
         RowBox[{"f", "\[Rule]", "\[FormalZ]"}], ",", 
         RowBox[{"s1", "\[Rule]", "1"}], ",", 
         RowBox[{"s2", "\[Rule]", "1"}]}], "\[RightAssociation]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{
         RowBox[{"f", "\[Rule]", "1"}], ",", 
         RowBox[{"s1", "\[Rule]", 
          RowBox[{"-", "1"}]}], ",", 
         RowBox[{"s2", "\[Rule]", 
          RowBox[{"-", "1"}]}]}], "\[RightAssociation]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"exampleFunctions", " ", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Implies]", 
        RowBox[{"s1", "[", "\[FormalA]", "]"}]}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"\[LeftAssociation]", 
        RowBox[{
         RowBox[{"f", "\[Rule]", "\[FormalZ]"}], ",", 
         RowBox[{"s1", "\[Rule]", "1"}]}], "\[RightAssociation]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{
         RowBox[{"f", "\[Rule]", "1"}], ",", 
         RowBox[{"s1", "\[Rule]", 
          RowBox[{"-", "1"}]}]}], "\[RightAssociation]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"exampleInvolutions", " ", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Implies]", 
          RowBox[{"s1", "[", "\[FormalA]", "]"}]}], ")"}], "\[And]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Implies]", 
          RowBox[{"f", "[", 
           RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}]}], ")"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{
         RowBox[{"f", "\[Rule]", "\[FormalZ]"}], ",", 
         RowBox[{"s1", "\[Rule]", "1"}]}], "\[RightAssociation]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{
         RowBox[{"f", "\[Rule]", "1"}], ",", 
         RowBox[{"s1", "\[Rule]", 
          RowBox[{"-", "1"}]}]}], "\[RightAssociation]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"example1Regularity", " ", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Not]", 
         RowBox[{"f", "[", 
          RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}]}], " ", "\[And]", 
        " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Implies]", 
          RowBox[{"s1", "[", "\[FormalA]", "]"}]}], ")"}], "\[And]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}], "\[Implies]", 
          RowBox[{"s2", "[", "\[FormalA]", "]"}]}], ")"}], "\[And]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Implies]", 
          RowBox[{"f", "[", 
           RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}]}], ")"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{
         RowBox[{"f", "\[Rule]", "\[FormalZ]"}], ",", 
         RowBox[{"s1", "\[Rule]", "1"}], ",", 
         RowBox[{"s2", "\[Rule]", "1"}]}], "\[RightAssociation]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{
         RowBox[{"f", "\[Rule]", "1"}], ",", 
         RowBox[{"s1", "\[Rule]", 
          RowBox[{"-", "1"}]}], ",", 
         RowBox[{"s2", "\[Rule]", 
          RowBox[{"-", "1"}]}]}], "\[RightAssociation]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"example2Regularity", " ", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Not]", 
         RowBox[{"e", "[", 
          RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}]}], "\[And]", 
        "\[IndentingNewLine]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"e", "[", 
           RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Equivalent]", 
          
          RowBox[{"e", "[", 
           RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}]}], ")"}], 
        "\[And]", "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"f1", "[", 
           RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Implies]", 
          RowBox[{"s1", "[", "\[FormalA]", "]"}]}], ")"}], "\[And]", 
        "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"f2", "[", 
           RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Implies]", 
          RowBox[{"s2", "[", "\[FormalA]", "]"}]}], ")"}], "\[And]", 
        "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"e", "[", 
           RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Equivalent]", 
          
          RowBox[{"(", 
           RowBox[{
            RowBox[{"f1", "[", 
             RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Or]", 
            RowBox[{"f2", "[", 
             RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}]}], ")"}]}], 
         ")"}], "\[And]", " ", "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Not]", 
           RowBox[{"f1", "[", 
            RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}]}], "\[Or]", 
          RowBox[{"\[Not]", 
           RowBox[{"f2", "[", 
            RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}]}]}], ")"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{
         RowBox[{"e", "\[Rule]", "\[FormalZ]"}], ",", 
         RowBox[{"s1", "\[Rule]", "1"}], ",", 
         RowBox[{"s2", "\[Rule]", "1"}], ",", 
         RowBox[{"f1", "\[Rule]", "1"}], ",", 
         RowBox[{"f2", "\[Rule]", "1"}]}], "\[RightAssociation]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{
         RowBox[{"e", "\[Rule]", "1"}], ",", 
         RowBox[{"s1", "\[Rule]", 
          RowBox[{"-", "1"}]}], ",", 
         RowBox[{"s2", "\[Rule]", 
          RowBox[{"-", "1"}]}], ",", 
         RowBox[{"f1", "\[Rule]", "1"}], ",", 
         RowBox[{"f2", "\[Rule]", "1"}]}], "\[RightAssociation]"}]}], 
      "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"example3Regularity", "=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Not]", 
         RowBox[{"e", "[", 
          RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}]}], "\[And]", 
        "\[IndentingNewLine]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"e", "[", 
           RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Implies]", 
          RowBox[{"e", "[", 
           RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}]}], ")"}], 
        "\[And]", "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"f1", "[", 
           RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Implies]", 
          RowBox[{"s1", "[", "\[FormalA]", "]"}]}], ")"}], "\[And]", 
        "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"f2", "[", 
           RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Implies]", 
          RowBox[{"s2", "[", "\[FormalA]", "]"}]}], ")"}], "\[And]", 
        "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"f3", "[", 
           RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Implies]", 
          RowBox[{"s3", "[", "\[FormalA]", "]"}]}], ")"}], "\[And]", 
        "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"e", "[", 
           RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Equivalent]", 
          
          RowBox[{"(", 
           RowBox[{
            RowBox[{"f1", "[", 
             RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Or]", 
            RowBox[{"f2", "[", 
             RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Or]", 
            RowBox[{"f3", "[", 
             RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}]}], ")"}]}], 
         ")"}], "\[And]", "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Not]", 
           RowBox[{"f1", "[", 
            RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}]}], "\[Or]", 
          RowBox[{"\[Not]", 
           RowBox[{"f2", "[", 
            RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}]}]}], ")"}], 
        "\[And]", "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Not]", 
           RowBox[{"f1", "[", 
            RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}]}], "\[Or]", 
          RowBox[{"\[Not]", 
           RowBox[{"f3", "[", 
            RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}]}]}], ")"}], 
        "\[And]", "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Not]", 
           RowBox[{"f2", "[", 
            RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}]}], "\[Or]", 
          RowBox[{"\[Not]", 
           RowBox[{"f3", "[", 
            RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}]}]}], ")"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{
         RowBox[{"e", "\[Rule]", "\[FormalZ]"}], ",", 
         RowBox[{"s1", "\[Rule]", "1"}], ",", 
         RowBox[{"s2", "\[Rule]", "1"}], ",", 
         RowBox[{"s3", "\[Rule]", "1"}], ",", 
         RowBox[{"f1", "\[Rule]", "1"}], ",", 
         RowBox[{"f2", "\[Rule]", "1"}], ",", 
         RowBox[{"f3", "\[Rule]", "1"}]}], "\[RightAssociation]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{
         RowBox[{"e", "\[Rule]", "1"}], ",", 
         RowBox[{"s1", "\[Rule]", 
          RowBox[{"-", "1"}]}], ",", 
         RowBox[{"s2", "\[Rule]", 
          RowBox[{"-", "1"}]}], ",", 
         RowBox[{"s3", "\[Rule]", 
          RowBox[{"-", "1"}]}], ",", 
         RowBox[{"f1", "\[Rule]", "1"}], ",", 
         RowBox[{"f2", "\[Rule]", "1"}], ",", 
         RowBox[{"f3", "\[Rule]", "1"}]}], "\[RightAssociation]"}]}], 
      "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"example3Coloredness", "=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Not]", 
         RowBox[{"e", "[", 
          RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}]}], "\[And]", 
        "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"e", "[", 
           RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Implies]", 
          RowBox[{"e", "[", 
           RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}]}], ")"}], 
        "\[And]", "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c1", "[", "\[FormalA]", "]"}], "\[Or]", 
          RowBox[{"c2", "[", "\[FormalA]", "]"}], "\[Or]", 
          RowBox[{"c3", "[", "\[FormalA]", "]"}]}], ")"}], "\[And]", 
        "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Not]", 
           RowBox[{"c1", "[", "\[FormalA]", "]"}]}], "\[Or]", " ", 
          RowBox[{"\[Not]", 
           RowBox[{"c2", "[", "\[FormalA]", "]"}]}]}], ")"}], "\[And]", 
        "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Not]", 
           RowBox[{"c3", "[", "\[FormalA]", "]"}]}], "\[Or]", " ", 
          RowBox[{"\[Not]", 
           RowBox[{"c2", "[", "\[FormalA]", "]"}]}]}], ")"}], "\[And]", 
        "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Not]", 
           RowBox[{"c1", "[", "\[FormalA]", "]"}]}], "\[Or]", " ", 
          RowBox[{"\[Not]", 
           RowBox[{"c3", "[", "\[FormalA]", "]"}]}]}], ")"}], "\[And]", 
        "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"e", "[", 
           RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Implies]", 
          " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Not]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"c1", "[", "\[FormalA]", "]"}], "\[And]", 
               RowBox[{"c1", "[", "\[FormalB]", "]"}]}], ")"}]}], "\[And]", 
            RowBox[{"\[Not]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"c2", "[", "\[FormalA]", "]"}], "\[And]", 
               RowBox[{"c2", "[", "\[FormalB]", "]"}]}], ")"}]}], "\[And]", 
            RowBox[{"\[Not]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"c3", "[", "\[FormalA]", "]"}], "\[And]", 
               RowBox[{"c3", "[", "\[FormalB]", "]"}]}], ")"}]}]}], ")"}]}], 
         ")"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{
         RowBox[{"e", "\[Rule]", "1"}], ",", 
         RowBox[{"c1", "\[Rule]", "1"}], ",", 
         RowBox[{"c2", "\[Rule]", "1"}], ",", 
         RowBox[{"c3", "\[Rule]", "1"}]}], "\[RightAssociation]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{
         RowBox[{"e", "\[Rule]", "1"}], ",", 
         RowBox[{"c1", "\[Rule]", "1"}], ",", 
         RowBox[{"c2", "\[Rule]", "1"}], ",", 
         RowBox[{"c3", "\[Rule]", "1"}]}], "\[RightAssociation]"}]}], 
      "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"example2Coloredness", "=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Not]", 
         RowBox[{"e", "[", 
          RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}]}], "\[And]", 
        "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"e", "[", 
           RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Implies]", 
          RowBox[{"e", "[", 
           RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}]}], ")"}], 
        "\[And]", "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c1", "[", "\[FormalA]", "]"}], "\[Xor]", " ", 
          RowBox[{"c2", "[", "\[FormalA]", "]"}]}], ")"}], "\[And]", 
        "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"e", "[", 
           RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Implies]", 
          " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Not]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"c1", "[", "\[FormalA]", "]"}], "\[And]", 
               RowBox[{"c1", "[", "\[FormalB]", "]"}]}], ")"}]}], "\[And]", 
            RowBox[{"\[Not]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"c2", "[", "\[FormalA]", "]"}], "\[And]", 
               RowBox[{"c2", "[", "\[FormalB]", "]"}]}], ")"}]}]}], ")"}]}], 
         ")"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{
         RowBox[{"e", "\[Rule]", "1"}], ",", 
         RowBox[{"c1", "\[Rule]", "1"}], ",", 
         RowBox[{"c2", "\[Rule]", "1"}]}], "\[RightAssociation]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{
         RowBox[{"e", "\[Rule]", "1"}], ",", 
         RowBox[{"c1", "\[Rule]", "1"}], ",", 
         RowBox[{"c2", "\[Rule]", "1"}]}], "\[RightAssociation]"}]}], 
      "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"s", ",", "w", ",", "r"}], "}"}], "=", 
     RowBox[{"SWR", "[", "exampleDerangements", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"sfunc", ",", "wfunc", ",", "rfunc"}], "}"}], " ", "=", 
     RowBox[{"SWR", "[", "exampleFunctions", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"sinvol", ",", "winvol", ",", "rinvol"}], "}"}], " ", "=", 
     RowBox[{"SWR", "[", "exampleFunctions", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"s1reg", ",", "w1reg", ",", "r1reg"}], "}"}], " ", "=", " ", 
     RowBox[{"SWR", "[", "example1Regularity", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"s2reg", ",", "w2reg", ",", "r2reg"}], "}"}], " ", "=", " ", 
     RowBox[{"SWR", "[", "example2Regularity", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"s2col", ",", "w2col", ",", "r2col"}], "}"}], " ", "=", " ", 
     RowBox[{"SWR", "[", "example2Coloredness", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"s3col", ",", "w3col", ",", "r3col"}], "}"}], " ", "=", " ", 
     RowBox[{"SWR", "[", "example3Coloredness", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rfull", "=", 
     RowBox[{"RTermsFull", "[", "exampleDerangements", "]"}]}], ";", " ", 
    RowBox[{"MatrixForm", "[", "r", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.840005860385851*^9, 3.8400058692333927`*^9}, {
   3.840078754646974*^9, 3.84007878629392*^9}, {3.840080472913*^9, 
   3.8400804806196632`*^9}, {3.8400809661903477`*^9, 3.840080973638291*^9}, {
   3.840268883762092*^9, 3.840269038706477*^9}, {3.8417249311286163`*^9, 
   3.841725021219054*^9}, {3.8417388258742657`*^9, 3.841738833286767*^9}, {
   3.841978769619272*^9, 3.841978778370488*^9}, {3.841978934298024*^9, 
   3.84197898572052*^9}, {3.841979037125477*^9, 3.8419791272095118`*^9}, {
   3.841979174487116*^9, 3.841979417110361*^9}, {3.841979958311084*^9, 
   3.841980028340973*^9}, {3.84198354019487*^9, 3.84198355090236*^9}, {
   3.841983582785203*^9, 3.841983669108244*^9}, {3.841983740346431*^9, 
   3.841983778572781*^9}, {3.842256010832583*^9, 3.84225628978911*^9}, {
   3.8422563858164062`*^9, 3.842256388755805*^9}, {3.842256442569722*^9, 
   3.8422564461291237`*^9}, {3.842256486057455*^9, 3.8422565981606073`*^9}, {
   3.84225663165132*^9, 3.84225663839228*^9}, {3.8424924675410137`*^9, 
   3.842492491560334*^9}, {3.842498802219186*^9, 3.842498831512241*^9}, {
   3.842502004812948*^9, 3.842502033937065*^9}, {3.842504527847623*^9, 
   3.8425045549185057`*^9}, {3.842677626951592*^9, 3.842677631350041*^9}, {
   3.842677685236588*^9, 3.842677688867722*^9}, {3.842684577416483*^9, 
   3.842684582695046*^9}, {3.8426846557097816`*^9, 3.842684655843658*^9}, 
   3.8426849893185253`*^9, 3.84268504396909*^9, 3.842686752578504*^9, {
   3.8426881216748857`*^9, 3.842688123882313*^9}, {3.842688196941394*^9, 
   3.842688241555835*^9}, {3.8429497259752703`*^9, 3.842949734302512*^9}, {
   3.843118794958046*^9, 3.843118798904464*^9}, {3.843119044641137*^9, 
   3.843119055134924*^9}, {3.843119361249031*^9, 3.843119425148756*^9}, {
   3.843120006114753*^9, 3.843120006623542*^9}, {3.843121924472622*^9, 
   3.843121939672483*^9}, {3.8431219871010427`*^9, 3.843121987929388*^9}},
 CellLabel->
  "In[536]:=",ExpressionUUID->"e916d1d5-57da-4d6d-a398-e237d7a69b52"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"1", "0", "0", "0"},
     {"1", 
      RowBox[{"1", "+", "\[FormalZ]"}], "0", "0"},
     {"1", 
      RowBox[{"1", "+", "\[FormalZ]"}], 
      RowBox[{"1", "+", "\[FormalZ]"}], "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.841979417865926*^9, {3.84198002187663*^9, 3.841980029217977*^9}, 
   3.8419836157711143`*^9, 3.841983779418131*^9, 3.8420675631804113`*^9, 
   3.8420682808390303`*^9, 3.842239485968123*^9, {3.84225626871572*^9, 
   3.8422562913414793`*^9}, 3.8422563468786983`*^9, 3.8422563895901413`*^9, {
   3.842256569993216*^9, 3.8422565990348673`*^9}, 3.84225663937055*^9, 
   3.842411363510233*^9, 3.842491549976253*^9, 3.8424937334347878`*^9, 
   3.8424945683377533`*^9, 3.8424975365209227`*^9, 3.842498832800283*^9, 
   3.842502057214665*^9, {3.842504529203577*^9, 3.84250455921907*^9}, 
   3.842578860762966*^9, 3.842670358014145*^9, 3.842677631863576*^9, 
   3.842677690302784*^9, 3.842678810028841*^9, 3.842678965060239*^9, 
   3.8426790091715384`*^9, 3.842679096553687*^9, {3.842679371680718*^9, 
   3.842679386323763*^9}, 3.842684595032153*^9, 3.842684657830386*^9, 
   3.842684991948852*^9, 3.842685141766384*^9, 3.8426867540826273`*^9, 
   3.842688125202389*^9, {3.842688205828285*^9, 3.8426882306321793`*^9}, 
   3.842931585821308*^9, 3.8429316208546333`*^9, {3.842932943185989*^9, 
   3.842932964201899*^9}, {3.842949727743442*^9, 3.8429497348132353`*^9}, 
   3.843017513248612*^9, 3.843103639024083*^9, 3.843105295302717*^9, 
   3.843105327548687*^9, 3.8431194310649853`*^9, 3.843120007225803*^9, 
   3.843121990519133*^9},
 CellLabel->
  "Out[551]//MatrixForm=",ExpressionUUID->"d1a89991-f078-4ae0-b0cd-\
bbcd593fc2d6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CellGraphEdges", "[", "cells_", "]"}], " ", ":=", " ", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
         "cells", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
         "\[DirectedEdge]", " ", 
         RowBox[{
         "cells", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}], 
        ",", " ", 
        RowBox[{"{", 
         RowBox[{"j", ",", " ", "1", ",", " ", 
          RowBox[{"Length", "[", "cells", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "j"}], "}"}]}], "]"}], ",", "2"}], 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CellGraph", "[", "specification_", "]"}], ":=", " ", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"cells", " ", "=", 
         RowBox[{"FormulaCellsValid", "[", 
          RowBox[{"First", "[", "specification", "]"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"edgeLabeling", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"cell1_", "\[DirectedEdge]", "cell2_"}], ")"}], 
          "\[RuleDelayed]", " ", 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"cell1", "\[DirectedEdge]", "cell2"}], ")"}], " ", 
            "\[Rule]", "\[IndentingNewLine]", 
            RowBox[{"RTerm", "[", 
             RowBox[{"specification", ",", " ", "cell1", ",", "cell2"}], 
             "]"}]}], ")"}]}]}], ",", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"Note", ":", " ", 
          RowBox[{
           RowBox[{"This", " ", "automagically", " ", "coumputes", " ", "S"}],
            "-", 
           RowBox[{"terms", " ", "at", " ", "loops"}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"vertexLabeling", "=", 
         RowBox[{"cell", "\[Function]", 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{"cell", " ", "\[Rule]", 
            RowBox[{"WTerm", "[", 
             RowBox[{"specification", ",", " ", "cell"}], "]"}]}], 
           ")"}]}]}]}], "\[IndentingNewLine]", "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"With", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"edges", "=", " ", 
          RowBox[{"CellGraphEdges", "[", "cells", "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Graph", "[", "\[IndentingNewLine]", 
         RowBox[{"edges", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"EdgeWeight", "\[Rule]", " ", "edges"}], " ", "/.", " ", 
           "edgeLabeling"}], ",", "\[IndentingNewLine]", 
          RowBox[{"EdgeLabels", "\[Rule]", "\"\<EdgeWeight\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"VertexLabels", "\[Rule]", 
           RowBox[{
            RowBox[{"(", "vertexLabeling", ")"}], " ", "/@", " ", "cells"}]}],
           ",", "\[IndentingNewLine]", 
          RowBox[{"GraphLayout", "->", "\"\<CircularEmbedding\>\""}]}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CellGraphIndependent", "[", "specification_", "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"g", "=", 
        RowBox[{"CellGraph", "[", "specification", "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"EdgeDelete", "[", 
       RowBox[{"g", ",", "\[IndentingNewLine]", 
        RowBox[{"First", "/@", 
         RowBox[{"Select", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"AnnotationValue", "[", 
            RowBox[{"g", ",", "EdgeLabels"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Last", "[", "#", "]"}], "==", "1"}], "&"}]}], 
          "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CellGraphReduced", "[", "specification_", "]"}], ":=", 
    RowBox[{"Module", "[", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"TODO", " ", "-", " ", 
       RowBox[{
       "this", " ", "implements", " ", "the", " ", "\"\<condensation\>\"", 
        " ", 
        RowBox[{"w", ".", "r", ".", "t", ".", " ", "cliques"}]}], " ", "-", 
       " ", 
       RowBox[{"is", " ", "that", " ", "even", " ", "useful", " ", "for", " ", 
        RowBox[{"anything", "?"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"terms", "=", 
         RowBox[{"SWR", "[", "specification", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"graph", " ", "=", " ", 
         RowBox[{"CellGraph", "[", "specification", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"cells", " ", "=", 
         RowBox[{"FormulaCellsValid", "[", 
          RowBox[{"First", "[", "specification", "]"}], "]"}]}]}], 
       "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"VertexDelete", "[", 
       RowBox[{"graph", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"cells", "[", 
           RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Rest", "/@", " ", 
           RowBox[{"Cliques", "[", "terms", "]"}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"example", " ", "=", " ", "exampleInvolutions"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cellGraph", " ", "=", " ", 
     RowBox[{"CellGraph", "[", "example", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Show", "[", "\[IndentingNewLine]", 
    RowBox[{"cellGraph", ",", "\[IndentingNewLine]", 
     RowBox[{"ImageSize", "->", "Small"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cellGraphIndependent", " ", "=", " ", 
     RowBox[{"CellGraphIndependent", "[", "example", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Show", "[", "\[IndentingNewLine]", 
    RowBox[{"cellGraphIndependent", ",", "\[IndentingNewLine]", 
     RowBox[{"ImageSize", "->", "Small"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"I1", "=", 
    RowBox[{"First", "@", 
     RowBox[{
     "FindIndependentVertexSet", "[", "cellGraphIndependent", "]"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"NeighborhoodGraph", "[", 
    RowBox[{"cellGraphIndependent", ",", "I1"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"cliques", "=", 
    RowBox[{"Cliques", "[", 
     RowBox[{"SWR", "[", "example", "]"}], " ", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.82677631664717*^9, 3.826776392106119*^9}, {
   3.8267765332843943`*^9, 3.8267766975869493`*^9}, {3.826776732923592*^9, 
   3.826776879441977*^9}, {3.826776914408204*^9, 3.826777159010041*^9}, {
   3.8267772126363697`*^9, 3.826777281654173*^9}, {3.826777409263867*^9, 
   3.82677752628185*^9}, {3.826779530135537*^9, 3.8267795697076406`*^9}, {
   3.826779604479659*^9, 3.8267796593012533`*^9}, {3.826779690132078*^9, 
   3.826779735226982*^9}, {3.826779768791193*^9, 3.8267799442464542`*^9}, {
   3.826779999790695*^9, 3.826780008762195*^9}, {3.826780216348117*^9, 
   3.8267802165420732`*^9}, {3.826780247717576*^9, 3.826780251767538*^9}, {
   3.82678032029327*^9, 3.826780380809041*^9}, {3.826780641696588*^9, 
   3.826780668223263*^9}, 3.826781434212461*^9, {3.826781507117353*^9, 
   3.826781639628915*^9}, 3.826781671652635*^9, {3.826781728169271*^9, 
   3.826781762582808*^9}, {3.8267818619143267`*^9, 3.826781873473317*^9}, {
   3.8267819217592897`*^9, 3.826781945990067*^9}, {3.826781976836549*^9, 
   3.826782016579034*^9}, {3.826782048146036*^9, 3.826782048744166*^9}, {
   3.826787002171405*^9, 3.826787002506032*^9}, {3.8267873756492157`*^9, 
   3.8267873817162027`*^9}, {3.827374667603437*^9, 3.827374674262203*^9}, {
   3.839990023453744*^9, 3.839990025503839*^9}, {3.8399949779423923`*^9, 
   3.839995006431424*^9}, {3.841738849521451*^9, 3.841738855360211*^9}, {
   3.841980869970791*^9, 3.841980890917142*^9}, {3.8420899036626587`*^9, 
   3.842089918628214*^9}, {3.842089966871708*^9, 3.8420899871192427`*^9}, {
   3.843024455807733*^9, 3.8430244596930227`*^9}, {3.843105231548208*^9, 
   3.843105282918071*^9}, {3.8431057287863073`*^9, 3.843105812317233*^9}, {
   3.8431058484282017`*^9, 3.843105928407014*^9}, {3.8431059798342113`*^9, 
   3.843106008805435*^9}, {3.843106630247072*^9, 3.843106766158869*^9}, {
   3.843117501310306*^9, 3.843117502113502*^9}, {3.843117555172702*^9, 
   3.8431175575682592`*^9}, {3.843118680608117*^9, 3.843118732785239*^9}, {
   3.8431205698448067`*^9, 3.843120599393984*^9}, {3.8431206747582293`*^9, 
   3.84312070447647*^9}, 3.843121049035801*^9, {3.843122026283421*^9, 
   3.843122041981823*^9}, {3.843122091237214*^9, 3.84312211792118*^9}, {
   3.8431223001227016`*^9, 3.8431223699913473`*^9}, {3.843122414178328*^9, 
   3.843122419749008*^9}, {3.843122922699553*^9, 3.843123044517785*^9}, {
   3.8431230801171017`*^9, 3.843123115564638*^9}, {3.843124077972109*^9, 
   3.84312409486526*^9}, {3.843124152104596*^9, 3.84312417872506*^9}, {
   3.8431248579714518`*^9, 3.8431248757460403`*^9}, {3.843125600561597*^9, 
   3.843125606347663*^9}, 3.843126412388007*^9, {3.8431264784886847`*^9, 
   3.843126484136108*^9}, 3.843126518482505*^9, 3.843127219550322*^9, {
   3.843127766610414*^9, 3.843127865815694*^9}, {3.843139696046556*^9, 
   3.843139722098288*^9}},
 CellLabel->
  "In[806]:=",ExpressionUUID->"cb5ccc7e-7f44-46d8-b840-19729f63b518"],

Cell[BoxData[
 GraphicsBox[{
   {Hue[0.6, 0.7, 0.5], Opacity[0.7], Arrowheads[
    Medium], {
     ArrowBox[BezierCurveBox[{{-0.8660254037844384, -0.4999999999999994}, \
{-0.8335209013159648, -0.862800581520903}, {-1.082998038973717, \
-1.119628759025554}, {-1.3248123036375836`, -1.1413261322732748`}, \
{-1.6508235763704866`, -0.5766580440596917}, {-1.5111259676106341`, \
-0.37808943448719007`}, {-1.163967672655071, -0.29044998436447517`}, \
{-0.8660254037844384, -0.4999999999999994}},
      SplineDegree->7], 0.020399597244776385`], 
     InsetBox["1", {-1.6160254037844388, -0.9330127018922184}, ImageScaled[{0.5, 0.5}],
      BaseStyle->"Graphics"]}, {
     ArrowBox[{{-0.8660254037844384, -0.4999999999999994}, {
      1.8369701987210297`*^-16, 1.}}, 0.020399597244776385`], 
     InsetBox["1", {-0.4330127018922191, 0.25000000000000033}, ImageScaled[{0.5, 0.5}],
      BaseStyle->"Graphics"]}, {
     ArrowBox[{{-0.8660254037844384, -0.4999999999999994}, {
      0.8660254037844389, -0.5000000000000012}}, 0.020399597244776385`], 
     InsetBox["1", {2.7755575615628914*^-16, -0.5000000000000003}, 
      ImageScaled[{0.5, 0.5}],
      BaseStyle->"Graphics"]}, {
     ArrowBox[BezierCurveBox[{{1.8369701987210297`*^-16, 
      1.}, {-0.33046715705303475`, 
      1.1532065938293599`}, {-0.42815434043523065`, 
      1.4976954721364832`}, {-0.32603138481484706`, 1.7179750434668788`}, {
      0.3260313848148485, 1.7179750434668781`}, {0.42815434043523176`, 
      1.4976954721364826`}, {0.33046715705303537`, 1.1532065938293594`}, {
      1.8369701987210297`*^-16, 1.}},
      SplineDegree->7], 0.020399597244776385`], InsetBox[
      RowBox[{
       SuperscriptBox["\[FormalZ]", "2"], "+", "1"}], {8.207521031283772*^-16, 1.8660254037844388},
       ImageScaled[{0.5, 0.5}],
      BaseStyle->"Graphics"]}, {
     ArrowBox[{{1.8369701987210297`*^-16, 1.}, {
      0.8660254037844389, -0.5000000000000012}}, 0.020399597244776385`], 
     InsetBox[
      RowBox[{
       SuperscriptBox["\[FormalZ]", "2"], "+", "1"}], {0.4330127018922196, 0.2499999999999994},
       ImageScaled[{0.5, 0.5}],
      BaseStyle->"Graphics"]}, {
     ArrowBox[BezierCurveBox[{{0.8660254037844389, -0.5000000000000012}, {
      1.1639676726554826`, -0.29044998436506153`}, {
      1.51112596761073, -0.37808943448769694`}, {
      1.6508235763704553`, -0.576658044060018}, {
      1.3248123036378483`, -1.1413261322730874`}, {
      1.0829980389742018`, -1.1196287590253862`}, {
      0.8335209013166767, -0.862800581520969}, {
      0.8660254037844389, -0.5000000000000012}},
      SplineDegree->7], 0.020399597244776385`], InsetBox[
      RowBox[{
       SuperscriptBox["\[FormalZ]", "2"], "+", "1"}], {1.6160254037844388, -0.9330127018922206},
       ImageScaled[{0.5, 0.5}],
      BaseStyle->"Graphics"]}}, 
   {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
    DiskBox[{-0.8660254037844384, -0.4999999999999994}, 0.020399597244776385],
     DiskBox[{1.8369701987210297*^-16, 1.}, 0.020399597244776385], 
    DiskBox[{0.8660254037844389, -0.5000000000000012}, 0.020399597244776385]}},
  FormatType->TraditionalForm,
  FrameTicks->None,
  ImageSize->Small]], "Output",
 CellChangeTimes->{{3.839994992149252*^9, 3.839995007026175*^9}, 
   3.839995038766769*^9, 3.839995124023505*^9, {3.8400057762395897`*^9, 
   3.840005799784596*^9}, 3.840005875207528*^9, 3.840078628183957*^9, {
   3.8400805385418873`*^9, 3.840080545873246*^9}, 3.840080591591329*^9, 
   3.8402688548086853`*^9, 3.840528032646559*^9, 3.841112940905177*^9, 
   3.841716900317541*^9, {3.841725056166939*^9, 3.841725081203833*^9}, {
   3.8417388434872837`*^9, 3.8417388562912617`*^9}, 3.841738935696185*^9, 
   3.841739491369882*^9, 3.8419750588331137`*^9, 3.841978762034347*^9, {
   3.841980872899082*^9, 3.8419808912941303`*^9}, 3.8420675632335443`*^9, 
   3.8420682808672733`*^9, {3.8420898790541477`*^9, 3.842089904738566*^9}, {
   3.842089971165962*^9, 3.842089987689747*^9}, 3.842239486006727*^9, 
   3.842256346891267*^9, 3.842411363552512*^9, 3.8424915500134087`*^9, 
   3.842493733475758*^9, 3.842494568366165*^9, 3.842497536538418*^9, 
   3.842502057233458*^9, {3.8425045372182198`*^9, 3.842504559237763*^9}, 
   3.842578860819373*^9, 3.842670358054867*^9, 3.842678810045169*^9, 
   3.842678965302392*^9, 3.84267900918524*^9, 3.842679096571191*^9, {
   3.842679371702304*^9, 3.842679386346599*^9}, 3.842931585881022*^9, 
   3.84293162086908*^9, {3.842932943209056*^9, 3.842932964219071*^9}, 
   3.843017513290777*^9, 3.8430244608624487`*^9, 3.8431036390635157`*^9, {
   3.843105289569127*^9, 3.843105295323182*^9}, 3.843105327564489*^9, {
   3.843105918661429*^9, 3.843105928715012*^9}, 3.843106009802006*^9, {
   3.8431067023305693`*^9, 3.8431067287831993`*^9}, 3.843106766845043*^9, 
   3.843117504973673*^9, 3.843117558035187*^9, {3.843118724548862*^9, 
   3.8431187331431217`*^9}, 3.843120709874757*^9, 3.843121050603915*^9, {
   3.843122033952897*^9, 3.843122043200193*^9}, 3.843122118535816*^9, {
   3.843123093731669*^9, 3.843123115926646*^9}, 3.843124877360867*^9, 
   3.843125606762615*^9, 3.84312641293804*^9, 3.843126484822681*^9, 
   3.843126519511985*^9, 3.843127220385944*^9, 3.8431273527223263`*^9, {
   3.843127769641077*^9, 3.843127866100389*^9}, {3.8431396968573933`*^9, 
   3.843139722605144*^9}},
 CellLabel->
  "Out[812]=",ExpressionUUID->"d84ad9f6-f41f-4a86-ba38-17b219098208"],

Cell[BoxData[
 GraphicsBox[{
   {Hue[0.6, 0.7, 0.5], Opacity[0.7], Arrowheads[
    Medium], {
     ArrowBox[BezierCurveBox[{{0.8660254037844389, -0.5000000000000012}, {
      1.2288259853054067`, -0.4674954975322388}, {
      1.4856541628098245`, -0.716972635189764}, {
      1.5073515360575258`, -0.9587868998534107}, {
      0.9426834478444563, -1.2847981725860183`}, {
      0.744114838272135, -1.1451005638262928`}, {
      0.6564753881494994, -0.7979422688710457}, {
      0.8660254037844389, -0.5000000000000012}},
      SplineDegree->7], 0.020399597244776385`], InsetBox[
      RowBox[{
       SuperscriptBox["\[FormalZ]", "2"], "+", "1"}], {1.2990381056766591, -1.2500000000000013},
       ImageScaled[{0.5, 0.5}],
      BaseStyle->"Graphics"]}, {
     ArrowBox[{{0.8660254037844389, -0.5000000000000012}, {
      1.8369701987210297`*^-16, 1.}}, 0.020399597244776385`], InsetBox[
      RowBox[{
       SuperscriptBox["\[FormalZ]", "2"], "+", "1"}], {0.4330127018922196, 0.2499999999999994},
       ImageScaled[{0.5, 0.5}],
      BaseStyle->"Graphics"]}, {
     ArrowBox[BezierCurveBox[{{1.8369701987210297`*^-16, 
      1.}, {-0.3628005815209674, 0.9674954975322381}, {-0.6196287590253851, 
      1.2169726351897634`}, {-0.6413261322730861, 
      1.4587868998534101`}, {-0.07665804406001622, 1.7847981725860171`}, {
      0.12191056551230489`, 1.6451005638262917`}, {0.2095500156349402, 
      1.297942268871044}, {1.8369701987210297`*^-16, 1.}},
      SplineDegree->7], 0.020399597244776385`], InsetBox[
      RowBox[{
       SuperscriptBox["\[FormalZ]", "2"], "+", "1"}], {-0.4330127018922189, 1.750000000000001},
       ImageScaled[{0.5, 0.5}],
      BaseStyle->"Graphics"]}}, 
   {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
    DiskBox[{-0.8660254037844384, -0.4999999999999994}, 0.020399597244776385],
     DiskBox[{0.8660254037844389, -0.5000000000000012}, 0.020399597244776385],
     DiskBox[{1.8369701987210297*^-16, 1.}, 0.020399597244776385]}},
  FormatType->TraditionalForm,
  FrameTicks->None,
  ImageSize->Small]], "Output",
 CellChangeTimes->{{3.839994992149252*^9, 3.839995007026175*^9}, 
   3.839995038766769*^9, 3.839995124023505*^9, {3.8400057762395897`*^9, 
   3.840005799784596*^9}, 3.840005875207528*^9, 3.840078628183957*^9, {
   3.8400805385418873`*^9, 3.840080545873246*^9}, 3.840080591591329*^9, 
   3.8402688548086853`*^9, 3.840528032646559*^9, 3.841112940905177*^9, 
   3.841716900317541*^9, {3.841725056166939*^9, 3.841725081203833*^9}, {
   3.8417388434872837`*^9, 3.8417388562912617`*^9}, 3.841738935696185*^9, 
   3.841739491369882*^9, 3.8419750588331137`*^9, 3.841978762034347*^9, {
   3.841980872899082*^9, 3.8419808912941303`*^9}, 3.8420675632335443`*^9, 
   3.8420682808672733`*^9, {3.8420898790541477`*^9, 3.842089904738566*^9}, {
   3.842089971165962*^9, 3.842089987689747*^9}, 3.842239486006727*^9, 
   3.842256346891267*^9, 3.842411363552512*^9, 3.8424915500134087`*^9, 
   3.842493733475758*^9, 3.842494568366165*^9, 3.842497536538418*^9, 
   3.842502057233458*^9, {3.8425045372182198`*^9, 3.842504559237763*^9}, 
   3.842578860819373*^9, 3.842670358054867*^9, 3.842678810045169*^9, 
   3.842678965302392*^9, 3.84267900918524*^9, 3.842679096571191*^9, {
   3.842679371702304*^9, 3.842679386346599*^9}, 3.842931585881022*^9, 
   3.84293162086908*^9, {3.842932943209056*^9, 3.842932964219071*^9}, 
   3.843017513290777*^9, 3.8430244608624487`*^9, 3.8431036390635157`*^9, {
   3.843105289569127*^9, 3.843105295323182*^9}, 3.843105327564489*^9, {
   3.843105918661429*^9, 3.843105928715012*^9}, 3.843106009802006*^9, {
   3.8431067023305693`*^9, 3.8431067287831993`*^9}, 3.843106766845043*^9, 
   3.843117504973673*^9, 3.843117558035187*^9, {3.843118724548862*^9, 
   3.8431187331431217`*^9}, 3.843120709874757*^9, 3.843121050603915*^9, {
   3.843122033952897*^9, 3.843122043200193*^9}, 3.843122118535816*^9, {
   3.843123093731669*^9, 3.843123115926646*^9}, 3.843124877360867*^9, 
   3.843125606762615*^9, 3.84312641293804*^9, 3.843126484822681*^9, 
   3.843126519511985*^9, 3.843127220385944*^9, 3.8431273527223263`*^9, {
   3.843127769641077*^9, 3.843127866100389*^9}, {3.8431396968573933`*^9, 
   3.843139722623004*^9}},
 CellLabel->
  "Out[814]=",ExpressionUUID->"e58305b6-b94c-43f5-a4ef-5168c94f08c6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", "False"}],
      ",", 
     RowBox[{
      RowBox[{"s1", "[", "\[FormalA]", "]"}], "\[Rule]", "False"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", "False"}],
      ",", 
     RowBox[{
      RowBox[{"s1", "[", "\[FormalA]", "]"}], "\[Rule]", "True"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.839994992149252*^9, 3.839995007026175*^9}, 
   3.839995038766769*^9, 3.839995124023505*^9, {3.8400057762395897`*^9, 
   3.840005799784596*^9}, 3.840005875207528*^9, 3.840078628183957*^9, {
   3.8400805385418873`*^9, 3.840080545873246*^9}, 3.840080591591329*^9, 
   3.8402688548086853`*^9, 3.840528032646559*^9, 3.841112940905177*^9, 
   3.841716900317541*^9, {3.841725056166939*^9, 3.841725081203833*^9}, {
   3.8417388434872837`*^9, 3.8417388562912617`*^9}, 3.841738935696185*^9, 
   3.841739491369882*^9, 3.8419750588331137`*^9, 3.841978762034347*^9, {
   3.841980872899082*^9, 3.8419808912941303`*^9}, 3.8420675632335443`*^9, 
   3.8420682808672733`*^9, {3.8420898790541477`*^9, 3.842089904738566*^9}, {
   3.842089971165962*^9, 3.842089987689747*^9}, 3.842239486006727*^9, 
   3.842256346891267*^9, 3.842411363552512*^9, 3.8424915500134087`*^9, 
   3.842493733475758*^9, 3.842494568366165*^9, 3.842497536538418*^9, 
   3.842502057233458*^9, {3.8425045372182198`*^9, 3.842504559237763*^9}, 
   3.842578860819373*^9, 3.842670358054867*^9, 3.842678810045169*^9, 
   3.842678965302392*^9, 3.84267900918524*^9, 3.842679096571191*^9, {
   3.842679371702304*^9, 3.842679386346599*^9}, 3.842931585881022*^9, 
   3.84293162086908*^9, {3.842932943209056*^9, 3.842932964219071*^9}, 
   3.843017513290777*^9, 3.8430244608624487`*^9, 3.8431036390635157`*^9, {
   3.843105289569127*^9, 3.843105295323182*^9}, 3.843105327564489*^9, {
   3.843105918661429*^9, 3.843105928715012*^9}, 3.843106009802006*^9, {
   3.8431067023305693`*^9, 3.8431067287831993`*^9}, 3.843106766845043*^9, 
   3.843117504973673*^9, 3.843117558035187*^9, {3.843118724548862*^9, 
   3.8431187331431217`*^9}, 3.843120709874757*^9, 3.843121050603915*^9, {
   3.843122033952897*^9, 3.843122043200193*^9}, 3.843122118535816*^9, {
   3.843123093731669*^9, 3.843123115926646*^9}, 3.843124877360867*^9, 
   3.843125606762615*^9, 3.84312641293804*^9, 3.843126484822681*^9, 
   3.843126519511985*^9, 3.843127220385944*^9, 3.8431273527223263`*^9, {
   3.843127769641077*^9, 3.843127866100389*^9}, {3.8431396968573933`*^9, 
   3.843139722626498*^9}},
 CellLabel->
  "Out[815]=",ExpressionUUID->"d971bf89-bf8a-4f23-934e-6cb56f9096ed"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{{$CellContext`f[\[FormalA], \[FormalA]] -> 
        False, $CellContext`s1[\[FormalA]] -> 
        False}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
        False, $CellContext`s1[\[FormalA]] -> 
        True}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
        True, $CellContext`s1[\[FormalA]] -> True}}, {{{2, 2}, {3, 3}, {2, 
       3}}, Null}, {
      EdgeLabels -> {
        DirectedEdge[{$CellContext`f[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            True}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> True}] -> 1 + \[FormalZ]^2, 
         DirectedEdge[{$CellContext`f[\[FormalA], \[FormalA]] -> 
            False, $CellContext`s1[\[FormalA]] -> 
            True}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
            True, $CellContext`s1[\[FormalA]] -> True}] -> 1 + \[FormalZ]^2, 
         DirectedEdge[{$CellContext`f[\[FormalA], \[FormalA]] -> 
            True, $CellContext`s1[\[FormalA]] -> 
            True}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
            True, $CellContext`s1[\[FormalA]] -> True}] -> 1 + \[FormalZ]^2}, 
       GraphLayout -> {
        "Dimension" -> 2, "VertexLayout" -> "CircularEmbedding"}, 
       VertexCoordinates -> {{-0.8660254037844384, -0.4999999999999994}, {
        0.8660254037844389, -0.5000000000000012}, {1.8369701987210297`*^-16, 
        1.}}, VertexLabels -> {{$CellContext`f[\[FormalA], \[FormalA]] -> 
           False, $CellContext`s1[\[FormalA]] -> True} -> {
          1 + \[FormalZ]^2, 1}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
           False, $CellContext`s1[\[FormalA]] -> False} -> {
          1, -1}, {$CellContext`f[\[FormalA], \[FormalA]] -> 
           True, $CellContext`s1[\[FormalA]] -> True} -> {
          1 + \[FormalZ]^2, \[FormalZ]}}}]]}, 
    TagBox[GraphicsGroupBox[{
       {Hue[0.6, 0.7, 0.5], Opacity[0.7], Arrowheads[
        Medium], {
         ArrowBox[BezierCurveBox[{{0.8660254037844389, -0.5000000000000012}, {
          1.2288259853054067`, -0.4674954975322388}, {
          1.4856541628098245`, -0.716972635189764}, {
          1.5073515360575258`, -0.9587868998534107}, {
          0.9426834478444563, -1.2847981725860183`}, {
          0.744114838272135, -1.1451005638262928`}, {
          0.6564753881494994, -0.7979422688710457}, {
          0.8660254037844389, -0.5000000000000012}},
          SplineDegree->7], 0.020399597244776385`], InsetBox[
          RowBox[{
           SuperscriptBox["\[FormalZ]", "2"], "+", "1"}], {1.2990381056766591, -1.2500000000000013},
           ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[{{0.8660254037844389, -0.5000000000000012}, {
          1.8369701987210297`*^-16, 1.}}, 0.020399597244776385`], InsetBox[
          RowBox[{
           SuperscriptBox["\[FormalZ]", "2"], "+", "1"}], {0.4330127018922196, 0.2499999999999994},
           ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}, {
         ArrowBox[BezierCurveBox[{{1.8369701987210297`*^-16, 
          1.}, {-0.3628005815209674, 
          0.9674954975322381}, {-0.6196287590253851, 
          1.2169726351897634`}, {-0.6413261322730861, 
          1.4587868998534101`}, {-0.07665804406001622, 1.7847981725860171`}, {
          0.12191056551230489`, 1.6451005638262917`}, {0.2095500156349402, 
          1.297942268871044}, {1.8369701987210297`*^-16, 1.}},
          SplineDegree->7], 0.020399597244776385`], InsetBox[
          RowBox[{
           SuperscriptBox["\[FormalZ]", "2"], "+", "1"}], {-0.4330127018922189, 1.750000000000001},
           ImageScaled[{0.5, 0.5}],
          BaseStyle->"Graphics"]}}, 
       {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
        DiskBox[{-0.8660254037844384, -0.4999999999999994}, 
         0.020399597244776385], 
        DiskBox[{0.8660254037844389, -0.5000000000000012}, 
         0.020399597244776385], 
        DiskBox[{1.8369701987210297*^-16, 1.}, 0.020399597244776385]}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameTicks->None,
  ImageSize->Small]], "Output",
 CellChangeTimes->{{3.839994992149252*^9, 3.839995007026175*^9}, 
   3.839995038766769*^9, 3.839995124023505*^9, {3.8400057762395897`*^9, 
   3.840005799784596*^9}, 3.840005875207528*^9, 3.840078628183957*^9, {
   3.8400805385418873`*^9, 3.840080545873246*^9}, 3.840080591591329*^9, 
   3.8402688548086853`*^9, 3.840528032646559*^9, 3.841112940905177*^9, 
   3.841716900317541*^9, {3.841725056166939*^9, 3.841725081203833*^9}, {
   3.8417388434872837`*^9, 3.8417388562912617`*^9}, 3.841738935696185*^9, 
   3.841739491369882*^9, 3.8419750588331137`*^9, 3.841978762034347*^9, {
   3.841980872899082*^9, 3.8419808912941303`*^9}, 3.8420675632335443`*^9, 
   3.8420682808672733`*^9, {3.8420898790541477`*^9, 3.842089904738566*^9}, {
   3.842089971165962*^9, 3.842089987689747*^9}, 3.842239486006727*^9, 
   3.842256346891267*^9, 3.842411363552512*^9, 3.8424915500134087`*^9, 
   3.842493733475758*^9, 3.842494568366165*^9, 3.842497536538418*^9, 
   3.842502057233458*^9, {3.8425045372182198`*^9, 3.842504559237763*^9}, 
   3.842578860819373*^9, 3.842670358054867*^9, 3.842678810045169*^9, 
   3.842678965302392*^9, 3.84267900918524*^9, 3.842679096571191*^9, {
   3.842679371702304*^9, 3.842679386346599*^9}, 3.842931585881022*^9, 
   3.84293162086908*^9, {3.842932943209056*^9, 3.842932964219071*^9}, 
   3.843017513290777*^9, 3.8430244608624487`*^9, 3.8431036390635157`*^9, {
   3.843105289569127*^9, 3.843105295323182*^9}, 3.843105327564489*^9, {
   3.843105918661429*^9, 3.843105928715012*^9}, 3.843106009802006*^9, {
   3.8431067023305693`*^9, 3.8431067287831993`*^9}, 3.843106766845043*^9, 
   3.843117504973673*^9, 3.843117558035187*^9, {3.843118724548862*^9, 
   3.8431187331431217`*^9}, 3.843120709874757*^9, 3.843121050603915*^9, {
   3.843122033952897*^9, 3.843122043200193*^9}, 3.843122118535816*^9, {
   3.843123093731669*^9, 3.843123115926646*^9}, 3.843124877360867*^9, 
   3.843125606762615*^9, 3.84312641293804*^9, 3.843126484822681*^9, 
   3.843126519511985*^9, 3.843127220385944*^9, 3.8431273527223263`*^9, {
   3.843127769641077*^9, 3.843127866100389*^9}, {3.8431396968573933`*^9, 
   3.843139722645699*^9}},
 CellLabel->
  "Out[816]=",ExpressionUUID->"e0bc7684-e1d6-4121-bdea-8b22b8e9f8d5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "1", "}"}], ",", 
   RowBox[{"{", "2", "}"}], ",", 
   RowBox[{"{", "3", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.839994992149252*^9, 3.839995007026175*^9}, 
   3.839995038766769*^9, 3.839995124023505*^9, {3.8400057762395897`*^9, 
   3.840005799784596*^9}, 3.840005875207528*^9, 3.840078628183957*^9, {
   3.8400805385418873`*^9, 3.840080545873246*^9}, 3.840080591591329*^9, 
   3.8402688548086853`*^9, 3.840528032646559*^9, 3.841112940905177*^9, 
   3.841716900317541*^9, {3.841725056166939*^9, 3.841725081203833*^9}, {
   3.8417388434872837`*^9, 3.8417388562912617`*^9}, 3.841738935696185*^9, 
   3.841739491369882*^9, 3.8419750588331137`*^9, 3.841978762034347*^9, {
   3.841980872899082*^9, 3.8419808912941303`*^9}, 3.8420675632335443`*^9, 
   3.8420682808672733`*^9, {3.8420898790541477`*^9, 3.842089904738566*^9}, {
   3.842089971165962*^9, 3.842089987689747*^9}, 3.842239486006727*^9, 
   3.842256346891267*^9, 3.842411363552512*^9, 3.8424915500134087`*^9, 
   3.842493733475758*^9, 3.842494568366165*^9, 3.842497536538418*^9, 
   3.842502057233458*^9, {3.8425045372182198`*^9, 3.842504559237763*^9}, 
   3.842578860819373*^9, 3.842670358054867*^9, 3.842678810045169*^9, 
   3.842678965302392*^9, 3.84267900918524*^9, 3.842679096571191*^9, {
   3.842679371702304*^9, 3.842679386346599*^9}, 3.842931585881022*^9, 
   3.84293162086908*^9, {3.842932943209056*^9, 3.842932964219071*^9}, 
   3.843017513290777*^9, 3.8430244608624487`*^9, 3.8431036390635157`*^9, {
   3.843105289569127*^9, 3.843105295323182*^9}, 3.843105327564489*^9, {
   3.843105918661429*^9, 3.843105928715012*^9}, 3.843106009802006*^9, {
   3.8431067023305693`*^9, 3.8431067287831993`*^9}, 3.843106766845043*^9, 
   3.843117504973673*^9, 3.843117558035187*^9, {3.843118724548862*^9, 
   3.8431187331431217`*^9}, 3.843120709874757*^9, 3.843121050603915*^9, {
   3.843122033952897*^9, 3.843122043200193*^9}, 3.843122118535816*^9, {
   3.843123093731669*^9, 3.843123115926646*^9}, 3.843124877360867*^9, 
   3.843125606762615*^9, 3.84312641293804*^9, 3.843126484822681*^9, 
   3.843126519511985*^9, 3.843127220385944*^9, 3.8431273527223263`*^9, {
   3.843127769641077*^9, 3.843127866100389*^9}, {3.8431396968573933`*^9, 
   3.843139722650078*^9}},
 CellLabel->
  "Out[817]=",ExpressionUUID->"85ee27c6-80bd-44b9-9760-a861b9ef657a"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"PolyToEGF", "[", 
   RowBox[{"poly_", ",", "var_"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"coefs", "=", 
      RowBox[{"CoefficientList", "[", 
       RowBox[{"poly", ",", "var"}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Sum", "[", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"coefs", "[", 
         RowBox[{"[", 
          RowBox[{"i", "+", "1"}], "]"}], "]"}], " ", "*", 
        RowBox[{"var", "^", "i"}]}], 
       RowBox[{"i", "!"}]], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", 
        RowBox[{
         RowBox[{"Length", "[", "coefs", "]"}], "-", "1"}]}], "}"}]}], 
     "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.84199707042507*^9, 3.841997075352816*^9}},
 CellLabel->
  "In[335]:=",ExpressionUUID->"5fe55467-7b28-4389-a85d-cb7549b1264d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Implementation", " ", "of", " ", "WFOMC", " ", "according", " ", "to", 
     " ", "formula", " ", 
     RowBox[{"(", "1", ")"}], " ", "in", " ", "Faster", " ", "Lifting", " ", 
     "for", " ", "Two"}], "-", 
    RowBox[{
    "Variable", " ", "Logic", " ", "using", " ", "Cell", " ", "Graphs"}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"OrderedPartitions", "[", 
     RowBox[{"n_Integer", ",", "m_Integer"}], "]"}], ":=", " ", 
    RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Permutations", "[", 
         RowBox[{"PadRight", "[", 
          RowBox[{"#", ",", "m"}], "]"}], "]"}], "&"}], "\[IndentingNewLine]",
        "/@", 
       RowBox[{"IntegerPartitions", "[", 
        RowBox[{"n", ",", "m"}], "]"}]}], ",", "\[IndentingNewLine]", "1"}], 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Pow", "[", 
     RowBox[{"0", ",", "0"}], "]"}], ":=", "1"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Pow", "[", 
     RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
    RowBox[{"a", "^", "b"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"WFOMC1", "[", 
     RowBox[{"n_Integer", ",", "property_"}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"s", "=", 
         RowBox[{"STerms", "[", "property", "]"}]}], ",", 
        RowBox[{"w", "=", 
         RowBox[{"WTerms", "[", "property", "]"}]}], ",", 
        RowBox[{"r", "=", 
         RowBox[{"RTerms", "[", "property", "]"}]}], ",", 
        "\[IndentingNewLine]", "u", ",", "i", ",", "j"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"u", "=", 
        RowBox[{"Length", "[", "s", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Total", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"partition", " ", "|->", " ", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Multinomial", "[", 
             RowBox[{"Sequence", "@@", "partition"}], "]"}], " ", "*", 
            "\[IndentingNewLine]", 
            RowBox[{"Product", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"r", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "~", 
               "Pow", "~", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                 "partition", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}], "*", 
                 RowBox[{
                 "partition", "\[LeftDoubleBracket]", "j", 
                  "\[RightDoubleBracket]"}]}], ")"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "u"}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", " ", ",", " ", 
                RowBox[{"i", "-", "1"}]}], "}"}]}], "]"}], "*", 
            "\[IndentingNewLine]", 
            RowBox[{"Product", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                "s", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
                "~", "Pow", "~", 
                RowBox[{"Binomial", "[", 
                 RowBox[{
                  RowBox[{
                  "partition", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}], ",", "2"}], "]"}]}], " ", "*", 
               "\[IndentingNewLine]", " ", 
               RowBox[{
                RowBox[{
                "w", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
                "~", "Pow", "~", 
                RowBox[{
                "partition", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}]}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "u"}], "}"}]}], "]"}]}]}], 
          "\[IndentingNewLine]", ")"}], " ", "/@", " ", 
         RowBox[{"OrderedPartitions", "[", 
          RowBox[{"n", ",", " ", "u"}], "]"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQ7XuLjef49DeOD/QfCIDoFY+vaoJoibNTjEH0pic3
XE8C6YAqYU8Q7XzyyhMQbfn3L5hOO5k8/xSQVlwfvwBE37nqsRREz/deuRJE
79e8vRZEq7eLbQDRH0zFtoJopxvJd0B0mnPLo9dAuk/f6QmIzot7+BJES1tn
vwfRegvnsLwB0j5PT3OAaJ2IS7Ig2rOJQw5E72HaqwSi9SKZVUH0nb0770nN
fOO47WrXAxCt5NfK5wikl7+aCqZ/p+85swtIFwifB9MmKpNnms4BmrN6xhwQ
XbFycVw8kF7Z5hUPomv3P+PrnP/G8QnDQkEQXbdSjrsLSGuq6AmCaADLZrKA

  "],
 CellLabel->
  "In[336]:=",ExpressionUUID->"de9d90ff-36d4-4acd-a124-54bc81661d37"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"maxN", "=", "6"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wfomc", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"WFOMC1", "[", 
      RowBox[{"n", ",", "example3Regularity"}], "]"}], ",", 
     "\[IndentingNewLine]", " ", 
     RowBox[{"{", 
      RowBox[{"n", ",", " ", "0", ",", " ", "maxN"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", "wfomc", "]"}], "\[IndentingNewLine]", 
 RowBox[{"wfomcCc", " ", "=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Coefficient", "[", 
     RowBox[{
      RowBox[{"wfomc", "[", 
       RowBox[{"[", 
        RowBox[{"n", "+", "1"}], "]"}], "]"}], ",", "\[FormalZ]", ",", 
      RowBox[{"3", "n"}]}], "]"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"n", ",", "0", ",", "maxN"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"%", "/", " ", 
  RowBox[{"(", 
   RowBox[{"6", "^", 
    RowBox[{"Range", "[", 
     RowBox[{"0", ",", "maxN"}], "]"}]}], 
   ")"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.837671569973804*^9, 3.8376715949630013`*^9}, {
   3.837671627206588*^9, 3.837671631546236*^9}, {3.837678818766939*^9, 
   3.837678831829865*^9}, {3.837678937946063*^9, 3.8376789529351254`*^9}, {
   3.837679364693651*^9, 3.837679417960854*^9}, {3.838111781844524*^9, 
   3.838111784124291*^9}, {3.8381118428259373`*^9, 3.838111910430691*^9}, {
   3.838698894148209*^9, 3.838698906137195*^9}, {3.838699871003758*^9, 
   3.8386998807575274`*^9}, {3.8387000986729717`*^9, 3.838700114533228*^9}, {
   3.838884395033263*^9, 3.838884442692211*^9}, 3.838885201886492*^9, {
   3.839925781031042*^9, 3.83992578198174*^9}, {3.839990422206552*^9, 
   3.839990711507616*^9}, {3.8399950578864613`*^9, 3.839995058842905*^9}, {
   3.84173890023422*^9, 3.841738906317997*^9}, 3.841738955804636*^9, {
   3.8424114733924713`*^9, 3.8424114754811907`*^9}, {3.842498320074768*^9, 
   3.842498323514279*^9}, {3.842498407005143*^9, 3.842498432216782*^9}, {
   3.842504902397052*^9, 3.842504907235993*^9}, {3.84251199905208*^9, 
   3.842512000157771*^9}, {3.842684664202684*^9, 3.842684665596312*^9}, 
   3.842685090396718*^9, 3.842685151201456*^9, {3.8426868026457157`*^9, 
   3.842686807361463*^9}, 3.84268802199098*^9, {3.842949796663443*^9, 
   3.842949843564514*^9}, {3.842949938090705*^9, 3.842949938616262*^9}, 
   3.843119985715637*^9, 3.8431200389916277`*^9, 3.84312010649266*^9, {
   3.8431201406241283`*^9, 3.843120141838829*^9}, 3.843120889811881*^9},
 CellLabel->
  "In[552]:=",ExpressionUUID->"3967da30-0426-4e51-8fed-f7c482dc836e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", 
   RowBox[{"1296", " ", 
    SuperscriptBox["\[FormalZ]", "12"]}], ",", 
   RowBox[{"139968", " ", 
    SuperscriptBox["\[FormalZ]", "16"], " ", 
    RowBox[{"(", 
     RowBox[{"5", "+", 
      RowBox[{"120", " ", 
       SuperscriptBox["\[FormalZ]", "2"]}], "+", 
      RowBox[{"432", " ", 
       SuperscriptBox["\[FormalZ]", "4"]}]}], ")"}]}], ",", 
   RowBox[{"233280", " ", 
    SuperscriptBox["\[FormalZ]", "18"], " ", 
    RowBox[{"(", 
     RowBox[{"14", "+", 
      RowBox[{"3708", " ", 
       SuperscriptBox["\[FormalZ]", "2"]}], "+", 
      RowBox[{"151209", " ", 
       SuperscriptBox["\[FormalZ]", "4"]}], "+", 
      RowBox[{"2178868", " ", 
       SuperscriptBox["\[FormalZ]", "6"]}], "+", 
      RowBox[{"14040000", " ", 
       SuperscriptBox["\[FormalZ]", "8"]}], "+", 
      RowBox[{"42187500", " ", 
       SuperscriptBox["\[FormalZ]", "10"]}], "+", 
      RowBox[{"48828125", " ", 
       SuperscriptBox["\[FormalZ]", "12"]}]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.837671573612368*^9, 3.837671595498357*^9}, 
   3.837671631855782*^9, {3.837678823257477*^9, 3.837678832158881*^9}, {
   3.837678939241272*^9, 3.83767895328126*^9}, {3.8376793938334217`*^9, 
   3.837679420199458*^9}, 3.837745785659285*^9, 3.837746983196039*^9, {
   3.837747250296301*^9, 3.8377472724534893`*^9}, 3.837747464566654*^9, 
   3.838090773490415*^9, 3.838092410185232*^9, 3.838093499868433*^9, {
   3.838093576075965*^9, 3.8380935923208027`*^9}, 3.838094131970779*^9, {
   3.838099053156966*^9, 3.8380990650603533`*^9}, 3.838102379617313*^9, 
   3.838103145302347*^9, 3.838108071159771*^9, {3.838111744725732*^9, 
   3.838111784742243*^9}, {3.838111906302454*^9, 3.838111911175551*^9}, 
   3.83812255757415*^9, 3.838122610587903*^9, 3.8381234411805*^9, 
   3.838183710998446*^9, 3.838184258966941*^9, {3.838184374123165*^9, 
   3.838184488370401*^9}, 3.838184583949355*^9, {3.83818870993018*^9, 
   3.838188730323399*^9}, 3.838189245691696*^9, 3.8381892837754993`*^9, 
   3.838191834650038*^9, 3.838191865897613*^9, {3.838191930535947*^9, 
   3.8381919512149963`*^9}, 3.838191989338784*^9, 3.838193627078986*^9, 
   3.838193666058004*^9, 3.8381969996710587`*^9, 3.838197036964589*^9, 
   3.83819708790653*^9, 3.838197474412085*^9, {3.838197518412426*^9, 
   3.838197537022626*^9}, 3.838354173953002*^9, 3.8383544325390043`*^9, {
   3.838354559879693*^9, 3.8383545844135427`*^9}, 3.838437454340425*^9, 
   3.8386949610540257`*^9, {3.838698889811092*^9, 3.838698906779139*^9}, {
   3.838699821471425*^9, 3.83869988477948*^9}, {3.838700087249617*^9, 
   3.838700115149205*^9}, 3.838883982557371*^9, {3.838884425674006*^9, 
   3.838884466446857*^9}, {3.838884509684677*^9, 3.838884519082439*^9}, {
   3.838884679375298*^9, 3.838884722427343*^9}, 3.8388852023435917`*^9, 
   3.8388865547976103`*^9, 3.838886585295733*^9, 3.8389565196962357`*^9, 
   3.838957068295257*^9, 3.838957113777787*^9, 3.839300318239327*^9, 
   3.839907181322254*^9, 3.839922473547883*^9, 3.839925437534092*^9, 
   3.839925619759066*^9, {3.839925769851269*^9, 3.839925782866544*^9}, 
   3.839926017961771*^9, 3.839926863715646*^9, 3.8399279849063396`*^9, 
   3.8399881568252697`*^9, 3.8399899837842407`*^9, 3.8399901625326967`*^9, 
   3.839990393910696*^9, {3.8399904384614763`*^9, 3.839990500460194*^9}, {
   3.839990577014641*^9, 3.8399906022248363`*^9}, {3.839990651629342*^9, 
   3.839990714802765*^9}, 3.8399907905538397`*^9, 3.8399913500436907`*^9, 
   3.8399914200377483`*^9, {3.8399917374893837`*^9, 3.839991773360799*^9}, 
   3.839991844492547*^9, {3.839995053980176*^9, 3.8399950602845707`*^9}, {
   3.839995114539592*^9, 3.839995124070311*^9}, {3.840005776393983*^9, 
   3.840005799898006*^9}, 3.840005875259334*^9, 3.8400786282227383`*^9, {
   3.840080538610586*^9, 3.840080545918857*^9}, 3.8400806065379343`*^9, 
   3.840080637277802*^9, 3.840268854842648*^9, 3.840528032691893*^9, 
   3.841112940951008*^9, 3.841716900365094*^9, {3.841725056293642*^9, 
   3.841725081266758*^9}, 3.841738843627206*^9, {3.8417389072677717`*^9, 
   3.841738956173457*^9}, {3.841739486663186*^9, 3.8417394914218817`*^9}, 
   3.841740850381817*^9, 3.8417409250508738`*^9, 3.841975058878697*^9, 
   3.8419787620753*^9, 3.842067564924415*^9, 3.842068280900497*^9, 
   3.842239486063857*^9, 3.842256346928388*^9, 3.842411363614459*^9, 
   3.8424114759352427`*^9, 3.84249155006269*^9, 3.842493733557475*^9, 
   3.84249456840998*^9, 3.842497536592144*^9, 3.842498323846835*^9, {
   3.842498409710412*^9, 3.842498432707316*^9}, 3.8424988429300833`*^9, 
   3.842502057313094*^9, {3.8425045373043737`*^9, 3.842504559302311*^9}, {
   3.842504902915909*^9, 3.842504907779996*^9}, 3.8425120005139103`*^9, 
   3.8425788609320107`*^9, 3.8426703581415873`*^9, 3.842677638722488*^9, 
   3.842678810110403*^9, 3.842678965419258*^9, {3.842679009250581*^9, 
   3.842679021747843*^9}, {3.842679096636393*^9, 3.8426791225331373`*^9}, {
   3.842679371773077*^9, 3.842679386412108*^9}, 3.842684665936859*^9, {
   3.842685151916936*^9, 3.842685170554677*^9}, 3.842685235917677*^9, {
   3.842686782804693*^9, 3.842686808115036*^9}, 3.842688023223915*^9, 
   3.842688130135625*^9, 3.842688210947959*^9, 3.842931586019629*^9, 
   3.842931620951811*^9, {3.842932939020261*^9, 3.8429329642854156`*^9}, 
   3.842949745216279*^9, 3.842949812910612*^9, 3.8429498439561043`*^9, 
   3.8429499391391363`*^9, 3.84301751340419*^9, 3.843103639163394*^9, 
   3.843105295455724*^9, 3.843105327644846*^9, 3.843119987009317*^9, {
   3.843120022155202*^9, 3.843120040567951*^9}, 3.8431201074518538`*^9, {
   3.843120868577064*^9, 3.843120891384077*^9}, 3.8431220117032547`*^9},
 CellLabel->
  "Out[554]=",ExpressionUUID->"2c245540-b680-4840-bdf9-2d46bc2e8f90"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1", ",", "0", ",", "0", ",", "0", ",", "1296", ",", "0", ",", "3265920"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.837671573612368*^9, 3.837671595498357*^9}, 
   3.837671631855782*^9, {3.837678823257477*^9, 3.837678832158881*^9}, {
   3.837678939241272*^9, 3.83767895328126*^9}, {3.8376793938334217`*^9, 
   3.837679420199458*^9}, 3.837745785659285*^9, 3.837746983196039*^9, {
   3.837747250296301*^9, 3.8377472724534893`*^9}, 3.837747464566654*^9, 
   3.838090773490415*^9, 3.838092410185232*^9, 3.838093499868433*^9, {
   3.838093576075965*^9, 3.8380935923208027`*^9}, 3.838094131970779*^9, {
   3.838099053156966*^9, 3.8380990650603533`*^9}, 3.838102379617313*^9, 
   3.838103145302347*^9, 3.838108071159771*^9, {3.838111744725732*^9, 
   3.838111784742243*^9}, {3.838111906302454*^9, 3.838111911175551*^9}, 
   3.83812255757415*^9, 3.838122610587903*^9, 3.8381234411805*^9, 
   3.838183710998446*^9, 3.838184258966941*^9, {3.838184374123165*^9, 
   3.838184488370401*^9}, 3.838184583949355*^9, {3.83818870993018*^9, 
   3.838188730323399*^9}, 3.838189245691696*^9, 3.8381892837754993`*^9, 
   3.838191834650038*^9, 3.838191865897613*^9, {3.838191930535947*^9, 
   3.8381919512149963`*^9}, 3.838191989338784*^9, 3.838193627078986*^9, 
   3.838193666058004*^9, 3.8381969996710587`*^9, 3.838197036964589*^9, 
   3.83819708790653*^9, 3.838197474412085*^9, {3.838197518412426*^9, 
   3.838197537022626*^9}, 3.838354173953002*^9, 3.8383544325390043`*^9, {
   3.838354559879693*^9, 3.8383545844135427`*^9}, 3.838437454340425*^9, 
   3.8386949610540257`*^9, {3.838698889811092*^9, 3.838698906779139*^9}, {
   3.838699821471425*^9, 3.83869988477948*^9}, {3.838700087249617*^9, 
   3.838700115149205*^9}, 3.838883982557371*^9, {3.838884425674006*^9, 
   3.838884466446857*^9}, {3.838884509684677*^9, 3.838884519082439*^9}, {
   3.838884679375298*^9, 3.838884722427343*^9}, 3.8388852023435917`*^9, 
   3.8388865547976103`*^9, 3.838886585295733*^9, 3.8389565196962357`*^9, 
   3.838957068295257*^9, 3.838957113777787*^9, 3.839300318239327*^9, 
   3.839907181322254*^9, 3.839922473547883*^9, 3.839925437534092*^9, 
   3.839925619759066*^9, {3.839925769851269*^9, 3.839925782866544*^9}, 
   3.839926017961771*^9, 3.839926863715646*^9, 3.8399279849063396`*^9, 
   3.8399881568252697`*^9, 3.8399899837842407`*^9, 3.8399901625326967`*^9, 
   3.839990393910696*^9, {3.8399904384614763`*^9, 3.839990500460194*^9}, {
   3.839990577014641*^9, 3.8399906022248363`*^9}, {3.839990651629342*^9, 
   3.839990714802765*^9}, 3.8399907905538397`*^9, 3.8399913500436907`*^9, 
   3.8399914200377483`*^9, {3.8399917374893837`*^9, 3.839991773360799*^9}, 
   3.839991844492547*^9, {3.839995053980176*^9, 3.8399950602845707`*^9}, {
   3.839995114539592*^9, 3.839995124070311*^9}, {3.840005776393983*^9, 
   3.840005799898006*^9}, 3.840005875259334*^9, 3.8400786282227383`*^9, {
   3.840080538610586*^9, 3.840080545918857*^9}, 3.8400806065379343`*^9, 
   3.840080637277802*^9, 3.840268854842648*^9, 3.840528032691893*^9, 
   3.841112940951008*^9, 3.841716900365094*^9, {3.841725056293642*^9, 
   3.841725081266758*^9}, 3.841738843627206*^9, {3.8417389072677717`*^9, 
   3.841738956173457*^9}, {3.841739486663186*^9, 3.8417394914218817`*^9}, 
   3.841740850381817*^9, 3.8417409250508738`*^9, 3.841975058878697*^9, 
   3.8419787620753*^9, 3.842067564924415*^9, 3.842068280900497*^9, 
   3.842239486063857*^9, 3.842256346928388*^9, 3.842411363614459*^9, 
   3.8424114759352427`*^9, 3.84249155006269*^9, 3.842493733557475*^9, 
   3.84249456840998*^9, 3.842497536592144*^9, 3.842498323846835*^9, {
   3.842498409710412*^9, 3.842498432707316*^9}, 3.8424988429300833`*^9, 
   3.842502057313094*^9, {3.8425045373043737`*^9, 3.842504559302311*^9}, {
   3.842504902915909*^9, 3.842504907779996*^9}, 3.8425120005139103`*^9, 
   3.8425788609320107`*^9, 3.8426703581415873`*^9, 3.842677638722488*^9, 
   3.842678810110403*^9, 3.842678965419258*^9, {3.842679009250581*^9, 
   3.842679021747843*^9}, {3.842679096636393*^9, 3.8426791225331373`*^9}, {
   3.842679371773077*^9, 3.842679386412108*^9}, 3.842684665936859*^9, {
   3.842685151916936*^9, 3.842685170554677*^9}, 3.842685235917677*^9, {
   3.842686782804693*^9, 3.842686808115036*^9}, 3.842688023223915*^9, 
   3.842688130135625*^9, 3.842688210947959*^9, 3.842931586019629*^9, 
   3.842931620951811*^9, {3.842932939020261*^9, 3.8429329642854156`*^9}, 
   3.842949745216279*^9, 3.842949812910612*^9, 3.8429498439561043`*^9, 
   3.8429499391391363`*^9, 3.84301751340419*^9, 3.843103639163394*^9, 
   3.843105295455724*^9, 3.843105327644846*^9, 3.843119987009317*^9, {
   3.843120022155202*^9, 3.843120040567951*^9}, 3.8431201074518538`*^9, {
   3.843120868577064*^9, 3.843120891384077*^9}, 3.843122011717923*^9},
 CellLabel->
  "Out[555]=",ExpressionUUID->"006feb05-3ce1-4e4e-bf9e-35ddde677dd1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "70"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.837671573612368*^9, 3.837671595498357*^9}, 
   3.837671631855782*^9, {3.837678823257477*^9, 3.837678832158881*^9}, {
   3.837678939241272*^9, 3.83767895328126*^9}, {3.8376793938334217`*^9, 
   3.837679420199458*^9}, 3.837745785659285*^9, 3.837746983196039*^9, {
   3.837747250296301*^9, 3.8377472724534893`*^9}, 3.837747464566654*^9, 
   3.838090773490415*^9, 3.838092410185232*^9, 3.838093499868433*^9, {
   3.838093576075965*^9, 3.8380935923208027`*^9}, 3.838094131970779*^9, {
   3.838099053156966*^9, 3.8380990650603533`*^9}, 3.838102379617313*^9, 
   3.838103145302347*^9, 3.838108071159771*^9, {3.838111744725732*^9, 
   3.838111784742243*^9}, {3.838111906302454*^9, 3.838111911175551*^9}, 
   3.83812255757415*^9, 3.838122610587903*^9, 3.8381234411805*^9, 
   3.838183710998446*^9, 3.838184258966941*^9, {3.838184374123165*^9, 
   3.838184488370401*^9}, 3.838184583949355*^9, {3.83818870993018*^9, 
   3.838188730323399*^9}, 3.838189245691696*^9, 3.8381892837754993`*^9, 
   3.838191834650038*^9, 3.838191865897613*^9, {3.838191930535947*^9, 
   3.8381919512149963`*^9}, 3.838191989338784*^9, 3.838193627078986*^9, 
   3.838193666058004*^9, 3.8381969996710587`*^9, 3.838197036964589*^9, 
   3.83819708790653*^9, 3.838197474412085*^9, {3.838197518412426*^9, 
   3.838197537022626*^9}, 3.838354173953002*^9, 3.8383544325390043`*^9, {
   3.838354559879693*^9, 3.8383545844135427`*^9}, 3.838437454340425*^9, 
   3.8386949610540257`*^9, {3.838698889811092*^9, 3.838698906779139*^9}, {
   3.838699821471425*^9, 3.83869988477948*^9}, {3.838700087249617*^9, 
   3.838700115149205*^9}, 3.838883982557371*^9, {3.838884425674006*^9, 
   3.838884466446857*^9}, {3.838884509684677*^9, 3.838884519082439*^9}, {
   3.838884679375298*^9, 3.838884722427343*^9}, 3.8388852023435917`*^9, 
   3.8388865547976103`*^9, 3.838886585295733*^9, 3.8389565196962357`*^9, 
   3.838957068295257*^9, 3.838957113777787*^9, 3.839300318239327*^9, 
   3.839907181322254*^9, 3.839922473547883*^9, 3.839925437534092*^9, 
   3.839925619759066*^9, {3.839925769851269*^9, 3.839925782866544*^9}, 
   3.839926017961771*^9, 3.839926863715646*^9, 3.8399279849063396`*^9, 
   3.8399881568252697`*^9, 3.8399899837842407`*^9, 3.8399901625326967`*^9, 
   3.839990393910696*^9, {3.8399904384614763`*^9, 3.839990500460194*^9}, {
   3.839990577014641*^9, 3.8399906022248363`*^9}, {3.839990651629342*^9, 
   3.839990714802765*^9}, 3.8399907905538397`*^9, 3.8399913500436907`*^9, 
   3.8399914200377483`*^9, {3.8399917374893837`*^9, 3.839991773360799*^9}, 
   3.839991844492547*^9, {3.839995053980176*^9, 3.8399950602845707`*^9}, {
   3.839995114539592*^9, 3.839995124070311*^9}, {3.840005776393983*^9, 
   3.840005799898006*^9}, 3.840005875259334*^9, 3.8400786282227383`*^9, {
   3.840080538610586*^9, 3.840080545918857*^9}, 3.8400806065379343`*^9, 
   3.840080637277802*^9, 3.840268854842648*^9, 3.840528032691893*^9, 
   3.841112940951008*^9, 3.841716900365094*^9, {3.841725056293642*^9, 
   3.841725081266758*^9}, 3.841738843627206*^9, {3.8417389072677717`*^9, 
   3.841738956173457*^9}, {3.841739486663186*^9, 3.8417394914218817`*^9}, 
   3.841740850381817*^9, 3.8417409250508738`*^9, 3.841975058878697*^9, 
   3.8419787620753*^9, 3.842067564924415*^9, 3.842068280900497*^9, 
   3.842239486063857*^9, 3.842256346928388*^9, 3.842411363614459*^9, 
   3.8424114759352427`*^9, 3.84249155006269*^9, 3.842493733557475*^9, 
   3.84249456840998*^9, 3.842497536592144*^9, 3.842498323846835*^9, {
   3.842498409710412*^9, 3.842498432707316*^9}, 3.8424988429300833`*^9, 
   3.842502057313094*^9, {3.8425045373043737`*^9, 3.842504559302311*^9}, {
   3.842504902915909*^9, 3.842504907779996*^9}, 3.8425120005139103`*^9, 
   3.8425788609320107`*^9, 3.8426703581415873`*^9, 3.842677638722488*^9, 
   3.842678810110403*^9, 3.842678965419258*^9, {3.842679009250581*^9, 
   3.842679021747843*^9}, {3.842679096636393*^9, 3.8426791225331373`*^9}, {
   3.842679371773077*^9, 3.842679386412108*^9}, 3.842684665936859*^9, {
   3.842685151916936*^9, 3.842685170554677*^9}, 3.842685235917677*^9, {
   3.842686782804693*^9, 3.842686808115036*^9}, 3.842688023223915*^9, 
   3.842688130135625*^9, 3.842688210947959*^9, 3.842931586019629*^9, 
   3.842931620951811*^9, {3.842932939020261*^9, 3.8429329642854156`*^9}, 
   3.842949745216279*^9, 3.842949812910612*^9, 3.8429498439561043`*^9, 
   3.8429499391391363`*^9, 3.84301751340419*^9, 3.843103639163394*^9, 
   3.843105295455724*^9, 3.843105327644846*^9, 3.843119987009317*^9, {
   3.843120022155202*^9, 3.843120040567951*^9}, 3.8431201074518538`*^9, {
   3.843120868577064*^9, 3.843120891384077*^9}, 3.8431220117205677`*^9},
 CellLabel->
  "Out[556]=",ExpressionUUID->"834fca88-73b4-4b17-a9ac-62e4044b5f90"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Range", "[", 
  RowBox[{"0", ",", "5"}], "]"}]], "Input",
 CellChangeTimes->{{3.8429498323722887`*^9, 3.8429498392365923`*^9}},
 CellLabel->
  "In[345]:=",ExpressionUUID->"683368db-8a73-4cfb-935a-6b3f32f4c0b6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "1", ",", "2", ",", "3", ",", "4", ",", "5"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.837671573612368*^9, 3.837671595498357*^9}, 
   3.837671631855782*^9, {3.837678823257477*^9, 3.837678832158881*^9}, {
   3.837678939241272*^9, 3.83767895328126*^9}, {3.8376793938334217`*^9, 
   3.837679420199458*^9}, 3.837745785659285*^9, 3.837746983196039*^9, {
   3.837747250296301*^9, 3.8377472724534893`*^9}, 3.837747464566654*^9, 
   3.838090773490415*^9, 3.838092410185232*^9, 3.838093499868433*^9, {
   3.838093576075965*^9, 3.8380935923208027`*^9}, 3.838094131970779*^9, {
   3.838099053156966*^9, 3.8380990650603533`*^9}, 3.838102379617313*^9, 
   3.838103145302347*^9, 3.838108071159771*^9, {3.838111744725732*^9, 
   3.838111784742243*^9}, {3.838111906302454*^9, 3.838111911175551*^9}, 
   3.83812255757415*^9, 3.838122610587903*^9, 3.8381234411805*^9, 
   3.838183710998446*^9, 3.838184258966941*^9, {3.838184374123165*^9, 
   3.838184488370401*^9}, 3.838184583949355*^9, {3.83818870993018*^9, 
   3.838188730323399*^9}, 3.838189245691696*^9, 3.8381892837754993`*^9, 
   3.838191834650038*^9, 3.838191865897613*^9, {3.838191930535947*^9, 
   3.8381919512149963`*^9}, 3.838191989338784*^9, 3.838193627078986*^9, 
   3.838193666058004*^9, 3.8381969996710587`*^9, 3.838197036964589*^9, 
   3.83819708790653*^9, 3.838197474412085*^9, {3.838197518412426*^9, 
   3.838197537022626*^9}, 3.838354173953002*^9, 3.8383544325390043`*^9, {
   3.838354559879693*^9, 3.8383545844135427`*^9}, 3.838437454340425*^9, 
   3.8386949610540257`*^9, {3.838698889811092*^9, 3.838698906779139*^9}, {
   3.838699821471425*^9, 3.83869988477948*^9}, {3.838700087249617*^9, 
   3.838700115149205*^9}, 3.838883982557371*^9, {3.838884425674006*^9, 
   3.838884466446857*^9}, {3.838884509684677*^9, 3.838884519082439*^9}, {
   3.838884679375298*^9, 3.838884722427343*^9}, 3.8388852023435917`*^9, 
   3.8388865547976103`*^9, 3.838886585295733*^9, 3.8389565196962357`*^9, 
   3.838957068295257*^9, 3.838957113777787*^9, 3.839300318239327*^9, 
   3.839907181322254*^9, 3.839922473547883*^9, 3.839925437534092*^9, 
   3.839925619759066*^9, {3.839925769851269*^9, 3.839925782866544*^9}, 
   3.839926017961771*^9, 3.839926863715646*^9, 3.8399279849063396`*^9, 
   3.8399881568252697`*^9, 3.8399899837842407`*^9, 3.8399901625326967`*^9, 
   3.839990393910696*^9, {3.8399904384614763`*^9, 3.839990500460194*^9}, {
   3.839990577014641*^9, 3.8399906022248363`*^9}, {3.839990651629342*^9, 
   3.839990714802765*^9}, 3.8399907905538397`*^9, 3.8399913500436907`*^9, 
   3.8399914200377483`*^9, {3.8399917374893837`*^9, 3.839991773360799*^9}, 
   3.839991844492547*^9, {3.839995053980176*^9, 3.8399950602845707`*^9}, {
   3.839995114539592*^9, 3.839995124070311*^9}, {3.840005776393983*^9, 
   3.840005799898006*^9}, 3.840005875259334*^9, 3.8400786282227383`*^9, {
   3.840080538610586*^9, 3.840080545918857*^9}, 3.8400806065379343`*^9, 
   3.840080637277802*^9, 3.840268854842648*^9, 3.840528032691893*^9, 
   3.841112940951008*^9, 3.841716900365094*^9, {3.841725056293642*^9, 
   3.841725081266758*^9}, 3.841738843627206*^9, {3.8417389072677717`*^9, 
   3.841738956173457*^9}, {3.841739486663186*^9, 3.8417394914218817`*^9}, 
   3.841740850381817*^9, 3.8417409250508738`*^9, 3.841975058878697*^9, 
   3.8419787620753*^9, 3.842067564924415*^9, 3.842068280900497*^9, 
   3.842239486063857*^9, 3.842256346928388*^9, 3.842411363614459*^9, 
   3.8424114759352427`*^9, 3.84249155006269*^9, 3.842493733557475*^9, 
   3.84249456840998*^9, 3.842497536592144*^9, 3.842498323846835*^9, {
   3.842498409710412*^9, 3.842498432707316*^9}, 3.8424988429300833`*^9, 
   3.842502057313094*^9, {3.8425045373043737`*^9, 3.842504559302311*^9}, {
   3.842504902915909*^9, 3.842504907779996*^9}, 3.8425120005139103`*^9, 
   3.8425788609320107`*^9, 3.8426703581415873`*^9, 3.842677638722488*^9, 
   3.842678810110403*^9, 3.842678965419258*^9, {3.842679009250581*^9, 
   3.842679021747843*^9}, {3.842679096636393*^9, 3.8426791225331373`*^9}, {
   3.842679371773077*^9, 3.842679386412108*^9}, 3.842684665936859*^9, {
   3.842685151916936*^9, 3.842685170554677*^9}, 3.842685235917677*^9, {
   3.842686782804693*^9, 3.842686808115036*^9}, 3.842688023223915*^9, 
   3.842688130135625*^9, 3.842688210947959*^9, 3.842931586019629*^9, 
   3.842931620951811*^9, {3.842932939020261*^9, 3.8429329642854156`*^9}, 
   3.842949745216279*^9, {3.8429498129151897`*^9, 3.842949840169348*^9}, 
   3.8430175134513283`*^9, 3.843103639206169*^9, 3.8431052963613358`*^9, 
   3.843105327661302*^9},
 CellLabel->
  "Out[345]=",ExpressionUUID->"944dc6fe-9f54-4df3-836b-e95bf03e0abc"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8419798240558023`*^9, 3.8419798284778843`*^9}, {
   3.841979876682139*^9, 3.84197988241896*^9}, 3.841980043781352*^9, {
   3.841985005911146*^9, 3.841985007362624*^9}, {3.842068673721623*^9, 
   3.842068680265994*^9}, {3.842077794980694*^9, 3.8420777996412277`*^9}, {
   3.842077993064715*^9, 3.8420779973992147`*^9}, {3.842089177571991*^9, 
   3.842089178791935*^9}, {3.8420898538488913`*^9, 3.842089854381344*^9}, 
   3.8420899149497232`*^9},
 CellLabel->
  "In[346]:=",ExpressionUUID->"faf1a1d3-18ac-4f43-9b8a-22fdf068e2fe"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"STerms", "[", "example2Regularity", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Should", " ", 
    RowBox[{"(", "probably", ")"}], " ", 
    RowBox[{"be", ":", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "+", 
         SuperscriptBox["\[FormalZ]", "2"]}], ",", 
        RowBox[{"1", "+", 
         SuperscriptBox["\[FormalZ]", "2"]}], ",", "1", ",", 
        RowBox[{"1", "+", 
         RowBox[{"2", 
          SuperscriptBox["\[FormalZ]", "2"]}]}]}], "}"}], 
      "\[IndentingNewLine]", "order", " ", "of", " ", "models", " ", "in", 
      " ", 
      RowBox[{"Tim", "'"}], "s", " ", "implementatation", " ", "is"}], ":", 
     "\[IndentingNewLine]", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"[", 
        RowBox[{
        "False", ",", "False", ",", "False", ",", "True", ",", "True"}], 
        "]"}], ",", 
       RowBox[{"[", 
        RowBox[{
        "False", ",", "False", ",", "False", ",", "False", ",", "True"}], 
        "]"}], ",", 
       RowBox[{"[", 
        RowBox[{
        "False", ",", "False", ",", "False", ",", "False", ",", "False"}], 
        "]"}], ",", 
       RowBox[{"[", 
        RowBox[{
        "False", ",", "False", ",", "False", ",", "True", ",", "False"}], 
        "]"}]}], "]"}]}]}], "\n", "\[IndentingNewLine]", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.841980823386189*^9, 3.8419808296791277`*^9}, {
   3.842498347535054*^9, 3.842498368015354*^9}, {3.842686506042798*^9, 
   3.842686511176292*^9}, {3.842686810866118*^9, 3.842686811411688*^9}, 
   3.8426880459644527`*^9, {3.842690693146228*^9, 3.842690705400178*^9}, {
   3.84269084308922*^9, 3.84269086256057*^9}, 3.842690903872554*^9, {
   3.842691027697804*^9, 3.8426910376635427`*^9}, {3.84269109716497*^9, 
   3.842691141738081*^9}},
 CellLabel->
  "In[347]:=",ExpressionUUID->"ffc8d311-9c1b-46c0-9b49-491e4eda5d62"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", 
   RowBox[{"1", "+", 
    SuperscriptBox["\[FormalZ]", "2"]}], ",", 
   RowBox[{"1", "+", 
    SuperscriptBox["\[FormalZ]", "2"]}], ",", 
   RowBox[{"1", "+", 
    RowBox[{"4", " ", 
     SuperscriptBox["\[FormalZ]", "2"]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.842931586049631*^9, 3.842931620974833*^9, {3.842932943313965*^9, 
   3.842932964306656*^9}, 3.842941030622798*^9, 3.843017513473928*^9, 
   3.8431036392286043`*^9, 3.843105296395439*^9, 3.843105327682749*^9},
 CellLabel->
  "Out[347]=",ExpressionUUID->"9023d5fb-165f-4e12-8d11-a0ee253fb270"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "1", ",", 
   RowBox[{"1", "+", 
    SuperscriptBox["\[FormalZ]", "2"]}], ",", 
   RowBox[{"1", "+", 
    SuperscriptBox["\[FormalZ]", "2"]}]}], "}"}]], "Input",
 CellChangeTimes->{3.842691023589793*^9},
 CellLabel->
  "In[348]:=",ExpressionUUID->"1b516721-dfd2-4a13-9011-22056b3d74b7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "1", ",", 
   RowBox[{"1", "+", 
    SuperscriptBox["\[FormalZ]", "2"]}], ",", 
   RowBox[{"1", "+", 
    SuperscriptBox["\[FormalZ]", "2"]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.842931620980525*^9, {3.842932943330945*^9, 3.842932964317295*^9}, 
   3.8430175134867277`*^9, 3.84310363924069*^9, 3.843105296407399*^9, 
   3.843105327693388*^9},
 CellLabel->
  "Out[348]=",ExpressionUUID->"7fe9d051-c08c-4f1d-a8cb-0e36b6c49689"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8426907828227863`*^9, 3.842690801803211*^9}, 
   3.842949000937901*^9},
 CellLabel->
  "In[349]:=",ExpressionUUID->"38fa3a29-0343-44f1-babe-6d01d432a5aa"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"FormulaCellsValid", "[", 
    RowBox[{"example2Regularity", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"SatisfiabilityInstances", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"example2Regularity", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "/.", "#"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"e", "[", 
           RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], ",", 
          RowBox[{"e", "[", 
           RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}], ",", 
          RowBox[{"f1", "[", 
           RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], ",", 
          RowBox[{"f2", "[", 
           RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], "&"}], " ", "/@", "  ", "%"}], " ", "//",
     " ", "Column"}]}]}]], "Input",
 CellChangeTimes->{{3.842426670494026*^9, 3.8424266811921864`*^9}, {
  3.8424946177722673`*^9, 3.842494659467057*^9}, {3.842946351843321*^9, 
  3.842946409196913*^9}, {3.842948939013582*^9, 3.842949041877284*^9}},
 CellLabel->
  "In[350]:=",ExpressionUUID->"fe0a984a-b40b-4fd3-a472-cf44d95b7e7d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"e", "[", 
       RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", "False"}],
      ",", 
     RowBox[{
      RowBox[{"f1", "[", 
       RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", "False"}],
      ",", 
     RowBox[{
      RowBox[{"f2", "[", 
       RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", "False"}],
      ",", 
     RowBox[{
      RowBox[{"s1", "[", "\[FormalA]", "]"}], "\[Rule]", "False"}], ",", 
     RowBox[{
      RowBox[{"s2", "[", "\[FormalA]", "]"}], "\[Rule]", "False"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"e", "[", 
       RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", "False"}],
      ",", 
     RowBox[{
      RowBox[{"f1", "[", 
       RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", "False"}],
      ",", 
     RowBox[{
      RowBox[{"f2", "[", 
       RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", "False"}],
      ",", 
     RowBox[{
      RowBox[{"s1", "[", "\[FormalA]", "]"}], "\[Rule]", "False"}], ",", 
     RowBox[{
      RowBox[{"s2", "[", "\[FormalA]", "]"}], "\[Rule]", "True"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"e", "[", 
       RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", "False"}],
      ",", 
     RowBox[{
      RowBox[{"f1", "[", 
       RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", "False"}],
      ",", 
     RowBox[{
      RowBox[{"f2", "[", 
       RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", "False"}],
      ",", 
     RowBox[{
      RowBox[{"s1", "[", "\[FormalA]", "]"}], "\[Rule]", "True"}], ",", 
     RowBox[{
      RowBox[{"s2", "[", "\[FormalA]", "]"}], "\[Rule]", "False"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"e", "[", 
       RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", "False"}],
      ",", 
     RowBox[{
      RowBox[{"f1", "[", 
       RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", "False"}],
      ",", 
     RowBox[{
      RowBox[{"f2", "[", 
       RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", "False"}],
      ",", 
     RowBox[{
      RowBox[{"s1", "[", "\[FormalA]", "]"}], "\[Rule]", "True"}], ",", 
     RowBox[{
      RowBox[{"s2", "[", "\[FormalA]", "]"}], "\[Rule]", "True"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.842494661045968*^9, 3.842497536767804*^9, 3.8425020574541187`*^9, {
   3.8425045374709787`*^9, 3.8425045594579906`*^9}, 3.842578861219552*^9, 
   3.842670358313191*^9, 3.842678810253913*^9, 3.842678965632924*^9, 
   3.842679009394916*^9, 3.842679096778264*^9, {3.842679371932672*^9, 
   3.842679386555375*^9}, 3.842931588898726*^9, 3.842931621104723*^9, {
   3.8429329434871273`*^9, 3.84293296445893*^9}, {3.842946353128191*^9, 
   3.842946372025078*^9}, 3.84294641221021*^9, {3.84294894014196*^9, 
   3.842948962964452*^9}, {3.8429489936672773`*^9, 3.842949042363619*^9}, 
   3.843017513509437*^9, 3.843103639261375*^9, 3.84310529646*^9, 
   3.843105327711995*^9},
 CellLabel->
  "Out[350]=",ExpressionUUID->"4e4a0b22-78a7-4e5b-b6ff-98eaa7ceecfe"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"False", ",", "False", ",", "False", ",", "False"}], "}"}], 
      "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"True", ",", "True", ",", "False", ",", "True"}], "}"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"True", ",", "True", ",", "True", ",", "False"}], "}"}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"True", ",", "True", ",", "True", ",", "False"}], "}"}], 
      "}"}]}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Output",
 CellChangeTimes->{
  3.842494661045968*^9, 3.842497536767804*^9, 3.8425020574541187`*^9, {
   3.8425045374709787`*^9, 3.8425045594579906`*^9}, 3.842578861219552*^9, 
   3.842670358313191*^9, 3.842678810253913*^9, 3.842678965632924*^9, 
   3.842679009394916*^9, 3.842679096778264*^9, {3.842679371932672*^9, 
   3.842679386555375*^9}, 3.842931588898726*^9, 3.842931621104723*^9, {
   3.8429329434871273`*^9, 3.84293296445893*^9}, {3.842946353128191*^9, 
   3.842946372025078*^9}, 3.84294641221021*^9, {3.84294894014196*^9, 
   3.842948962964452*^9}, {3.8429489936672773`*^9, 3.842949042363619*^9}, 
   3.843017513509437*^9, 3.843103639261375*^9, 3.84310529646*^9, 
   3.843105327713388*^9},
 CellLabel->
  "Out[351]=",ExpressionUUID->"a44bdf4e-2dc6-4752-af1f-d4846afb625a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"FormulaCellsValid", "[", 
    RowBox[{"example2Regularity", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "]"}], " ", "//", " ", 
   "Column"}]}]], "Input",
 CellChangeTimes->{{3.842424199806501*^9, 3.842424243193194*^9}, {
  3.8424266398346243`*^9, 3.842426660344995*^9}, {3.8425969514390783`*^9, 
  3.8425969534404173`*^9}, {3.8426024538342133`*^9, 3.842602453998652*^9}, {
  3.842602599984399*^9, 3.842602620702224*^9}},
 CellLabel->
  "In[352]:=",ExpressionUUID->"c75e1d7a-620f-4cb2-947a-cd33f46e90d6"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"e", "[", 
         RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", 
        "False"}], ",", 
       RowBox[{
        RowBox[{"f1", "[", 
         RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", 
        "False"}], ",", 
       RowBox[{
        RowBox[{"f2", "[", 
         RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", 
        "False"}], ",", 
       RowBox[{
        RowBox[{"s1", "[", "\[FormalA]", "]"}], "\[Rule]", "False"}], ",", 
       RowBox[{
        RowBox[{"s2", "[", "\[FormalA]", "]"}], "\[Rule]", "False"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"e", "[", 
         RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", 
        "False"}], ",", 
       RowBox[{
        RowBox[{"f1", "[", 
         RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", 
        "False"}], ",", 
       RowBox[{
        RowBox[{"f2", "[", 
         RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", 
        "False"}], ",", 
       RowBox[{
        RowBox[{"s1", "[", "\[FormalA]", "]"}], "\[Rule]", "False"}], ",", 
       RowBox[{
        RowBox[{"s2", "[", "\[FormalA]", "]"}], "\[Rule]", "True"}]}], 
      "}"}]},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"e", "[", 
         RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", 
        "False"}], ",", 
       RowBox[{
        RowBox[{"f1", "[", 
         RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", 
        "False"}], ",", 
       RowBox[{
        RowBox[{"f2", "[", 
         RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", 
        "False"}], ",", 
       RowBox[{
        RowBox[{"s1", "[", "\[FormalA]", "]"}], "\[Rule]", "True"}], ",", 
       RowBox[{
        RowBox[{"s2", "[", "\[FormalA]", "]"}], "\[Rule]", "False"}]}], "}"}]},
    {
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"e", "[", 
         RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", 
        "False"}], ",", 
       RowBox[{
        RowBox[{"f1", "[", 
         RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", 
        "False"}], ",", 
       RowBox[{
        RowBox[{"f2", "[", 
         RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", 
        "False"}], ",", 
       RowBox[{
        RowBox[{"s1", "[", "\[FormalA]", "]"}], "\[Rule]", "True"}], ",", 
       RowBox[{
        RowBox[{"s2", "[", "\[FormalA]", "]"}], "\[Rule]", "True"}]}], "}"}]}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Output",
 CellChangeTimes->{{3.8424242142215023`*^9, 3.842424243606419*^9}, 
   3.842426642521994*^9, 3.842491550305375*^9, {3.842493729494198*^9, 
   3.842493733949793*^9}, 3.842494568622232*^9, {3.842497536780237*^9, 
   3.842497551205678*^9}, 3.8425020574666033`*^9, {3.8425045374857883`*^9, 
   3.8425045594726152`*^9}, 3.842578861234462*^9, {3.842596945999043*^9, 
   3.84259695375585*^9}, 3.842602454515995*^9, {3.842602602327146*^9, 
   3.8426026167014236`*^9}, 3.842670358326449*^9, 3.842678810264473*^9, 
   3.842678965644209*^9, 3.8426790094050407`*^9, 3.842679096789125*^9, {
   3.8426793719473*^9, 3.8426793865667667`*^9}, 3.842931588911899*^9, 
   3.842931621116248*^9, {3.842932943505303*^9, 3.8429329644704313`*^9}, 
   3.8430175135243073`*^9, 3.843103639275936*^9, 3.843105296473823*^9, 
   3.843105327723154*^9},
 CellLabel->
  "Out[352]=",ExpressionUUID->"46809fe4-6cb2-4f69-a4e7-876afd5843e3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"SatisfiabilityInstances", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Not]", "e"}], "\[Or]", " ", "f1", "\[Or]", " ", "f2"}], 
     ")"}], "\[And]", 
    RowBox[{"(", 
     RowBox[{"f1", "\[Implies]", "e"}], ")"}], "\[And]", 
    RowBox[{"(", 
     RowBox[{"f2", "\[Implies]", "e"}], ")"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"e", ",", "f1", ",", "f2"}], "}"}], ",", "All"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"SatisfiabilityInstances", "[", 
  RowBox[{
   RowBox[{"e", "\[Equivalent]", 
    RowBox[{"(", 
     RowBox[{"f1", "\[Or]", "f2"}], ")"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"e", ",", "f1", ",", "f2"}], "}"}], ",", "All"}], "]"}]}], "Input",\

 CellChangeTimes->{{3.842501897759088*^9, 3.842501981346961*^9}},
 CellLabel->
  "In[353]:=",ExpressionUUID->"433b46ea-1aab-4939-a788-2b2fcf74139a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"True", ",", "True", ",", "True"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"True", ",", "True", ",", "False"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"True", ",", "False", ",", "True"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"False", ",", "False", ",", "False"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.842501920772787*^9, 3.8425019492231283`*^9}, 
   3.842501982064643*^9, 3.842502057483438*^9, {3.842504537507218*^9, 
   3.842504559494421*^9}, 3.842578861278233*^9, 3.842670358340785*^9, 
   3.842678810277062*^9, 3.8426789656645813`*^9, 3.842679009418912*^9, 
   3.8426790968017073`*^9, {3.842679371962942*^9, 3.842679386580529*^9}, 
   3.842931588927992*^9, 3.8429316211332893`*^9, {3.842932943526228*^9, 
   3.842932964483356*^9}, 3.843017513538994*^9, 3.843103639290843*^9, 
   3.8431052965025597`*^9, 3.843105327735961*^9},
 CellLabel->
  "Out[353]=",ExpressionUUID->"f54c1bba-4270-4c4c-b0d4-a0de76fc75d5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"True", ",", "True", ",", "True"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"True", ",", "True", ",", "False"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"True", ",", "False", ",", "True"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"False", ",", "False", ",", "False"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.842501920772787*^9, 3.8425019492231283`*^9}, 
   3.842501982064643*^9, 3.842502057483438*^9, {3.842504537507218*^9, 
   3.842504559494421*^9}, 3.842578861278233*^9, 3.842670358340785*^9, 
   3.842678810277062*^9, 3.8426789656645813`*^9, 3.842679009418912*^9, 
   3.8426790968017073`*^9, {3.842679371962942*^9, 3.842679386580529*^9}, 
   3.842931588927992*^9, 3.8429316211332893`*^9, {3.842932943526228*^9, 
   3.842932964483356*^9}, 3.843017513538994*^9, 3.843103639290843*^9, 
   3.8431052965025597`*^9, 3.84310532773949*^9},
 CellLabel->
  "Out[354]=",ExpressionUUID->"a15a550f-cc6f-446f-96d9-a05bb31ea5f4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"#", "->", "1"}], "&"}], "/@", " ", 
  RowBox[{"UnaryPredicateSymbols", "[", 
   RowBox[{"First", "@", "example2Regularity"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.842677739887353*^9, 3.842677768284544*^9}, {
  3.842677819338941*^9, 3.84267786061169*^9}, {3.842678345872422*^9, 
  3.842678369077306*^9}, {3.842678725189828*^9, 3.8426787260350857`*^9}},
 CellLabel->
  "In[355]:=",ExpressionUUID->"90def5fd-d3ca-4dad-9f1d-3362578ad2d5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"s1", "\[Rule]", "1"}], ",", 
   RowBox[{"s2", "\[Rule]", "1"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.842677749892769*^9, {3.842677822700458*^9, 3.8426778446558647`*^9}, 
   3.84267836949629*^9, 3.842678726424181*^9, 3.842678810290185*^9, 
   3.84267896568531*^9, 3.8426790094332123`*^9, 3.842679096815583*^9, {
   3.8426793719804497`*^9, 3.842679386595422*^9}, 3.842931588946871*^9, 
   3.842931621151861*^9, {3.842932943548604*^9, 3.842932964497836*^9}, 
   3.843017513554441*^9, 3.843103639305828*^9, 3.843105296519059*^9, 
   3.843105327749442*^9},
 CellLabel->
  "Out[355]=",ExpressionUUID->"02f46927-217a-4bd4-bbb9-134af3cb14d2"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8426912035796967`*^9, 3.842691205686574*^9}},
 CellLabel->
  "In[356]:=",ExpressionUUID->"53be15de-9c20-4ffc-8406-9c5b002d3f28"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"STerm", "[", 
  RowBox[{
   RowBox[{"example2Regularity", "[", 
    RowBox[{"[", "1", "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"e", "[", 
       RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", "False"}],
      ",", 
     RowBox[{
      RowBox[{"f1", "[", 
       RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", "False"}],
      ",", 
     RowBox[{
      RowBox[{"f2", "[", 
       RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", "False"}],
      ",", 
     RowBox[{
      RowBox[{"s1", "[", "\[FormalA]", "]"}], "\[Rule]", "False"}], ",", 
     RowBox[{
      RowBox[{"s2", "[", "\[FormalA]", "]"}], "\[Rule]", "False"}]}], "}"}], 
   ",", 
   RowBox[{"example2Regularity", "[", 
    RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
   RowBox[{"example2Regularity", "[", 
    RowBox[{"[", "3", "]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.842691263942565*^9, 3.842691287562791*^9}},
 CellLabel->
  "In[357]:=",ExpressionUUID->"245cbaa0-c0c1-4efc-94be-e104cd1c5f7b"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{
  3.842691288002749*^9, 3.842691361736292*^9, 3.8429315889718122`*^9, 
   3.842931621177846*^9, {3.842932943575015*^9, 3.842932964518599*^9}, 
   3.843017513576345*^9, 3.843103639326075*^9, 3.843105296538877*^9, 
   3.843105327767174*^9},
 CellLabel->
  "Out[357]=",ExpressionUUID->"16a74cd8-5d93-4dca-981b-f3dad80ac25b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"example2Regularity", "[", 
   RowBox[{"[", "1", "]"}], "]"}], " ", "/.", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"e", "[", 
      RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", "False"}], 
    ",", 
    RowBox[{
     RowBox[{"f1", "[", 
      RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", "False"}], 
    ",", 
    RowBox[{
     RowBox[{"f2", "[", 
      RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", "False"}], 
    ",", 
    RowBox[{
     RowBox[{"s1", "[", "\[FormalA]", "]"}], "\[Rule]", "False"}], ",", 
    RowBox[{
     RowBox[{"s2", "[", "\[FormalA]", "]"}], "\[Rule]", "False"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FormulaSymmetric", "[", 
    RowBox[{"example2Regularity", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "]"}], " ", "/.", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"e", "[", 
       RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", "False"}],
      ",", 
     RowBox[{
      RowBox[{"f1", "[", 
       RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", "False"}],
      ",", 
     RowBox[{
      RowBox[{"f2", "[", 
       RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", "False"}],
      ",", 
     RowBox[{
      RowBox[{"s1", "[", "\[FormalA]", "]"}], "\[Rule]", "False"}], ",", 
     RowBox[{
      RowBox[{"s2", "[", "\[FormalA]", "]"}], "\[Rule]", "False"}]}], "}"}]}],
   " ", "/.", " ", 
  RowBox[{"(", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"e", "[", 
        RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", 
       "False"}], ",", 
      RowBox[{
       RowBox[{"f1", "[", 
        RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", 
       "False"}], ",", 
      RowBox[{
       RowBox[{"f2", "[", 
        RowBox[{"\[FormalA]", ",", "\[FormalA]"}], "]"}], "\[Rule]", 
       "False"}], ",", 
      RowBox[{
       RowBox[{"s1", "[", "\[FormalA]", "]"}], "\[Rule]", "False"}], ",", 
      RowBox[{
       RowBox[{"s2", "[", "\[FormalA]", "]"}], "\[Rule]", "False"}]}], "}"}], 
    " ", "/.", 
    RowBox[{"\[FormalA]", "->", "\[FormalB]"}]}], ")"}]}]}], "Input",
 CellChangeTimes->{{3.84269140905194*^9, 3.842691495423662*^9}},
 CellLabel->
  "In[358]:=",ExpressionUUID->"8e7ee854-7a2d-4b14-ba44-4c18477302b6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"e", "[", 
     RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Equivalent]", 
    RowBox[{"e", "[", 
     RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}]}], ")"}], "&&", 
  RowBox[{"!", 
   RowBox[{"f1", "[", 
    RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}]}], "&&", 
  RowBox[{"!", 
   RowBox[{"f2", "[", 
    RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}]}], "&&", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"e", "[", 
     RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Equivalent]", 
    RowBox[{
     RowBox[{"f1", "[", 
      RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "||", 
     RowBox[{"f2", "[", 
      RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}]}]}], ")"}], "&&", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"f1", "[", 
      RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}]}], "||", 
    RowBox[{"!", 
     RowBox[{"f2", "[", 
      RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}]}]}], ")"}]}]], "Output",\

 CellChangeTimes->{
  3.8426914174481688`*^9, 3.842691451331513*^9, 3.842691496312664*^9, 
   3.8429315889848948`*^9, 3.842931621184436*^9, {3.842932943593611*^9, 
   3.84293296452975*^9}, 3.843017513590455*^9, 3.843103639338789*^9, 
   3.8431052965511227`*^9, 3.843105327777405*^9},
 CellLabel->
  "Out[358]=",ExpressionUUID->"77781675-372d-4a98-bc83-3c36e9e36eb9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"e", "[", 
     RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Equivalent]", 
    RowBox[{"e", "[", 
     RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}]}], ")"}], "&&", 
  RowBox[{"!", 
   RowBox[{"f1", "[", 
    RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}]}], "&&", 
  RowBox[{"!", 
   RowBox[{"f2", "[", 
    RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}]}], "&&", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"e", "[", 
     RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Equivalent]", 
    RowBox[{
     RowBox[{"f1", "[", 
      RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "||", 
     RowBox[{"f2", "[", 
      RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}]}]}], ")"}], "&&", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"f1", "[", 
      RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}]}], "||", 
    RowBox[{"!", 
     RowBox[{"f2", "[", 
      RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}]}]}], ")"}], "&&", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"e", "[", 
     RowBox[{"\[FormalA]", ",", "\[FormalB]"}], "]"}], "\[Equivalent]", 
    RowBox[{"e", "[", 
     RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}]}], ")"}], "&&", 
  RowBox[{"!", 
   RowBox[{"f1", "[", 
    RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}]}], "&&", 
  RowBox[{"!", 
   RowBox[{"f2", "[", 
    RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}]}], "&&", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"e", "[", 
     RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}], "\[Equivalent]", 
    RowBox[{
     RowBox[{"f1", "[", 
      RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}], "||", 
     RowBox[{"f2", "[", 
      RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}]}]}], ")"}], "&&", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"f1", "[", 
      RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}]}], "||", 
    RowBox[{"!", 
     RowBox[{"f2", "[", 
      RowBox[{"\[FormalB]", ",", "\[FormalA]"}], "]"}]}]}], ")"}]}]], "Output",\

 CellChangeTimes->{
  3.8426914174481688`*^9, 3.842691451331513*^9, 3.842691496312664*^9, 
   3.8429315889848948`*^9, 3.842931621184436*^9, {3.842932943593611*^9, 
   3.84293296452975*^9}, 3.843017513590455*^9, 3.843103639338789*^9, 
   3.8431052965511227`*^9, 3.843105327780884*^9},
 CellLabel->
  "Out[359]=",ExpressionUUID->"978a6ede-a8e9-499d-8961-d506fb3769f9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"s2reg", " ", "//", " ", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.842950055035297*^9, 3.842950087687544*^9}},
 CellLabel->
  "In[360]:=",ExpressionUUID->"af98fb1e-3d23-4eda-9258-f17bc46e8c0b"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"1"},
      {
       RowBox[{"1", "+", 
        SuperscriptBox["\[FormalZ]", "2"]}]},
      {
       RowBox[{"1", "+", 
        SuperscriptBox["\[FormalZ]", "2"]}]},
      {
       RowBox[{"1", "+", 
        RowBox[{"4", " ", 
         SuperscriptBox["\[FormalZ]", "2"]}]}]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8429500588904123`*^9, 3.842950088058281*^9}, 
   3.843017513606585*^9, 3.843103639353582*^9, 3.843105296567019*^9, 
   3.8431053277912073`*^9},
 CellLabel->
  "Out[360]//MatrixForm=",ExpressionUUID->"51e5c20f-3a11-49a8-a014-\
5ddbecb6e6e1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"1", "+", 
     RowBox[{"4", " ", 
      SuperscriptBox["\[FormalZ]", "2"]}]}], "==", "0"}], ",", "\[FormalZ]"}],
   "]"}]], "Input",
 CellChangeTimes->{{3.843022205333358*^9, 3.843022220823015*^9}},
 CellLabel->
  "In[361]:=",ExpressionUUID->"d442a6bd-5619-4721-a4a8-561bd53fb87d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[FormalZ]", "\[Rule]", 
     RowBox[{"-", 
      FractionBox["\[ImaginaryI]", "2"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[FormalZ]", "\[Rule]", 
     FractionBox["\[ImaginaryI]", "2"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.843022221341955*^9, 3.8431036393720617`*^9, 
  3.843105296582614*^9, 3.8431053278036203`*^9},
 CellLabel->
  "Out[361]=",ExpressionUUID->"183fc5a6-b031-4f04-a9b2-8207473b6248"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.84302424581693*^9, 3.843024249862726*^9}, {
  3.843024352473624*^9, 3.8430243645691633`*^9}, {3.8430244152871923`*^9, 
  3.843024442396989*^9}},
 CellLabel->
  "In[362]:=",ExpressionUUID->"8bfd1b06-e7d4-448f-80b2-1dc3ad6832da"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"s", "[", 
  RowBox[{"[", 
   RowBox[{"cliques", "[", 
    RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8430244676937237`*^9, 3.843024486923085*^9}, {
  3.843024968044166*^9, 3.843024973930616*^9}},
 CellLabel->
  "In[363]:=",ExpressionUUID->"278795bc-cbcc-4ad3-8537-eac89ccdf9be"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", "+", 
   RowBox[{"2", " ", "\[FormalZ]"}], "+", 
   SuperscriptBox["\[FormalZ]", "2"]}], "}"}]], "Output",
 CellChangeTimes->{{3.843024471675465*^9, 3.843024487509843*^9}, {
   3.843024969596785*^9, 3.8430249742943296`*^9}, 3.843103639390649*^9, 
   3.8431052966021442`*^9, 3.8431053278217487`*^9},
 CellLabel->
  "Out[363]=",ExpressionUUID->"a5eeda8b-1437-4896-849c-2eae6a61f7fb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"#", "[", 
    RowBox[{"[", 
     RowBox[{"cliques", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "&"}], "/@", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"r", "+", 
     RowBox[{"Transpose", "[", "r", "]"}]}], ")"}], "[", 
   RowBox[{"[", 
    RowBox[{"cliques", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.843024489925268*^9, 3.843024498017353*^9}, {
  3.843024544801491*^9, 3.843024554503744*^9}, {3.843024837994681*^9, 
  3.843024841961253*^9}},
 CellLabel->
  "In[364]:=",ExpressionUUID->"4b14b352-9182-4a2d-bedd-946b30c95fac"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"1", "+", "\[FormalZ]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "+", "\[FormalZ]"}], ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.843024490298761*^9, 3.843024498420444*^9}, 
   3.843024555165662*^9, 3.8430248425089493`*^9, 3.843103639404676*^9, 
   3.8431052966142693`*^9, 3.84310532783119*^9},
 CellLabel->
  "Out[364]=",ExpressionUUID->"0df44be1-6e95-4188-9fa4-6fd7277104af"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["cliques"], "Input",
 CellChangeTimes->{{3.843024625358433*^9, 3.8430246261190453`*^9}},
 CellLabel->
  "In[365]:=",ExpressionUUID->"72c4e250-cf4a-4040-9f75-e567b5afa601"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "1", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", "4", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.843024626406014*^9, 3.84310363941676*^9, 
  3.8431052966285543`*^9, 3.843105327843047*^9},
 CellLabel->
  "Out[365]=",ExpressionUUID->"256d02a9-8f11-4901-97f0-ac90952309b6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"r", "[", 
  RowBox[{"[", 
   RowBox[{"2", ",", "3"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"r", "[", 
  RowBox[{"[", 
   RowBox[{"3", ",", "2"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.843024716041768*^9, 3.84302472721484*^9}},
 CellLabel->
  "In[366]:=",ExpressionUUID->"c25c8f52-626d-4e22-864d-c897854e3a00"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.843024718776146*^9, 3.843024727682603*^9}, 
   3.843103639436366*^9, 3.843105296643153*^9, 3.843105327855549*^9},
 CellLabel->
  "Out[366]=",ExpressionUUID->"c21607a7-419e-4bd3-a1a7-431b1682ab54"],

Cell[BoxData[
 RowBox[{"1", "+", "\[FormalZ]"}]], "Output",
 CellChangeTimes->{{3.843024718776146*^9, 3.843024727682603*^9}, 
   3.843103639436366*^9, 3.843105296643153*^9, 3.843105327859273*^9},
 CellLabel->
  "Out[367]=",ExpressionUUID->"80369471-db20-4512-bd87-76ea9eeb37f6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["cliques"], "Input",
 CellChangeTimes->{{3.8430317717509727`*^9, 3.843031772506024*^9}},
 CellLabel->
  "In[368]:=",ExpressionUUID->"15d4a89d-b0cf-4452-b819-43059d71adbe"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "1", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", "4", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.8430317728268013`*^9, 3.84310529665917*^9, 
  3.8431053278689327`*^9},
 CellLabel->
  "Out[368]=",ExpressionUUID->"317ca3cd-fb4e-44b8-a061-b84542ed20b3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SRratio", "[", 
  RowBox[{"s", ",", "r", ",", 
   RowBox[{"cliques", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8430317587372637`*^9, 3.843031766758976*^9}},
 CellLabel->
  "In[369]:=",ExpressionUUID->"768e878d-6962-4f99-9921-f5489ad8d0ca"],

Cell[BoxData[
 FractionBox["1", 
  RowBox[{"1", "+", "\[FormalZ]"}]]], "Output",
 CellChangeTimes->{3.8430317672771273`*^9, 3.843031810194171*^9, 
  3.843103639451549*^9, 3.843105296673456*^9, 3.843105327882214*^9},
 CellLabel->
  "Out[369]=",ExpressionUUID->"e928a274-37bd-4f50-8091-dc7841980397"]
}, Open  ]]
},
WindowSize->{1368.7128712871288`, 749.2277227722773},
WindowMargins->{{-1368.7128712871288`, Automatic}, {0, Automatic}},
DockedCells->{},
Magnification:>0.8 Inherited,
FrontEndVersion->"12.3 for Linux x86 (64-bit) (June 19, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"3f7ebace-b87e-4310-9597-9cae25c330a8"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 47455, 1098, 3072, "Input",ExpressionUUID->"bd4dac13-24d5-43d7-ae76-3f67079096f2"],
Cell[CellGroupData[{
Cell[48038, 1122, 20298, 495, 1191, "Input",ExpressionUUID->"e916d1d5-57da-4d6d-a398-e237d7a69b52"],
Cell[68339, 1619, 2110, 43, 82, "Output",ExpressionUUID->"d1a89991-f078-4ae0-b0cd-bbcd593fc2d6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[70486, 1667, 9848, 204, 918, "Input",ExpressionUUID->"cb5ccc7e-7f44-46d8-b840-19729f63b518"],
Cell[80337, 1873, 5378, 92, 142, "Output",ExpressionUUID->"d84ad9f6-f41f-4a86-ba38-17b219098208"],
Cell[85718, 1967, 4270, 72, 186, "Output",ExpressionUUID->"e58305b6-b94c-43f5-a4ef-5168c94f08c6"],
Cell[89991, 2041, 2779, 52, 28, "Output",ExpressionUUID->"d971bf89-bf8a-4f23-934e-6cb56f9096ed"],
Cell[92773, 2095, 6590, 113, 186, "Output",ExpressionUUID->"e0bc7684-e1d6-4121-bdea-8b22b8e9f8d5"],
Cell[99366, 2210, 2361, 37, 76, "Output",ExpressionUUID->"85ee27c6-80bd-44b9-9760-a861b9ef657a"]
}, Open  ]],
Cell[101742, 2250, 948, 27, 103, "Input",ExpressionUUID->"5fe55467-7b28-4389-a85d-cb7549b1264d"],
Cell[102693, 2279, 4823, 118, 405, "Input",ExpressionUUID->"de9d90ff-36d4-4acd-a124-54bc81661d37"],
Cell[CellGroupData[{
Cell[107541, 2401, 2615, 53, 144, "Input",ExpressionUUID->"3967da30-0426-4e51-8fed-f7c482dc836e"],
Cell[110159, 2456, 5773, 94, 28, "Output",ExpressionUUID->"2c245540-b680-4840-bdf9-2d46bc2e8f90"],
Cell[115935, 2552, 4849, 70, 26, "Output",ExpressionUUID->"006feb05-3ce1-4e4e-bf9e-35ddde677dd1"],
Cell[120787, 2624, 4840, 69, 26, "Output",ExpressionUUID->"834fca88-73b4-4b17-a9ac-62e4044b5f90"]
}, Open  ]],
Cell[CellGroupData[{
Cell[125664, 2698, 234, 5, 24, "Input",ExpressionUUID->"683368db-8a73-4cfb-935a-6b3f32f4c0b6"],
Cell[125901, 2705, 4642, 67, 26, "Output",ExpressionUUID->"944dc6fe-9f54-4df3-836b-e95bf03e0abc"]
}, Open  ]],
Cell[130558, 2775, 576, 9, 23, "Input",ExpressionUUID->"faf1a1d3-18ac-4f43-9b8a-22fdf068e2fe"],
Cell[CellGroupData[{
Cell[131159, 2788, 1924, 47, 123, "Input",ExpressionUUID->"ffc8d311-9c1b-46c0-9b49-491e4eda5d62"],
Cell[133086, 2837, 612, 15, 28, "Output",ExpressionUUID->"9023d5fb-165f-4e12-8d11-a0ee253fb270"]
}, Open  ]],
Cell[CellGroupData[{
Cell[133735, 2857, 335, 9, 25, "Input",ExpressionUUID->"1b516721-dfd2-4a13-9011-22056b3d74b7"],
Cell[134073, 2868, 482, 12, 28, "Output",ExpressionUUID->"7fe9d051-c08c-4f1d-a8cb-0e36b6c49689"]
}, Open  ]],
Cell[134570, 2883, 203, 4, 23, "Input",ExpressionUUID->"38fa3a29-0343-44f1-babe-6d01d432a5aa"],
Cell[CellGroupData[{
Cell[134798, 2891, 1327, 31, 110, "Input",ExpressionUUID->"fe0a984a-b40b-4fd3-a472-cf44d95b7e7d"],
Cell[136128, 2924, 3265, 91, 46, "Output",ExpressionUUID->"4e4a0b22-78a7-4e5b-b6ff-98eaa7ceecfe"],
Cell[139396, 3017, 1503, 37, 68, "Output",ExpressionUUID->"a44bdf4e-2dc6-4752-af1f-d4846afb625a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[140936, 3059, 573, 12, 41, "Input",ExpressionUUID->"c75e1d7a-620f-4cb2-947a-cd33f46e90d6"],
Cell[141512, 3073, 3708, 97, 84, "Output",ExpressionUUID->"46809fe4-6cb2-4f69-a4e7-876afd5843e3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[145257, 3175, 874, 25, 43, "Input",ExpressionUUID->"433b46ea-1aab-4939-a788-2b2fcf74139a"],
Cell[146134, 3202, 1003, 20, 26, "Output",ExpressionUUID->"f54c1bba-4270-4c4c-b0d4-a0de76fc75d5"],
Cell[147140, 3224, 1002, 20, 26, "Output",ExpressionUUID->"a15a550f-cc6f-446f-96d9-a05bb31ea5f4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[148179, 3249, 485, 10, 25, "Input",ExpressionUUID->"90def5fd-d3ca-4dad-9f1d-3362578ad2d5"],
Cell[148667, 3261, 693, 14, 26, "Output",ExpressionUUID->"02f46927-217a-4bd4-bbb9-134af3cb14d2"]
}, Open  ]],
Cell[149375, 3278, 177, 3, 23, "Input",ExpressionUUID->"53be15de-9c20-4ffc-8406-9c5b002d3f28"],
Cell[CellGroupData[{
Cell[149577, 3285, 1069, 30, 25, "Input",ExpressionUUID->"245cbaa0-c0c1-4efc-94be-e104cd1c5f7b"],
Cell[150649, 3317, 370, 7, 26, "Output",ExpressionUUID->"16a74cd8-5d93-4dca-981b-f3dad80ac25b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[151056, 3329, 2399, 71, 43, "Input",ExpressionUUID->"8e7ee854-7a2d-4b14-ba44-4c18477302b6"],
Cell[153458, 3402, 1397, 38, 28, "Output",ExpressionUUID->"77781675-372d-4a98-bc83-3c36e9e36eb9"],
Cell[154858, 3442, 2396, 67, 28, "Output",ExpressionUUID->"978a6ede-a8e9-499d-8961-d506fb3769f9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[157291, 3514, 222, 4, 24, "Input",ExpressionUUID->"af98fb1e-3d23-4eda-9258-f17bc46e8c0b"],
Cell[157516, 3520, 1042, 32, 87, "Output",ExpressionUUID->"51e5c20f-3a11-49a8-a014-5ddbecb6e6e1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[158595, 3557, 355, 10, 25, "Input",ExpressionUUID->"d442a6bd-5619-4721-a4a8-561bd53fb87d"],
Cell[158953, 3569, 493, 13, 40, "Output",ExpressionUUID->"183fc5a6-b031-4f04-a9b2-8207473b6248"]
}, Open  ]],
Cell[159461, 3585, 276, 5, 23, "Input",ExpressionUUID->"8bfd1b06-e7d4-448f-80b2-1dc3ad6832da"],
Cell[CellGroupData[{
Cell[159762, 3594, 337, 8, 25, "Input",ExpressionUUID->"278795bc-cbcc-4ad3-8537-eac89ccdf9be"],
Cell[160102, 3604, 425, 9, 28, "Output",ExpressionUUID->"a5eeda8b-1437-4896-849c-2eae6a61f7fb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[160564, 3618, 635, 18, 25, "Input",ExpressionUUID->"4b14b352-9182-4a2d-bedd-946b30c95fac"],
Cell[161202, 3638, 511, 13, 28, "Output",ExpressionUUID->"0df44be1-6e95-4188-9fa4-6fd7277104af"]
}, Open  ]],
Cell[CellGroupData[{
Cell[161750, 3656, 184, 3, 23, "Input",ExpressionUUID->"72c4e250-cf4a-4040-9f75-e567b5afa601"],
Cell[161937, 3661, 375, 10, 26, "Output",ExpressionUUID->"256d02a9-8f11-4901-97f0-ac90952309b6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[162349, 3676, 353, 9, 40, "Input",ExpressionUUID->"c25c8f52-626d-4e22-864d-c897854e3a00"],
Cell[162705, 3687, 247, 4, 26, "Output",ExpressionUUID->"c21607a7-419e-4bd3-a1a7-431b1682ab54"],
Cell[162955, 3693, 278, 5, 28, "Output",ExpressionUUID->"80369471-db20-4512-bd87-76ea9eeb37f6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[163270, 3703, 184, 3, 23, "Input",ExpressionUUID->"15d4a89d-b0cf-4452-b819-43059d71adbe"],
Cell[163457, 3708, 355, 10, 26, "Output",ExpressionUUID->"317ca3cd-fb4e-44b8-a061-b84542ed20b3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[163849, 3723, 304, 7, 25, "Input",ExpressionUUID->"768e878d-6962-4f99-9921-f5489ad8d0ca"],
Cell[164156, 3732, 298, 6, 44, "Output",ExpressionUUID->"e928a274-37bd-4f50-8091-dc7841980397"]
}, Open  ]]
}
]
*)

